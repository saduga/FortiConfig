define("angular",["jquery","ftnt_shared"],function(){return function(window){"use strict";function minErr(module,ErrorConstructor){return ErrorConstructor=ErrorConstructor||Error,function(){var paramPrefix,i,SKIP_INDEXES=2,templateArgs=arguments,code=templateArgs[0],message="["+(module?module+":":"")+code+"] ",template=templateArgs[1];for(message+=template.replace(/\{\d+\}/g,function(match){var index=+match.slice(1,-1),shiftedIndex=index+SKIP_INDEXES;return shiftedIndex<templateArgs.length?toDebugString(templateArgs[shiftedIndex]):match}),message+="\nhttp://errors.angularjs.org/1.5.9/"+(module?module+"/":"")+code,i=SKIP_INDEXES,paramPrefix="?";i<templateArgs.length;i++,paramPrefix="&")message+=paramPrefix+"p"+(i-SKIP_INDEXES)+"="+encodeURIComponent(toDebugString(templateArgs[i]));return new ErrorConstructor(message)}}function isArrayLike(obj){if(null==obj||isWindow(obj))return!1;if(isArray(obj)||isString(obj)||jqLite&&obj instanceof jqLite)return!0;var length="length"in Object(obj)&&obj.length;return isNumber(length)&&(length>=0&&(length-1 in obj||obj instanceof Array)||"function"==typeof obj.item)}function forEach(obj,iterator,context){var key,length;if(obj)if(isFunction(obj))for(key in obj)"prototype"===key||"length"===key||"name"===key||obj.hasOwnProperty&&!obj.hasOwnProperty(key)||iterator.call(context,obj[key],key,obj);else if(isArray(obj)||isArrayLike(obj)){var isPrimitive="object"!=typeof obj;for(key=0,length=obj.length;key<length;key++)(isPrimitive||key in obj)&&iterator.call(context,obj[key],key,obj)}else if(obj.forEach&&obj.forEach!==forEach)obj.forEach(iterator,context,obj);else if(isBlankObject(obj))for(key in obj)iterator.call(context,obj[key],key,obj);else if("function"==typeof obj.hasOwnProperty)for(key in obj)obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key,obj);else for(key in obj)hasOwnProperty.call(obj,key)&&iterator.call(context,obj[key],key,obj);return obj}function forEachSorted(obj,iterator,context){for(var keys=Object.keys(obj).sort(),i=0;i<keys.length;i++)iterator.call(context,obj[keys[i]],keys[i]);return keys}function reverseParams(iteratorFn){return function(value,key){iteratorFn(key,value)}}function nextUid(){return++uid}function setHashKey(obj,h){h?obj.$$hashKey=h:delete obj.$$hashKey}function baseExtend(dst,objs,deep){for(var h=dst.$$hashKey,i=0,ii=objs.length;i<ii;++i){var obj=objs[i];if(isObject(obj)||isFunction(obj))for(var keys=Object.keys(obj),j=0,jj=keys.length;j<jj;j++){var key=keys[j],src=obj[key];deep&&isObject(src)?isDate(src)?dst[key]=new Date(src.valueOf()):isRegExp(src)?dst[key]=new RegExp(src):src.nodeName?dst[key]=src.cloneNode(!0):isElement(src)?dst[key]=src.clone():(isObject(dst[key])||(dst[key]=isArray(src)?[]:{}),baseExtend(dst[key],[src],!0)):dst[key]=src}}return setHashKey(dst,h),dst}function extend(dst){return baseExtend(dst,slice.call(arguments,1),!1)}function merge(dst){return baseExtend(dst,slice.call(arguments,1),!0)}function toInt(str){return parseInt(str,10)}function inherit(parent,extra){return extend(Object.create(parent),extra)}function noop(){}function identity($){return $}function valueFn(value){return function(){return value}}function hasCustomToString(obj){return isFunction(obj.toString)&&obj.toString!==toString}function isUndefined(value){return"undefined"==typeof value}function isDefined(value){return"undefined"!=typeof value}function isObject(value){return null!==value&&"object"==typeof value}function isBlankObject(value){return null!==value&&"object"==typeof value&&!getPrototypeOf(value)}function isString(value){return"string"==typeof value}function isNumber(value){return"number"==typeof value}function isDate(value){return"[object Date]"===toString.call(value)}function isFunction(value){return"function"==typeof value}function isRegExp(value){return"[object RegExp]"===toString.call(value)}function isWindow(obj){return obj&&obj.window===obj}function isScope(obj){return obj&&obj.$evalAsync&&obj.$watch}function isFile(obj){return"[object File]"===toString.call(obj)}function isFormData(obj){return"[object FormData]"===toString.call(obj)}function isBlob(obj){return"[object Blob]"===toString.call(obj)}function isBoolean(value){return"boolean"==typeof value}function isPromiseLike(obj){return obj&&isFunction(obj.then)}function isTypedArray(value){return value&&isNumber(value.length)&&TYPED_ARRAY_REGEXP.test(toString.call(value))}function isArrayBuffer(obj){return"[object ArrayBuffer]"===toString.call(obj)}function isElement(node){return!(!node||!(node.nodeName||node.prop&&node.attr&&node.find))}function makeMap(str){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[items[i]]=!0;return obj}function nodeName_(element){return lowercase(element.nodeName||element[0]&&element[0].nodeName)}function arrayRemove(array,value){var index=array.indexOf(value);return index>=0&&array.splice(index,1),index}function copy(source,destination){function copyRecurse(source,destination){var key,h=destination.$$hashKey;if(isArray(source))for(var i=0,ii=source.length;i<ii;i++)destination.push(copyElement(source[i]));else if(isBlankObject(source))for(key in source)destination[key]=copyElement(source[key]);else if(source&&"function"==typeof source.hasOwnProperty)for(key in source)source.hasOwnProperty(key)&&(destination[key]=copyElement(source[key]));else for(key in source)hasOwnProperty.call(source,key)&&(destination[key]=copyElement(source[key]));return setHashKey(destination,h),destination}function copyElement(source){if(!isObject(source))return source;var index=stackSource.indexOf(source);if(index!==-1)return stackDest[index];if(isWindow(source)||isScope(source))throw ngMinErr("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");var needsRecurse=!1,destination=copyType(source);return void 0===destination&&(destination=isArray(source)?[]:Object.create(getPrototypeOf(source)),needsRecurse=!0),stackSource.push(source),stackDest.push(destination),needsRecurse?copyRecurse(source,destination):destination}function copyType(source){switch(toString.call(source)){case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return new source.constructor(copyElement(source.buffer),source.byteOffset,source.length);case"[object ArrayBuffer]":if(!source.slice){var copied=new ArrayBuffer(source.byteLength);return new Uint8Array(copied).set(new Uint8Array(source)),copied}return source.slice(0);case"[object Boolean]":case"[object Number]":case"[object String]":case"[object Date]":return new source.constructor(source.valueOf());case"[object RegExp]":var re=new RegExp(source.source,source.toString().match(/[^\/]*$/)[0]);return re.lastIndex=source.lastIndex,re;case"[object Blob]":return new source.constructor([source],{type:source.type})}if(isFunction(source.cloneNode))return source.cloneNode(!0)}var stackSource=[],stackDest=[];if(destination){if(isTypedArray(destination)||isArrayBuffer(destination))throw ngMinErr("cpta","Can't copy! TypedArray destination cannot be mutated.");if(source===destination)throw ngMinErr("cpi","Can't copy! Source and destination are identical.");return isArray(destination)?destination.length=0:forEach(destination,function(value,key){"$$hashKey"!==key&&delete destination[key]}),stackSource.push(source),stackDest.push(destination),copyRecurse(source,destination)}return copyElement(source)}function equals(o1,o2){if(o1===o2)return!0;if(null===o1||null===o2)return!1;if(o1!==o1&&o2!==o2)return!0;var length,key,keySet,t1=typeof o1,t2=typeof o2;if(t1===t2&&"object"===t1){if(!isArray(o1)){if(isDate(o1))return!!isDate(o2)&&equals(o1.getTime(),o2.getTime());if(isRegExp(o1))return!!isRegExp(o2)&&o1.toString()===o2.toString();if(isScope(o1)||isScope(o2)||isWindow(o1)||isWindow(o2)||isArray(o2)||isDate(o2)||isRegExp(o2))return!1;keySet=createMap();for(key in o1)if("$"!==key.charAt(0)&&!isFunction(o1[key])){if(!equals(o1[key],o2[key]))return!1;keySet[key]=!0}for(key in o2)if(!(key in keySet)&&"$"!==key.charAt(0)&&isDefined(o2[key])&&!isFunction(o2[key]))return!1;return!0}if(!isArray(o2))return!1;if((length=o1.length)===o2.length){for(key=0;key<length;key++)if(!equals(o1[key],o2[key]))return!1;return!0}}return!1}function concat(array1,array2,index){return array1.concat(slice.call(array2,index))}function sliceArgs(args,startIndex){return slice.call(args,startIndex||0)}function bind(self,fn){var curryArgs=arguments.length>2?sliceArgs(arguments,2):[];return!isFunction(fn)||fn instanceof RegExp?fn:curryArgs.length?function(){return arguments.length?fn.apply(self,concat(curryArgs,arguments,0)):fn.apply(self,curryArgs)}:function(){return arguments.length?fn.apply(self,arguments):fn.call(self)}}function toJsonReplacer(key,value){var val=value;return"string"==typeof key&&"$"===key.charAt(0)&&"$"===key.charAt(1)?val=void 0:isWindow(value)?val="$WINDOW":value&&window.document===value?val="$DOCUMENT":isScope(value)&&(val="$SCOPE"),val}function toJson(obj,pretty){if(!isUndefined(obj))return isNumber(pretty)||(pretty=pretty?2:null),JSON.stringify(obj,toJsonReplacer,pretty)}function fromJson(json){return isString(json)?JSON.parse(json):json}function timezoneToOffset(timezone,fallback){timezone=timezone.replace(ALL_COLONS,"");var requestedTimezoneOffset=Date.parse("Jan 01, 1970 00:00:00 "+timezone)/6e4;return isNumberNaN(requestedTimezoneOffset)?fallback:requestedTimezoneOffset}function addDateMinutes(date,minutes){return date=new Date(date.getTime()),date.setMinutes(date.getMinutes()+minutes),date}function convertTimezoneToLocal(date,timezone,reverse){reverse=reverse?-1:1;var dateTimezoneOffset=date.getTimezoneOffset(),timezoneOffset=timezoneToOffset(timezone,dateTimezoneOffset);return addDateMinutes(date,reverse*(timezoneOffset-dateTimezoneOffset))}function startingTag(element){element=jqLite(element).clone();try{element.empty()}catch(e){}var elemHtml=jqLite("<div>").append(element).html();try{return element[0].nodeType===NODE_TYPE_TEXT?lowercase(elemHtml):elemHtml.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(match,nodeName){return"<"+lowercase(nodeName)})}catch(e){return lowercase(elemHtml)}}function tryDecodeURIComponent(value){try{return decodeURIComponent(value)}catch(e){}}function parseKeyValue(keyValue){var obj={};return forEach((keyValue||"").split("&"),function(keyValue){var splitPoint,key,val;keyValue&&(key=keyValue=keyValue.replace(/\+/g,"%20"),splitPoint=keyValue.indexOf("="),splitPoint!==-1&&(key=keyValue.substring(0,splitPoint),val=keyValue.substring(splitPoint+1)),key=tryDecodeURIComponent(key),isDefined(key)&&(val=!isDefined(val)||tryDecodeURIComponent(val),hasOwnProperty.call(obj,key)?isArray(obj[key])?obj[key].push(val):obj[key]=[obj[key],val]:obj[key]=val))}),obj}function toKeyValue(obj){var parts=[];return forEach(obj,function(value,key){isArray(value)?forEach(value,function(arrayValue){parts.push(encodeUriQuery(key,!0)+(arrayValue===!0?"":"="+encodeUriQuery(arrayValue,!0)))}):parts.push(encodeUriQuery(key,!0)+(value===!0?"":"="+encodeUriQuery(value,!0)))}),parts.length?parts.join("&"):""}function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function getNgAttribute(element,ngAttr){var attr,i,ii=ngAttrPrefixes.length;for(i=0;i<ii;++i)if(attr=ngAttrPrefixes[i]+ngAttr,isString(attr=element.getAttribute(attr)))return attr;return null}function allowAutoBootstrap(document){if(!document.currentScript)return!0;var src=document.currentScript.getAttribute("src"),link=document.createElement("a");link.href=src;var scriptProtocol=link.protocol,docLoadProtocol=document.location.protocol;if(docLoadProtocol===scriptProtocol)return!0;switch(scriptProtocol){case"http:":case"https:":case"ftp:":case"blob:":case"file:":case"data:":return!0;default:return!1}}function angularInit(element,bootstrap){var appElement,module,config={};if(forEach(ngAttrPrefixes,function(prefix){var name=prefix+"app";!appElement&&element.hasAttribute&&element.hasAttribute(name)&&(appElement=element,module=element.getAttribute(name))}),forEach(ngAttrPrefixes,function(prefix){var candidate,name=prefix+"app";!appElement&&(candidate=element.querySelector("["+name.replace(":","\\:")+"]"))&&(appElement=candidate,module=candidate.getAttribute(name))}),appElement){if(!isAutoBootstrapAllowed)return void window.console.error("Angular: disabling automatic bootstrap. <script> protocol indicates an extension, document.location.href does not match.");config.strictDi=null!==getNgAttribute(appElement,"strict-di"),bootstrap(appElement,module?[module]:[],config)}}function bootstrap(element,modules,config){isObject(config)||(config={});var defaultConfig={strictDi:!1};config=extend(defaultConfig,config);var doBootstrap=function(){if(element=jqLite(element),element.injector()){var tag=element[0]===window.document?"document":startingTag(element);throw ngMinErr("btstrpd","App already bootstrapped with this element '{0}'",tag.replace(/</,"&lt;").replace(/>/,"&gt;"))}modules=modules||[],modules.unshift(["$provide",function($provide){$provide.value("$rootElement",element)}]),config.debugInfoEnabled&&modules.push(["$compileProvider",function($compileProvider){$compileProvider.debugInfoEnabled(!0)}]),modules.unshift("ng");var injector=createInjector(modules,config.strictDi);return injector.invoke(["$rootScope","$rootElement","$compile","$injector",function(scope,element,compile,injector){scope.$apply(function(){element.data("$injector",injector),compile(element)(scope)})}]),injector},NG_ENABLE_DEBUG_INFO=/^NG_ENABLE_DEBUG_INFO!/,NG_DEFER_BOOTSTRAP=/^NG_DEFER_BOOTSTRAP!/;return window&&NG_ENABLE_DEBUG_INFO.test(window.name)&&(config.debugInfoEnabled=!0,window.name=window.name.replace(NG_ENABLE_DEBUG_INFO,"")),window&&!NG_DEFER_BOOTSTRAP.test(window.name)?doBootstrap():(window.name=window.name.replace(NG_DEFER_BOOTSTRAP,""),angular.resumeBootstrap=function(extraModules){return forEach(extraModules,function(module){modules.push(module)}),doBootstrap()},void(isFunction(angular.resumeDeferredBootstrap)&&angular.resumeDeferredBootstrap()))}function reloadWithDebugInfo(){window.name="NG_ENABLE_DEBUG_INFO!"+window.name,window.location.reload()}function getTestability(rootElement){var injector=angular.element(rootElement).injector();if(!injector)throw ngMinErr("test","no injector found for element argument to getTestability");return injector.get("$$testability")}function snake_case(name,separator){return separator=separator||"_",name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}function bindJQuery(){var originalCleanData;if(!bindJQueryFired){var jqName=jq();jQuery=isUndefined(jqName)?window.jQuery:jqName?window[jqName]:void 0,jQuery&&jQuery.fn.on?(jqLite=jQuery,extend(jQuery.fn,{scope:JQLitePrototype.scope,isolateScope:JQLitePrototype.isolateScope,controller:JQLitePrototype.controller,injector:JQLitePrototype.injector,inheritedData:JQLitePrototype.inheritedData}),originalCleanData=jQuery.cleanData,jQuery.cleanData=function(elems){for(var events,elem,i=0;null!=(elem=elems[i]);i++)events=jQuery._data(elem,"events"),events&&events.$destroy&&jQuery(elem).triggerHandler("$destroy");originalCleanData(elems)}):jqLite=JQLite,angular.element=jqLite,bindJQueryFired=!0}}function assertArg(arg,name,reason){if(!arg)throw ngMinErr("areq","Argument '{0}' is {1}",name||"?",reason||"required");return arg}function assertArgFn(arg,name,acceptArrayAnnotation){return acceptArrayAnnotation&&isArray(arg)&&(arg=arg[arg.length-1]),assertArg(isFunction(arg),name,"not a function, got "+(arg&&"object"==typeof arg?arg.constructor.name||"Object":typeof arg)),arg}function assertNotHasOwnProperty(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)}function getter(obj,path,bindFnToScope){if(!path)return obj;for(var key,keys=path.split("."),lastInstance=obj,len=keys.length,i=0;i<len;i++)key=keys[i],obj&&(obj=(lastInstance=obj)[key]);return!bindFnToScope&&isFunction(obj)?bind(lastInstance,obj):obj}function getBlockNodes(nodes){for(var blockNodes,node=nodes[0],endNode=nodes[nodes.length-1],i=1;node!==endNode&&(node=node.nextSibling);i++)(blockNodes||nodes[i]!==node)&&(blockNodes||(blockNodes=jqLite(slice.call(nodes,0,i))),blockNodes.push(node));return blockNodes||nodes}function createMap(){return Object.create(null)}function setupModuleLoader(window){function ensure(obj,name,factory){return obj[name]||(obj[name]=factory())}var $injectorMinErr=minErr("$injector"),ngMinErr=minErr("ng"),angular=ensure(window,"angular",Object);return angular.$$minErr=angular.$$minErr||minErr,ensure(angular,"module",function(){var modules={};return function(name,requires,configFn){var assertNotHasOwnProperty=function(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)};return assertNotHasOwnProperty(name,"module"),requires&&modules.hasOwnProperty(name)&&(modules[name]=null),ensure(modules,name,function(){function invokeLater(provider,method,insertMethod,queue){return queue||(queue=invokeQueue),function(){return queue[insertMethod||"push"]([provider,method,arguments]),moduleInstance}}function invokeLaterAndSetModuleName(provider,method){return function(recipeName,factoryFunction){return factoryFunction&&isFunction(factoryFunction)&&(factoryFunction.$$moduleName=name),invokeQueue.push([provider,method,arguments]),moduleInstance}}if(!requires)throw $injectorMinErr("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",name);var invokeQueue=[],configBlocks=[],runBlocks=[],config=invokeLater("$injector","invoke","push",configBlocks),moduleInstance={_invokeQueue:invokeQueue,_configBlocks:configBlocks,_runBlocks:runBlocks,requires:requires,name:name,provider:invokeLaterAndSetModuleName("$provide","provider"),factory:invokeLaterAndSetModuleName("$provide","factory"),service:invokeLaterAndSetModuleName("$provide","service"),value:invokeLater("$provide","value"),constant:invokeLater("$provide","constant","unshift"),decorator:invokeLaterAndSetModuleName("$provide","decorator"),animation:invokeLaterAndSetModuleName("$animateProvider","register"),filter:invokeLaterAndSetModuleName("$filterProvider","register"),controller:invokeLaterAndSetModuleName("$controllerProvider","register"),directive:invokeLaterAndSetModuleName("$compileProvider","directive"),component:invokeLaterAndSetModuleName("$compileProvider","component"),config:config,run:function(block){return runBlocks.push(block),this}};return configFn&&config(configFn),moduleInstance})}})}function shallowCopy(src,dst){if(isArray(src)){dst=dst||[];for(var i=0,ii=src.length;i<ii;i++)dst[i]=src[i]}else if(isObject(src)){dst=dst||{};for(var key in src)"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key])}return dst||src}function serializeObject(obj){var seen=[];return JSON.stringify(obj,function(key,val){if(val=toJsonReplacer(key,val),isObject(val)){if(seen.indexOf(val)>=0)return"...";seen.push(val)}return val})}function toDebugString(obj){return"function"==typeof obj?obj.toString().replace(/ \{[\s\S]*$/,""):isUndefined(obj)?"undefined":"string"!=typeof obj?serializeObject(obj):obj}function publishExternalAPI(angular){extend(angular,{bootstrap:bootstrap,copy:copy,extend:extend,merge:merge,equals:equals,element:jqLite,forEach:forEach,injector:createInjector,noop:noop,bind:bind,toJson:toJson,fromJson:fromJson,identity:identity,isUndefined:isUndefined,isDefined:isDefined,isString:isString,isFunction:isFunction,isObject:isObject,isNumber:isNumber,isElement:isElement,isArray:isArray,version:version,isDate:isDate,lowercase:lowercase,uppercase:uppercase,callbacks:{$$counter:0},getTestability:getTestability,$$minErr:minErr,$$csp:csp,reloadWithDebugInfo:reloadWithDebugInfo}),(angularModule=setupModuleLoader(window))("ng",["ngLocale"],["$provide",function($provide){$provide.provider({$$sanitizeUri:$$SanitizeUriProvider}),$provide.provider("$compile",$CompileProvider).directive({a:htmlAnchorDirective,input:inputDirective,textarea:inputDirective,form:formDirective,script:scriptDirective,select:selectDirective,option:optionDirective,ngBind:ngBindDirective,ngBindHtml:ngBindHtmlDirective,ngBindTemplate:ngBindTemplateDirective,ngClass:ngClassDirective,ngClassEven:ngClassEvenDirective,ngClassOdd:ngClassOddDirective,ngCloak:ngCloakDirective,ngController:ngControllerDirective,ngForm:ngFormDirective,ngHide:ngHideDirective,ngIf:ngIfDirective,ngInclude:ngIncludeDirective,ngInit:ngInitDirective,ngNonBindable:ngNonBindableDirective,ngPluralize:ngPluralizeDirective,ngRepeat:ngRepeatDirective,ngShow:ngShowDirective,ngStyle:ngStyleDirective,ngSwitch:ngSwitchDirective,ngSwitchWhen:ngSwitchWhenDirective,ngSwitchDefault:ngSwitchDefaultDirective,ngOptions:ngOptionsDirective,ngTransclude:ngTranscludeDirective,ngModel:ngModelDirective,ngList:ngListDirective,ngChange:ngChangeDirective,pattern:patternDirective,ngPattern:patternDirective,required:requiredDirective,ngRequired:requiredDirective,minlength:minlengthDirective,ngMinlength:minlengthDirective,maxlength:maxlengthDirective,ngMaxlength:maxlengthDirective,ngValue:ngValueDirective,ngModelOptions:ngModelOptionsDirective}).directive({ngInclude:ngIncludeFillContentDirective}).directive(ngAttributeAliasDirectives).directive(ngEventDirectives),$provide.provider({$anchorScroll:$AnchorScrollProvider,$animate:$AnimateProvider,$animateCss:$CoreAnimateCssProvider,$$animateJs:$$CoreAnimateJsProvider,$$animateQueue:$$CoreAnimateQueueProvider,$$AnimateRunner:$$AnimateRunnerFactoryProvider,$$animateAsyncRun:$$AnimateAsyncRunFactoryProvider,$browser:$BrowserProvider,$cacheFactory:$CacheFactoryProvider,$controller:$ControllerProvider,$document:$DocumentProvider,$exceptionHandler:$ExceptionHandlerProvider,$filter:$FilterProvider,$$forceReflow:$$ForceReflowProvider,$interpolate:$InterpolateProvider,$interval:$IntervalProvider,$http:$HttpProvider,$httpParamSerializer:$HttpParamSerializerProvider,$httpParamSerializerJQLike:$HttpParamSerializerJQLikeProvider,$httpBackend:$HttpBackendProvider,$xhrFactory:$xhrFactoryProvider,$jsonpCallbacks:$jsonpCallbacksProvider,$location:$LocationProvider,$log:$LogProvider,$parse:$ParseProvider,$rootScope:$RootScopeProvider,$q:$QProvider,$$q:$$QProvider,$sce:$SceProvider,$sceDelegate:$SceDelegateProvider,$sniffer:$SnifferProvider,$templateCache:$TemplateCacheProvider,$templateRequest:$TemplateRequestProvider,$$testability:$$TestabilityProvider,$timeout:$TimeoutProvider,$window:$WindowProvider,$$rAF:$$RAFProvider,$$jqLite:$$jqLiteProvider,$$HashMap:$$HashMapProvider,$$cookieReader:$$CookieReaderProvider})}])}function jqNextId(){return++jqId}function camelCase(name){return name.replace(SPECIAL_CHARS_REGEXP,function(_,separator,letter,offset){return offset?letter.toUpperCase():letter}).replace(MOZ_HACK_REGEXP,"Moz$1")}function jqLiteIsTextNode(html){return!HTML_REGEXP.test(html)}function jqLiteAcceptsData(node){var nodeType=node.nodeType;return nodeType===NODE_TYPE_ELEMENT||!nodeType||nodeType===NODE_TYPE_DOCUMENT}function jqLiteHasData(node){for(var key in jqCache[node.ng339])return!0;return!1}function jqLiteCleanData(nodes){for(var i=0,ii=nodes.length;i<ii;i++)jqLiteRemoveData(nodes[i])}function jqLiteBuildFragment(html,context){var tmp,tag,wrap,i,fragment=context.createDocumentFragment(),nodes=[];if(jqLiteIsTextNode(html))nodes.push(context.createTextNode(html));else{for(tmp=fragment.appendChild(context.createElement("div")),tag=(TAG_NAME_REGEXP.exec(html)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+html.replace(XHTML_TAG_REGEXP,"<$1></$2>")+wrap[2],i=wrap[0];i--;)tmp=tmp.lastChild;nodes=concat(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent=""}return fragment.textContent="",fragment.innerHTML="",forEach(nodes,function(node){fragment.appendChild(node)}),fragment}function jqLiteParseHTML(html,context){context=context||window.document;var parsed;return(parsed=SINGLE_TAG_REGEXP.exec(html))?[context.createElement(parsed[1])]:(parsed=jqLiteBuildFragment(html,context))?parsed.childNodes:[]}function jqLiteWrapNode(node,wrapper){var parent=node.parentNode;parent&&parent.replaceChild(wrapper,node),wrapper.appendChild(node)}function JQLite(element){if(element instanceof JQLite)return element;var argIsString;if(isString(element)&&(element=trim(element),argIsString=!0),!(this instanceof JQLite)){if(argIsString&&"<"!==element.charAt(0))throw jqLiteMinErr("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new JQLite(element)}argIsString?jqLiteAddNodes(this,jqLiteParseHTML(element)):jqLiteAddNodes(this,element)}function jqLiteClone(element){return element.cloneNode(!0)}function jqLiteDealoc(element,onlyDescendants){if(onlyDescendants||jqLiteRemoveData(element),element.querySelectorAll)for(var descendants=element.querySelectorAll("*"),i=0,l=descendants.length;i<l;i++)jqLiteRemoveData(descendants[i])}function jqLiteOff(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("offargs","jqLite#off() does not support the `selector` argument");var expandoStore=jqLiteExpandoStore(element),events=expandoStore&&expandoStore.events,handle=expandoStore&&expandoStore.handle;if(handle)if(type){var removeHandler=function(type){var listenerFns=events[type];isDefined(fn)&&arrayRemove(listenerFns||[],fn),isDefined(fn)&&listenerFns&&listenerFns.length>0||(removeEventListenerFn(element,type,handle),delete events[type])};forEach(type.split(" "),function(type){removeHandler(type),MOUSE_EVENT_MAP[type]&&removeHandler(MOUSE_EVENT_MAP[type])})}else for(type in events)"$destroy"!==type&&removeEventListenerFn(element,type,handle),delete events[type]}function jqLiteRemoveData(element,name){var expandoId=element.ng339,expandoStore=expandoId&&jqCache[expandoId];if(expandoStore){if(name)return void delete expandoStore.data[name];expandoStore.handle&&(expandoStore.events.$destroy&&expandoStore.handle({},"$destroy"),jqLiteOff(element)),delete jqCache[expandoId],element.ng339=void 0}}function jqLiteExpandoStore(element,createIfNecessary){var expandoId=element.ng339,expandoStore=expandoId&&jqCache[expandoId];return createIfNecessary&&!expandoStore&&(element.ng339=expandoId=jqNextId(),expandoStore=jqCache[expandoId]={events:{},data:{},handle:void 0}),expandoStore}function jqLiteData(element,key,value){if(jqLiteAcceptsData(element)){var isSimpleSetter=isDefined(value),isSimpleGetter=!isSimpleSetter&&key&&!isObject(key),massGetter=!key,expandoStore=jqLiteExpandoStore(element,!isSimpleGetter),data=expandoStore&&expandoStore.data;if(isSimpleSetter)data[key]=value;else{if(massGetter)return data;if(isSimpleGetter)return data&&data[key];extend(data,key)}}}function jqLiteHasClass(element,selector){return!!element.getAttribute&&(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+selector+" ")>-1}function jqLiteRemoveClass(element,cssClasses){cssClasses&&element.setAttribute&&forEach(cssClasses.split(" "),function(cssClass){element.setAttribute("class",trim((" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+trim(cssClass)+" "," ")))})}function jqLiteAddClass(element,cssClasses){if(cssClasses&&element.setAttribute){var existingClasses=(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");forEach(cssClasses.split(" "),function(cssClass){cssClass=trim(cssClass),existingClasses.indexOf(" "+cssClass+" ")===-1&&(existingClasses+=cssClass+" ")}),element.setAttribute("class",trim(existingClasses))}}function jqLiteAddNodes(root,elements){if(elements)if(elements.nodeType)root[root.length++]=elements;else{var length=elements.length;if("number"==typeof length&&elements.window!==elements){if(length)for(var i=0;i<length;i++)root[root.length++]=elements[i]}else root[root.length++]=elements}}function jqLiteController(element,name){return jqLiteInheritedData(element,"$"+(name||"ngController")+"Controller")}function jqLiteInheritedData(element,name,value){element.nodeType===NODE_TYPE_DOCUMENT&&(element=element.documentElement);for(var names=isArray(name)?name:[name];element;){for(var i=0,ii=names.length;i<ii;i++)if(isDefined(value=jqLite.data(element,names[i])))return value;element=element.parentNode||element.nodeType===NODE_TYPE_DOCUMENT_FRAGMENT&&element.host}}function jqLiteEmpty(element){for(jqLiteDealoc(element,!0);element.firstChild;)element.removeChild(element.firstChild)}function jqLiteRemove(element,keepData){keepData||jqLiteDealoc(element);var parent=element.parentNode;parent&&parent.removeChild(element)}function jqLiteDocumentLoaded(action,win){win=win||window,"complete"===win.document.readyState?win.setTimeout(action):jqLite(win).on("load",action)}function getBooleanAttrName(element,name){var booleanAttr=BOOLEAN_ATTR[name.toLowerCase()];return booleanAttr&&BOOLEAN_ELEMENTS[nodeName_(element)]&&booleanAttr}function getAliasedAttrName(name){return ALIASED_ATTR[name]}function createEventHandler(element,events){var eventHandler=function(event,type){event.isDefaultPrevented=function(){return event.defaultPrevented};var eventFns=events[type||event.type],eventFnsLength=eventFns?eventFns.length:0;if(eventFnsLength){if(isUndefined(event.immediatePropagationStopped)){var originalStopImmediatePropagation=event.stopImmediatePropagation;event.stopImmediatePropagation=function(){event.immediatePropagationStopped=!0,event.stopPropagation&&event.stopPropagation(),originalStopImmediatePropagation&&originalStopImmediatePropagation.call(event)}}event.isImmediatePropagationStopped=function(){return event.immediatePropagationStopped===!0};var handlerWrapper=eventFns.specialHandlerWrapper||defaultHandlerWrapper;eventFnsLength>1&&(eventFns=shallowCopy(eventFns));for(var i=0;i<eventFnsLength;i++)event.isImmediatePropagationStopped()||handlerWrapper(element,event,eventFns[i])}};return eventHandler.elem=element,eventHandler}function defaultHandlerWrapper(element,event,handler){handler.call(element,event)}function specialMouseHandlerWrapper(target,event,handler){var related=event.relatedTarget;related&&(related===target||jqLiteContains.call(target,related))||handler.call(target,event)}function $$jqLiteProvider(){this.$get=function(){return extend(JQLite,{hasClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteHasClass(node,classes)},addClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteAddClass(node,classes)},removeClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteRemoveClass(node,classes)}})}}function hashKey(obj,nextUidFn){var key=obj&&obj.$$hashKey;if(key)return"function"==typeof key&&(key=obj.$$hashKey()),key;var objType=typeof obj;return key="function"===objType||"object"===objType&&null!==obj?obj.$$hashKey=objType+":"+(nextUidFn||nextUid)():objType+":"+obj}function HashMap(array,isolatedUid){if(isolatedUid){var uid=0;this.nextUid=function(){return++uid}}forEach(array,this.put,this)}function stringifyFn(fn){return Function.prototype.toString.call(fn)+" "}function extractArgs(fn){var fnText=stringifyFn(fn).replace(STRIP_COMMENTS,""),args=fnText.match(ARROW_ARG)||fnText.match(FN_ARGS);return args}function anonFn(fn){var args=extractArgs(fn);return args?"function("+(args[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function annotate(fn,strictDi,name){var $inject,argDecl,last;if("function"==typeof fn){if(!($inject=fn.$inject)){if($inject=[],fn.length){if(strictDi)throw isString(name)&&name||(name=fn.name||anonFn(fn)),$injectorMinErr("strictdi","{0} is not using explicit annotation and cannot be invoked in strict mode",name);
argDecl=extractArgs(fn),forEach(argDecl[1].split(FN_ARG_SPLIT),function(arg){arg.replace(FN_ARG,function(all,underscore,name){$inject.push(name)})})}fn.$inject=$inject}}else isArray(fn)?(last=fn.length-1,assertArgFn(fn[last],"fn"),$inject=fn.slice(0,last)):assertArgFn(fn,"fn",!0);return $inject}function createInjector(modulesToLoad,strictDi){function supportObject(delegate){return function(key,value){return isObject(key)?void forEach(key,reverseParams(delegate)):delegate(key,value)}}function provider(name,provider_){if(assertNotHasOwnProperty(name,"service"),(isFunction(provider_)||isArray(provider_))&&(provider_=providerInjector.instantiate(provider_)),!provider_.$get)throw $injectorMinErr("pget","Provider '{0}' must define $get factory method.",name);return providerCache[name+providerSuffix]=provider_}function enforceReturnValue(name,factory){return function(){var result=instanceInjector.invoke(factory,this);if(isUndefined(result))throw $injectorMinErr("undef","Provider '{0}' must return a value from $get factory method.",name);return result}}function factory(name,factoryFn,enforce){return provider(name,{$get:enforce!==!1?enforceReturnValue(name,factoryFn):factoryFn})}function service(name,constructor){return factory(name,["$injector",function($injector){return $injector.instantiate(constructor)}])}function value(name,val){return factory(name,valueFn(val),!1)}function constant(name,value){assertNotHasOwnProperty(name,"constant"),providerCache[name]=value,instanceCache[name]=value}function decorator(serviceName,decorFn){var origProvider=providerInjector.get(serviceName+providerSuffix),orig$get=origProvider.$get;origProvider.$get=function(){var origInstance=instanceInjector.invoke(orig$get,origProvider);return instanceInjector.invoke(decorFn,null,{$delegate:origInstance})}}function loadModules(modulesToLoad){assertArg(isUndefined(modulesToLoad)||isArray(modulesToLoad),"modulesToLoad","not an array");var moduleFn,runBlocks=[];return forEach(modulesToLoad,function(module){function runInvokeQueue(queue){var i,ii;for(i=0,ii=queue.length;i<ii;i++){var invokeArgs=queue[i],provider=providerInjector.get(invokeArgs[0]);provider[invokeArgs[1]].apply(provider,invokeArgs[2])}}if(!loadedModules.get(module)){loadedModules.put(module,!0);try{isString(module)?(moduleFn=angularModule(module),runBlocks=runBlocks.concat(loadModules(moduleFn.requires)).concat(moduleFn._runBlocks),runInvokeQueue(moduleFn._invokeQueue),runInvokeQueue(moduleFn._configBlocks)):isFunction(module)?runBlocks.push(providerInjector.invoke(module)):isArray(module)?runBlocks.push(providerInjector.invoke(module)):assertArgFn(module,"module")}catch(e){throw isArray(module)&&(module=module[module.length-1]),e.message&&e.stack&&e.stack.indexOf(e.message)===-1&&(e=e.message+"\n"+e.stack),$injectorMinErr("modulerr","Failed to instantiate module {0} due to:\n{1}",module,e.stack||e.message||e)}}}),runBlocks}function createInternalInjector(cache,factory){function getService(serviceName,caller){if(cache.hasOwnProperty(serviceName)){if(cache[serviceName]===INSTANTIATING)throw $injectorMinErr("cdep","Circular dependency found: {0}",serviceName+" <- "+path.join(" <- "));return cache[serviceName]}try{return path.unshift(serviceName),cache[serviceName]=INSTANTIATING,cache[serviceName]=factory(serviceName,caller),cache[serviceName]}catch(err){throw cache[serviceName]===INSTANTIATING&&delete cache[serviceName],err}finally{path.shift()}}function injectionArgs(fn,locals,serviceName){for(var args=[],$inject=createInjector.$$annotate(fn,strictDi,serviceName),i=0,length=$inject.length;i<length;i++){var key=$inject[i];if("string"!=typeof key)throw $injectorMinErr("itkn","Incorrect injection token! Expected service name as string, got {0}",key);args.push(locals&&locals.hasOwnProperty(key)?locals[key]:getService(key,serviceName))}return args}function isClass(func){return!(msie<=11)&&("function"==typeof func&&/^(?:class\b|constructor\()/.test(stringifyFn(func)))}function invoke(fn,self,locals,serviceName){"string"==typeof locals&&(serviceName=locals,locals=null);var args=injectionArgs(fn,locals,serviceName);return isArray(fn)&&(fn=fn[fn.length-1]),isClass(fn)?(args.unshift(null),new(Function.prototype.bind.apply(fn,args))):fn.apply(self,args)}function instantiate(Type,locals,serviceName){var ctor=isArray(Type)?Type[Type.length-1]:Type,args=injectionArgs(Type,locals,serviceName);return args.unshift(null),new(Function.prototype.bind.apply(ctor,args))}return{invoke:invoke,instantiate:instantiate,get:getService,annotate:createInjector.$$annotate,has:function(name){return providerCache.hasOwnProperty(name+providerSuffix)||cache.hasOwnProperty(name)}}}strictDi=strictDi===!0;var INSTANTIATING={},providerSuffix="Provider",path=[],loadedModules=new HashMap([],!0),providerCache={$provide:{provider:supportObject(provider),factory:supportObject(factory),service:supportObject(service),value:supportObject(value),constant:supportObject(constant),decorator:decorator}},providerInjector=providerCache.$injector=createInternalInjector(providerCache,function(serviceName,caller){throw angular.isString(caller)&&path.push(caller),$injectorMinErr("unpr","Unknown provider: {0}",path.join(" <- "))}),instanceCache={},protoInstanceInjector=createInternalInjector(instanceCache,function(serviceName,caller){var provider=providerInjector.get(serviceName+providerSuffix,caller);return instanceInjector.invoke(provider.$get,provider,void 0,serviceName)}),instanceInjector=protoInstanceInjector;providerCache["$injector"+providerSuffix]={$get:valueFn(protoInstanceInjector)};var runBlocks=loadModules(modulesToLoad);return instanceInjector=protoInstanceInjector.get("$injector"),instanceInjector.strictDi=strictDi,forEach(runBlocks,function(fn){fn&&instanceInjector.invoke(fn)}),instanceInjector}function $AnchorScrollProvider(){var autoScrollingEnabled=!0;this.disableAutoScrolling=function(){autoScrollingEnabled=!1},this.$get=["$window","$location","$rootScope",function($window,$location,$rootScope){function getFirstAnchor(list){var result=null;return Array.prototype.some.call(list,function(element){if("a"===nodeName_(element))return result=element,!0}),result}function getYOffset(){var offset=scroll.yOffset;if(isFunction(offset))offset=offset();else if(isElement(offset)){var elem=offset[0],style=$window.getComputedStyle(elem);offset="fixed"!==style.position?0:elem.getBoundingClientRect().bottom}else isNumber(offset)||(offset=0);return offset}function scrollTo(elem){if(elem){elem.scrollIntoView();var offset=getYOffset();if(offset){var elemTop=elem.getBoundingClientRect().top;$window.scrollBy(0,elemTop-offset)}}else $window.scrollTo(0,0)}function scroll(hash){hash=isString(hash)?hash:$location.hash();var elm;hash?(elm=document.getElementById(hash))?scrollTo(elm):(elm=getFirstAnchor(document.getElementsByName(hash)))?scrollTo(elm):"top"===hash&&scrollTo(null):scrollTo(null)}var document=$window.document;return autoScrollingEnabled&&$rootScope.$watch(function(){return $location.hash()},function(newVal,oldVal){newVal===oldVal&&""===newVal||jqLiteDocumentLoaded(function(){$rootScope.$evalAsync(scroll)})}),scroll}]}function mergeClasses(a,b){return a||b?a?b?(isArray(a)&&(a=a.join(" ")),isArray(b)&&(b=b.join(" ")),a+" "+b):a:b:""}function extractElementNode(element){for(var i=0;i<element.length;i++){var elm=element[i];if(elm.nodeType===ELEMENT_NODE)return elm}}function splitClasses(classes){isString(classes)&&(classes=classes.split(" "));var obj=createMap();return forEach(classes,function(klass){klass.length&&(obj[klass]=!0)}),obj}function prepareAnimateOptions(options){return isObject(options)?options:{}}function Browser(window,document,$log,$sniffer){function completeOutstandingRequest(fn){try{fn.apply(null,sliceArgs(arguments,1))}finally{if(outstandingRequestCount--,0===outstandingRequestCount)for(;outstandingRequestCallbacks.length;)try{outstandingRequestCallbacks.pop()()}catch(e){$log.error(e)}}}function getHash(url){var index=url.indexOf("#");return index===-1?"":url.substr(index)}function cacheStateAndFireUrlChange(){pendingLocation=null,cacheState(),fireUrlChange()}function cacheState(){cachedState=getCurrentState(),cachedState=isUndefined(cachedState)?null:cachedState,equals(cachedState,lastCachedState)&&(cachedState=lastCachedState),lastCachedState=cachedState}function fireUrlChange(){lastBrowserUrl===self.url()&&lastHistoryState===cachedState||(lastBrowserUrl=self.url(),lastHistoryState=cachedState,forEach(urlChangeListeners,function(listener){listener(self.url(),cachedState)}))}var self=this,location=window.location,history=window.history,setTimeout=window.setTimeout,clearTimeout=window.clearTimeout,pendingDeferIds={};self.isMock=!1;var outstandingRequestCount=0,outstandingRequestCallbacks=[];self.$$completeOutstandingRequest=completeOutstandingRequest,self.$$incOutstandingRequestCount=function(){outstandingRequestCount++},self.notifyWhenNoOutstandingRequests=function(callback){0===outstandingRequestCount?callback():outstandingRequestCallbacks.push(callback)};var cachedState,lastHistoryState,lastBrowserUrl=location.href,baseElement=document.find("base"),pendingLocation=null,getCurrentState=$sniffer.history?function(){try{return history.state}catch(e){}}:noop;cacheState(),lastHistoryState=cachedState,self.url=function(url,replace,state){if(isUndefined(state)&&(state=null),location!==window.location&&(location=window.location),history!==window.history&&(history=window.history),url){var sameState=lastHistoryState===state;if(lastBrowserUrl===url&&(!$sniffer.history||sameState))return self;var sameBase=lastBrowserUrl&&stripHash(lastBrowserUrl)===stripHash(url);return lastBrowserUrl=url,lastHistoryState=state,!$sniffer.history||sameBase&&sameState?(sameBase||(pendingLocation=url),replace?location.replace(url):sameBase?location.hash=getHash(url):location.href=url,location.href!==url&&(pendingLocation=url)):(history[replace?"replaceState":"pushState"](state,"",url),cacheState(),lastHistoryState=cachedState),pendingLocation&&(pendingLocation=url),self}return pendingLocation||location.href.replace(/%27/g,"'")},self.state=function(){return cachedState};var urlChangeListeners=[],urlChangeInit=!1,lastCachedState=null;self.onUrlChange=function(callback){return urlChangeInit||($sniffer.history&&jqLite(window).on("popstate",cacheStateAndFireUrlChange),jqLite(window).on("hashchange",cacheStateAndFireUrlChange),urlChangeInit=!0),urlChangeListeners.push(callback),callback},self.$$applicationDestroyed=function(){jqLite(window).off("hashchange popstate",cacheStateAndFireUrlChange)},self.$$checkUrlChange=fireUrlChange,self.baseHref=function(){var href=baseElement.attr("href");return href?href.replace(/^(https?:)?\/\/[^\/]*/,""):""},self.defer=function(fn,delay){var timeoutId;return outstandingRequestCount++,timeoutId=setTimeout(function(){delete pendingDeferIds[timeoutId],completeOutstandingRequest(fn)},delay||0),pendingDeferIds[timeoutId]=!0,timeoutId},self.defer.cancel=function(deferId){return!!pendingDeferIds[deferId]&&(delete pendingDeferIds[deferId],clearTimeout(deferId),completeOutstandingRequest(noop),!0)}}function $BrowserProvider(){this.$get=["$window","$log","$sniffer","$document",function($window,$log,$sniffer,$document){return new Browser($window,$document,$log,$sniffer)}]}function $CacheFactoryProvider(){this.$get=function(){function cacheFactory(cacheId,options){function refresh(entry){entry!==freshEnd&&(staleEnd?staleEnd===entry&&(staleEnd=entry.n):staleEnd=entry,link(entry.n,entry.p),link(entry,freshEnd),freshEnd=entry,freshEnd.n=null)}function link(nextEntry,prevEntry){nextEntry!==prevEntry&&(nextEntry&&(nextEntry.p=prevEntry),prevEntry&&(prevEntry.n=nextEntry))}if(cacheId in caches)throw minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",cacheId);var size=0,stats=extend({},options,{id:cacheId}),data=createMap(),capacity=options&&options.capacity||Number.MAX_VALUE,lruHash=createMap(),freshEnd=null,staleEnd=null;return caches[cacheId]={put:function(key,value){if(!isUndefined(value)){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key]||(lruHash[key]={key:key});refresh(lruEntry)}return key in data||size++,data[key]=value,size>capacity&&this.remove(staleEnd.key),value}},get:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;refresh(lruEntry)}return data[key]},remove:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;lruEntry===freshEnd&&(freshEnd=lruEntry.p),lruEntry===staleEnd&&(staleEnd=lruEntry.n),link(lruEntry.n,lruEntry.p),delete lruHash[key]}key in data&&(delete data[key],size--)},removeAll:function(){data=createMap(),size=0,lruHash=createMap(),freshEnd=staleEnd=null},destroy:function(){data=null,stats=null,lruHash=null,delete caches[cacheId]},info:function(){return extend({},stats,{size:size})}}}var caches={};return cacheFactory.info=function(){var info={};return forEach(caches,function(cache,cacheId){info[cacheId]=cache.info()}),info},cacheFactory.get=function(cacheId){return caches[cacheId]},cacheFactory}}function $TemplateCacheProvider(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("templates")}]}function UNINITIALIZED_VALUE(){}function $CompileProvider($provide,$$sanitizeUriProvider){function parseIsolateBindings(scope,directiveName,isController){var LOCAL_REGEXP=/^\s*([@&<]|=(\*?))(\??)\s*(\w*)\s*$/,bindings=createMap();return forEach(scope,function(definition,scopeName){if(definition in bindingCache)return void(bindings[scopeName]=bindingCache[definition]);var match=definition.match(LOCAL_REGEXP);if(!match)throw $compileMinErr("iscp","Invalid {3} for directive '{0}'. Definition: {... {1}: '{2}' ...}",directiveName,scopeName,definition,isController?"controller bindings definition":"isolate scope definition");bindings[scopeName]={mode:match[1][0],collection:"*"===match[2],optional:"?"===match[3],attrName:match[4]||scopeName},match[4]&&(bindingCache[definition]=bindings[scopeName])}),bindings}function parseDirectiveBindings(directive,directiveName){var bindings={isolateScope:null,bindToController:null};if(isObject(directive.scope)&&(directive.bindToController===!0?(bindings.bindToController=parseIsolateBindings(directive.scope,directiveName,!0),bindings.isolateScope={}):bindings.isolateScope=parseIsolateBindings(directive.scope,directiveName,!1)),isObject(directive.bindToController)&&(bindings.bindToController=parseIsolateBindings(directive.bindToController,directiveName,!0)),isObject(bindings.bindToController)){var controller=directive.controller,controllerAs=directive.controllerAs;if(!controller)throw $compileMinErr("noctrl","Cannot bind to controller without directive '{0}'s controller.",directiveName);if(!identifierForController(controller,controllerAs))throw $compileMinErr("noident","Cannot bind to controller without identifier for directive '{0}'.",directiveName)}return bindings}function assertValidDirectiveName(name){var letter=name.charAt(0);if(!letter||letter!==lowercase(letter))throw $compileMinErr("baddir","Directive/Component name '{0}' is invalid. The first character must be a lowercase letter",name);if(name!==name.trim())throw $compileMinErr("baddir","Directive/Component name '{0}' is invalid. The name should not contain leading or trailing whitespaces",name)}function getDirectiveRequire(directive){var require=directive.require||directive.controller&&directive.name;return!isArray(require)&&isObject(require)&&forEach(require,function(value,key){var match=value.match(REQUIRE_PREFIX_REGEXP),name=value.substring(match[0].length);name||(require[key]=match[0]+key)}),require}var hasDirectives={},Suffix="Directive",COMMENT_DIRECTIVE_REGEXP=/^\s*directive:\s*([\w\-]+)\s+(.*)$/,CLASS_DIRECTIVE_REGEXP=/(([\w\-]+)(?::([^;]+))?;?)/,ALL_OR_NOTHING_ATTRS=makeMap("ngSrc,ngSrcset,src,srcset"),REQUIRE_PREFIX_REGEXP=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,EVENT_HANDLER_ATTR_REGEXP=/^(on[a-z]+|formaction)$/,bindingCache=createMap();this.directive=function registerDirective(name,directiveFactory){return assertNotHasOwnProperty(name,"directive"),isString(name)?(assertValidDirectiveName(name),assertArg(directiveFactory,"directiveFactory"),hasDirectives.hasOwnProperty(name)||(hasDirectives[name]=[],$provide.factory(name+Suffix,["$injector","$exceptionHandler",function($injector,$exceptionHandler){var directives=[];return forEach(hasDirectives[name],function(directiveFactory,index){try{var directive=$injector.invoke(directiveFactory);isFunction(directive)?directive={compile:valueFn(directive)}:!directive.compile&&directive.link&&(directive.compile=valueFn(directive.link)),directive.priority=directive.priority||0,directive.index=index,directive.name=directive.name||name,directive.require=getDirectiveRequire(directive),directive.restrict=directive.restrict||"EA",directive.$$moduleName=directiveFactory.$$moduleName,directives.push(directive)}catch(e){$exceptionHandler(e)}}),directives}])),hasDirectives[name].push(directiveFactory)):forEach(name,reverseParams(registerDirective)),this},this.component=function(name,options){function factory($injector){function makeInjectable(fn){return isFunction(fn)||isArray(fn)?function(tElement,tAttrs){return $injector.invoke(fn,this,{$element:tElement,$attrs:tAttrs})}:fn}var template=options.template||options.templateUrl?options.template:"",ddo={controller:controller,controllerAs:identifierForController(options.controller)||options.controllerAs||"$ctrl",template:makeInjectable(template),templateUrl:makeInjectable(options.templateUrl),transclude:options.transclude,scope:{},bindToController:options.bindings||{},restrict:"E",require:options.require};return forEach(options,function(val,key){"$"===key.charAt(0)&&(ddo[key]=val)}),ddo}var controller=options.controller||function(){};return forEach(options,function(val,key){"$"===key.charAt(0)&&(factory[key]=val,isFunction(controller)&&(controller[key]=val))}),factory.$inject=["$injector"],this.directive(name,factory)},this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.aHrefSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.imgSrcSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.imgSrcSanitizationWhitelist()};var debugInfoEnabled=!0;this.debugInfoEnabled=function(enabled){return isDefined(enabled)?(debugInfoEnabled=enabled,this):debugInfoEnabled};var TTL=10;this.onChangesTtl=function(value){return arguments.length?(TTL=value,this):TTL};var commentDirectivesEnabledConfig=!0;this.commentDirectivesEnabled=function(value){return arguments.length?(commentDirectivesEnabledConfig=value,this):commentDirectivesEnabledConfig};var cssClassDirectivesEnabledConfig=!0;this.cssClassDirectivesEnabled=function(value){return arguments.length?(cssClassDirectivesEnabledConfig=value,this):cssClassDirectivesEnabledConfig},this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$sce","$animate","$$sanitizeUri",function($injector,$interpolate,$exceptionHandler,$templateRequest,$parse,$controller,$rootScope,$sce,$animate,$$sanitizeUri){function flushOnChangesQueue(){try{if(!--onChangesTtl)throw onChangesQueue=void 0,$compileMinErr("infchng","{0} $onChanges() iterations reached. Aborting!\n",TTL);$rootScope.$apply(function(){for(var errors=[],i=0,ii=onChangesQueue.length;i<ii;++i)try{onChangesQueue[i]()}catch(e){errors.push(e)}if(onChangesQueue=void 0,errors.length)throw errors})}finally{onChangesTtl++}}function Attributes(element,attributesToCopy){if(attributesToCopy){var i,l,key,keys=Object.keys(attributesToCopy);for(i=0,l=keys.length;i<l;i++)key=keys[i],this[key]=attributesToCopy[key]}else this.$attr={};this.$$element=element}function setSpecialAttr(element,attrName,value){specialAttrHolder.innerHTML="<span "+attrName+">";var attributes=specialAttrHolder.firstChild.attributes,attribute=attributes[0];attributes.removeNamedItem(attribute.name),attribute.value=value,element.attributes.setNamedItem(attribute)}function safeAddClass($element,className){try{$element.addClass(className)}catch(e){}}function compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext){$compileNodes instanceof jqLite||($compileNodes=jqLite($compileNodes));for(var NOT_EMPTY=/\S+/,i=0,len=$compileNodes.length;i<len;i++){var domNode=$compileNodes[i];domNode.nodeType===NODE_TYPE_TEXT&&domNode.nodeValue.match(NOT_EMPTY)&&jqLiteWrapNode(domNode,$compileNodes[i]=window.document.createElement("span"))}var compositeLinkFn=compileNodes($compileNodes,transcludeFn,$compileNodes,maxPriority,ignoreDirective,previousCompileContext);compile.$$addScopeClass($compileNodes);var namespace=null;return function(scope,cloneConnectFn,options){assertArg(scope,"scope"),previousCompileContext&&previousCompileContext.needsNewScope&&(scope=scope.$parent.$new()),options=options||{};var parentBoundTranscludeFn=options.parentBoundTranscludeFn,transcludeControllers=options.transcludeControllers,futureParentElement=options.futureParentElement;parentBoundTranscludeFn&&parentBoundTranscludeFn.$$boundTransclude&&(parentBoundTranscludeFn=parentBoundTranscludeFn.$$boundTransclude),namespace||(namespace=detectNamespaceForChildElements(futureParentElement));var $linkNode;if($linkNode="html"!==namespace?jqLite(wrapTemplate(namespace,jqLite("<div>").append($compileNodes).html())):cloneConnectFn?JQLitePrototype.clone.call($compileNodes):$compileNodes,transcludeControllers)for(var controllerName in transcludeControllers)$linkNode.data("$"+controllerName+"Controller",transcludeControllers[controllerName].instance);return compile.$$addScopeInfo($linkNode,scope),cloneConnectFn&&cloneConnectFn($linkNode,scope),compositeLinkFn&&compositeLinkFn(scope,$linkNode,$linkNode,parentBoundTranscludeFn),$linkNode}}function detectNamespaceForChildElements(parentElement){var node=parentElement&&parentElement[0];return node&&"foreignobject"!==nodeName_(node)&&toString.call(node).match(/SVG/)?"svg":"html"}function compileNodes(nodeList,transcludeFn,$rootElement,maxPriority,ignoreDirective,previousCompileContext){function compositeLinkFn(scope,nodeList,$rootElement,parentBoundTranscludeFn){var nodeLinkFn,childLinkFn,node,childScope,i,ii,idx,childBoundTranscludeFn,stableNodeList;if(nodeLinkFnFound){var nodeListLength=nodeList.length;for(stableNodeList=new Array(nodeListLength),i=0;i<linkFns.length;i+=3)idx=linkFns[i],stableNodeList[idx]=nodeList[idx]}else stableNodeList=nodeList;for(i=0,ii=linkFns.length;i<ii;)node=stableNodeList[linkFns[i++]],nodeLinkFn=linkFns[i++],childLinkFn=linkFns[i++],nodeLinkFn?(nodeLinkFn.scope?(childScope=scope.$new(),compile.$$addScopeInfo(jqLite(node),childScope)):childScope=scope,childBoundTranscludeFn=nodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,nodeLinkFn.transclude,parentBoundTranscludeFn):!nodeLinkFn.templateOnThisElement&&parentBoundTranscludeFn?parentBoundTranscludeFn:!parentBoundTranscludeFn&&transcludeFn?createBoundTranscludeFn(scope,transcludeFn):null,nodeLinkFn(childLinkFn,childScope,node,$rootElement,childBoundTranscludeFn)):childLinkFn&&childLinkFn(scope,node.childNodes,void 0,parentBoundTranscludeFn)}for(var attrs,directives,nodeLinkFn,childNodes,childLinkFn,linkFnFound,nodeLinkFnFound,linkFns=[],i=0;i<nodeList.length;i++)attrs=new Attributes,directives=collectDirectives(nodeList[i],[],attrs,0===i?maxPriority:void 0,ignoreDirective),nodeLinkFn=directives.length?applyDirectivesToNode(directives,nodeList[i],attrs,transcludeFn,$rootElement,null,[],[],previousCompileContext):null,nodeLinkFn&&nodeLinkFn.scope&&compile.$$addScopeClass(attrs.$$element),childLinkFn=nodeLinkFn&&nodeLinkFn.terminal||!(childNodes=nodeList[i].childNodes)||!childNodes.length?null:compileNodes(childNodes,nodeLinkFn?(nodeLinkFn.transcludeOnThisElement||!nodeLinkFn.templateOnThisElement)&&nodeLinkFn.transclude:transcludeFn),(nodeLinkFn||childLinkFn)&&(linkFns.push(i,nodeLinkFn,childLinkFn),linkFnFound=!0,nodeLinkFnFound=nodeLinkFnFound||nodeLinkFn),previousCompileContext=null;return linkFnFound?compositeLinkFn:null}function createBoundTranscludeFn(scope,transcludeFn,previousBoundTranscludeFn){function boundTranscludeFn(transcludedScope,cloneFn,controllers,futureParentElement,containingScope){return transcludedScope||(transcludedScope=scope.$new(!1,containingScope),transcludedScope.$$transcluded=!0),transcludeFn(transcludedScope,cloneFn,{parentBoundTranscludeFn:previousBoundTranscludeFn,transcludeControllers:controllers,futureParentElement:futureParentElement})}var boundSlots=boundTranscludeFn.$$slots=createMap();for(var slotName in transcludeFn.$$slots)transcludeFn.$$slots[slotName]?boundSlots[slotName]=createBoundTranscludeFn(scope,transcludeFn.$$slots[slotName],previousBoundTranscludeFn):boundSlots[slotName]=null;return boundTranscludeFn}function collectDirectives(node,directives,attrs,maxPriority,ignoreDirective){var match,nodeName,className,nodeType=node.nodeType,attrsMap=attrs.$attr;switch(nodeType){case NODE_TYPE_ELEMENT:nodeName=nodeName_(node),addDirective(directives,directiveNormalize(nodeName),"E",maxPriority,ignoreDirective);for(var attr,name,nName,ngAttrName,value,isNgAttr,nAttrs=node.attributes,j=0,jj=nAttrs&&nAttrs.length;j<jj;j++){var attrStartName=!1,attrEndName=!1;attr=nAttrs[j],name=attr.name,value=trim(attr.value),ngAttrName=directiveNormalize(name),isNgAttr=NG_ATTR_BINDING.test(ngAttrName),isNgAttr&&(name=name.replace(PREFIX_REGEXP,"").substr(8).replace(/_(.)/g,function(match,letter){return letter.toUpperCase()}));var multiElementMatch=ngAttrName.match(MULTI_ELEMENT_DIR_RE);multiElementMatch&&directiveIsMultiElement(multiElementMatch[1])&&(attrStartName=name,attrEndName=name.substr(0,name.length-5)+"end",name=name.substr(0,name.length-6)),nName=directiveNormalize(name.toLowerCase()),attrsMap[nName]=name,!isNgAttr&&attrs.hasOwnProperty(nName)||(attrs[nName]=value,getBooleanAttrName(node,nName)&&(attrs[nName]=!0)),addAttrInterpolateDirective(node,directives,value,nName,isNgAttr),addDirective(directives,nName,"A",maxPriority,ignoreDirective,attrStartName,attrEndName)}if("input"===nodeName&&"hidden"===node.getAttribute("type")&&node.setAttribute("autocomplete","off"),!cssClassDirectivesEnabled)break;if(className=node.className,isObject(className)&&(className=className.animVal),isString(className)&&""!==className)for(;match=CLASS_DIRECTIVE_REGEXP.exec(className);)nName=directiveNormalize(match[2]),addDirective(directives,nName,"C",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[3])),className=className.substr(match.index+match[0].length);break;case NODE_TYPE_TEXT:if(11===msie)for(;node.parentNode&&node.nextSibling&&node.nextSibling.nodeType===NODE_TYPE_TEXT;)node.nodeValue=node.nodeValue+node.nextSibling.nodeValue,node.parentNode.removeChild(node.nextSibling);addTextInterpolateDirective(directives,node.nodeValue);break;case NODE_TYPE_COMMENT:if(!commentDirectivesEnabled)break;collectCommentDirectives(node,directives,attrs,maxPriority,ignoreDirective)}return directives.sort(byPriority),directives}function collectCommentDirectives(node,directives,attrs,maxPriority,ignoreDirective){try{var match=COMMENT_DIRECTIVE_REGEXP.exec(node.nodeValue);if(match){var nName=directiveNormalize(match[1]);addDirective(directives,nName,"M",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[2]))}}catch(e){}}function groupScan(node,attrStart,attrEnd){var nodes=[],depth=0;if(attrStart&&node.hasAttribute&&node.hasAttribute(attrStart)){do{if(!node)throw $compileMinErr("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",attrStart,attrEnd);node.nodeType===NODE_TYPE_ELEMENT&&(node.hasAttribute(attrStart)&&depth++,node.hasAttribute(attrEnd)&&depth--),nodes.push(node),node=node.nextSibling}while(depth>0)}else nodes.push(node);return jqLite(nodes)}function groupElementsLinkFnWrapper(linkFn,attrStart,attrEnd){return function(scope,element,attrs,controllers,transcludeFn){return element=groupScan(element[0],attrStart,attrEnd),linkFn(scope,element,attrs,controllers,transcludeFn)}}function compilationGenerator(eager,$compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext){var compiled;return eager?compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext):function(){return compiled||(compiled=compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext),$compileNodes=transcludeFn=previousCompileContext=null),compiled.apply(this,arguments)}}function applyDirectivesToNode(directives,compileNode,templateAttrs,transcludeFn,jqCollection,originalReplaceDirective,preLinkFns,postLinkFns,previousCompileContext){function addLinkFns(pre,post,attrStart,attrEnd){pre&&(attrStart&&(pre=groupElementsLinkFnWrapper(pre,attrStart,attrEnd)),pre.require=directive.require,pre.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(pre=cloneAndAnnotateFn(pre,{isolateScope:!0})),preLinkFns.push(pre)),post&&(attrStart&&(post=groupElementsLinkFnWrapper(post,attrStart,attrEnd)),post.require=directive.require,post.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(post=cloneAndAnnotateFn(post,{isolateScope:!0})),postLinkFns.push(post))}function nodeLinkFn(childLinkFn,scope,linkNode,$rootElement,boundTranscludeFn){function controllersBoundTransclude(scope,cloneAttachFn,futureParentElement,slotName){var transcludeControllers;if(isScope(scope)||(slotName=futureParentElement,futureParentElement=cloneAttachFn,cloneAttachFn=scope,scope=void 0),hasElementTranscludeDirective&&(transcludeControllers=elementControllers),futureParentElement||(futureParentElement=hasElementTranscludeDirective?$element.parent():$element),!slotName)return boundTranscludeFn(scope,cloneAttachFn,transcludeControllers,futureParentElement,scopeToChild);var slotTranscludeFn=boundTranscludeFn.$$slots[slotName];if(slotTranscludeFn)return slotTranscludeFn(scope,cloneAttachFn,transcludeControllers,futureParentElement,scopeToChild);if(isUndefined(slotTranscludeFn))throw $compileMinErr("noslot",'No parent directive that requires a transclusion with slot name "{0}". Element: {1}',slotName,startingTag($element))}var i,ii,linkFn,isolateScope,controllerScope,elementControllers,transcludeFn,$element,attrs,scopeBindingInfo;compileNode===linkNode?(attrs=templateAttrs,$element=templateAttrs.$$element):($element=jqLite(linkNode),attrs=new Attributes($element,templateAttrs)),controllerScope=scope,newIsolateScopeDirective?isolateScope=scope.$new(!0):newScopeDirective&&(controllerScope=scope.$parent),boundTranscludeFn&&(transcludeFn=controllersBoundTransclude,transcludeFn.$$boundTransclude=boundTranscludeFn,transcludeFn.isSlotFilled=function(slotName){return!!boundTranscludeFn.$$slots[slotName]}),controllerDirectives&&(elementControllers=setupControllers($element,attrs,transcludeFn,controllerDirectives,isolateScope,scope,newIsolateScopeDirective)),newIsolateScopeDirective&&(compile.$$addScopeInfo($element,isolateScope,!0,!(templateDirective&&(templateDirective===newIsolateScopeDirective||templateDirective===newIsolateScopeDirective.$$originalDirective))),compile.$$addScopeClass($element,!0),isolateScope.$$isolateBindings=newIsolateScopeDirective.$$isolateBindings,scopeBindingInfo=initializeDirectiveBindings(scope,attrs,isolateScope,isolateScope.$$isolateBindings,newIsolateScopeDirective),scopeBindingInfo.removeWatches&&isolateScope.$on("$destroy",scopeBindingInfo.removeWatches));for(var name in elementControllers){var controllerDirective=controllerDirectives[name],controller=elementControllers[name],bindings=controllerDirective.$$bindings.bindToController;controller.identifier&&bindings?controller.bindingInfo=initializeDirectiveBindings(controllerScope,attrs,controller.instance,bindings,controllerDirective):controller.bindingInfo={};var controllerResult=controller();controllerResult!==controller.instance&&(controller.instance=controllerResult,$element.data("$"+controllerDirective.name+"Controller",controllerResult),
controller.bindingInfo.removeWatches&&controller.bindingInfo.removeWatches(),controller.bindingInfo=initializeDirectiveBindings(controllerScope,attrs,controller.instance,bindings,controllerDirective))}for(forEach(controllerDirectives,function(controllerDirective,name){var require=controllerDirective.require;controllerDirective.bindToController&&!isArray(require)&&isObject(require)&&extend(elementControllers[name].instance,getControllers(name,require,$element,elementControllers))}),forEach(elementControllers,function(controller){var controllerInstance=controller.instance;if(isFunction(controllerInstance.$onChanges))try{controllerInstance.$onChanges(controller.bindingInfo.initialChanges)}catch(e){$exceptionHandler(e)}if(isFunction(controllerInstance.$onInit))try{controllerInstance.$onInit()}catch(e){$exceptionHandler(e)}isFunction(controllerInstance.$doCheck)&&(controllerScope.$watch(function(){controllerInstance.$doCheck()}),controllerInstance.$doCheck()),isFunction(controllerInstance.$onDestroy)&&controllerScope.$on("$destroy",function(){controllerInstance.$onDestroy()})}),i=0,ii=preLinkFns.length;i<ii;i++)linkFn=preLinkFns[i],invokeLinkFn(linkFn,linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn);var scopeToChild=scope;for(newIsolateScopeDirective&&(newIsolateScopeDirective.template||null===newIsolateScopeDirective.templateUrl)&&(scopeToChild=isolateScope),childLinkFn&&childLinkFn(scopeToChild,linkNode.childNodes,void 0,boundTranscludeFn),i=postLinkFns.length-1;i>=0;i--)linkFn=postLinkFns[i],invokeLinkFn(linkFn,linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn);forEach(elementControllers,function(controller){var controllerInstance=controller.instance;isFunction(controllerInstance.$postLink)&&controllerInstance.$postLink()})}previousCompileContext=previousCompileContext||{};for(var directive,directiveName,$template,linkFn,directiveValue,terminalPriority=-Number.MAX_VALUE,newScopeDirective=previousCompileContext.newScopeDirective,controllerDirectives=previousCompileContext.controllerDirectives,newIsolateScopeDirective=previousCompileContext.newIsolateScopeDirective,templateDirective=previousCompileContext.templateDirective,nonTlbTranscludeDirective=previousCompileContext.nonTlbTranscludeDirective,hasTranscludeDirective=!1,hasTemplate=!1,hasElementTranscludeDirective=previousCompileContext.hasElementTranscludeDirective,$compileNode=templateAttrs.$$element=jqLite(compileNode),replaceDirective=originalReplaceDirective,childTranscludeFn=transcludeFn,didScanForMultipleTransclusion=!1,mightHaveMultipleTransclusionError=!1,i=0,ii=directives.length;i<ii;i++){directive=directives[i];var attrStart=directive.$$start,attrEnd=directive.$$end;if(attrStart&&($compileNode=groupScan(compileNode,attrStart,attrEnd)),$template=void 0,terminalPriority>directive.priority)break;if(directiveValue=directive.scope,directiveValue&&(directive.templateUrl||(isObject(directiveValue)?(assertNoDuplicate("new/isolated scope",newIsolateScopeDirective||newScopeDirective,directive,$compileNode),newIsolateScopeDirective=directive):assertNoDuplicate("new/isolated scope",newIsolateScopeDirective,directive,$compileNode)),newScopeDirective=newScopeDirective||directive),directiveName=directive.name,!didScanForMultipleTransclusion&&(directive.replace&&(directive.templateUrl||directive.template)||directive.transclude&&!directive.$$tlb)){for(var candidateDirective,scanningIndex=i+1;candidateDirective=directives[scanningIndex++];)if(candidateDirective.transclude&&!candidateDirective.$$tlb||candidateDirective.replace&&(candidateDirective.templateUrl||candidateDirective.template)){mightHaveMultipleTransclusionError=!0;break}didScanForMultipleTransclusion=!0}if(!directive.templateUrl&&directive.controller&&(directiveValue=directive.controller,controllerDirectives=controllerDirectives||createMap(),assertNoDuplicate("'"+directiveName+"' controller",controllerDirectives[directiveName],directive,$compileNode),controllerDirectives[directiveName]=directive),directiveValue=directive.transclude)if(hasTranscludeDirective=!0,directive.$$tlb||(assertNoDuplicate("transclusion",nonTlbTranscludeDirective,directive,$compileNode),nonTlbTranscludeDirective=directive),"element"===directiveValue)hasElementTranscludeDirective=!0,terminalPriority=directive.priority,$template=$compileNode,$compileNode=templateAttrs.$$element=jqLite(compile.$$createComment(directiveName,templateAttrs[directiveName])),compileNode=$compileNode[0],replaceWith(jqCollection,sliceArgs($template),compileNode),$template[0].$$parentNode=$template[0].parentNode,childTranscludeFn=compilationGenerator(mightHaveMultipleTransclusionError,$template,transcludeFn,terminalPriority,replaceDirective&&replaceDirective.name,{nonTlbTranscludeDirective:nonTlbTranscludeDirective});else{var slots=createMap();if($template=jqLite(jqLiteClone(compileNode)).contents(),isObject(directiveValue)){$template=[];var slotMap=createMap(),filledSlots=createMap();forEach(directiveValue,function(elementSelector,slotName){var optional="?"===elementSelector.charAt(0);elementSelector=optional?elementSelector.substring(1):elementSelector,slotMap[elementSelector]=slotName,slots[slotName]=null,filledSlots[slotName]=optional}),forEach($compileNode.contents(),function(node){var slotName=slotMap[directiveNormalize(nodeName_(node))];slotName?(filledSlots[slotName]=!0,slots[slotName]=slots[slotName]||[],slots[slotName].push(node)):$template.push(node)}),forEach(filledSlots,function(filled,slotName){if(!filled)throw $compileMinErr("reqslot","Required transclusion slot `{0}` was not filled.",slotName)});for(var slotName in slots)slots[slotName]&&(slots[slotName]=compilationGenerator(mightHaveMultipleTransclusionError,slots[slotName],transcludeFn))}$compileNode.empty(),childTranscludeFn=compilationGenerator(mightHaveMultipleTransclusionError,$template,transcludeFn,void 0,void 0,{needsNewScope:directive.$$isolateScope||directive.$$newScope}),childTranscludeFn.$$slots=slots}if(directive.template)if(hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directiveValue=isFunction(directive.template)?directive.template($compileNode,templateAttrs):directive.template,directiveValue=denormalizeTemplate(directiveValue),directive.replace){if(replaceDirective=directive,$template=jqLiteIsTextNode(directiveValue)?[]:removeComments(wrapTemplate(directive.templateNamespace,trim(directiveValue))),compileNode=$template[0],1!==$template.length||compileNode.nodeType!==NODE_TYPE_ELEMENT)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",directiveName,"");replaceWith(jqCollection,$compileNode,compileNode);var newTemplateAttrs={$attr:{}},templateDirectives=collectDirectives(compileNode,[],newTemplateAttrs),unprocessedDirectives=directives.splice(i+1,directives.length-(i+1));(newIsolateScopeDirective||newScopeDirective)&&markDirectiveScope(templateDirectives,newIsolateScopeDirective,newScopeDirective),directives=directives.concat(templateDirectives).concat(unprocessedDirectives),mergeTemplateAttributes(templateAttrs,newTemplateAttrs),ii=directives.length}else $compileNode.html(directiveValue);if(directive.templateUrl)hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directive.replace&&(replaceDirective=directive),nodeLinkFn=compileTemplateUrl(directives.splice(i,directives.length-i),$compileNode,templateAttrs,jqCollection,hasTranscludeDirective&&childTranscludeFn,preLinkFns,postLinkFns,{controllerDirectives:controllerDirectives,newScopeDirective:newScopeDirective!==directive&&newScopeDirective,newIsolateScopeDirective:newIsolateScopeDirective,templateDirective:templateDirective,nonTlbTranscludeDirective:nonTlbTranscludeDirective}),ii=directives.length;else if(directive.compile)try{linkFn=directive.compile($compileNode,templateAttrs,childTranscludeFn);var context=directive.$$originalDirective||directive;isFunction(linkFn)?addLinkFns(null,bind(context,linkFn),attrStart,attrEnd):linkFn&&addLinkFns(bind(context,linkFn.pre),bind(context,linkFn.post),attrStart,attrEnd)}catch(e){$exceptionHandler(e,startingTag($compileNode))}directive.terminal&&(nodeLinkFn.terminal=!0,terminalPriority=Math.max(terminalPriority,directive.priority))}return nodeLinkFn.scope=newScopeDirective&&newScopeDirective.scope===!0,nodeLinkFn.transcludeOnThisElement=hasTranscludeDirective,nodeLinkFn.templateOnThisElement=hasTemplate,nodeLinkFn.transclude=childTranscludeFn,previousCompileContext.hasElementTranscludeDirective=hasElementTranscludeDirective,nodeLinkFn}function getControllers(directiveName,require,$element,elementControllers){var value;if(isString(require)){var match=require.match(REQUIRE_PREFIX_REGEXP),name=require.substring(match[0].length),inheritType=match[1]||match[3],optional="?"===match[2];if("^^"===inheritType?$element=$element.parent():(value=elementControllers&&elementControllers[name],value=value&&value.instance),!value){var dataName="$"+name+"Controller";value=inheritType?$element.inheritedData(dataName):$element.data(dataName)}if(!value&&!optional)throw $compileMinErr("ctreq","Controller '{0}', required by directive '{1}', can't be found!",name,directiveName)}else if(isArray(require)){value=[];for(var i=0,ii=require.length;i<ii;i++)value[i]=getControllers(directiveName,require[i],$element,elementControllers)}else isObject(require)&&(value={},forEach(require,function(controller,property){value[property]=getControllers(directiveName,controller,$element,elementControllers)}));return value||null}function setupControllers($element,attrs,transcludeFn,controllerDirectives,isolateScope,scope,newIsolateScopeDirective){var elementControllers=createMap();for(var controllerKey in controllerDirectives){var directive=controllerDirectives[controllerKey],locals={$scope:directive===newIsolateScopeDirective||directive.$$isolateScope?isolateScope:scope,$element:$element,$attrs:attrs,$transclude:transcludeFn},controller=directive.controller;"@"===controller&&(controller=attrs[directive.name]);var controllerInstance=$controller(controller,locals,!0,directive.controllerAs);elementControllers[directive.name]=controllerInstance,$element.data("$"+directive.name+"Controller",controllerInstance.instance)}return elementControllers}function markDirectiveScope(directives,isolateScope,newScope){for(var j=0,jj=directives.length;j<jj;j++)directives[j]=inherit(directives[j],{$$isolateScope:isolateScope,$$newScope:newScope})}function addDirective(tDirectives,name,location,maxPriority,ignoreDirective,startAttrName,endAttrName){if(name===ignoreDirective)return null;var match=null;if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;i<ii;i++)try{if(directive=directives[i],(isUndefined(maxPriority)||maxPriority>directive.priority)&&directive.restrict.indexOf(location)!==-1){if(startAttrName&&(directive=inherit(directive,{$$start:startAttrName,$$end:endAttrName})),!directive.$$bindings){var bindings=directive.$$bindings=parseDirectiveBindings(directive,directive.name);isObject(bindings.isolateScope)&&(directive.$$isolateBindings=bindings.isolateScope)}tDirectives.push(directive),match=directive}}catch(e){$exceptionHandler(e)}return match}function directiveIsMultiElement(name){if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;i<ii;i++)if(directive=directives[i],directive.multiElement)return!0;return!1}function mergeTemplateAttributes(dst,src){var srcAttr=src.$attr,dstAttr=dst.$attr;forEach(dst,function(value,key){"$"!==key.charAt(0)&&(src[key]&&src[key]!==value&&(value+=("style"===key?";":" ")+src[key]),dst.$set(key,value,!0,srcAttr[key]))}),forEach(src,function(value,key){dst.hasOwnProperty(key)||"$"===key.charAt(0)||(dst[key]=value,"class"!==key&&"style"!==key&&(dstAttr[key]=srcAttr[key]))})}function compileTemplateUrl(directives,$compileNode,tAttrs,$rootElement,childTranscludeFn,preLinkFns,postLinkFns,previousCompileContext){var afterTemplateNodeLinkFn,afterTemplateChildLinkFn,linkQueue=[],beforeTemplateCompileNode=$compileNode[0],origAsyncDirective=directives.shift(),derivedSyncDirective=inherit(origAsyncDirective,{templateUrl:null,transclude:null,replace:null,$$originalDirective:origAsyncDirective}),templateUrl=isFunction(origAsyncDirective.templateUrl)?origAsyncDirective.templateUrl($compileNode,tAttrs):origAsyncDirective.templateUrl,templateNamespace=origAsyncDirective.templateNamespace;return $compileNode.empty(),$templateRequest(templateUrl).then(function(content){var compileNode,tempTemplateAttrs,$template,childBoundTranscludeFn;if(content=denormalizeTemplate(content),origAsyncDirective.replace){if($template=jqLiteIsTextNode(content)?[]:removeComments(wrapTemplate(templateNamespace,trim(content))),compileNode=$template[0],1!==$template.length||compileNode.nodeType!==NODE_TYPE_ELEMENT)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",origAsyncDirective.name,templateUrl);tempTemplateAttrs={$attr:{}},replaceWith($rootElement,$compileNode,compileNode);var templateDirectives=collectDirectives(compileNode,[],tempTemplateAttrs);isObject(origAsyncDirective.scope)&&markDirectiveScope(templateDirectives,!0),directives=templateDirectives.concat(directives),mergeTemplateAttributes(tAttrs,tempTemplateAttrs)}else compileNode=beforeTemplateCompileNode,$compileNode.html(content);for(directives.unshift(derivedSyncDirective),afterTemplateNodeLinkFn=applyDirectivesToNode(directives,compileNode,tAttrs,childTranscludeFn,$compileNode,origAsyncDirective,preLinkFns,postLinkFns,previousCompileContext),forEach($rootElement,function(node,i){node===compileNode&&($rootElement[i]=$compileNode[0])}),afterTemplateChildLinkFn=compileNodes($compileNode[0].childNodes,childTranscludeFn);linkQueue.length;){var scope=linkQueue.shift(),beforeTemplateLinkNode=linkQueue.shift(),linkRootElement=linkQueue.shift(),boundTranscludeFn=linkQueue.shift(),linkNode=$compileNode[0];if(!scope.$$destroyed){if(beforeTemplateLinkNode!==beforeTemplateCompileNode){var oldClasses=beforeTemplateLinkNode.className;previousCompileContext.hasElementTranscludeDirective&&origAsyncDirective.replace||(linkNode=jqLiteClone(compileNode)),replaceWith(linkRootElement,jqLite(beforeTemplateLinkNode),linkNode),safeAddClass(jqLite(linkNode),oldClasses)}childBoundTranscludeFn=afterTemplateNodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn):boundTranscludeFn,afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,linkNode,$rootElement,childBoundTranscludeFn)}}linkQueue=null}),function(ignoreChildLinkFn,scope,node,rootElement,boundTranscludeFn){var childBoundTranscludeFn=boundTranscludeFn;scope.$$destroyed||(linkQueue?linkQueue.push(scope,node,rootElement,childBoundTranscludeFn):(afterTemplateNodeLinkFn.transcludeOnThisElement&&(childBoundTranscludeFn=createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn)),afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,node,rootElement,childBoundTranscludeFn)))}}function byPriority(a,b){var diff=b.priority-a.priority;return 0!==diff?diff:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function assertNoDuplicate(what,previousDirective,directive,element){function wrapModuleNameIfDefined(moduleName){return moduleName?" (module: "+moduleName+")":""}if(previousDirective)throw $compileMinErr("multidir","Multiple directives [{0}{1}, {2}{3}] asking for {4} on: {5}",previousDirective.name,wrapModuleNameIfDefined(previousDirective.$$moduleName),directive.name,wrapModuleNameIfDefined(directive.$$moduleName),what,startingTag(element))}function addTextInterpolateDirective(directives,text){var interpolateFn=$interpolate(text,!0);interpolateFn&&directives.push({priority:0,compile:function(templateNode){var templateNodeParent=templateNode.parent(),hasCompileParent=!!templateNodeParent.length;return hasCompileParent&&compile.$$addBindingClass(templateNodeParent),function(scope,node){var parent=node.parent();hasCompileParent||compile.$$addBindingClass(parent),compile.$$addBindingInfo(parent,interpolateFn.expressions),scope.$watch(interpolateFn,function(value){node[0].nodeValue=value})}}})}function wrapTemplate(type,template){switch(type=lowercase(type||"html")){case"svg":case"math":var wrapper=window.document.createElement("div");return wrapper.innerHTML="<"+type+">"+template+"</"+type+">",wrapper.childNodes[0].childNodes;default:return template}}function getTrustedContext(node,attrNormalizedName){if("srcdoc"===attrNormalizedName)return $sce.HTML;var tag=nodeName_(node);if("src"===attrNormalizedName||"ngSrc"===attrNormalizedName){if(["img","video","audio","source","track"].indexOf(tag)===-1)return $sce.RESOURCE_URL}else if("xlinkHref"===attrNormalizedName||"form"===tag&&"action"===attrNormalizedName)return $sce.RESOURCE_URL}function addAttrInterpolateDirective(node,directives,value,name,allOrNothing){var trustedContext=getTrustedContext(node,name);allOrNothing=ALL_OR_NOTHING_ATTRS[name]||allOrNothing;var interpolateFn=$interpolate(value,!0,trustedContext,allOrNothing);if(interpolateFn){if("multiple"===name&&"select"===nodeName_(node))throw $compileMinErr("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",startingTag(node));directives.push({priority:100,compile:function(){return{pre:function(scope,element,attr){var $$observers=attr.$$observers||(attr.$$observers=createMap());if(EVENT_HANDLER_ATTR_REGEXP.test(name))throw $compileMinErr("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");var newValue=attr[name];newValue!==value&&(interpolateFn=newValue&&$interpolate(newValue,!0,trustedContext,allOrNothing),value=newValue),interpolateFn&&(attr[name]=interpolateFn(scope),($$observers[name]||($$observers[name]=[])).$$inter=!0,(attr.$$observers&&attr.$$observers[name].$$scope||scope).$watch(interpolateFn,function(newValue,oldValue){"class"===name&&newValue!==oldValue?attr.$updateClass(newValue,oldValue):attr.$set(name,newValue)}))}}}})}}function replaceWith($rootElement,elementsToRemove,newNode){var i,ii,firstElementToRemove=elementsToRemove[0],removeCount=elementsToRemove.length,parent=firstElementToRemove.parentNode;if($rootElement)for(i=0,ii=$rootElement.length;i<ii;i++)if($rootElement[i]===firstElementToRemove){$rootElement[i++]=newNode;for(var j=i,j2=j+removeCount-1,jj=$rootElement.length;j<jj;j++,j2++)j2<jj?$rootElement[j]=$rootElement[j2]:delete $rootElement[j];$rootElement.length-=removeCount-1,$rootElement.context===firstElementToRemove&&($rootElement.context=newNode);break}parent&&parent.replaceChild(newNode,firstElementToRemove);var fragment=window.document.createDocumentFragment();for(i=0;i<removeCount;i++)fragment.appendChild(elementsToRemove[i]);for(jqLite.hasData(firstElementToRemove)&&(jqLite.data(newNode,jqLite.data(firstElementToRemove)),jqLite(firstElementToRemove).off("$destroy")),jqLite.cleanData(fragment.querySelectorAll("*")),i=1;i<removeCount;i++)delete elementsToRemove[i];elementsToRemove[0]=newNode,elementsToRemove.length=1}function cloneAndAnnotateFn(fn,annotation){return extend(function(){return fn.apply(null,arguments)},fn,annotation)}function invokeLinkFn(linkFn,scope,$element,attrs,controllers,transcludeFn){try{linkFn(scope,$element,attrs,controllers,transcludeFn)}catch(e){$exceptionHandler(e,startingTag($element))}}function initializeDirectiveBindings(scope,attrs,destination,bindings,directive){function recordChanges(key,currentValue,previousValue){isFunction(destination.$onChanges)&&currentValue!==previousValue&&(onChangesQueue||(scope.$$postDigest(flushOnChangesQueue),onChangesQueue=[]),changes||(changes={},onChangesQueue.push(triggerOnChangesHook)),changes[key]&&(previousValue=changes[key].previousValue),changes[key]=new SimpleChange(previousValue,currentValue))}function triggerOnChangesHook(){destination.$onChanges(changes),changes=void 0}var changes,removeWatchCollection=[],initialChanges={};return forEach(bindings,function(definition,scopeName){var lastValue,parentGet,parentSet,compare,removeWatch,attrName=definition.attrName,optional=definition.optional,mode=definition.mode;switch(mode){case"@":optional||hasOwnProperty.call(attrs,attrName)||(destination[scopeName]=attrs[attrName]=void 0),attrs.$observe(attrName,function(value){if(isString(value)||isBoolean(value)){var oldValue=destination[scopeName];recordChanges(scopeName,value,oldValue),destination[scopeName]=value}}),attrs.$$observers[attrName].$$scope=scope,lastValue=attrs[attrName],isString(lastValue)?destination[scopeName]=$interpolate(lastValue)(scope):isBoolean(lastValue)&&(destination[scopeName]=lastValue),initialChanges[scopeName]=new SimpleChange(_UNINITIALIZED_VALUE,destination[scopeName]);break;case"=":if(!hasOwnProperty.call(attrs,attrName)){if(optional)break;attrs[attrName]=void 0}if(optional&&!attrs[attrName])break;parentGet=$parse(attrs[attrName]),compare=parentGet.literal?equals:function(a,b){return a===b||a!==a&&b!==b},parentSet=parentGet.assign||function(){throw lastValue=destination[scopeName]=parentGet(scope),$compileMinErr("nonassign","Expression '{0}' in attribute '{1}' used with directive '{2}' is non-assignable!",attrs[attrName],attrName,directive.name)},lastValue=destination[scopeName]=parentGet(scope);var parentValueWatch=function(parentValue){return compare(parentValue,destination[scopeName])||(compare(parentValue,lastValue)?parentSet(scope,parentValue=destination[scopeName]):destination[scopeName]=parentValue),lastValue=parentValue};parentValueWatch.$stateful=!0,removeWatch=definition.collection?scope.$watchCollection(attrs[attrName],parentValueWatch):scope.$watch($parse(attrs[attrName],parentValueWatch),null,parentGet.literal),removeWatchCollection.push(removeWatch);break;case"<":if(!hasOwnProperty.call(attrs,attrName)){if(optional)break;attrs[attrName]=void 0}if(optional&&!attrs[attrName])break;parentGet=$parse(attrs[attrName]);var initialValue=destination[scopeName]=parentGet(scope);initialChanges[scopeName]=new SimpleChange(_UNINITIALIZED_VALUE,destination[scopeName]),removeWatch=scope.$watch(parentGet,function(newValue,oldValue){if(oldValue===newValue){if(oldValue===initialValue)return;oldValue=initialValue}recordChanges(scopeName,newValue,oldValue),destination[scopeName]=newValue},parentGet.literal),removeWatchCollection.push(removeWatch);break;case"&":if(parentGet=attrs.hasOwnProperty(attrName)?$parse(attrs[attrName]):noop,parentGet===noop&&optional)break;destination[scopeName]=function(locals){return parentGet(scope,locals)}}}),{initialChanges:initialChanges,removeWatches:removeWatchCollection.length&&function(){for(var i=0,ii=removeWatchCollection.length;i<ii;++i)removeWatchCollection[i]()}}}var onChangesQueue,SIMPLE_ATTR_NAME=/^\w/,specialAttrHolder=window.document.createElement("div"),commentDirectivesEnabled=commentDirectivesEnabledConfig,cssClassDirectivesEnabled=cssClassDirectivesEnabledConfig,onChangesTtl=TTL;Attributes.prototype={$normalize:directiveNormalize,$addClass:function(classVal){classVal&&classVal.length>0&&$animate.addClass(this.$$element,classVal)},$removeClass:function(classVal){classVal&&classVal.length>0&&$animate.removeClass(this.$$element,classVal)},$updateClass:function(newClasses,oldClasses){var toAdd=tokenDifference(newClasses,oldClasses);toAdd&&toAdd.length&&$animate.addClass(this.$$element,toAdd);var toRemove=tokenDifference(oldClasses,newClasses);toRemove&&toRemove.length&&$animate.removeClass(this.$$element,toRemove)},$set:function(key,value,writeAttr,attrName){var nodeName,node=this.$$element[0],booleanKey=getBooleanAttrName(node,key),aliasedKey=getAliasedAttrName(key),observer=key;if(booleanKey?(this.$$element.prop(key,value),attrName=booleanKey):aliasedKey&&(this[aliasedKey]=value,observer=aliasedKey),this[key]=value,attrName?this.$attr[key]=attrName:(attrName=this.$attr[key],attrName||(this.$attr[key]=attrName=snake_case(key,"-"))),nodeName=nodeName_(this.$$element),"a"===nodeName&&("href"===key||"xlinkHref"===key)||"img"===nodeName&&"src"===key)this[key]=value=$$sanitizeUri(value,"src"===key);else if("img"===nodeName&&"srcset"===key&&isDefined(value)){for(var result="",trimmedSrcset=trim(value),srcPattern=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,pattern=/\s/.test(trimmedSrcset)?srcPattern:/(,)/,rawUris=trimmedSrcset.split(pattern),nbrUrisWith2parts=Math.floor(rawUris.length/2),i=0;i<nbrUrisWith2parts;i++){var innerIdx=2*i;result+=$$sanitizeUri(trim(rawUris[innerIdx]),!0),result+=" "+trim(rawUris[innerIdx+1])}var lastTuple=trim(rawUris[2*i]).split(/\s/);result+=$$sanitizeUri(trim(lastTuple[0]),!0),2===lastTuple.length&&(result+=" "+trim(lastTuple[1])),this[key]=value=result}writeAttr!==!1&&(null===value||isUndefined(value)?this.$$element.removeAttr(attrName):SIMPLE_ATTR_NAME.test(attrName)?this.$$element.attr(attrName,value):setSpecialAttr(this.$$element[0],attrName,value));var $$observers=this.$$observers;$$observers&&forEach($$observers[observer],function(fn){try{fn(value)}catch(e){$exceptionHandler(e)}})},$observe:function(key,fn){var attrs=this,$$observers=attrs.$$observers||(attrs.$$observers=createMap()),listeners=$$observers[key]||($$observers[key]=[]);return listeners.push(fn),$rootScope.$evalAsync(function(){listeners.$$inter||!attrs.hasOwnProperty(key)||isUndefined(attrs[key])||fn(attrs[key])}),function(){arrayRemove(listeners,fn)}}};var startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),denormalizeTemplate="{{"===startSymbol&&"}}"===endSymbol?identity:function(template){return template.replace(/\{\{/g,startSymbol).replace(/}}/g,endSymbol)},NG_ATTR_BINDING=/^ngAttr[A-Z]/,MULTI_ELEMENT_DIR_RE=/^(.+)Start$/;return compile.$$addBindingInfo=debugInfoEnabled?function($element,binding){var bindings=$element.data("$binding")||[];isArray(binding)?bindings=bindings.concat(binding):bindings.push(binding),$element.data("$binding",bindings)}:noop,compile.$$addBindingClass=debugInfoEnabled?function($element){safeAddClass($element,"ng-binding")}:noop,compile.$$addScopeInfo=debugInfoEnabled?function($element,scope,isolated,noTemplate){var dataName=isolated?noTemplate?"$isolateScopeNoTemplate":"$isolateScope":"$scope";$element.data(dataName,scope)}:noop,compile.$$addScopeClass=debugInfoEnabled?function($element,isolated){safeAddClass($element,isolated?"ng-isolate-scope":"ng-scope")}:noop,compile.$$createComment=function(directiveName,comment){var content="";return debugInfoEnabled&&(content=" "+(directiveName||"")+": ",comment&&(content+=comment+" ")),window.document.createComment(content)},compile}]}function SimpleChange(previous,current){this.previousValue=previous,this.currentValue=current}function directiveNormalize(name){return camelCase(name.replace(PREFIX_REGEXP,""))}function tokenDifference(str1,str2){var values="",tokens1=str1.split(/\s+/),tokens2=str2.split(/\s+/);outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token===tokens2[j])continue outer;values+=(values.length>0?" ":"")+token}return values}function removeComments(jqNodes){jqNodes=jqLite(jqNodes);var i=jqNodes.length;if(i<=1)return jqNodes;for(;i--;){var node=jqNodes[i];node.nodeType===NODE_TYPE_COMMENT&&splice.call(jqNodes,i,1)}return jqNodes}function identifierForController(controller,ident){if(ident&&isString(ident))return ident;if(isString(controller)){var match=CNTRL_REG.exec(controller);if(match)return match[3]}}function $ControllerProvider(){var controllers={},globals=!1;this.has=function(name){return controllers.hasOwnProperty(name)},this.register=function(name,constructor){assertNotHasOwnProperty(name,"controller"),isObject(name)?extend(controllers,name):controllers[name]=constructor},this.allowGlobals=function(){globals=!0},this.$get=["$injector","$window",function($injector,$window){function addIdentifier(locals,identifier,instance,name){if(!locals||!isObject(locals.$scope))throw minErr("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",name,identifier);locals.$scope[identifier]=instance}return function(expression,locals,later,ident){var instance,match,constructor,identifier;if(later=later===!0,ident&&isString(ident)&&(identifier=ident),isString(expression)){if(match=expression.match(CNTRL_REG),!match)throw $controllerMinErr("ctrlfmt","Badly formed controller string '{0}'. Must match `__name__ as __id__` or `__name__`.",expression);constructor=match[1],identifier=identifier||match[3],expression=controllers.hasOwnProperty(constructor)?controllers[constructor]:getter(locals.$scope,constructor,!0)||(globals?getter($window,constructor,!0):void 0),assertArgFn(expression,constructor,!0)}if(later){var controllerPrototype=(isArray(expression)?expression[expression.length-1]:expression).prototype;return instance=Object.create(controllerPrototype||null),identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name),extend(function(){var result=$injector.invoke(expression,instance,locals,constructor);return result!==instance&&(isObject(result)||isFunction(result))&&(instance=result,identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name)),instance},{instance:instance,identifier:identifier})}return instance=$injector.instantiate(expression,locals,constructor),identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name),instance}}]}function $DocumentProvider(){this.$get=["$window",function(window){return jqLite(window.document)}]}function $ExceptionHandlerProvider(){this.$get=["$log",function($log){return function(exception,cause){$log.error.apply($log,arguments)}}]}function serializeValue(v){return isObject(v)?isDate(v)?v.toISOString():toJson(v):v}function $HttpParamSerializerProvider(){this.$get=function(){return function(params){if(!params)return"";var parts=[];return forEachSorted(params,function(value,key){null===value||isUndefined(value)||(isArray(value)?forEach(value,function(v){parts.push(encodeUriQuery(key)+"="+encodeUriQuery(serializeValue(v)))}):parts.push(encodeUriQuery(key)+"="+encodeUriQuery(serializeValue(value))))}),parts.join("&")}}}function $HttpParamSerializerJQLikeProvider(){this.$get=function(){return function(params){function serialize(toSerialize,prefix,topLevel){null===toSerialize||isUndefined(toSerialize)||(isArray(toSerialize)?forEach(toSerialize,function(value,index){serialize(value,prefix+"["+(isObject(value)?index:"")+"]")}):isObject(toSerialize)&&!isDate(toSerialize)?forEachSorted(toSerialize,function(value,key){serialize(value,prefix+(topLevel?"":"[")+key+(topLevel?"":"]"))}):parts.push(encodeUriQuery(prefix)+"="+encodeUriQuery(serializeValue(toSerialize))))}if(!params)return"";var parts=[];return serialize(params,"",!0),parts.join("&")}}}function defaultHttpResponseTransform(data,headers){if(isString(data)){var tempData=data.replace(JSON_PROTECTION_PREFIX,"").trim();if(tempData){var contentType=headers("Content-Type");(contentType&&0===contentType.indexOf(APPLICATION_JSON)||isJsonLike(tempData))&&(data=fromJson(tempData))}}return data}function isJsonLike(str){var jsonStart=str.match(JSON_START);return jsonStart&&JSON_ENDS[jsonStart[0]].test(str)}function parseHeaders(headers){function fillInParsed(key,val){key&&(parsed[key]=parsed[key]?parsed[key]+", "+val:val)}var i,parsed=createMap();return isString(headers)?forEach(headers.split("\n"),function(line){i=line.indexOf(":"),fillInParsed(lowercase(trim(line.substr(0,i))),trim(line.substr(i+1)))}):isObject(headers)&&forEach(headers,function(headerVal,headerKey){fillInParsed(lowercase(headerKey),trim(headerVal))}),parsed}function headersGetter(headers){var headersObj;return function(name){
if(headersObj||(headersObj=parseHeaders(headers)),name){var value=headersObj[lowercase(name)];return void 0===value&&(value=null),value}return headersObj}}function transformData(data,headers,status,fns){return isFunction(fns)?fns(data,headers,status):(forEach(fns,function(fn){data=fn(data,headers,status)}),data)}function isSuccess(status){return 200<=status&&status<300}function $HttpProvider(){var defaults=this.defaults={transformResponse:[defaultHttpResponseTransform],transformRequest:[function(d){return!isObject(d)||isFile(d)||isBlob(d)||isFormData(d)?d:toJson(d)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),put:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),patch:shallowCopy(CONTENT_TYPE_APPLICATION_JSON)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer"},useApplyAsync=!1;this.useApplyAsync=function(value){return isDefined(value)?(useApplyAsync=!!value,this):useApplyAsync};var useLegacyPromise=!0;this.useLegacyPromiseExtensions=function(value){return isDefined(value)?(useLegacyPromise=!!value,this):useLegacyPromise};var interceptorFactories=this.interceptors=[];this.$get=["$httpBackend","$$cookieReader","$cacheFactory","$rootScope","$q","$injector",function($httpBackend,$$cookieReader,$cacheFactory,$rootScope,$q,$injector){function $http(requestConfig){function chainInterceptors(promise,interceptors){for(var i=0,ii=interceptors.length;i<ii;){var thenFn=interceptors[i++],rejectFn=interceptors[i++];promise=promise.then(thenFn,rejectFn)}return interceptors.length=0,promise}function executeHeaderFns(headers,config){var headerContent,processedHeaders={};return forEach(headers,function(headerFn,header){isFunction(headerFn)?(headerContent=headerFn(config),null!=headerContent&&(processedHeaders[header]=headerContent)):processedHeaders[header]=headerFn}),processedHeaders}function mergeHeaders(config){var defHeaderName,lowercaseDefHeaderName,reqHeaderName,defHeaders=defaults.headers,reqHeaders=extend({},config.headers);defHeaders=extend({},defHeaders.common,defHeaders[lowercase(config.method)]);defaultHeadersIteration:for(defHeaderName in defHeaders){lowercaseDefHeaderName=lowercase(defHeaderName);for(reqHeaderName in reqHeaders)if(lowercase(reqHeaderName)===lowercaseDefHeaderName)continue defaultHeadersIteration;reqHeaders[defHeaderName]=defHeaders[defHeaderName]}return executeHeaderFns(reqHeaders,shallowCopy(config))}function serverRequest(config){var headers=config.headers,reqData=transformData(config.data,headersGetter(headers),void 0,config.transformRequest);return isUndefined(reqData)&&forEach(headers,function(value,header){"content-type"===lowercase(header)&&delete headers[header]}),isUndefined(config.withCredentials)&&!isUndefined(defaults.withCredentials)&&(config.withCredentials=defaults.withCredentials),sendReq(config,reqData).then(transformResponse,transformResponse)}function transformResponse(response){var resp=extend({},response);return resp.data=transformData(response.data,response.headers,response.status,config.transformResponse),isSuccess(response.status)?resp:$q.reject(resp)}if(!isObject(requestConfig))throw minErr("$http")("badreq","Http request configuration must be an object.  Received: {0}",requestConfig);if(!isString(requestConfig.url))throw minErr("$http")("badreq","Http request configuration url must be a string.  Received: {0}",requestConfig.url);var config=extend({method:"get",transformRequest:defaults.transformRequest,transformResponse:defaults.transformResponse,paramSerializer:defaults.paramSerializer},requestConfig);config.headers=mergeHeaders(requestConfig),config.method=uppercase(config.method),config.paramSerializer=isString(config.paramSerializer)?$injector.get(config.paramSerializer):config.paramSerializer;var requestInterceptors=[],responseInterceptors=[],promise=$q.when(config);return forEach(reversedInterceptors,function(interceptor){(interceptor.request||interceptor.requestError)&&requestInterceptors.unshift(interceptor.request,interceptor.requestError),(interceptor.response||interceptor.responseError)&&responseInterceptors.push(interceptor.response,interceptor.responseError)}),promise=chainInterceptors(promise,requestInterceptors),promise=promise.then(serverRequest),promise=chainInterceptors(promise,responseInterceptors),useLegacyPromise?(promise.success=function(fn){return assertArgFn(fn,"fn"),promise.then(function(response){fn(response.data,response.status,response.headers,config)}),promise},promise.error=function(fn){return assertArgFn(fn,"fn"),promise.then(null,function(response){fn(response.data,response.status,response.headers,config)}),promise}):(promise.success=$httpMinErrLegacyFn("success"),promise.error=$httpMinErrLegacyFn("error")),promise}function createShortMethods(names){forEach(arguments,function(name){$http[name]=function(url,config){return $http(extend({},config||{},{method:name,url:url}))}})}function createShortMethodsWithData(name){forEach(arguments,function(name){$http[name]=function(url,data,config){return $http(extend({},config||{},{method:name,url:url,data:data}))}})}function sendReq(config,reqData){function createApplyHandlers(eventHandlers){if(eventHandlers){var applyHandlers={};return forEach(eventHandlers,function(eventHandler,key){applyHandlers[key]=function(event){function callEventHandler(){eventHandler(event)}useApplyAsync?$rootScope.$applyAsync(callEventHandler):$rootScope.$$phase?callEventHandler():$rootScope.$apply(callEventHandler)}}),applyHandlers}}function done(status,response,headersString,statusText){function resolveHttpPromise(){resolvePromise(response,status,headersString,statusText)}cache&&(isSuccess(status)?cache.put(url,[status,response,parseHeaders(headersString),statusText]):cache.remove(url)),useApplyAsync?$rootScope.$applyAsync(resolveHttpPromise):(resolveHttpPromise(),$rootScope.$$phase||$rootScope.$apply())}function resolvePromise(response,status,headers,statusText){status=status>=-1?status:0,(isSuccess(status)?deferred.resolve:deferred.reject)({data:response,status:status,headers:headersGetter(headers),config:config,statusText:statusText})}function resolvePromiseWithResult(result){resolvePromise(result.data,result.status,shallowCopy(result.headers()),result.statusText)}function removePendingReq(){var idx=$http.pendingRequests.indexOf(config);idx!==-1&&$http.pendingRequests.splice(idx,1)}var cache,cachedResp,deferred=$q.defer(),promise=deferred.promise,reqHeaders=config.headers,url=buildUrl(config.url,config.paramSerializer(config.params));if($http.pendingRequests.push(config),promise.then(removePendingReq,removePendingReq),!config.cache&&!defaults.cache||config.cache===!1||"GET"!==config.method&&"JSONP"!==config.method||(cache=isObject(config.cache)?config.cache:isObject(defaults.cache)?defaults.cache:defaultCache),cache&&(cachedResp=cache.get(url),isDefined(cachedResp)?isPromiseLike(cachedResp)?cachedResp.then(resolvePromiseWithResult,resolvePromiseWithResult):isArray(cachedResp)?resolvePromise(cachedResp[1],cachedResp[0],shallowCopy(cachedResp[2]),cachedResp[3]):resolvePromise(cachedResp,200,{},"OK"):cache.put(url,promise)),isUndefined(cachedResp)){var xsrfValue=urlIsSameOrigin(config.url)?$$cookieReader()[config.xsrfCookieName||defaults.xsrfCookieName]:void 0;xsrfValue&&(reqHeaders[config.xsrfHeaderName||defaults.xsrfHeaderName]=xsrfValue),$httpBackend(config.method,url,reqData,done,reqHeaders,config.timeout,config.withCredentials,config.responseType,createApplyHandlers(config.eventHandlers),createApplyHandlers(config.uploadEventHandlers))}return promise}function buildUrl(url,serializedParams){return serializedParams.length>0&&(url+=(url.indexOf("?")===-1?"?":"&")+serializedParams),url}var defaultCache=$cacheFactory("$http");defaults.paramSerializer=isString(defaults.paramSerializer)?$injector.get(defaults.paramSerializer):defaults.paramSerializer;var reversedInterceptors=[];return forEach(interceptorFactories,function(interceptorFactory){reversedInterceptors.unshift(isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory))}),$http.pendingRequests=[],createShortMethods("get","delete","head","jsonp"),createShortMethodsWithData("post","put","patch"),$http.defaults=defaults,$http}]}function $xhrFactoryProvider(){this.$get=function(){return function(){return new window.XMLHttpRequest}}}function $HttpBackendProvider(){this.$get=["$browser","$jsonpCallbacks","$document","$xhrFactory",function($browser,$jsonpCallbacks,$document,$xhrFactory){return createHttpBackend($browser,$xhrFactory,$browser.defer,$jsonpCallbacks,$document[0])}]}function createHttpBackend($browser,createXhr,$browserDefer,callbacks,rawDocument){function jsonpReq(url,callbackPath,done){url=url.replace("JSON_CALLBACK",callbackPath);var script=rawDocument.createElement("script"),callback=null;return script.type="text/javascript",script.src=url,script.async=!0,callback=function(event){removeEventListenerFn(script,"load",callback),removeEventListenerFn(script,"error",callback),rawDocument.body.removeChild(script),script=null;var status=-1,text="unknown";event&&("load"!==event.type||callbacks.wasCalled(callbackPath)||(event={type:"error"}),text=event.type,status="error"===event.type?404:200),done&&done(status,text)},addEventListenerFn(script,"load",callback),addEventListenerFn(script,"error",callback),rawDocument.body.appendChild(script),callback}return function(method,url,post,callback,headers,timeout,withCredentials,responseType,eventHandlers,uploadEventHandlers){function timeoutRequest(){jsonpDone&&jsonpDone(),xhr&&xhr.abort()}function completeRequest(callback,status,response,headersString,statusText){isDefined(timeoutId)&&$browserDefer.cancel(timeoutId),jsonpDone=xhr=null,callback(status,response,headersString,statusText),$browser.$$completeOutstandingRequest(noop)}if($browser.$$incOutstandingRequestCount(),url=url||$browser.url(),"jsonp"===lowercase(method))var callbackPath=callbacks.createCallback(url),jsonpDone=jsonpReq(url,callbackPath,function(status,text){var response=200===status&&callbacks.getResponse(callbackPath);completeRequest(callback,status,response,"",text),callbacks.removeCallback(callbackPath)});else{var xhr=createXhr(method,url);xhr.open(method,url,!0),forEach(headers,function(value,key){isDefined(value)&&xhr.setRequestHeader(key,value)}),xhr.onload=function(){var statusText=xhr.statusText||"",response="response"in xhr?xhr.response:xhr.responseText,status=1223===xhr.status?204:xhr.status;0===status&&(status=response?200:"file"===urlResolve(url).protocol?404:0),completeRequest(callback,status,response,xhr.getAllResponseHeaders(),statusText)};var requestError=function(){completeRequest(callback,-1,null,null,"")};if(xhr.onerror=requestError,xhr.onabort=requestError,xhr.ontimeout=requestError,forEach(eventHandlers,function(value,key){xhr.addEventListener(key,value)}),forEach(uploadEventHandlers,function(value,key){xhr.upload.addEventListener(key,value)}),withCredentials&&(xhr.withCredentials=!0),responseType)try{xhr.responseType=responseType}catch(e){if("json"!==responseType)throw e}xhr.send(isUndefined(post)?null:post)}if(timeout>0)var timeoutId=$browserDefer(timeoutRequest,timeout);else isPromiseLike(timeout)&&timeout.then(timeoutRequest)}}function $InterpolateProvider(){var startSymbol="{{",endSymbol="}}";this.startSymbol=function(value){return value?(startSymbol=value,this):startSymbol},this.endSymbol=function(value){return value?(endSymbol=value,this):endSymbol},this.$get=["$parse","$exceptionHandler","$sce",function($parse,$exceptionHandler,$sce){function escape(ch){return"\\\\\\"+ch}function unescapeText(text){return text.replace(escapedStartRegexp,startSymbol).replace(escapedEndRegexp,endSymbol)}function stringify(value){if(null==value)return"";switch(typeof value){case"string":break;case"number":value=""+value;break;default:value=toJson(value)}return value}function constantWatchDelegate(scope,listener,objectEquality,constantInterp){var unwatch=scope.$watch(function(scope){return unwatch(),constantInterp(scope)},listener,objectEquality);return unwatch}function $interpolate(text,mustHaveExpression,trustedContext,allOrNothing){function parseStringifyInterceptor(value){try{return value=getValue(value),allOrNothing&&!isDefined(value)?value:stringify(value)}catch(err){$exceptionHandler($interpolateMinErr.interr(text,err))}}if(!text.length||text.indexOf(startSymbol)===-1){var constantInterp;if(!mustHaveExpression){var unescapedText=unescapeText(text);constantInterp=valueFn(unescapedText),constantInterp.exp=text,constantInterp.expressions=[],constantInterp.$$watchDelegate=constantWatchDelegate}return constantInterp}allOrNothing=!!allOrNothing;for(var startIndex,endIndex,exp,index=0,expressions=[],parseFns=[],textLength=text.length,concat=[],expressionPositions=[];index<textLength;){if((startIndex=text.indexOf(startSymbol,index))===-1||(endIndex=text.indexOf(endSymbol,startIndex+startSymbolLength))===-1){index!==textLength&&concat.push(unescapeText(text.substring(index)));break}index!==startIndex&&concat.push(unescapeText(text.substring(index,startIndex))),exp=text.substring(startIndex+startSymbolLength,endIndex),expressions.push(exp),parseFns.push($parse(exp,parseStringifyInterceptor)),index=endIndex+endSymbolLength,expressionPositions.push(concat.length),concat.push("")}if(trustedContext&&concat.length>1&&$interpolateMinErr.throwNoconcat(text),!mustHaveExpression||expressions.length){var compute=function(values){for(var i=0,ii=expressions.length;i<ii;i++){if(allOrNothing&&isUndefined(values[i]))return;concat[expressionPositions[i]]=values[i]}return concat.join("")},getValue=function(value){return trustedContext?$sce.getTrusted(trustedContext,value):$sce.valueOf(value)};return extend(function(context){var i=0,ii=expressions.length,values=new Array(ii);try{for(;i<ii;i++)values[i]=parseFns[i](context);return compute(values)}catch(err){$exceptionHandler($interpolateMinErr.interr(text,err))}},{exp:text,expressions:expressions,$$watchDelegate:function(scope,listener){var lastValue;return scope.$watchGroup(parseFns,function(values,oldValues){var currValue=compute(values);isFunction(listener)&&listener.call(this,currValue,values!==oldValues?lastValue:currValue,scope),lastValue=currValue})}})}}var startSymbolLength=startSymbol.length,endSymbolLength=endSymbol.length,escapedStartRegexp=new RegExp(startSymbol.replace(/./g,escape),"g"),escapedEndRegexp=new RegExp(endSymbol.replace(/./g,escape),"g");return $interpolate.startSymbol=function(){return startSymbol},$interpolate.endSymbol=function(){return endSymbol},$interpolate}]}function $IntervalProvider(){this.$get=["$rootScope","$window","$q","$$q","$browser",function($rootScope,$window,$q,$$q,$browser){function interval(fn,delay,count,invokeApply){function callback(){hasParams?fn.apply(null,args):fn(iteration)}var hasParams=arguments.length>4,args=hasParams?sliceArgs(arguments,4):[],setInterval=$window.setInterval,clearInterval=$window.clearInterval,iteration=0,skipApply=isDefined(invokeApply)&&!invokeApply,deferred=(skipApply?$$q:$q).defer(),promise=deferred.promise;return count=isDefined(count)?count:0,promise.$$intervalId=setInterval(function(){skipApply?$browser.defer(callback):$rootScope.$evalAsync(callback),deferred.notify(iteration++),count>0&&iteration>=count&&(deferred.resolve(iteration),clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId]),skipApply||$rootScope.$apply()},delay),intervals[promise.$$intervalId]=deferred,promise}var intervals={};return interval.cancel=function(promise){return!!(promise&&promise.$$intervalId in intervals)&&(intervals[promise.$$intervalId].reject("canceled"),$window.clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId],!0)},interval}]}function encodePath(path){for(var segments=path.split("/"),i=segments.length;i--;)segments[i]=encodeUriSegment(segments[i]);return segments.join("/")}function parseAbsoluteUrl(absoluteUrl,locationObj){var parsedUrl=urlResolve(absoluteUrl);locationObj.$$protocol=parsedUrl.protocol,locationObj.$$host=parsedUrl.hostname,locationObj.$$port=toInt(parsedUrl.port)||DEFAULT_PORTS[parsedUrl.protocol]||null}function parseAppUrl(url,locationObj){if(DOUBLE_SLASH_REGEX.test(url))throw $locationMinErr("badpath",'Invalid url "{0}".',url);var prefixed="/"!==url.charAt(0);prefixed&&(url="/"+url);var match=urlResolve(url);locationObj.$$path=decodeURIComponent(prefixed&&"/"===match.pathname.charAt(0)?match.pathname.substring(1):match.pathname),locationObj.$$search=parseKeyValue(match.search),locationObj.$$hash=decodeURIComponent(match.hash),locationObj.$$path&&"/"!==locationObj.$$path.charAt(0)&&(locationObj.$$path="/"+locationObj.$$path)}function startsWith(haystack,needle){return 0===haystack.lastIndexOf(needle,0)}function stripBaseUrl(base,url){if(startsWith(url,base))return url.substr(base.length)}function stripHash(url){var index=url.indexOf("#");return index===-1?url:url.substr(0,index)}function trimEmptyHash(url){return url.replace(/(#.+)|#$/,"$1")}function stripFile(url){return url.substr(0,stripHash(url).lastIndexOf("/")+1)}function serverBase(url){return url.substring(0,url.indexOf("/",url.indexOf("//")+2))}function LocationHtml5Url(appBase,appBaseNoFile,basePrefix){this.$$html5=!0,basePrefix=basePrefix||"",parseAbsoluteUrl(appBase,this),this.$$parse=function(url){var pathUrl=stripBaseUrl(appBaseNoFile,url);if(!isString(pathUrl))throw $locationMinErr("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',url,appBaseNoFile);parseAppUrl(pathUrl,this),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBaseNoFile+this.$$url.substr(1)},this.$$parseLinkUrl=function(url,relHref){if(relHref&&"#"===relHref[0])return this.hash(relHref.slice(1)),!0;var appUrl,prevAppUrl,rewrittenUrl;return isDefined(appUrl=stripBaseUrl(appBase,url))?(prevAppUrl=appUrl,rewrittenUrl=basePrefix&&isDefined(appUrl=stripBaseUrl(basePrefix,appUrl))?appBaseNoFile+(stripBaseUrl("/",appUrl)||appUrl):appBase+prevAppUrl):isDefined(appUrl=stripBaseUrl(appBaseNoFile,url))?rewrittenUrl=appBaseNoFile+appUrl:appBaseNoFile===url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl}}function LocationHashbangUrl(appBase,appBaseNoFile,hashPrefix){parseAbsoluteUrl(appBase,this),this.$$parse=function(url){function removeWindowsDriveName(path,url,base){var firstPathSegmentMatch,windowsFilePathExp=/^\/[A-Z]:(\/.*)/;return startsWith(url,base)&&(url=url.replace(base,"")),windowsFilePathExp.exec(url)?path:(firstPathSegmentMatch=windowsFilePathExp.exec(path),firstPathSegmentMatch?firstPathSegmentMatch[1]:path)}var withoutHashUrl,withoutBaseUrl=stripBaseUrl(appBase,url)||stripBaseUrl(appBaseNoFile,url);isUndefined(withoutBaseUrl)||"#"!==withoutBaseUrl.charAt(0)?this.$$html5?withoutHashUrl=withoutBaseUrl:(withoutHashUrl="",isUndefined(withoutBaseUrl)&&(appBase=url,this.replace())):(withoutHashUrl=stripBaseUrl(hashPrefix,withoutBaseUrl),isUndefined(withoutHashUrl)&&(withoutHashUrl=withoutBaseUrl)),parseAppUrl(withoutHashUrl,this),this.$$path=removeWindowsDriveName(this.$$path,withoutHashUrl,appBase),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+(this.$$url?hashPrefix+this.$$url:"")},this.$$parseLinkUrl=function(url,relHref){return stripHash(appBase)===stripHash(url)&&(this.$$parse(url),!0)}}function LocationHashbangInHtml5Url(appBase,appBaseNoFile,hashPrefix){this.$$html5=!0,LocationHashbangUrl.apply(this,arguments),this.$$parseLinkUrl=function(url,relHref){if(relHref&&"#"===relHref[0])return this.hash(relHref.slice(1)),!0;var rewrittenUrl,appUrl;return appBase===stripHash(url)?rewrittenUrl=url:(appUrl=stripBaseUrl(appBaseNoFile,url))?rewrittenUrl=appBase+hashPrefix+appUrl:appBaseNoFile===url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+hashPrefix+this.$$url}}function locationGetter(property){return function(){return this[property]}}function locationGetterSetter(property,preprocess){return function(value){return isUndefined(value)?this[property]:(this[property]=preprocess(value),this.$$compose(),this)}}function $LocationProvider(){var hashPrefix="",html5Mode={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(prefix){return isDefined(prefix)?(hashPrefix=prefix,this):hashPrefix},this.html5Mode=function(mode){return isBoolean(mode)?(html5Mode.enabled=mode,this):isObject(mode)?(isBoolean(mode.enabled)&&(html5Mode.enabled=mode.enabled),isBoolean(mode.requireBase)&&(html5Mode.requireBase=mode.requireBase),isBoolean(mode.rewriteLinks)&&(html5Mode.rewriteLinks=mode.rewriteLinks),this):html5Mode},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function($rootScope,$browser,$sniffer,$rootElement,$window){function setBrowserUrlWithFallback(url,replace,state){var oldUrl=$location.url(),oldState=$location.$$state;try{$browser.url(url,replace,state),$location.$$state=$browser.state()}catch(e){throw $location.url(oldUrl),$location.$$state=oldState,e}}function afterLocationChange(oldUrl,oldState){$rootScope.$broadcast("$locationChangeSuccess",$location.absUrl(),oldUrl,$location.$$state,oldState)}var $location,LocationMode,appBase,baseHref=$browser.baseHref(),initialUrl=$browser.url();if(html5Mode.enabled){if(!baseHref&&html5Mode.requireBase)throw $locationMinErr("nobase","$location in HTML5 mode requires a <base> tag to be present!");appBase=serverBase(initialUrl)+(baseHref||"/"),LocationMode=$sniffer.history?LocationHtml5Url:LocationHashbangInHtml5Url}else appBase=stripHash(initialUrl),LocationMode=LocationHashbangUrl;var appBaseNoFile=stripFile(appBase);$location=new LocationMode(appBase,appBaseNoFile,"#"+hashPrefix),$location.$$parseLinkUrl(initialUrl,initialUrl),$location.$$state=$browser.state();var IGNORE_URI_REGEXP=/^\s*(javascript|mailto):/i;$rootElement.on("click",function(event){if(html5Mode.rewriteLinks&&!event.ctrlKey&&!event.metaKey&&!event.shiftKey&&2!==event.which&&2!==event.button){for(var elm=jqLite(event.target);"a"!==nodeName_(elm[0]);)if(elm[0]===$rootElement[0]||!(elm=elm.parent())[0])return;var absHref=elm.prop("href"),relHref=elm.attr("href")||elm.attr("xlink:href");isObject(absHref)&&"[object SVGAnimatedString]"===absHref.toString()&&(absHref=urlResolve(absHref.animVal).href),IGNORE_URI_REGEXP.test(absHref)||!absHref||elm.attr("target")||event.isDefaultPrevented()||$location.$$parseLinkUrl(absHref,relHref)&&(event.preventDefault(),$location.absUrl()!==$browser.url()&&($rootScope.$apply(),$window.angular["ff-684208-preventDefault"]=!0))}}),trimEmptyHash($location.absUrl())!==trimEmptyHash(initialUrl)&&$browser.url($location.absUrl(),!0);var initializing=!0;return $browser.onUrlChange(function(newUrl,newState){return isUndefined(stripBaseUrl(appBaseNoFile,newUrl))?void($window.location.href=newUrl):($rootScope.$evalAsync(function(){var defaultPrevented,oldUrl=$location.absUrl(),oldState=$location.$$state;newUrl=trimEmptyHash(newUrl),$location.$$parse(newUrl),$location.$$state=newState,defaultPrevented=$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl,newState,oldState).defaultPrevented,$location.absUrl()===newUrl&&(defaultPrevented?($location.$$parse(oldUrl),$location.$$state=oldState,setBrowserUrlWithFallback(oldUrl,!1,oldState)):(initializing=!1,afterLocationChange(oldUrl,oldState)))}),void($rootScope.$$phase||$rootScope.$digest()))}),$rootScope.$watch(function(){var oldUrl=trimEmptyHash($browser.url()),newUrl=trimEmptyHash($location.absUrl()),oldState=$browser.state(),currentReplace=$location.$$replace,urlOrStateChanged=oldUrl!==newUrl||$location.$$html5&&$sniffer.history&&oldState!==$location.$$state;(initializing||urlOrStateChanged)&&(initializing=!1,$rootScope.$evalAsync(function(){var newUrl=$location.absUrl(),defaultPrevented=$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl,$location.$$state,oldState).defaultPrevented;$location.absUrl()===newUrl&&(defaultPrevented?($location.$$parse(oldUrl),$location.$$state=oldState):(urlOrStateChanged&&setBrowserUrlWithFallback(newUrl,currentReplace,oldState===$location.$$state?null:$location.$$state),afterLocationChange(oldUrl,oldState)))})),$location.$$replace=!1}),$location}]}function $LogProvider(){var debug=!0,self=this;this.debugEnabled=function(flag){return isDefined(flag)?(debug=flag,this):debug},this.$get=["$window",function($window){function formatError(arg){return arg instanceof Error&&(arg.stack?arg=arg.message&&arg.stack.indexOf(arg.message)===-1?"Error: "+arg.message+"\n"+arg.stack:arg.stack:arg.sourceURL&&(arg=arg.message+"\n"+arg.sourceURL+":"+arg.line)),arg}function consoleLog(type){var console=$window.console||{},logFn=console[type]||console.log||noop,hasApply=!1;try{hasApply=!!logFn.apply}catch(e){}return hasApply?function(){var args=[];return forEach(arguments,function(arg){args.push(formatError(arg))}),logFn.apply(console,args)}:function(arg1,arg2){logFn(arg1,null==arg2?"":arg2)}}return{log:consoleLog("log"),info:consoleLog("info"),warn:consoleLog("warn"),error:consoleLog("error"),debug:function(){var fn=consoleLog("debug");return function(){debug&&fn.apply(self,arguments)}}()}}]}function ensureSafeMemberName(name,fullExpression){if("__defineGetter__"===name||"__defineSetter__"===name||"__lookupGetter__"===name||"__lookupSetter__"===name||"__proto__"===name)throw $parseMinErr("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",fullExpression);return name}function getStringValue(name){return name+""}function ensureSafeObject(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.window===obj)throw $parseMinErr("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.children&&(obj.nodeName||obj.prop&&obj.attr&&obj.find))throw $parseMinErr("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===Object)throw $parseMinErr("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",fullExpression)}return obj}function ensureSafeFunction(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===CALL||obj===APPLY||obj===BIND)throw $parseMinErr("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",fullExpression)}}function ensureSafeAssignContext(obj,fullExpression){if(obj&&(obj===ARRAY_CTOR||obj===BOOLEAN_CTOR||obj===FUNCTION_CTOR||obj===NUMBER_CTOR||obj===OBJECT_CTOR||obj===STRING_CTOR||obj===ARRAY_CTOR_PROTO||obj===BOOLEAN_CTOR_PROTO||obj===FUNCTION_CTOR_PROTO||obj===NUMBER_CTOR_PROTO||obj===OBJECT_CTOR_PROTO||obj===STRING_CTOR_PROTO))throw $parseMinErr("isecaf","Assigning to a constructor or its prototype is disallowed! Expression: {0}",fullExpression)}function ifDefined(v,d){return"undefined"!=typeof v?v:d}function plusFn(l,r){return"undefined"==typeof l?r:"undefined"==typeof r?l:l+r}function isStateless($filter,filterName){var fn=$filter(filterName);return!fn.$stateful}function findConstantAndWatchExpressions(ast,$filter){var allConstants,argsToWatch,isStatelessFilter;switch(ast.type){case AST.Program:allConstants=!0,forEach(ast.body,function(expr){findConstantAndWatchExpressions(expr.expression,$filter),allConstants=allConstants&&expr.expression.constant}),ast.constant=allConstants;break;case AST.Literal:ast.constant=!0,ast.toWatch=[];break;case AST.UnaryExpression:findConstantAndWatchExpressions(ast.argument,$filter),ast.constant=ast.argument.constant,ast.toWatch=ast.argument.toWatch;break;case AST.BinaryExpression:findConstantAndWatchExpressions(ast.left,$filter),findConstantAndWatchExpressions(ast.right,$filter),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=ast.left.toWatch.concat(ast.right.toWatch);break;case AST.LogicalExpression:findConstantAndWatchExpressions(ast.left,$filter),findConstantAndWatchExpressions(ast.right,$filter),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=ast.constant?[]:[ast];break;case AST.ConditionalExpression:findConstantAndWatchExpressions(ast.test,$filter),findConstantAndWatchExpressions(ast.alternate,$filter),findConstantAndWatchExpressions(ast.consequent,$filter),ast.constant=ast.test.constant&&ast.alternate.constant&&ast.consequent.constant,ast.toWatch=ast.constant?[]:[ast];break;case AST.Identifier:ast.constant=!1,ast.toWatch=[ast];break;case AST.MemberExpression:findConstantAndWatchExpressions(ast.object,$filter),ast.computed&&findConstantAndWatchExpressions(ast.property,$filter),ast.constant=ast.object.constant&&(!ast.computed||ast.property.constant),ast.toWatch=[ast];break;case AST.CallExpression:isStatelessFilter=!!ast.filter&&isStateless($filter,ast.callee.name),allConstants=isStatelessFilter,argsToWatch=[],forEach(ast.arguments,function(expr){findConstantAndWatchExpressions(expr,$filter),allConstants=allConstants&&expr.constant,expr.constant||argsToWatch.push.apply(argsToWatch,expr.toWatch)}),ast.constant=allConstants,ast.toWatch=isStatelessFilter?argsToWatch:[ast];break;case AST.AssignmentExpression:findConstantAndWatchExpressions(ast.left,$filter),findConstantAndWatchExpressions(ast.right,$filter),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=[ast];break;case AST.ArrayExpression:allConstants=!0,argsToWatch=[],forEach(ast.elements,function(expr){findConstantAndWatchExpressions(expr,$filter),allConstants=allConstants&&expr.constant,expr.constant||argsToWatch.push.apply(argsToWatch,expr.toWatch)}),ast.constant=allConstants,ast.toWatch=argsToWatch;break;case AST.ObjectExpression:allConstants=!0,argsToWatch=[],forEach(ast.properties,function(property){findConstantAndWatchExpressions(property.value,$filter),allConstants=allConstants&&property.value.constant&&!property.computed,property.value.constant||argsToWatch.push.apply(argsToWatch,property.value.toWatch)}),ast.constant=allConstants,ast.toWatch=argsToWatch;break;case AST.ThisExpression:ast.constant=!1,ast.toWatch=[];break;case AST.LocalsExpression:ast.constant=!1,ast.toWatch=[]}}function getInputs(body){if(1===body.length){var lastExpression=body[0].expression,candidate=lastExpression.toWatch;return 1!==candidate.length?candidate:candidate[0]!==lastExpression?candidate:void 0}}function isAssignable(ast){return ast.type===AST.Identifier||ast.type===AST.MemberExpression}function assignableAST(ast){if(1===ast.body.length&&isAssignable(ast.body[0].expression))return{type:AST.AssignmentExpression,left:ast.body[0].expression,right:{type:AST.NGValueParameter},operator:"="}}function isLiteral(ast){return 0===ast.body.length||1===ast.body.length&&(ast.body[0].expression.type===AST.Literal||ast.body[0].expression.type===AST.ArrayExpression||ast.body[0].expression.type===AST.ObjectExpression)}function isConstant(ast){return ast.constant}function ASTCompiler(astBuilder,$filter){this.astBuilder=astBuilder,this.$filter=$filter}function ASTInterpreter(astBuilder,$filter){this.astBuilder=astBuilder,this.$filter=$filter}function isPossiblyDangerousMemberName(name){return"constructor"===name}function getValueOf(value){return isFunction(value.valueOf)?value.valueOf():objectValueOf.call(value)}function $ParseProvider(){var identStart,identContinue,cacheDefault=createMap(),cacheExpensive=createMap(),literals={true:!0,false:!1,null:null,
undefined:void 0};this.addLiteral=function(literalName,literalValue){literals[literalName]=literalValue},this.setIdentifierFns=function(identifierStart,identifierContinue){return identStart=identifierStart,identContinue=identifierContinue,this},this.$get=["$filter",function($filter){function $parse(exp,interceptorFn,expensiveChecks){var parsedExpression,oneTime,cacheKey;switch(expensiveChecks=expensiveChecks||runningChecksEnabled,typeof exp){case"string":exp=exp.trim(),cacheKey=exp;var cache=expensiveChecks?cacheExpensive:cacheDefault;if(parsedExpression=cache[cacheKey],!parsedExpression){":"===exp.charAt(0)&&":"===exp.charAt(1)&&(oneTime=!0,exp=exp.substring(2));var parseOptions=expensiveChecks?$parseOptionsExpensive:$parseOptions,lexer=new Lexer(parseOptions),parser=new Parser(lexer,$filter,parseOptions);parsedExpression=parser.parse(exp),parsedExpression.constant?parsedExpression.$$watchDelegate=constantWatchDelegate:oneTime?parsedExpression.$$watchDelegate=parsedExpression.literal?oneTimeLiteralWatchDelegate:oneTimeWatchDelegate:parsedExpression.inputs&&(parsedExpression.$$watchDelegate=inputsWatchDelegate),expensiveChecks&&(parsedExpression=expensiveChecksInterceptor(parsedExpression)),cache[cacheKey]=parsedExpression}return addInterceptor(parsedExpression,interceptorFn);case"function":return addInterceptor(exp,interceptorFn);default:return addInterceptor(noop,interceptorFn)}}function expensiveChecksInterceptor(fn){function expensiveCheckFn(scope,locals,assign,inputs){var expensiveCheckOldValue=runningChecksEnabled;runningChecksEnabled=!0;try{return fn(scope,locals,assign,inputs)}finally{runningChecksEnabled=expensiveCheckOldValue}}if(!fn)return fn;expensiveCheckFn.$$watchDelegate=fn.$$watchDelegate,expensiveCheckFn.assign=expensiveChecksInterceptor(fn.assign),expensiveCheckFn.constant=fn.constant,expensiveCheckFn.literal=fn.literal;for(var i=0;fn.inputs&&i<fn.inputs.length;++i)fn.inputs[i]=expensiveChecksInterceptor(fn.inputs[i]);return expensiveCheckFn.inputs=fn.inputs,expensiveCheckFn}function expressionInputDirtyCheck(newValue,oldValueOfValue){return null==newValue||null==oldValueOfValue?newValue===oldValueOfValue:("object"!=typeof newValue||(newValue=getValueOf(newValue),"object"!=typeof newValue))&&(newValue===oldValueOfValue||newValue!==newValue&&oldValueOfValue!==oldValueOfValue)}function inputsWatchDelegate(scope,listener,objectEquality,parsedExpression,prettyPrintExpression){var lastResult,inputExpressions=parsedExpression.inputs;if(1===inputExpressions.length){var oldInputValueOf=expressionInputDirtyCheck;return inputExpressions=inputExpressions[0],scope.$watch(function(scope){var newInputValue=inputExpressions(scope);return expressionInputDirtyCheck(newInputValue,oldInputValueOf)||(lastResult=parsedExpression(scope,void 0,void 0,[newInputValue]),oldInputValueOf=newInputValue&&getValueOf(newInputValue)),lastResult},listener,objectEquality,prettyPrintExpression)}for(var oldInputValueOfValues=[],oldInputValues=[],i=0,ii=inputExpressions.length;i<ii;i++)oldInputValueOfValues[i]=expressionInputDirtyCheck,oldInputValues[i]=null;return scope.$watch(function(scope){for(var changed=!1,i=0,ii=inputExpressions.length;i<ii;i++){var newInputValue=inputExpressions[i](scope);(changed||(changed=!expressionInputDirtyCheck(newInputValue,oldInputValueOfValues[i])))&&(oldInputValues[i]=newInputValue,oldInputValueOfValues[i]=newInputValue&&getValueOf(newInputValue))}return changed&&(lastResult=parsedExpression(scope,void 0,void 0,oldInputValues)),lastResult},listener,objectEquality,prettyPrintExpression)}function oneTimeWatchDelegate(scope,listener,objectEquality,parsedExpression){var unwatch,lastValue;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(value,old,scope){lastValue=value,isFunction(listener)&&listener.apply(this,arguments),isDefined(value)&&scope.$$postDigest(function(){isDefined(lastValue)&&unwatch()})},objectEquality)}function oneTimeLiteralWatchDelegate(scope,listener,objectEquality,parsedExpression){function isAllDefined(value){var allDefined=!0;return forEach(value,function(val){isDefined(val)||(allDefined=!1)}),allDefined}var unwatch,lastValue;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(value,old,scope){lastValue=value,isFunction(listener)&&listener.call(this,value,old,scope),isAllDefined(value)&&scope.$$postDigest(function(){isAllDefined(lastValue)&&unwatch()})},objectEquality)}function constantWatchDelegate(scope,listener,objectEquality,parsedExpression){var unwatch=scope.$watch(function(scope){return unwatch(),parsedExpression(scope)},listener,objectEquality);return unwatch}function addInterceptor(parsedExpression,interceptorFn){if(!interceptorFn)return parsedExpression;var watchDelegate=parsedExpression.$$watchDelegate,useInputs=!1,regularWatch=watchDelegate!==oneTimeLiteralWatchDelegate&&watchDelegate!==oneTimeWatchDelegate,fn=regularWatch?function(scope,locals,assign,inputs){var value=useInputs&&inputs?inputs[0]:parsedExpression(scope,locals,assign,inputs);return interceptorFn(value,scope,locals)}:function(scope,locals,assign,inputs){var value=parsedExpression(scope,locals,assign,inputs),result=interceptorFn(value,scope,locals);return isDefined(value)?result:value};return parsedExpression.$$watchDelegate&&parsedExpression.$$watchDelegate!==inputsWatchDelegate?fn.$$watchDelegate=parsedExpression.$$watchDelegate:interceptorFn.$stateful||(fn.$$watchDelegate=inputsWatchDelegate,useInputs=!parsedExpression.inputs,fn.inputs=parsedExpression.inputs?parsedExpression.inputs:[parsedExpression]),fn}var noUnsafeEval=csp().noUnsafeEval,$parseOptions={csp:noUnsafeEval,expensiveChecks:!1,literals:copy(literals),isIdentifierStart:isFunction(identStart)&&identStart,isIdentifierContinue:isFunction(identContinue)&&identContinue},$parseOptionsExpensive={csp:noUnsafeEval,expensiveChecks:!0,literals:copy(literals),isIdentifierStart:isFunction(identStart)&&identStart,isIdentifierContinue:isFunction(identContinue)&&identContinue},runningChecksEnabled=!1;return $parse.$$runningExpensiveChecks=function(){return runningChecksEnabled},$parse}]}function $QProvider(){this.$get=["$rootScope","$exceptionHandler",function($rootScope,$exceptionHandler){return qFactory(function(callback){$rootScope.$evalAsync(callback)},$exceptionHandler)}]}function $$QProvider(){this.$get=["$browser","$exceptionHandler",function($browser,$exceptionHandler){return qFactory(function(callback){$browser.defer(callback)},$exceptionHandler)}]}function qFactory(nextTick,exceptionHandler){function Promise(){this.$$state={status:0}}function simpleBind(context,fn){return function(value){fn.call(context,value)}}function processQueue(state){var fn,deferred,pending;pending=state.pending,state.processScheduled=!1,state.pending=void 0;for(var i=0,ii=pending.length;i<ii;++i){deferred=pending[i][0],fn=pending[i][state.status];try{isFunction(fn)?deferred.resolve(fn(state.value)):1===state.status?deferred.resolve(state.value):deferred.reject(state.value)}catch(e){deferred.reject(e),exceptionHandler(e)}}}function scheduleProcessQueue(state){!state.processScheduled&&state.pending&&(state.processScheduled=!0,nextTick(function(){processQueue(state)}))}function Deferred(){this.promise=new Promise}function all(promises){var deferred=new Deferred,counter=0,results=isArray(promises)?[]:{};return forEach(promises,function(promise,key){counter++,when(promise).then(function(value){results.hasOwnProperty(key)||(results[key]=value,--counter||deferred.resolve(results))},function(reason){results.hasOwnProperty(key)||deferred.reject(reason)})}),0===counter&&deferred.resolve(results),deferred.promise}function race(promises){var deferred=defer();return forEach(promises,function(promise){when(promise).then(deferred.resolve,deferred.reject)}),deferred.promise}var $qMinErr=minErr("$q",TypeError),defer=function(){var d=new Deferred;return d.resolve=simpleBind(d,d.resolve),d.reject=simpleBind(d,d.reject),d.notify=simpleBind(d,d.notify),d};extend(Promise.prototype,{then:function(onFulfilled,onRejected,progressBack){if(isUndefined(onFulfilled)&&isUndefined(onRejected)&&isUndefined(progressBack))return this;var result=new Deferred;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([result,onFulfilled,onRejected,progressBack]),this.$$state.status>0&&scheduleProcessQueue(this.$$state),result.promise},catch:function(callback){return this.then(null,callback)},finally:function(callback,progressBack){return this.then(function(value){return handleCallback(value,!0,callback)},function(error){return handleCallback(error,!1,callback)},progressBack)}}),extend(Deferred.prototype,{resolve:function(val){this.promise.$$state.status||(val===this.promise?this.$$reject($qMinErr("qcycle","Expected promise to be resolved with value other than itself '{0}'",val)):this.$$resolve(val))},$$resolve:function(val){function resolvePromise(val){done||(done=!0,that.$$resolve(val))}function rejectPromise(val){done||(done=!0,that.$$reject(val))}var then,that=this,done=!1;try{(isObject(val)||isFunction(val))&&(then=val&&val.then),isFunction(then)?(this.promise.$$state.status=-1,then.call(val,resolvePromise,rejectPromise,simpleBind(this,this.notify))):(this.promise.$$state.value=val,this.promise.$$state.status=1,scheduleProcessQueue(this.promise.$$state))}catch(e){rejectPromise(e),exceptionHandler(e)}},reject:function(reason){this.promise.$$state.status||this.$$reject(reason)},$$reject:function(reason){this.promise.$$state.value=reason,this.promise.$$state.status=2,scheduleProcessQueue(this.promise.$$state)},notify:function(progress){var callbacks=this.promise.$$state.pending;this.promise.$$state.status<=0&&callbacks&&callbacks.length&&nextTick(function(){for(var callback,result,i=0,ii=callbacks.length;i<ii;i++){result=callbacks[i][0],callback=callbacks[i][3];try{result.notify(isFunction(callback)?callback(progress):progress)}catch(e){exceptionHandler(e)}}})}});var reject=function(reason){var result=new Deferred;return result.reject(reason),result.promise},makePromise=function(value,resolved){var result=new Deferred;return resolved?result.resolve(value):result.reject(value),result.promise},handleCallback=function(value,isResolved,callback){var callbackOutput=null;try{isFunction(callback)&&(callbackOutput=callback())}catch(e){return makePromise(e,!1)}return isPromiseLike(callbackOutput)?callbackOutput.then(function(){return makePromise(value,isResolved)},function(error){return makePromise(error,!1)}):makePromise(value,isResolved)},when=function(value,callback,errback,progressBack){var result=new Deferred;return result.resolve(value),result.promise.then(callback,errback,progressBack)},resolve=when,$Q=function(resolver){function resolveFn(value){deferred.resolve(value)}function rejectFn(reason){deferred.reject(reason)}if(!isFunction(resolver))throw $qMinErr("norslvr","Expected resolverFn, got '{0}'",resolver);var deferred=new Deferred;return resolver(resolveFn,rejectFn),deferred.promise};return $Q.prototype=Promise.prototype,$Q.defer=defer,$Q.reject=reject,$Q.when=when,$Q.resolve=resolve,$Q.all=all,$Q.race=race,$Q}function $$RAFProvider(){this.$get=["$window","$timeout",function($window,$timeout){var requestAnimationFrame=$window.requestAnimationFrame||$window.webkitRequestAnimationFrame,cancelAnimationFrame=$window.cancelAnimationFrame||$window.webkitCancelAnimationFrame||$window.webkitCancelRequestAnimationFrame,rafSupported=!!requestAnimationFrame,raf=rafSupported?function(fn){var id=requestAnimationFrame(fn);return function(){cancelAnimationFrame(id)}}:function(fn){var timer=$timeout(fn,16.66,!1);return function(){$timeout.cancel(timer)}};return raf.supported=rafSupported,raf}]}function $RootScopeProvider(){function createChildScopeClass(parent){function ChildScope(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$id=nextUid(),this.$$ChildScope=null}return ChildScope.prototype=parent,ChildScope}var TTL=10,$rootScopeMinErr=minErr("$rootScope"),lastDirtyWatch=null,applyAsyncId=null;this.digestTtl=function(value){return arguments.length&&(TTL=value),TTL},this.$get=["$exceptionHandler","$parse","$browser",function($exceptionHandler,$parse,$browser){function destroyChildScope($event){$event.currentScope.$$destroyed=!0}function cleanUpScope($scope){9===msie&&($scope.$$childHead&&cleanUpScope($scope.$$childHead),$scope.$$nextSibling&&cleanUpScope($scope.$$nextSibling)),$scope.$parent=$scope.$$nextSibling=$scope.$$prevSibling=$scope.$$childHead=$scope.$$childTail=$scope.$root=$scope.$$watchers=null}function Scope(){this.$id=nextUid(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.$root=this,this.$$destroyed=!1,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$$isolateBindings=null}function beginPhase(phase){if($rootScope.$$phase)throw $rootScopeMinErr("inprog","{0} already in progress",$rootScope.$$phase);$rootScope.$$phase=phase}function clearPhase(){$rootScope.$$phase=null}function incrementWatchersCount(current,count){do current.$$watchersCount+=count;while(current=current.$parent)}function decrementListenerCount(current,count,name){do current.$$listenerCount[name]-=count,0===current.$$listenerCount[name]&&delete current.$$listenerCount[name];while(current=current.$parent)}function initWatchVal(){}function flushApplyAsync(){for(;applyAsyncQueue.length;)try{applyAsyncQueue.shift()()}catch(e){$exceptionHandler(e)}applyAsyncId=null}function scheduleApplyAsync(){null===applyAsyncId&&(applyAsyncId=$browser.defer(function(){$rootScope.$apply(flushApplyAsync)}))}Scope.prototype={constructor:Scope,$new:function(isolate,parent){var child;return parent=parent||this,isolate?(child=new Scope,child.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=createChildScopeClass(this)),child=new this.$$ChildScope),child.$parent=parent,child.$$prevSibling=parent.$$childTail,parent.$$childHead?(parent.$$childTail.$$nextSibling=child,parent.$$childTail=child):parent.$$childHead=parent.$$childTail=child,(isolate||parent!==this)&&child.$on("$destroy",destroyChildScope),child},$watch:function(watchExp,listener,objectEquality,prettyPrintExpression){var get=$parse(watchExp);if(get.$$watchDelegate)return get.$$watchDelegate(this,listener,objectEquality,get,watchExp);var scope=this,array=scope.$$watchers,watcher={fn:listener,last:initWatchVal,get:get,exp:prettyPrintExpression||watchExp,eq:!!objectEquality};return lastDirtyWatch=null,isFunction(listener)||(watcher.fn=noop),array||(array=scope.$$watchers=[]),array.unshift(watcher),incrementWatchersCount(this,1),function(){arrayRemove(array,watcher)>=0&&incrementWatchersCount(scope,-1),lastDirtyWatch=null}},$watchGroup:function(watchExpressions,listener){function watchGroupAction(){changeReactionScheduled=!1,firstRun?(firstRun=!1,listener(newValues,newValues,self)):listener(newValues,oldValues,self)}var oldValues=new Array(watchExpressions.length),newValues=new Array(watchExpressions.length),deregisterFns=[],self=this,changeReactionScheduled=!1,firstRun=!0;if(!watchExpressions.length){var shouldCall=!0;return self.$evalAsync(function(){shouldCall&&listener(newValues,newValues,self)}),function(){shouldCall=!1}}return 1===watchExpressions.length?this.$watch(watchExpressions[0],function(value,oldValue,scope){newValues[0]=value,oldValues[0]=oldValue,listener(newValues,value===oldValue?newValues:oldValues,scope)}):(forEach(watchExpressions,function(expr,i){var unwatchFn=self.$watch(expr,function(value,oldValue){newValues[i]=value,oldValues[i]=oldValue,changeReactionScheduled||(changeReactionScheduled=!0,self.$evalAsync(watchGroupAction))});deregisterFns.push(unwatchFn)}),function(){for(;deregisterFns.length;)deregisterFns.shift()()})},$watchCollection:function(obj,listener){function $watchCollectionInterceptor(_value){newValue=_value;var newLength,key,bothNaN,newItem,oldItem;if(!isUndefined(newValue)){if(isObject(newValue))if(isArrayLike(newValue)){oldValue!==internalArray&&(oldValue=internalArray,oldLength=oldValue.length=0,changeDetected++),newLength=newValue.length,oldLength!==newLength&&(changeDetected++,oldValue.length=oldLength=newLength);for(var i=0;i<newLength;i++)oldItem=oldValue[i],newItem=newValue[i],bothNaN=oldItem!==oldItem&&newItem!==newItem,bothNaN||oldItem===newItem||(changeDetected++,oldValue[i]=newItem)}else{oldValue!==internalObject&&(oldValue=internalObject={},oldLength=0,changeDetected++),newLength=0;for(key in newValue)hasOwnProperty.call(newValue,key)&&(newLength++,newItem=newValue[key],oldItem=oldValue[key],key in oldValue?(bothNaN=oldItem!==oldItem&&newItem!==newItem,bothNaN||oldItem===newItem||(changeDetected++,oldValue[key]=newItem)):(oldLength++,oldValue[key]=newItem,changeDetected++));if(oldLength>newLength){changeDetected++;for(key in oldValue)hasOwnProperty.call(newValue,key)||(oldLength--,delete oldValue[key])}}else oldValue!==newValue&&(oldValue=newValue,changeDetected++);return changeDetected}}function $watchCollectionAction(){if(initRun?(initRun=!1,listener(newValue,newValue,self)):listener(newValue,veryOldValue,self),trackVeryOldValue)if(isObject(newValue))if(isArrayLike(newValue)){veryOldValue=new Array(newValue.length);for(var i=0;i<newValue.length;i++)veryOldValue[i]=newValue[i]}else{veryOldValue={};for(var key in newValue)hasOwnProperty.call(newValue,key)&&(veryOldValue[key]=newValue[key])}else veryOldValue=newValue}$watchCollectionInterceptor.$stateful=!0;var newValue,oldValue,veryOldValue,self=this,trackVeryOldValue=listener.length>1,changeDetected=0,changeDetector=$parse(obj,$watchCollectionInterceptor),internalArray=[],internalObject={},initRun=!0,oldLength=0;return this.$watch(changeDetector,$watchCollectionAction)},$digest:function(){var watch,value,last,fn,get,watchers,length,dirty,next,current,logIdx,asyncTask,ttl=TTL,target=this,watchLog=[];beginPhase("$digest"),$browser.$$checkUrlChange(),this===$rootScope&&null!==applyAsyncId&&($browser.defer.cancel(applyAsyncId),flushApplyAsync()),lastDirtyWatch=null;do{dirty=!1,current=target;for(var asyncQueuePosition=0;asyncQueuePosition<asyncQueue.length;asyncQueuePosition++){try{asyncTask=asyncQueue[asyncQueuePosition],asyncTask.scope.$eval(asyncTask.expression,asyncTask.locals)}catch(e){$exceptionHandler(e)}lastDirtyWatch=null}asyncQueue.length=0;traverseScopesLoop:do{if(watchers=current.$$watchers)for(length=watchers.length;length--;)try{if(watch=watchers[length])if(get=watch.get,(value=get(current))===(last=watch.last)||(watch.eq?equals(value,last):isNumberNaN(value)&&isNumberNaN(last))){if(watch===lastDirtyWatch){dirty=!1;break traverseScopesLoop}}else dirty=!0,lastDirtyWatch=watch,watch.last=watch.eq?copy(value,null):value,fn=watch.fn,fn(value,last===initWatchVal?value:last,current),ttl<5&&(logIdx=4-ttl,watchLog[logIdx]||(watchLog[logIdx]=[]),watchLog[logIdx].push({msg:isFunction(watch.exp)?"fn: "+(watch.exp.name||watch.exp.toString()):watch.exp,newVal:value,oldVal:last}))}catch(e){$exceptionHandler(e)}if(!(next=current.$$watchersCount&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}while(current=next);if((dirty||asyncQueue.length)&&!ttl--)throw clearPhase(),$rootScopeMinErr("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",TTL,watchLog)}while(dirty||asyncQueue.length);for(clearPhase();postDigestQueuePosition<postDigestQueue.length;)try{postDigestQueue[postDigestQueuePosition++]()}catch(e){$exceptionHandler(e)}postDigestQueue.length=postDigestQueuePosition=0},$destroy:function(){if(!this.$$destroyed){var parent=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this===$rootScope&&$browser.$$applicationDestroyed(),incrementWatchersCount(this,-this.$$watchersCount);for(var eventName in this.$$listenerCount)decrementListenerCount(this,this.$$listenerCount[eventName],eventName);parent&&parent.$$childHead===this&&(parent.$$childHead=this.$$nextSibling),parent&&parent.$$childTail===this&&(parent.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=noop,this.$on=this.$watch=this.$watchGroup=function(){return noop},this.$$listeners={},this.$$nextSibling=null,cleanUpScope(this)}},$eval:function(expr,locals){return $parse(expr)(this,locals)},$evalAsync:function(expr,locals){$rootScope.$$phase||asyncQueue.length||$browser.defer(function(){asyncQueue.length&&$rootScope.$digest()}),asyncQueue.push({scope:this,expression:$parse(expr),locals:locals})},$$postDigest:function(fn){postDigestQueue.push(fn)},$apply:function(expr){try{beginPhase("$apply");try{return this.$eval(expr)}finally{clearPhase()}}catch(e){$exceptionHandler(e)}finally{try{$rootScope.$digest()}catch(e){throw $exceptionHandler(e),e}}},$applyAsync:function(expr){function $applyAsyncExpression(){scope.$eval(expr)}var scope=this;expr&&applyAsyncQueue.push($applyAsyncExpression),expr=$parse(expr),scheduleApplyAsync()},$on:function(name,listener){var namedListeners=this.$$listeners[name];namedListeners||(this.$$listeners[name]=namedListeners=[]),namedListeners.push(listener);var current=this;do current.$$listenerCount[name]||(current.$$listenerCount[name]=0),current.$$listenerCount[name]++;while(current=current.$parent);var self=this;return function(){var indexOfListener=namedListeners.indexOf(listener);indexOfListener!==-1&&(namedListeners[indexOfListener]=null,decrementListenerCount(self,1,name))}},$emit:function(name,args){var namedListeners,i,length,empty=[],scope=this,stopPropagation=!1,event={name:name,targetScope:scope,stopPropagation:function(){stopPropagation=!0},preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);do{for(namedListeners=scope.$$listeners[name]||empty,event.currentScope=scope,i=0,length=namedListeners.length;i<length;i++)if(namedListeners[i])try{namedListeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else namedListeners.splice(i,1),i--,length--;if(stopPropagation)return event.currentScope=null,event;scope=scope.$parent}while(scope);return event.currentScope=null,event},$broadcast:function(name,args){var target=this,current=target,next=target,event={name:name,targetScope:target,preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1};if(!target.$$listenerCount[name])return event;for(var listeners,i,length,listenerArgs=concat([event],arguments,1);current=next;){for(event.currentScope=current,listeners=current.$$listeners[name]||[],i=0,length=listeners.length;i<length;i++)if(listeners[i])try{listeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else listeners.splice(i,1),i--,length--;if(!(next=current.$$listenerCount[name]&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}return event.currentScope=null,event}};var $rootScope=new Scope,asyncQueue=$rootScope.$$asyncQueue=[],postDigestQueue=$rootScope.$$postDigestQueue=[],applyAsyncQueue=$rootScope.$$applyAsyncQueue=[],postDigestQueuePosition=0;return $rootScope}]}function $$SanitizeUriProvider(){var aHrefSanitizationWhitelist=/^\s*(https?|ftp|mailto|tel|file):/,imgSrcSanitizationWhitelist=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?(aHrefSanitizationWhitelist=regexp,this):aHrefSanitizationWhitelist},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?(imgSrcSanitizationWhitelist=regexp,this):imgSrcSanitizationWhitelist},this.$get=function(){return function(uri,isImage){var normalizedVal,regex=isImage?imgSrcSanitizationWhitelist:aHrefSanitizationWhitelist;return normalizedVal=urlResolve(uri).href,""===normalizedVal||normalizedVal.match(regex)?uri:"unsafe:"+normalizedVal}}}function adjustMatcher(matcher){if("self"===matcher)return matcher;if(isString(matcher)){if(matcher.indexOf("***")>-1)throw $sceMinErr("iwcard","Illegal sequence *** in string matcher.  String: {0}",matcher);return matcher=escapeForRegexp(matcher).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+matcher+"$")}if(isRegExp(matcher))return new RegExp("^"+matcher.source+"$");throw $sceMinErr("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}function adjustMatchers(matchers){var adjustedMatchers=[];return isDefined(matchers)&&forEach(matchers,function(matcher){adjustedMatchers.push(adjustMatcher(matcher))}),adjustedMatchers}function $SceDelegateProvider(){this.SCE_CONTEXTS=SCE_CONTEXTS;var resourceUrlWhitelist=["self"],resourceUrlBlacklist=[];this.resourceUrlWhitelist=function(value){return arguments.length&&(resourceUrlWhitelist=adjustMatchers(value)),resourceUrlWhitelist},this.resourceUrlBlacklist=function(value){return arguments.length&&(resourceUrlBlacklist=adjustMatchers(value)),resourceUrlBlacklist},this.$get=["$injector",function($injector){function matchUrl(matcher,parsedUrl){return"self"===matcher?urlIsSameOrigin(parsedUrl):!!matcher.exec(parsedUrl.href)}function isResourceUrlAllowedByPolicy(url){var i,n,parsedUrl=urlResolve(url.toString()),allowed=!1;for(i=0,n=resourceUrlWhitelist.length;i<n;i++)if(matchUrl(resourceUrlWhitelist[i],parsedUrl)){allowed=!0;break}if(allowed)for(i=0,n=resourceUrlBlacklist.length;i<n;i++)if(matchUrl(resourceUrlBlacklist[i],parsedUrl)){allowed=!1;break}return allowed}function generateHolderType(Base){var holderType=function(trustedValue){this.$$unwrapTrustedValue=function(){return trustedValue}};return Base&&(holderType.prototype=new Base),holderType.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},holderType.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},holderType}function trustAs(type,trustedValue){var Constructor=byType.hasOwnProperty(type)?byType[type]:null;if(!Constructor)throw $sceMinErr("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",type,trustedValue);if(null===trustedValue||isUndefined(trustedValue)||""===trustedValue)return trustedValue;if("string"!=typeof trustedValue)throw $sceMinErr("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",type);return new Constructor(trustedValue)}function valueOf(maybeTrusted){return maybeTrusted instanceof trustedValueHolderBase?maybeTrusted.$$unwrapTrustedValue():maybeTrusted}function getTrusted(type,maybeTrusted){if(null===maybeTrusted||isUndefined(maybeTrusted)||""===maybeTrusted)return maybeTrusted;var constructor=byType.hasOwnProperty(type)?byType[type]:null;if(constructor&&maybeTrusted instanceof constructor)return maybeTrusted.$$unwrapTrustedValue();if(type===SCE_CONTEXTS.RESOURCE_URL){if(isResourceUrlAllowedByPolicy(maybeTrusted))return maybeTrusted;throw $sceMinErr("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",maybeTrusted.toString())}if(type===SCE_CONTEXTS.HTML)return htmlSanitizer(maybeTrusted);throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")}var htmlSanitizer=function(html){throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")};$injector.has("$sanitize")&&(htmlSanitizer=$injector.get("$sanitize"));var trustedValueHolderBase=generateHolderType(),byType={};return byType[SCE_CONTEXTS.HTML]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.CSS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.URL]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.JS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.RESOURCE_URL]=generateHolderType(byType[SCE_CONTEXTS.URL]),{trustAs:trustAs,getTrusted:getTrusted,valueOf:valueOf}}]}function $SceProvider(){var enabled=!0;this.enabled=function(value){return arguments.length&&(enabled=!!value),enabled},this.$get=["$parse","$sceDelegate",function($parse,$sceDelegate){if(enabled&&msie<8)throw $sceMinErr("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 11 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var sce=shallowCopy(SCE_CONTEXTS);sce.isEnabled=function(){return enabled},sce.trustAs=$sceDelegate.trustAs,sce.getTrusted=$sceDelegate.getTrusted,sce.valueOf=$sceDelegate.valueOf,enabled||(sce.trustAs=sce.getTrusted=function(type,value){return value},sce.valueOf=identity),sce.parseAs=function(type,expr){var parsed=$parse(expr);return parsed.literal&&parsed.constant?parsed:$parse(expr,function(value){return sce.getTrusted(type,value)})};var parse=sce.parseAs,getTrusted=sce.getTrusted,trustAs=sce.trustAs;return forEach(SCE_CONTEXTS,function(enumValue,name){var lName=lowercase(name);sce[camelCase("parse_as_"+lName)]=function(expr){return parse(enumValue,expr)},sce[camelCase("get_trusted_"+lName)]=function(value){return getTrusted(enumValue,value)},sce[camelCase("trust_as_"+lName)]=function(value){return trustAs(enumValue,value)}}),sce}]}function $SnifferProvider(){this.$get=["$window","$document",function($window,$document){var vendorPrefix,match,eventSupport={},isChromePackagedApp=$window.chrome&&($window.chrome.app&&$window.chrome.app.runtime||!$window.chrome.app&&$window.chrome.runtime&&$window.chrome.runtime.id),hasHistoryPushState=!isChromePackagedApp&&$window.history&&$window.history.pushState,android=toInt((/android (\d+)/.exec(lowercase(($window.navigator||{}).userAgent))||[])[1]),boxee=/Boxee/i.test(($window.navigator||{}).userAgent),document=$document[0]||{},vendorRegex=/^(Moz|webkit|ms)(?=[A-Z])/,bodyStyle=document.body&&document.body.style,transitions=!1,animations=!1;if(bodyStyle){for(var prop in bodyStyle)if(match=vendorRegex.exec(prop)){vendorPrefix=match[0],vendorPrefix=vendorPrefix[0].toUpperCase()+vendorPrefix.substr(1);break}vendorPrefix||(vendorPrefix="WebkitOpacity"in bodyStyle&&"webkit"),transitions=!!("transition"in bodyStyle||vendorPrefix+"Transition"in bodyStyle),animations=!!("animation"in bodyStyle||vendorPrefix+"Animation"in bodyStyle),!android||transitions&&animations||(transitions=isString(bodyStyle.webkitTransition),animations=isString(bodyStyle.webkitAnimation))}return{history:!(!hasHistoryPushState||android<4||boxee),hasEvent:function(event){if("input"===event&&msie<=11)return!1;if(isUndefined(eventSupport[event])){var divElm=document.createElement("div");eventSupport[event]="on"+event in divElm}return eventSupport[event]},csp:csp(),vendorPrefix:vendorPrefix,transitions:transitions,animations:animations,android:android}}]}function $TemplateRequestProvider(){var httpOptions;this.httpOptions=function(val){return val?(httpOptions=val,this):httpOptions},this.$get=["$templateCache","$http","$q","$sce",function($templateCache,$http,$q,$sce){function handleRequestFn(tpl,ignoreRequestError){function handleError(resp){if(!ignoreRequestError)throw $templateRequestMinErr("tpload","Failed to load template: {0} (HTTP status: {1} {2})",tpl,resp.status,resp.statusText);return $q.reject(resp)}handleRequestFn.totalPendingRequests++,isString(tpl)&&!isUndefined($templateCache.get(tpl))||(tpl=$sce.getTrustedResourceUrl(tpl));var transformResponse=$http.defaults&&$http.defaults.transformResponse;return isArray(transformResponse)?transformResponse=transformResponse.filter(function(transformer){return transformer!==defaultHttpResponseTransform}):transformResponse===defaultHttpResponseTransform&&(transformResponse=null),$http.get(tpl,extend({cache:$templateCache,transformResponse:transformResponse},httpOptions)).finally(function(){handleRequestFn.totalPendingRequests--}).then(function(response){return $templateCache.put(tpl,response.data),response.data},handleError)}return handleRequestFn.totalPendingRequests=0,
handleRequestFn}]}function $$TestabilityProvider(){this.$get=["$rootScope","$browser","$location",function($rootScope,$browser,$location){var testability={};return testability.findBindings=function(element,expression,opt_exactMatch){var bindings=element.getElementsByClassName("ng-binding"),matches=[];return forEach(bindings,function(binding){var dataBinding=angular.element(binding).data("$binding");dataBinding&&forEach(dataBinding,function(bindingName){if(opt_exactMatch){var matcher=new RegExp("(^|\\s)"+escapeForRegexp(expression)+"(\\s|\\||$)");matcher.test(bindingName)&&matches.push(binding)}else bindingName.indexOf(expression)!==-1&&matches.push(binding)})}),matches},testability.findModels=function(element,expression,opt_exactMatch){for(var prefixes=["ng-","data-ng-","ng\\:"],p=0;p<prefixes.length;++p){var attributeEquals=opt_exactMatch?"=":"*=",selector="["+prefixes[p]+"model"+attributeEquals+'"'+expression+'"]',elements=element.querySelectorAll(selector);if(elements.length)return elements}},testability.getLocation=function(){return $location.url()},testability.setLocation=function(url){url!==$location.url()&&($location.url(url),$rootScope.$digest())},testability.whenStable=function(callback){$browser.notifyWhenNoOutstandingRequests(callback)},testability}]}function $TimeoutProvider(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function($rootScope,$browser,$q,$$q,$exceptionHandler){function timeout(fn,delay,invokeApply){isFunction(fn)||(invokeApply=delay,delay=fn,fn=noop);var timeoutId,args=sliceArgs(arguments,3),skipApply=isDefined(invokeApply)&&!invokeApply,deferred=(skipApply?$$q:$q).defer(),promise=deferred.promise;return timeoutId=$browser.defer(function(){try{deferred.resolve(fn.apply(null,args))}catch(e){deferred.reject(e),$exceptionHandler(e)}finally{delete deferreds[promise.$$timeoutId]}skipApply||$rootScope.$apply()},delay),promise.$$timeoutId=timeoutId,deferreds[timeoutId]=deferred,promise}var deferreds={};return timeout.cancel=function(promise){return!!(promise&&promise.$$timeoutId in deferreds)&&(deferreds[promise.$$timeoutId].reject("canceled"),delete deferreds[promise.$$timeoutId],$browser.defer.cancel(promise.$$timeoutId))},timeout}]}function urlResolve(url){var href=url;return msie&&(urlParsingNode.setAttribute("href",href),href=urlParsingNode.href),urlParsingNode.setAttribute("href",href),{href:urlParsingNode.href,protocol:urlParsingNode.protocol?urlParsingNode.protocol.replace(/:$/,""):"",host:urlParsingNode.host,search:urlParsingNode.search?urlParsingNode.search.replace(/^\?/,""):"",hash:urlParsingNode.hash?urlParsingNode.hash.replace(/^#/,""):"",hostname:urlParsingNode.hostname,port:urlParsingNode.port,pathname:"/"===urlParsingNode.pathname.charAt(0)?urlParsingNode.pathname:"/"+urlParsingNode.pathname}}function urlIsSameOrigin(requestUrl){var parsed=isString(requestUrl)?urlResolve(requestUrl):requestUrl;return parsed.protocol===originUrl.protocol&&parsed.host===originUrl.host}function $WindowProvider(){this.$get=valueFn(window)}function $$CookieReader($document){function safeDecodeURIComponent(str){try{return decodeURIComponent(str)}catch(e){return str}}var rawDocument=$document[0]||{},lastCookies={},lastCookieString="";return function(){var cookieArray,cookie,i,index,name,currentCookieString=rawDocument.cookie||"";if(currentCookieString!==lastCookieString)for(lastCookieString=currentCookieString,cookieArray=lastCookieString.split("; "),lastCookies={},i=0;i<cookieArray.length;i++)cookie=cookieArray[i],index=cookie.indexOf("="),index>0&&(name=safeDecodeURIComponent(cookie.substring(0,index)),isUndefined(lastCookies[name])&&(lastCookies[name]=safeDecodeURIComponent(cookie.substring(index+1))));return lastCookies}}function $$CookieReaderProvider(){this.$get=$$CookieReader}function $FilterProvider($provide){function register(name,factory){if(isObject(name)){var filters={};return forEach(name,function(filter,key){filters[key]=register(key,filter)}),filters}return $provide.factory(name+suffix,factory)}var suffix="Filter";this.register=register,this.$get=["$injector",function($injector){return function(name){return $injector.get(name+suffix)}}],register("currency",currencyFilter),register("date",dateFilter),register("filter",filterFilter),register("json",jsonFilter),register("limitTo",limitToFilter),register("lowercase",lowercaseFilter),register("number",numberFilter),register("orderBy",orderByFilter),register("uppercase",uppercaseFilter)}function filterFilter(){return function(array,expression,comparator,anyPropertyKey){if(!isArrayLike(array)){if(null==array)return array;throw minErr("filter")("notarray","Expected array but received: {0}",array)}anyPropertyKey=anyPropertyKey||"$";var predicateFn,matchAgainstAnyProp,expressionType=getTypeForFilter(expression);switch(expressionType){case"function":predicateFn=expression;break;case"boolean":case"null":case"number":case"string":matchAgainstAnyProp=!0;case"object":predicateFn=createPredicateFn(expression,comparator,anyPropertyKey,matchAgainstAnyProp);break;default:return array}return Array.prototype.filter.call(array,predicateFn)}}function createPredicateFn(expression,comparator,anyPropertyKey,matchAgainstAnyProp){var predicateFn,shouldMatchPrimitives=isObject(expression)&&anyPropertyKey in expression;return comparator===!0?comparator=equals:isFunction(comparator)||(comparator=function(actual,expected){return!isUndefined(actual)&&(null===actual||null===expected?actual===expected:!(isObject(expected)||isObject(actual)&&!hasCustomToString(actual))&&(actual=lowercase(""+actual),expected=lowercase(""+expected),actual.indexOf(expected)!==-1))}),predicateFn=function(item){return shouldMatchPrimitives&&!isObject(item)?deepCompare(item,expression[anyPropertyKey],comparator,anyPropertyKey,!1):deepCompare(item,expression,comparator,anyPropertyKey,matchAgainstAnyProp)}}function deepCompare(actual,expected,comparator,anyPropertyKey,matchAgainstAnyProp,dontMatchWholeObject){var actualType=getTypeForFilter(actual),expectedType=getTypeForFilter(expected);if("string"===expectedType&&"!"===expected.charAt(0))return!deepCompare(actual,expected.substring(1),comparator,anyPropertyKey,matchAgainstAnyProp);if(isArray(actual))return actual.some(function(item){return deepCompare(item,expected,comparator,anyPropertyKey,matchAgainstAnyProp)});switch(actualType){case"object":var key;if(matchAgainstAnyProp){for(key in actual)if("$"!==key.charAt(0)&&deepCompare(actual[key],expected,comparator,anyPropertyKey,!0))return!0;return!dontMatchWholeObject&&deepCompare(actual,expected,comparator,anyPropertyKey,!1)}if("object"===expectedType){for(key in expected){var expectedVal=expected[key];if(!isFunction(expectedVal)&&!isUndefined(expectedVal)){var matchAnyProperty=key===anyPropertyKey,actualVal=matchAnyProperty?actual:actual[key];if(!deepCompare(actualVal,expectedVal,comparator,anyPropertyKey,matchAnyProperty,matchAnyProperty))return!1}}return!0}return comparator(actual,expected);case"function":return!1;default:return comparator(actual,expected)}}function getTypeForFilter(val){return null===val?"null":typeof val}function currencyFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(amount,currencySymbol,fractionSize){return isUndefined(currencySymbol)&&(currencySymbol=formats.CURRENCY_SYM),isUndefined(fractionSize)&&(fractionSize=formats.PATTERNS[1].maxFrac),null==amount?amount:formatNumber(amount,formats.PATTERNS[1],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize).replace(/\u00A4/g,currencySymbol)}}function numberFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(number,fractionSize){return null==number?number:formatNumber(number,formats.PATTERNS[0],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize)}}function parse(numStr){var digits,numberOfIntegerDigits,i,j,zeros,exponent=0;for((numberOfIntegerDigits=numStr.indexOf(DECIMAL_SEP))>-1&&(numStr=numStr.replace(DECIMAL_SEP,"")),(i=numStr.search(/e/i))>0?(numberOfIntegerDigits<0&&(numberOfIntegerDigits=i),numberOfIntegerDigits+=+numStr.slice(i+1),numStr=numStr.substring(0,i)):numberOfIntegerDigits<0&&(numberOfIntegerDigits=numStr.length),i=0;numStr.charAt(i)===ZERO_CHAR;i++);if(i===(zeros=numStr.length))digits=[0],numberOfIntegerDigits=1;else{for(zeros--;numStr.charAt(zeros)===ZERO_CHAR;)zeros--;for(numberOfIntegerDigits-=i,digits=[],j=0;i<=zeros;i++,j++)digits[j]=+numStr.charAt(i)}return numberOfIntegerDigits>MAX_DIGITS&&(digits=digits.splice(0,MAX_DIGITS-1),exponent=numberOfIntegerDigits-1,numberOfIntegerDigits=1),{d:digits,e:exponent,i:numberOfIntegerDigits}}function roundNumber(parsedNumber,fractionSize,minFrac,maxFrac){var digits=parsedNumber.d,fractionLen=digits.length-parsedNumber.i;fractionSize=isUndefined(fractionSize)?Math.min(Math.max(minFrac,fractionLen),maxFrac):+fractionSize;var roundAt=fractionSize+parsedNumber.i,digit=digits[roundAt];if(roundAt>0){digits.splice(Math.max(parsedNumber.i,roundAt));for(var j=roundAt;j<digits.length;j++)digits[j]=0}else{fractionLen=Math.max(0,fractionLen),parsedNumber.i=1,digits.length=Math.max(1,roundAt=fractionSize+1),digits[0]=0;for(var i=1;i<roundAt;i++)digits[i]=0}if(digit>=5)if(roundAt-1<0){for(var k=0;k>roundAt;k--)digits.unshift(0),parsedNumber.i++;digits.unshift(1),parsedNumber.i++}else digits[roundAt-1]++;for(;fractionLen<Math.max(0,fractionSize);fractionLen++)digits.push(0);var carry=digits.reduceRight(function(carry,d,i,digits){return d+=carry,digits[i]=d%10,Math.floor(d/10)},0);carry&&(digits.unshift(carry),parsedNumber.i++)}function formatNumber(number,pattern,groupSep,decimalSep,fractionSize){if(!isString(number)&&!isNumber(number)||isNaN(number))return"";var parsedNumber,isInfinity=!isFinite(number),isZero=!1,numStr=Math.abs(number)+"",formattedText="";if(isInfinity)formattedText="∞";else{parsedNumber=parse(numStr),roundNumber(parsedNumber,fractionSize,pattern.minFrac,pattern.maxFrac);var digits=parsedNumber.d,integerLen=parsedNumber.i,exponent=parsedNumber.e,decimals=[];for(isZero=digits.reduce(function(isZero,d){return isZero&&!d},!0);integerLen<0;)digits.unshift(0),integerLen++;integerLen>0?decimals=digits.splice(integerLen,digits.length):(decimals=digits,digits=[0]);var groups=[];for(digits.length>=pattern.lgSize&&groups.unshift(digits.splice(-pattern.lgSize,digits.length).join(""));digits.length>pattern.gSize;)groups.unshift(digits.splice(-pattern.gSize,digits.length).join(""));digits.length&&groups.unshift(digits.join("")),formattedText=groups.join(groupSep),decimals.length&&(formattedText+=decimalSep+decimals.join("")),exponent&&(formattedText+="e+"+exponent)}return number<0&&!isZero?pattern.negPre+formattedText+pattern.negSuf:pattern.posPre+formattedText+pattern.posSuf}function padNumber(num,digits,trim,negWrap){var neg="";for((num<0||negWrap&&num<=0)&&(negWrap?num=-num+1:(num=-num,neg="-")),num=""+num;num.length<digits;)num=ZERO_CHAR+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function dateGetter(name,size,offset,trim,negWrap){return offset=offset||0,function(date){var value=date["get"+name]();return(offset>0||value>-offset)&&(value+=offset),0===value&&offset===-12&&(value=12),padNumber(value,size,trim,negWrap)}}function dateStrGetter(name,shortForm,standAlone){return function(date,formats){var value=date["get"+name](),propPrefix=(standAlone?"STANDALONE":"")+(shortForm?"SHORT":""),get=uppercase(propPrefix+name);return formats[get][value]}}function timeZoneGetter(date,formats,offset){var zone=-1*offset,paddedZone=zone>=0?"+":"";return paddedZone+=padNumber(Math[zone>0?"floor":"ceil"](zone/60),2)+padNumber(Math.abs(zone%60),2)}function getFirstThursdayOfYear(year){var dayOfWeekOnFirst=new Date(year,0,1).getDay();return new Date(year,0,(dayOfWeekOnFirst<=4?5:12)-dayOfWeekOnFirst)}function getThursdayThisWeek(datetime){return new Date(datetime.getFullYear(),datetime.getMonth(),datetime.getDate()+(4-datetime.getDay()))}function weekGetter(size){return function(date){var firstThurs=getFirstThursdayOfYear(date.getFullYear()),thisThurs=getThursdayThisWeek(date),diff=+thisThurs-+firstThurs,result=1+Math.round(diff/6048e5);return padNumber(result,size)}}function ampmGetter(date,formats){return date.getHours()<12?formats.AMPMS[0]:formats.AMPMS[1]}function eraGetter(date,formats){return date.getFullYear()<=0?formats.ERAS[0]:formats.ERAS[1]}function longEraGetter(date,formats){return date.getFullYear()<=0?formats.ERANAMES[0]:formats.ERANAMES[1]}function dateFilter($locale){function jsonStringToDate(string){var match;if(match=string.match(R_ISO8601_STR)){var date=new Date(0),tzHour=0,tzMin=0,dateSetter=match[8]?date.setUTCFullYear:date.setFullYear,timeSetter=match[8]?date.setUTCHours:date.setHours;match[9]&&(tzHour=toInt(match[9]+match[10]),tzMin=toInt(match[9]+match[11])),dateSetter.call(date,toInt(match[1]),toInt(match[2])-1,toInt(match[3]));var h=toInt(match[4]||0)-tzHour,m=toInt(match[5]||0)-tzMin,s=toInt(match[6]||0),ms=Math.round(1e3*parseFloat("0."+(match[7]||0)));return timeSetter.call(date,h,m,s,ms),date}return string}var R_ISO8601_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(date,format,timezone){var fn,match,text="",parts=[];if(format=format||"mediumDate",format=$locale.DATETIME_FORMATS[format]||format,isString(date)&&(date=NUMBER_STRING.test(date)?toInt(date):jsonStringToDate(date)),isNumber(date)&&(date=new Date(date)),!isDate(date)||!isFinite(date.getTime()))return date;for(;format;)match=DATE_FORMATS_SPLIT.exec(format),match?(parts=concat(parts,match,1),format=parts.pop()):(parts.push(format),format=null);var dateTimezoneOffset=date.getTimezoneOffset();return timezone&&(dateTimezoneOffset=timezoneToOffset(timezone,dateTimezoneOffset),date=convertTimezoneToLocal(date,timezone,!0)),forEach(parts,function(value){fn=DATE_FORMATS[value],text+=fn?fn(date,$locale.DATETIME_FORMATS,dateTimezoneOffset):"''"===value?"'":value.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),text}}function jsonFilter(){return function(object,spacing){return isUndefined(spacing)&&(spacing=2),toJson(object,spacing)}}function limitToFilter(){return function(input,limit,begin){return limit=Math.abs(Number(limit))===1/0?Number(limit):toInt(limit),isNumberNaN(limit)?input:(isNumber(input)&&(input=input.toString()),isArrayLike(input)?(begin=!begin||isNaN(begin)?0:toInt(begin),begin=begin<0?Math.max(0,input.length+begin):begin,limit>=0?sliceFn(input,begin,begin+limit):0===begin?sliceFn(input,limit,input.length):sliceFn(input,Math.max(0,begin+limit),begin)):input)}}function sliceFn(input,begin,end){return isString(input)?input.slice(begin,end):slice.call(input,begin,end)}function orderByFilter($parse){function processPredicates(sortPredicates){return sortPredicates.map(function(predicate){var descending=1,get=identity;if(isFunction(predicate))get=predicate;else if(isString(predicate)&&("+"!==predicate.charAt(0)&&"-"!==predicate.charAt(0)||(descending="-"===predicate.charAt(0)?-1:1,predicate=predicate.substring(1)),""!==predicate&&(get=$parse(predicate),get.constant))){var key=get();get=function(value){return value[key]}}return{get:get,descending:descending}})}function isPrimitive(value){switch(typeof value){case"number":case"boolean":case"string":return!0;default:return!1}}function objectValue(value){return isFunction(value.valueOf)&&(value=value.valueOf(),isPrimitive(value))?value:hasCustomToString(value)&&(value=value.toString(),isPrimitive(value))?value:value}function getPredicateValue(value,index){var type=typeof value;return null===value?(type="string",value="null"):"object"===type&&(value=objectValue(value)),{value:value,type:type,index:index}}function defaultCompare(v1,v2){var result=0,type1=v1.type,type2=v2.type;if(type1===type2){var value1=v1.value,value2=v2.value;"string"===type1?(value1=value1.toLowerCase(),value2=value2.toLowerCase()):"object"===type1&&(isObject(value1)&&(value1=v1.index),isObject(value2)&&(value2=v2.index)),value1!==value2&&(result=value1<value2?-1:1)}else result=type1<type2?-1:1;return result}return function(array,sortPredicate,reverseOrder,compareFn){function getComparisonObject(value,index){return{value:value,tieBreaker:{value:index,type:"number",index:index},predicateValues:predicates.map(function(predicate){return getPredicateValue(predicate.get(value),index)})}}function doComparison(v1,v2){for(var i=0,ii=predicates.length;i<ii;i++){var result=compare(v1.predicateValues[i],v2.predicateValues[i]);if(result)return result*predicates[i].descending*descending}return compare(v1.tieBreaker,v2.tieBreaker)*descending}if(null==array)return array;if(!isArrayLike(array))throw minErr("orderBy")("notarray","Expected array but received: {0}",array);isArray(sortPredicate)||(sortPredicate=[sortPredicate]),0===sortPredicate.length&&(sortPredicate=["+"]);var predicates=processPredicates(sortPredicate),descending=reverseOrder?-1:1,compare=isFunction(compareFn)?compareFn:defaultCompare,compareValues=Array.prototype.map.call(array,getComparisonObject);return compareValues.sort(doComparison),array=compareValues.map(function(item){return item.value})}}function ngDirective(directive){return isFunction(directive)&&(directive={link:directive}),directive.restrict=directive.restrict||"AC",valueFn(directive)}function nullFormRenameControl(control,name){control.$name=name}function FormController(element,attrs,$scope,$animate,$interpolate){var form=this,controls=[];form.$error={},form.$$success={},form.$pending=void 0,form.$name=$interpolate(attrs.name||attrs.ngForm||"")($scope),form.$dirty=!1,form.$pristine=!0,form.$valid=!0,form.$invalid=!1,form.$submitted=!1,form.$$parentForm=nullFormCtrl,form.$rollbackViewValue=function(){forEach(controls,function(control){control.$rollbackViewValue()})},form.$commitViewValue=function(){forEach(controls,function(control){control.$commitViewValue()})},form.$addControl=function(control){assertNotHasOwnProperty(control.$name,"input"),controls.push(control),control.$name&&(form[control.$name]=control),control.$$parentForm=form},form.$$renameControl=function(control,newName){var oldName=control.$name;form[oldName]===control&&delete form[oldName],form[newName]=control,control.$name=newName},form.$removeControl=function(control){control.$name&&form[control.$name]===control&&delete form[control.$name],forEach(form.$pending,function(value,name){form.$setValidity(name,null,control)}),forEach(form.$error,function(value,name){form.$setValidity(name,null,control)}),forEach(form.$$success,function(value,name){form.$setValidity(name,null,control)}),arrayRemove(controls,control),control.$$parentForm=nullFormCtrl},addSetValidityMethod({ctrl:this,$element:element,set:function(object,property,controller){var list=object[property];if(list){var index=list.indexOf(controller);index===-1&&list.push(controller)}else object[property]=[controller]},unset:function(object,property,controller){var list=object[property];list&&(arrayRemove(list,controller),0===list.length&&delete object[property])},$animate:$animate}),form.$setDirty=function(){$animate.removeClass(element,PRISTINE_CLASS),$animate.addClass(element,DIRTY_CLASS),form.$dirty=!0,form.$pristine=!1,form.$$parentForm.$setDirty()},form.$setPristine=function(){$animate.setClass(element,PRISTINE_CLASS,DIRTY_CLASS+" "+SUBMITTED_CLASS),form.$dirty=!1,form.$pristine=!0,form.$submitted=!1,forEach(controls,function(control){control.$setPristine()})},form.$setUntouched=function(){forEach(controls,function(control){control.$setUntouched()})},form.$setSubmitted=function(){$animate.addClass(element,SUBMITTED_CLASS),form.$submitted=!0,form.$$parentForm.$setSubmitted()}}function stringBasedInputType(ctrl){ctrl.$formatters.push(function(value){return ctrl.$isEmpty(value)?value:value.toString()})}function textInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl)}function baseInputType(scope,element,attr,ctrl,$sniffer,$browser){var type=lowercase(element[0].type);if(!$sniffer.android){var composing=!1;element.on("compositionstart",function(){composing=!0}),element.on("compositionend",function(){composing=!1,listener()})}var timeout,listener=function(ev){if(timeout&&($browser.defer.cancel(timeout),timeout=null),!composing){var value=element.val(),event=ev&&ev.type;"password"===type||attr.ngTrim&&"false"===attr.ngTrim||(value=trim(value)),(ctrl.$viewValue!==value||""===value&&ctrl.$$hasNativeValidators)&&ctrl.$setViewValue(value,event)}};if($sniffer.hasEvent("input"))element.on("input",listener);else{var deferListener=function(ev,input,origValue){timeout||(timeout=$browser.defer(function(){timeout=null,input&&input.value===origValue||listener(ev)}))};element.on("keydown",function(event){var key=event.keyCode;91===key||15<key&&key<19||37<=key&&key<=40||deferListener(event,this,this.value)}),$sniffer.hasEvent("paste")&&element.on("paste cut",deferListener)}element.on("change",listener),PARTIAL_VALIDATION_TYPES[type]&&ctrl.$$hasNativeValidators&&type===attr.type&&element.on(PARTIAL_VALIDATION_EVENTS,function(ev){if(!timeout){var validity=this[VALIDITY_STATE_PROPERTY],origBadInput=validity.badInput,origTypeMismatch=validity.typeMismatch;timeout=$browser.defer(function(){timeout=null,validity.badInput===origBadInput&&validity.typeMismatch===origTypeMismatch||listener(ev)})}}),ctrl.$render=function(){var value=ctrl.$isEmpty(ctrl.$viewValue)?"":ctrl.$viewValue;element.val()!==value&&element.val(value)}}function weekParser(isoWeek,existingDate){if(isDate(isoWeek))return isoWeek;if(isString(isoWeek)){WEEK_REGEXP.lastIndex=0;var parts=WEEK_REGEXP.exec(isoWeek);if(parts){var year=+parts[1],week=+parts[2],hours=0,minutes=0,seconds=0,milliseconds=0,firstThurs=getFirstThursdayOfYear(year),addDays=7*(week-1);return existingDate&&(hours=existingDate.getHours(),minutes=existingDate.getMinutes(),seconds=existingDate.getSeconds(),milliseconds=existingDate.getMilliseconds()),new Date(year,0,firstThurs.getDate()+addDays,hours,minutes,seconds,milliseconds)}}return NaN}function createDateParser(regexp,mapping){return function(iso,date){var parts,map;if(isDate(iso))return iso;if(isString(iso)){if('"'===iso.charAt(0)&&'"'===iso.charAt(iso.length-1)&&(iso=iso.substring(1,iso.length-1)),ISO_DATE_REGEXP.test(iso))return new Date(iso);if(regexp.lastIndex=0,parts=regexp.exec(iso))return parts.shift(),map=date?{yyyy:date.getFullYear(),MM:date.getMonth()+1,dd:date.getDate(),HH:date.getHours(),mm:date.getMinutes(),ss:date.getSeconds(),sss:date.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},forEach(parts,function(part,index){index<mapping.length&&(map[mapping[index]]=+part)}),new Date(map.yyyy,map.MM-1,map.dd,map.HH,map.mm,map.ss||0,1e3*map.sss||0)}return NaN}}function createDateInputType(type,regexp,parseDate,format){return function(scope,element,attr,ctrl,$sniffer,$browser,$filter){function isValidDate(value){return value&&!(value.getTime&&value.getTime()!==value.getTime())}function parseObservedDateValue(val){return isDefined(val)&&!isDate(val)?parseDate(val)||void 0:val}badInputChecker(scope,element,attr,ctrl),baseInputType(scope,element,attr,ctrl,$sniffer,$browser);var previousDate,timezone=ctrl&&ctrl.$options&&ctrl.$options.timezone;if(ctrl.$$parserName=type,ctrl.$parsers.push(function(value){if(ctrl.$isEmpty(value))return null;if(regexp.test(value)){var parsedDate=parseDate(value,previousDate);return timezone&&(parsedDate=convertTimezoneToLocal(parsedDate,timezone)),parsedDate}}),ctrl.$formatters.push(function(value){if(value&&!isDate(value))throw ngModelMinErr("datefmt","Expected `{0}` to be a date",value);return isValidDate(value)?(previousDate=value,previousDate&&timezone&&(previousDate=convertTimezoneToLocal(previousDate,timezone,!0)),$filter("date")(value,format,timezone)):(previousDate=null,"")}),isDefined(attr.min)||attr.ngMin){var minVal;ctrl.$validators.min=function(value){return!isValidDate(value)||isUndefined(minVal)||parseDate(value)>=minVal},attr.$observe("min",function(val){minVal=parseObservedDateValue(val),ctrl.$validate()})}if(isDefined(attr.max)||attr.ngMax){var maxVal;ctrl.$validators.max=function(value){return!isValidDate(value)||isUndefined(maxVal)||parseDate(value)<=maxVal},attr.$observe("max",function(val){maxVal=parseObservedDateValue(val),ctrl.$validate()})}}}function badInputChecker(scope,element,attr,ctrl){var node=element[0],nativeValidation=ctrl.$$hasNativeValidators=isObject(node.validity);nativeValidation&&ctrl.$parsers.push(function(value){var validity=element.prop(VALIDITY_STATE_PROPERTY)||{};return validity.badInput||validity.typeMismatch?void 0:value})}function numberFormatterParser(ctrl){ctrl.$$parserName="number",ctrl.$parsers.push(function(value){return ctrl.$isEmpty(value)?null:NUMBER_REGEXP.test(value)?parseFloat(value):void 0}),ctrl.$formatters.push(function(value){if(!ctrl.$isEmpty(value)){if(!isNumber(value))throw ngModelMinErr("numfmt","Expected `{0}` to be a number",value);value=value.toString()}return value})}function parseNumberAttrVal(val){return isDefined(val)&&!isNumber(val)&&(val=parseFloat(val)),isNumberNaN(val)?void 0:val}function isNumberInteger(num){return(0|num)===num}function countDecimals(num){var numString=num.toString(),decimalSymbolIndex=numString.indexOf(".");if(decimalSymbolIndex===-1){if(-1<num&&num<1){var match=/e-(\d+)$/.exec(numString);if(match)return Number(match[1])}return 0}return numString.length-decimalSymbolIndex-1}function isValidForStep(viewValue,stepBase,step){var value=Number(viewValue);if(!isNumberInteger(value)||!isNumberInteger(stepBase)||!isNumberInteger(step)){var decimalCount=Math.max(countDecimals(value),countDecimals(stepBase),countDecimals(step)),multiplier=Math.pow(10,decimalCount);value*=multiplier,stepBase*=multiplier,step*=multiplier}return(value-stepBase)%step===0}function numberInputType(scope,element,attr,ctrl,$sniffer,$browser){badInputChecker(scope,element,attr,ctrl),baseInputType(scope,element,attr,ctrl,$sniffer,$browser),numberFormatterParser(ctrl);var minVal,maxVal;(isDefined(attr.min)||attr.ngMin)&&(ctrl.$validators.min=function(value){return ctrl.$isEmpty(value)||isUndefined(minVal)||value>=minVal},attr.$observe("min",function(val){minVal=parseNumberAttrVal(val),ctrl.$validate()})),(isDefined(attr.max)||attr.ngMax)&&(ctrl.$validators.max=function(value){return ctrl.$isEmpty(value)||isUndefined(maxVal)||value<=maxVal},attr.$observe("max",function(val){maxVal=parseNumberAttrVal(val),ctrl.$validate()}))}function rangeInputType(scope,element,attr,ctrl,$sniffer,$browser){function setInitialValueAndObserver(htmlAttrName,changeFn){element.attr(htmlAttrName,attr[htmlAttrName]),attr.$observe(htmlAttrName,changeFn)}function minChange(val){if(minVal=parseNumberAttrVal(val),!isNumberNaN(ctrl.$modelValue))if(supportsRange){var elVal=element.val();minVal>elVal&&(elVal=minVal,element.val(elVal)),ctrl.$setViewValue(elVal)}else ctrl.$validate()}function maxChange(val){if(maxVal=parseNumberAttrVal(val),!isNumberNaN(ctrl.$modelValue))if(supportsRange){var elVal=element.val();maxVal<elVal&&(element.val(maxVal),elVal=maxVal<minVal?minVal:maxVal),ctrl.$setViewValue(elVal)}else ctrl.$validate()}function stepChange(val){stepVal=parseNumberAttrVal(val),isNumberNaN(ctrl.$modelValue)||(supportsRange&&ctrl.$viewValue!==element.val()?ctrl.$setViewValue(element.val()):ctrl.$validate())}badInputChecker(scope,element,attr,ctrl),numberFormatterParser(ctrl),baseInputType(scope,element,attr,ctrl,$sniffer,$browser);var supportsRange=ctrl.$$hasNativeValidators&&"range"===element[0].type,minVal=supportsRange?0:void 0,maxVal=supportsRange?100:void 0,stepVal=supportsRange?1:void 0,validity=element[0].validity,hasMinAttr=isDefined(attr.min),hasMaxAttr=isDefined(attr.max),hasStepAttr=isDefined(attr.step),originalRender=ctrl.$render;ctrl.$render=supportsRange&&isDefined(validity.rangeUnderflow)&&isDefined(validity.rangeOverflow)?function(){originalRender(),ctrl.$setViewValue(element.val())}:originalRender,hasMinAttr&&(ctrl.$validators.min=supportsRange?function(){return!0}:function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||isUndefined(minVal)||viewValue>=minVal},setInitialValueAndObserver("min",minChange)),hasMaxAttr&&(ctrl.$validators.max=supportsRange?function(){return!0}:function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||isUndefined(maxVal)||viewValue<=maxVal},setInitialValueAndObserver("max",maxChange)),hasStepAttr&&(ctrl.$validators.step=supportsRange?function(){return!validity.stepMismatch}:function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||isUndefined(stepVal)||isValidForStep(viewValue,minVal||0,stepVal)},setInitialValueAndObserver("step",stepChange))}function urlInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl),ctrl.$$parserName="url",ctrl.$validators.url=function(modelValue,viewValue){var value=modelValue||viewValue;return ctrl.$isEmpty(value)||URL_REGEXP.test(value)}}function emailInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl),ctrl.$$parserName="email",ctrl.$validators.email=function(modelValue,viewValue){var value=modelValue||viewValue;return ctrl.$isEmpty(value)||EMAIL_REGEXP.test(value)}}function radioInputType(scope,element,attr,ctrl){isUndefined(attr.name)&&element.attr("name",nextUid());var listener=function(ev){element[0].checked&&ctrl.$setViewValue(attr.value,ev&&ev.type)};element.on("click",listener),ctrl.$render=function(){var value=attr.value;element[0].checked=value===ctrl.$viewValue},attr.$observe("value",ctrl.$render)}function parseConstantExpr($parse,context,name,expression,fallback){var parseFn;if(isDefined(expression)){if(parseFn=$parse(expression),!parseFn.constant)throw ngModelMinErr("constexpr","Expected constant expression for `{0}`, but saw `{1}`.",name,expression);return parseFn(context)}return fallback}function checkboxInputType(scope,element,attr,ctrl,$sniffer,$browser,$filter,$parse){var trueValue=parseConstantExpr($parse,scope,"ngTrueValue",attr.ngTrueValue,!0),falseValue=parseConstantExpr($parse,scope,"ngFalseValue",attr.ngFalseValue,!1),listener=function(ev){ctrl.$setViewValue(element[0].checked,ev&&ev.type)};element.on("click",listener),ctrl.$render=function(){element[0].checked=ctrl.$viewValue},ctrl.$isEmpty=function(value){return value===!1},ctrl.$formatters.push(function(value){return equals(value,trueValue)}),ctrl.$parsers.push(function(value){return value?trueValue:falseValue})}function classDirective(name,selector){return name="ngClass"+name,["$animate",function($animate){function arrayDifference(tokens1,tokens2){var values=[];outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token===tokens2[j])continue outer;values.push(token)}return values}function arrayClasses(classVal){var classes=[];return isArray(classVal)?(forEach(classVal,function(v){classes=classes.concat(arrayClasses(v))}),classes):isString(classVal)?classVal.split(" "):isObject(classVal)?(forEach(classVal,function(v,k){v&&(classes=classes.concat(k.split(" ")))}),classes):classVal}return{restrict:"AC",link:function(scope,element,attr){function addClasses(classes){var newClasses=digestClassCounts(classes,1);attr.$addClass(newClasses)}function removeClasses(classes){var newClasses=digestClassCounts(classes,-1);attr.$removeClass(newClasses)}function digestClassCounts(classes,count){var classCounts=element.data("$classCounts")||createMap(),classesToUpdate=[];return forEach(classes,function(className){(count>0||classCounts[className])&&(classCounts[className]=(classCounts[className]||0)+count,classCounts[className]===+(count>0)&&classesToUpdate.push(className))}),element.data("$classCounts",classCounts),classesToUpdate.join(" ")}function updateClasses(oldClasses,newClasses){var toAdd=arrayDifference(newClasses,oldClasses),toRemove=arrayDifference(oldClasses,newClasses);toAdd=digestClassCounts(toAdd,1),toRemove=digestClassCounts(toRemove,-1),toAdd&&toAdd.length&&$animate.addClass(element,toAdd),toRemove&&toRemove.length&&$animate.removeClass(element,toRemove);
}function ngClassWatchAction(newVal){if(selector===!0||(1&scope.$index)===selector){var newClasses=arrayClasses(newVal||[]);if(oldVal){if(!equals(newVal,oldVal)){var oldClasses=arrayClasses(oldVal);updateClasses(oldClasses,newClasses)}}else addClasses(newClasses)}oldVal=isArray(newVal)?newVal.map(function(v){return shallowCopy(v)}):shallowCopy(newVal)}var oldVal;scope.$watch(attr[name],ngClassWatchAction,!0),attr.$observe("class",function(value){ngClassWatchAction(scope.$eval(attr[name]))}),"ngClass"!==name&&scope.$watch("$index",function($index,old$index){var mod=1&$index;if(mod!==(1&old$index)){var classes=arrayClasses(scope.$eval(attr[name]));mod===selector?addClasses(classes):removeClasses(classes)}})}}}]}function addSetValidityMethod(context){function setValidity(validationErrorKey,state,controller){isUndefined(state)?createAndSet("$pending",validationErrorKey,controller):unsetAndCleanup("$pending",validationErrorKey,controller),isBoolean(state)?state?(unset(ctrl.$error,validationErrorKey,controller),set(ctrl.$$success,validationErrorKey,controller)):(set(ctrl.$error,validationErrorKey,controller),unset(ctrl.$$success,validationErrorKey,controller)):(unset(ctrl.$error,validationErrorKey,controller),unset(ctrl.$$success,validationErrorKey,controller)),ctrl.$pending?(cachedToggleClass(PENDING_CLASS,!0),ctrl.$valid=ctrl.$invalid=void 0,toggleValidationCss("",null)):(cachedToggleClass(PENDING_CLASS,!1),ctrl.$valid=isObjectEmpty(ctrl.$error),ctrl.$invalid=!ctrl.$valid,toggleValidationCss("",ctrl.$valid));var combinedState;combinedState=ctrl.$pending&&ctrl.$pending[validationErrorKey]?void 0:!ctrl.$error[validationErrorKey]&&(!!ctrl.$$success[validationErrorKey]||null),toggleValidationCss(validationErrorKey,combinedState),ctrl.$$parentForm.$setValidity(validationErrorKey,combinedState,ctrl)}function createAndSet(name,value,controller){ctrl[name]||(ctrl[name]={}),set(ctrl[name],value,controller)}function unsetAndCleanup(name,value,controller){ctrl[name]&&unset(ctrl[name],value,controller),isObjectEmpty(ctrl[name])&&(ctrl[name]=void 0)}function cachedToggleClass(className,switchValue){switchValue&&!classCache[className]?($animate.addClass($element,className),classCache[className]=!0):!switchValue&&classCache[className]&&($animate.removeClass($element,className),classCache[className]=!1)}function toggleValidationCss(validationErrorKey,isValid){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",cachedToggleClass(VALID_CLASS+validationErrorKey,isValid===!0),cachedToggleClass(INVALID_CLASS+validationErrorKey,isValid===!1)}var ctrl=context.ctrl,$element=context.$element,classCache={},set=context.set,unset=context.unset,$animate=context.$animate;classCache[INVALID_CLASS]=!(classCache[VALID_CLASS]=$element.hasClass(VALID_CLASS)),ctrl.$setValidity=setValidity}function isObjectEmpty(obj){if(obj)for(var prop in obj)if(obj.hasOwnProperty(prop))return!1;return!0}function chromeHack(optionElement){optionElement[0].hasAttribute("selected")&&(optionElement[0].selected=!0)}var REGEX_STRING_REGEXP=/^\/(.+)\/([a-z]*)$/,VALIDITY_STATE_PROPERTY="validity",hasOwnProperty=Object.prototype.hasOwnProperty,lowercase=function(string){return isString(string)?string.toLowerCase():string},uppercase=function(string){return isString(string)?string.toUpperCase():string},manualLowercase=function(s){return isString(s)?s.replace(/[A-Z]/g,function(ch){return String.fromCharCode(32|ch.charCodeAt(0))}):s},manualUppercase=function(s){return isString(s)?s.replace(/[a-z]/g,function(ch){return String.fromCharCode(ch.charCodeAt(0)&-33)}):s};"i"!=="I".toLowerCase()&&(lowercase=manualLowercase,uppercase=manualUppercase);var msie,jqLite,jQuery,angularModule,slice=[].slice,splice=[].splice,push=[].push,toString=Object.prototype.toString,getPrototypeOf=Object.getPrototypeOf,ngMinErr=minErr("ng"),angular=window.angular||(window.angular={}),uid=0;msie=window.document.documentMode;var isNumberNaN=Number.isNaN||function(num){return num!==num};noop.$inject=[],identity.$inject=[];var isArray=Array.isArray,TYPED_ARRAY_REGEXP=/^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array\]$/,trim=function(value){return isString(value)?value.trim():value},escapeForRegexp=function(s){return s.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},csp=function(){function noUnsafeEval(){try{return new Function(""),!1}catch(e){return!0}}if(!isDefined(csp.rules)){var ngCspElement=window.document.querySelector("[ng-csp]")||window.document.querySelector("[data-ng-csp]");if(ngCspElement){var ngCspAttribute=ngCspElement.getAttribute("ng-csp")||ngCspElement.getAttribute("data-ng-csp");csp.rules={noUnsafeEval:!ngCspAttribute||ngCspAttribute.indexOf("no-unsafe-eval")!==-1,noInlineStyle:!ngCspAttribute||ngCspAttribute.indexOf("no-inline-style")!==-1}}else csp.rules={noUnsafeEval:noUnsafeEval(),noInlineStyle:!1}}return csp.rules},jq=function(){if(isDefined(jq.name_))return jq.name_;var el,i,prefix,name,ii=ngAttrPrefixes.length;for(i=0;i<ii;++i)if(prefix=ngAttrPrefixes[i],el=window.document.querySelector("["+prefix.replace(":","\\:")+"jq]")){name=el.getAttribute(prefix+"jq");break}return jq.name_=name},ALL_COLONS=/:/g,ngAttrPrefixes=["ng-","data-ng-","ng:","x-ng-"],isAutoBootstrapAllowed=allowAutoBootstrap(window.document),SNAKE_CASE_REGEXP=/[A-Z]/g,bindJQueryFired=!1,NODE_TYPE_ELEMENT=1,NODE_TYPE_ATTRIBUTE=2,NODE_TYPE_TEXT=3,NODE_TYPE_COMMENT=8,NODE_TYPE_DOCUMENT=9,NODE_TYPE_DOCUMENT_FRAGMENT=11,version={full:"1.5.9",major:1,minor:5,dot:9,codeName:"timeturning-lockdown"};JQLite.expando="ng339";var jqCache=JQLite.cache={},jqId=1,addEventListenerFn=function(element,type,fn){element.addEventListener(type,fn,!1)},removeEventListenerFn=function(element,type,fn){element.removeEventListener(type,fn,!1)};JQLite._data=function(node){return this.cache[node[this.expando]]||{}};var SPECIAL_CHARS_REGEXP=/([:\-_]+(.))/g,MOZ_HACK_REGEXP=/^moz([A-Z])/,MOUSE_EVENT_MAP={mouseleave:"mouseout",mouseenter:"mouseover"},jqLiteMinErr=minErr("jqLite"),SINGLE_TAG_REGEXP=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,HTML_REGEXP=/<|&#?\w+;/,TAG_NAME_REGEXP=/<([\w:-]+)/,XHTML_TAG_REGEXP=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,wrapMap={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var jqLiteContains=window.Node.prototype.contains||function(arg){return!!(16&this.compareDocumentPosition(arg))},JQLitePrototype=JQLite.prototype={ready:function(fn){function trigger(){fired||(fired=!0,fn())}var fired=!1;"complete"===window.document.readyState?window.setTimeout(trigger):(this.on("DOMContentLoaded",trigger),JQLite(window).on("load",trigger))},toString:function(){var value=[];return forEach(this,function(e){value.push(""+e)}),"["+value.join(", ")+"]"},eq:function(index){return jqLite(index>=0?this[index]:this[this.length+index])},length:0,push:push,sort:[].sort,splice:[].splice},BOOLEAN_ATTR={};forEach("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(value){BOOLEAN_ATTR[lowercase(value)]=value});var BOOLEAN_ELEMENTS={};forEach("input,select,option,textarea,button,form,details".split(","),function(value){BOOLEAN_ELEMENTS[value]=!0});var ALIASED_ATTR={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};forEach({data:jqLiteData,removeData:jqLiteRemoveData,hasData:jqLiteHasData,cleanData:jqLiteCleanData},function(fn,name){JQLite[name]=fn}),forEach({data:jqLiteData,inheritedData:jqLiteInheritedData,scope:function(element){return jqLite.data(element,"$scope")||jqLiteInheritedData(element.parentNode||element,["$isolateScope","$scope"])},isolateScope:function(element){return jqLite.data(element,"$isolateScope")||jqLite.data(element,"$isolateScopeNoTemplate")},controller:jqLiteController,injector:function(element){return jqLiteInheritedData(element,"$injector")},removeAttr:function(element,name){element.removeAttribute(name)},hasClass:jqLiteHasClass,css:function(element,name,value){return name=camelCase(name),isDefined(value)?void(element.style[name]=value):element.style[name]},attr:function(element,name,value){var nodeType=element.nodeType;if(nodeType!==NODE_TYPE_TEXT&&nodeType!==NODE_TYPE_ATTRIBUTE&&nodeType!==NODE_TYPE_COMMENT){var lowercasedName=lowercase(name);if(BOOLEAN_ATTR[lowercasedName]){if(!isDefined(value))return element[name]||(element.attributes.getNamedItem(name)||noop).specified?lowercasedName:void 0;value?(element[name]=!0,element.setAttribute(name,lowercasedName)):(element[name]=!1,element.removeAttribute(lowercasedName))}else if(isDefined(value))element.setAttribute(name,value);else if(element.getAttribute){var ret=element.getAttribute(name,2);return null===ret?void 0:ret}}},prop:function(element,name,value){return isDefined(value)?void(element[name]=value):element[name]},text:function(){function getText(element,value){if(isUndefined(value)){var nodeType=element.nodeType;return nodeType===NODE_TYPE_ELEMENT||nodeType===NODE_TYPE_TEXT?element.textContent:""}element.textContent=value}return getText.$dv="",getText}(),val:function(element,value){if(isUndefined(value)){if(element.multiple&&"select"===nodeName_(element)){var result=[];return forEach(element.options,function(option){option.selected&&result.push(option.value||option.text)}),0===result.length?null:result}return element.value}element.value=value},html:function(element,value){return isUndefined(value)?element.innerHTML:(jqLiteDealoc(element,!0),void(element.innerHTML=value))},empty:jqLiteEmpty},function(fn,name){JQLite.prototype[name]=function(arg1,arg2){var i,key,nodeCount=this.length;if(fn!==jqLiteEmpty&&isUndefined(2===fn.length&&fn!==jqLiteHasClass&&fn!==jqLiteController?arg1:arg2)){if(isObject(arg1)){for(i=0;i<nodeCount;i++)if(fn===jqLiteData)fn(this[i],arg1);else for(key in arg1)fn(this[i],key,arg1[key]);return this}for(var value=fn.$dv,jj=isUndefined(value)?Math.min(nodeCount,1):nodeCount,j=0;j<jj;j++){var nodeValue=fn(this[j],arg1,arg2);value=value?value+nodeValue:nodeValue}return value}for(i=0;i<nodeCount;i++)fn(this[i],arg1,arg2);return this}}),forEach({removeData:jqLiteRemoveData,on:function(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");if(jqLiteAcceptsData(element)){var expandoStore=jqLiteExpandoStore(element,!0),events=expandoStore.events,handle=expandoStore.handle;handle||(handle=expandoStore.handle=createEventHandler(element,events));for(var types=type.indexOf(" ")>=0?type.split(" "):[type],i=types.length,addHandler=function(type,specialHandlerWrapper,noEventListener){var eventFns=events[type];eventFns||(eventFns=events[type]=[],eventFns.specialHandlerWrapper=specialHandlerWrapper,"$destroy"===type||noEventListener||addEventListenerFn(element,type,handle)),eventFns.push(fn)};i--;)type=types[i],MOUSE_EVENT_MAP[type]?(addHandler(MOUSE_EVENT_MAP[type],specialMouseHandlerWrapper),addHandler(type,void 0,!0)):addHandler(type)}},off:jqLiteOff,one:function(element,type,fn){element=jqLite(element),element.on(type,function onFn(){element.off(type,fn),element.off(type,onFn)}),element.on(type,fn)},replaceWith:function(element,replaceNode){var index,parent=element.parentNode;jqLiteDealoc(element),forEach(new JQLite(replaceNode),function(node){index?parent.insertBefore(node,index.nextSibling):parent.replaceChild(node,element),index=node})},children:function(element){var children=[];return forEach(element.childNodes,function(element){element.nodeType===NODE_TYPE_ELEMENT&&children.push(element)}),children},contents:function(element){return element.contentDocument||element.childNodes||[]},append:function(element,node){var nodeType=element.nodeType;if(nodeType===NODE_TYPE_ELEMENT||nodeType===NODE_TYPE_DOCUMENT_FRAGMENT){node=new JQLite(node);for(var i=0,ii=node.length;i<ii;i++){var child=node[i];element.appendChild(child)}}},prepend:function(element,node){if(element.nodeType===NODE_TYPE_ELEMENT){var index=element.firstChild;forEach(new JQLite(node),function(child){element.insertBefore(child,index)})}},wrap:function(element,wrapNode){jqLiteWrapNode(element,jqLite(wrapNode).eq(0).clone()[0])},remove:jqLiteRemove,detach:function(element){jqLiteRemove(element,!0)},after:function(element,newElement){var index=element,parent=element.parentNode;newElement=new JQLite(newElement);for(var i=0,ii=newElement.length;i<ii;i++){var node=newElement[i];parent.insertBefore(node,index.nextSibling),index=node}},addClass:jqLiteAddClass,removeClass:jqLiteRemoveClass,toggleClass:function(element,selector,condition){selector&&forEach(selector.split(" "),function(className){var classCondition=condition;isUndefined(classCondition)&&(classCondition=!jqLiteHasClass(element,className)),(classCondition?jqLiteAddClass:jqLiteRemoveClass)(element,className)})},parent:function(element){var parent=element.parentNode;return parent&&parent.nodeType!==NODE_TYPE_DOCUMENT_FRAGMENT?parent:null},next:function(element){return element.nextElementSibling},find:function(element,selector){return element.getElementsByTagName?element.getElementsByTagName(selector):[]},clone:jqLiteClone,triggerHandler:function(element,event,extraParameters){var dummyEvent,eventFnsCopy,handlerArgs,eventName=event.type||event,expandoStore=jqLiteExpandoStore(element),events=expandoStore&&expandoStore.events,eventFns=events&&events[eventName];eventFns&&(dummyEvent={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return this.defaultPrevented===!0},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return this.immediatePropagationStopped===!0},stopPropagation:noop,type:eventName,target:element},event.type&&(dummyEvent=extend(dummyEvent,event)),eventFnsCopy=shallowCopy(eventFns),handlerArgs=extraParameters?[dummyEvent].concat(extraParameters):[dummyEvent],forEach(eventFnsCopy,function(fn){dummyEvent.isImmediatePropagationStopped()||fn.apply(element,handlerArgs)}))}},function(fn,name){JQLite.prototype[name]=function(arg1,arg2,arg3){for(var value,i=0,ii=this.length;i<ii;i++)isUndefined(value)?(value=fn(this[i],arg1,arg2,arg3),isDefined(value)&&(value=jqLite(value))):jqLiteAddNodes(value,fn(this[i],arg1,arg2,arg3));return isDefined(value)?value:this},JQLite.prototype.bind=JQLite.prototype.on,JQLite.prototype.unbind=JQLite.prototype.off}),HashMap.prototype={put:function(key,value){this[hashKey(key,this.nextUid)]=value},get:function(key){return this[hashKey(key,this.nextUid)]},remove:function(key){var value=this[key=hashKey(key,this.nextUid)];return delete this[key],value}};var $$HashMapProvider=[function(){this.$get=[function(){return HashMap}]}],ARROW_ARG=/^([^\(]+?)=>/,FN_ARGS=/^[^\(]*\(\s*([^\)]*)\)/m,FN_ARG_SPLIT=/,/,FN_ARG=/^\s*(_?)(\S+?)\1\s*$/,STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,$injectorMinErr=minErr("$injector");createInjector.$$annotate=annotate;var $animateMinErr=minErr("$animate"),ELEMENT_NODE=1,NG_ANIMATE_CLASSNAME="ng-animate",$$CoreAnimateJsProvider=function(){this.$get=noop},$$CoreAnimateQueueProvider=function(){var postDigestQueue=new HashMap,postDigestElements=[];this.$get=["$$AnimateRunner","$rootScope",function($$AnimateRunner,$rootScope){function updateData(data,classes,value){var changed=!1;return classes&&(classes=isString(classes)?classes.split(" "):isArray(classes)?classes:[],forEach(classes,function(className){className&&(changed=!0,data[className]=value)})),changed}function handleCSSClassChanges(){forEach(postDigestElements,function(element){var data=postDigestQueue.get(element);if(data){var existing=splitClasses(element.attr("class")),toAdd="",toRemove="";forEach(data,function(status,className){var hasClass=!!existing[className];status!==hasClass&&(status?toAdd+=(toAdd.length?" ":"")+className:toRemove+=(toRemove.length?" ":"")+className)}),forEach(element,function(elm){toAdd&&jqLiteAddClass(elm,toAdd),toRemove&&jqLiteRemoveClass(elm,toRemove)}),postDigestQueue.remove(element)}}),postDigestElements.length=0}function addRemoveClassesPostDigest(element,add,remove){var data=postDigestQueue.get(element)||{},classesAdded=updateData(data,add,!0),classesRemoved=updateData(data,remove,!1);(classesAdded||classesRemoved)&&(postDigestQueue.put(element,data),postDigestElements.push(element),1===postDigestElements.length&&$rootScope.$$postDigest(handleCSSClassChanges))}return{enabled:noop,on:noop,off:noop,pin:noop,push:function(element,event,options,domOperation){domOperation&&domOperation(),options=options||{},options.from&&element.css(options.from),options.to&&element.css(options.to),(options.addClass||options.removeClass)&&addRemoveClassesPostDigest(element,options.addClass,options.removeClass);var runner=new $$AnimateRunner;return runner.complete(),runner}}}]},$AnimateProvider=["$provide",function($provide){var provider=this;this.$$registeredAnimations=Object.create(null),this.register=function(name,factory){if(name&&"."!==name.charAt(0))throw $animateMinErr("notcsel","Expecting class selector starting with '.' got '{0}'.",name);var key=name+"-animation";provider.$$registeredAnimations[name.substr(1)]=key,$provide.factory(key,factory)},this.classNameFilter=function(expression){if(1===arguments.length&&(this.$$classNameFilter=expression instanceof RegExp?expression:null,this.$$classNameFilter)){var reservedRegex=new RegExp("(\\s+|\\/)"+NG_ANIMATE_CLASSNAME+"(\\s+|\\/)");if(reservedRegex.test(this.$$classNameFilter.toString()))throw $animateMinErr("nongcls",'$animateProvider.classNameFilter(regex) prohibits accepting a regex value which matches/contains the "{0}" CSS class.',NG_ANIMATE_CLASSNAME)}return this.$$classNameFilter},this.$get=["$$animateQueue",function($$animateQueue){function domInsert(element,parentElement,afterElement){if(afterElement){var afterNode=extractElementNode(afterElement);!afterNode||afterNode.parentNode||afterNode.previousElementSibling||(afterElement=null)}afterElement?afterElement.after(element):parentElement.prepend(element)}return{on:$$animateQueue.on,off:$$animateQueue.off,pin:$$animateQueue.pin,enabled:$$animateQueue.enabled,cancel:function(runner){runner.end&&runner.end()},enter:function(element,parent,after,options){return parent=parent&&jqLite(parent),after=after&&jqLite(after),parent=parent||after.parent(),domInsert(element,parent,after),$$animateQueue.push(element,"enter",prepareAnimateOptions(options))},move:function(element,parent,after,options){return parent=parent&&jqLite(parent),after=after&&jqLite(after),parent=parent||after.parent(),domInsert(element,parent,after),$$animateQueue.push(element,"move",prepareAnimateOptions(options))},leave:function(element,options){return $$animateQueue.push(element,"leave",prepareAnimateOptions(options),function(){element.remove()})},addClass:function(element,className,options){return options=prepareAnimateOptions(options),options.addClass=mergeClasses(options.addclass,className),$$animateQueue.push(element,"addClass",options)},removeClass:function(element,className,options){return options=prepareAnimateOptions(options),options.removeClass=mergeClasses(options.removeClass,className),$$animateQueue.push(element,"removeClass",options)},setClass:function(element,add,remove,options){return options=prepareAnimateOptions(options),options.addClass=mergeClasses(options.addClass,add),options.removeClass=mergeClasses(options.removeClass,remove),$$animateQueue.push(element,"setClass",options)},animate:function(element,from,to,className,options){return options=prepareAnimateOptions(options),options.from=options.from?extend(options.from,from):from,options.to=options.to?extend(options.to,to):to,className=className||"ng-inline-animate",options.tempClasses=mergeClasses(options.tempClasses,className),$$animateQueue.push(element,"animate",options)}}}]}],$$AnimateAsyncRunFactoryProvider=function(){this.$get=["$$rAF",function($$rAF){function waitForTick(fn){waitQueue.push(fn),waitQueue.length>1||$$rAF(function(){for(var i=0;i<waitQueue.length;i++)waitQueue[i]();waitQueue=[]})}var waitQueue=[];return function(){var passed=!1;return waitForTick(function(){passed=!0}),function(callback){passed?callback():waitForTick(callback)}}}]},$$AnimateRunnerFactoryProvider=function(){this.$get=["$q","$sniffer","$$animateAsyncRun","$document","$timeout",function($q,$sniffer,$$animateAsyncRun,$document,$timeout){function AnimateRunner(host){this.setHost(host);var rafTick=$$animateAsyncRun(),timeoutTick=function(fn){$timeout(fn,0,!1)};this._doneCallbacks=[],this._tick=function(fn){var doc=$document[0];doc&&doc.hidden?timeoutTick(fn):rafTick(fn)},this._state=0}var INITIAL_STATE=0,DONE_PENDING_STATE=1,DONE_COMPLETE_STATE=2;return AnimateRunner.chain=function(chain,callback){function next(){return index===chain.length?void callback(!0):void chain[index](function(response){return response===!1?void callback(!1):(index++,void next())})}var index=0;next()},AnimateRunner.all=function(runners,callback){function onProgress(response){status=status&&response,++count===runners.length&&callback(status)}var count=0,status=!0;forEach(runners,function(runner){runner.done(onProgress)})},AnimateRunner.prototype={setHost:function(host){this.host=host||{}},done:function(fn){this._state===DONE_COMPLETE_STATE?fn():this._doneCallbacks.push(fn)},progress:noop,getPromise:function(){if(!this.promise){var self=this;this.promise=$q(function(resolve,reject){self.done(function(status){status===!1?reject():resolve()})})}return this.promise},then:function(resolveHandler,rejectHandler){return this.getPromise().then(resolveHandler,rejectHandler)},catch:function(handler){return this.getPromise().catch(handler)},finally:function(handler){return this.getPromise().finally(handler)},pause:function(){this.host.pause&&this.host.pause()},resume:function(){this.host.resume&&this.host.resume()},end:function(){this.host.end&&this.host.end(),this._resolve(!0)},cancel:function(){this.host.cancel&&this.host.cancel(),this._resolve(!1)},complete:function(response){var self=this;self._state===INITIAL_STATE&&(self._state=DONE_PENDING_STATE,self._tick(function(){self._resolve(response)}))},_resolve:function(response){this._state!==DONE_COMPLETE_STATE&&(forEach(this._doneCallbacks,function(fn){fn(response)}),this._doneCallbacks.length=0,this._state=DONE_COMPLETE_STATE)}},AnimateRunner}]},$CoreAnimateCssProvider=function(){this.$get=["$$rAF","$q","$$AnimateRunner",function($$rAF,$q,$$AnimateRunner){return function(element,initialOptions){function run(){return $$rAF(function(){applyAnimationContents(),closed||runner.complete(),closed=!0}),runner}function applyAnimationContents(){options.addClass&&(element.addClass(options.addClass),options.addClass=null),options.removeClass&&(element.removeClass(options.removeClass),options.removeClass=null),options.to&&(element.css(options.to),options.to=null)}var options=initialOptions||{};options.$$prepared||(options=copy(options)),options.cleanupStyles&&(options.from=options.to=null),options.from&&(element.css(options.from),options.from=null);var closed,runner=new $$AnimateRunner;return{start:run,end:run}}}]},$compileMinErr=minErr("$compile"),_UNINITIALIZED_VALUE=new UNINITIALIZED_VALUE;$CompileProvider.$inject=["$provide","$$sanitizeUriProvider"],SimpleChange.prototype.isFirstChange=function(){return this.previousValue===_UNINITIALIZED_VALUE};var PREFIX_REGEXP=/^((?:x|data)[:\-_])/i,$controllerMinErr=minErr("$controller"),CNTRL_REG=/^(\S+)(\s+as\s+([\w$]+))?$/,$$ForceReflowProvider=function(){this.$get=["$document",function($document){return function(domNode){return domNode?!domNode.nodeType&&domNode instanceof jqLite&&(domNode=domNode[0]):domNode=$document[0].body,domNode.offsetWidth+1}}]},APPLICATION_JSON="application/json",CONTENT_TYPE_APPLICATION_JSON={"Content-Type":APPLICATION_JSON+";charset=utf-8"},JSON_START=/^\[|^\{(?!\{)/,JSON_ENDS={"[":/]$/,"{":/}$/},JSON_PROTECTION_PREFIX=/^\)\]\}',?\n/,$httpMinErr=minErr("$http"),$httpMinErrLegacyFn=function(method){return function(){throw $httpMinErr("legacy","The method `{0}` on the promise returned from `$http` has been disabled.",method)}},$interpolateMinErr=angular.$interpolateMinErr=minErr("$interpolate");$interpolateMinErr.throwNoconcat=function(text){throw $interpolateMinErr("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",text)},$interpolateMinErr.interr=function(text,err){return $interpolateMinErr("interr","Can't interpolate: {0}\n{1}",text,err.toString())};var $jsonpCallbacksProvider=function(){this.$get=["$window",function($window){function createCallback(callbackId){var callback=function(data){callback.data=data,callback.called=!0};return callback.id=callbackId,callback}var callbacks=$window.angular.callbacks,callbackMap={};return{createCallback:function(url){var callbackId="_"+(callbacks.$$counter++).toString(36),callbackPath="angular.callbacks."+callbackId,callback=createCallback(callbackId);return callbackMap[callbackPath]=callbacks[callbackId]=callback,callbackPath},wasCalled:function(callbackPath){return callbackMap[callbackPath].called},getResponse:function(callbackPath){return callbackMap[callbackPath].data},removeCallback:function(callbackPath){var callback=callbackMap[callbackPath];delete callbacks[callback.id],delete callbackMap[callbackPath]}}}]},PATH_MATCH=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,DEFAULT_PORTS={http:80,https:443,ftp:21},$locationMinErr=minErr("$location"),DOUBLE_SLASH_REGEX=/^\s*[\\/]{2,}/,locationPrototype={$$absUrl:"",$$html5:!1,$$replace:!1,absUrl:locationGetter("$$absUrl"),url:function(url){if(isUndefined(url))return this.$$url;var match=PATH_MATCH.exec(url);return(match[1]||""===url)&&this.path(decodeURIComponent(match[1])),(match[2]||match[1]||""===url)&&this.search(match[3]||""),this.hash(match[5]||""),this},protocol:locationGetter("$$protocol"),host:locationGetter("$$host"),port:locationGetter("$$port"),path:locationGetterSetter("$$path",function(path){return path=null!==path?path.toString():"","/"===path.charAt(0)?path:"/"+path}),search:function(search,paramValue){switch(arguments.length){case 0:return this.$$search;case 1:if(isString(search)||isNumber(search))search=search.toString(),this.$$search=parseKeyValue(search);else{if(!isObject(search))throw $locationMinErr("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");search=copy(search,{}),forEach(search,function(value,key){null==value&&delete search[key]}),this.$$search=search}break;default:isUndefined(paramValue)||null===paramValue?delete this.$$search[search]:this.$$search[search]=paramValue}return this.$$compose(),this},hash:locationGetterSetter("$$hash",function(hash){return null!==hash?hash.toString():""}),replace:function(){return this.$$replace=!0,this}};forEach([LocationHashbangInHtml5Url,LocationHashbangUrl,LocationHtml5Url],function(Location){Location.prototype=Object.create(locationPrototype),Location.prototype.state=function(state){if(!arguments.length)return this.$$state;if(Location!==LocationHtml5Url||!this.$$html5)throw $locationMinErr("nostate","History API state support is available only in HTML5 mode and only in browsers supporting HTML5 History API");return this.$$state=isUndefined(state)?null:state,this}});var $parseMinErr=minErr("$parse"),ARRAY_CTOR=[].constructor,BOOLEAN_CTOR=(!1).constructor,FUNCTION_CTOR=Function.constructor,NUMBER_CTOR=(0).constructor,OBJECT_CTOR={}.constructor,STRING_CTOR="".constructor,ARRAY_CTOR_PROTO=ARRAY_CTOR.prototype,BOOLEAN_CTOR_PROTO=BOOLEAN_CTOR.prototype,FUNCTION_CTOR_PROTO=FUNCTION_CTOR.prototype,NUMBER_CTOR_PROTO=NUMBER_CTOR.prototype,OBJECT_CTOR_PROTO=OBJECT_CTOR.prototype,STRING_CTOR_PROTO=STRING_CTOR.prototype,CALL=FUNCTION_CTOR_PROTO.call,APPLY=FUNCTION_CTOR_PROTO.apply,BIND=FUNCTION_CTOR_PROTO.bind,objectValueOf=OBJECT_CTOR_PROTO.valueOf,OPERATORS=createMap();forEach("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(operator){OPERATORS[operator]=!0});var ESCAPE={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},Lexer=function(options){this.options=options};Lexer.prototype={constructor:Lexer,lex:function(text){for(this.text=text,this.index=0,this.tokens=[];this.index<this.text.length;){var ch=this.text.charAt(this.index);if('"'===ch||"'"===ch)this.readString(ch);else if(this.isNumber(ch)||"."===ch&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdentifierStart(this.peekMultichar()))this.readIdent();else if(this.is(ch,"(){}[].,;:?"))this.tokens.push({index:this.index,text:ch}),this.index++;else if(this.isWhitespace(ch))this.index++;else{var ch2=ch+this.peek(),ch3=ch2+this.peek(2),op1=OPERATORS[ch],op2=OPERATORS[ch2],op3=OPERATORS[ch3];if(op1||op2||op3){var token=op3?ch3:op2?ch2:ch;this.tokens.push({index:this.index,text:token,operator:!0}),this.index+=token.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens},is:function(ch,chars){return chars.indexOf(ch)!==-1},peek:function(i){var num=i||1;return this.index+num<this.text.length&&this.text.charAt(this.index+num)},isNumber:function(ch){return"0"<=ch&&ch<="9"&&"string"==typeof ch},isWhitespace:function(ch){return" "===ch||"\r"===ch||"\t"===ch||"\n"===ch||"\v"===ch||" "===ch},isIdentifierStart:function(ch){return this.options.isIdentifierStart?this.options.isIdentifierStart(ch,this.codePointAt(ch)):this.isValidIdentifierStart(ch)},isValidIdentifierStart:function(ch){return"a"<=ch&&ch<="z"||"A"<=ch&&ch<="Z"||"_"===ch||"$"===ch},isIdentifierContinue:function(ch){return this.options.isIdentifierContinue?this.options.isIdentifierContinue(ch,this.codePointAt(ch)):this.isValidIdentifierContinue(ch)},isValidIdentifierContinue:function(ch,cp){return this.isValidIdentifierStart(ch,cp)||this.isNumber(ch)},codePointAt:function(ch){return 1===ch.length?ch.charCodeAt(0):(ch.charCodeAt(0)<<10)+ch.charCodeAt(1)-56613888},peekMultichar:function(){var ch=this.text.charAt(this.index),peek=this.peek();if(!peek)return ch;var cp1=ch.charCodeAt(0),cp2=peek.charCodeAt(0);return cp1>=55296&&cp1<=56319&&cp2>=56320&&cp2<=57343?ch+peek:ch},isExpOperator:function(ch){return"-"===ch||"+"===ch||this.isNumber(ch)},throwError:function(error,start,end){end=end||this.index;var colStr=isDefined(start)?"s "+start+"-"+this.index+" ["+this.text.substring(start,end)+"]":" "+end;throw $parseMinErr("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",error,colStr,this.text)},readNumber:function(){for(var number="",start=this.index;this.index<this.text.length;){var ch=lowercase(this.text.charAt(this.index));if("."===ch||this.isNumber(ch))number+=ch;else{var peekCh=this.peek();if("e"===ch&&this.isExpOperator(peekCh))number+=ch;else if(this.isExpOperator(ch)&&peekCh&&this.isNumber(peekCh)&&"e"===number.charAt(number.length-1))number+=ch;else{if(!this.isExpOperator(ch)||peekCh&&this.isNumber(peekCh)||"e"!==number.charAt(number.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:start,text:number,constant:!0,value:Number(number)})},readIdent:function(){var start=this.index;for(this.index+=this.peekMultichar().length;this.index<this.text.length;){var ch=this.peekMultichar();if(!this.isIdentifierContinue(ch))break;this.index+=ch.length}this.tokens.push({index:start,text:this.text.slice(start,this.index),identifier:!0})},readString:function(quote){var start=this.index;this.index++;for(var string="",rawString=quote,escape=!1;this.index<this.text.length;){var ch=this.text.charAt(this.index);if(rawString+=ch,escape){if("u"===ch){var hex=this.text.substring(this.index+1,this.index+5);hex.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+hex+"]"),
this.index+=4,string+=String.fromCharCode(parseInt(hex,16))}else{var rep=ESCAPE[ch];string+=rep||ch}escape=!1}else if("\\"===ch)escape=!0;else{if(ch===quote)return this.index++,void this.tokens.push({index:start,text:rawString,constant:!0,value:string});string+=ch}this.index++}this.throwError("Unterminated quote",start)}};var AST=function(lexer,options){this.lexer=lexer,this.options=options};AST.Program="Program",AST.ExpressionStatement="ExpressionStatement",AST.AssignmentExpression="AssignmentExpression",AST.ConditionalExpression="ConditionalExpression",AST.LogicalExpression="LogicalExpression",AST.BinaryExpression="BinaryExpression",AST.UnaryExpression="UnaryExpression",AST.CallExpression="CallExpression",AST.MemberExpression="MemberExpression",AST.Identifier="Identifier",AST.Literal="Literal",AST.ArrayExpression="ArrayExpression",AST.Property="Property",AST.ObjectExpression="ObjectExpression",AST.ThisExpression="ThisExpression",AST.LocalsExpression="LocalsExpression",AST.NGValueParameter="NGValueParameter",AST.prototype={ast:function(text){this.text=text,this.tokens=this.lexer.lex(text);var value=this.program();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),value},program:function(){for(var body=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&body.push(this.expressionStatement()),!this.expect(";"))return{type:AST.Program,body:body}},expressionStatement:function(){return{type:AST.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var left=this.expression();this.expect("|");)left=this.filter(left);return left},expression:function(){return this.assignment()},assignment:function(){var result=this.ternary();return this.expect("=")&&(result={type:AST.AssignmentExpression,left:result,right:this.assignment(),operator:"="}),result},ternary:function(){var alternate,consequent,test=this.logicalOR();return this.expect("?")&&(alternate=this.expression(),this.consume(":"))?(consequent=this.expression(),{type:AST.ConditionalExpression,test:test,alternate:alternate,consequent:consequent}):test},logicalOR:function(){for(var left=this.logicalAND();this.expect("||");)left={type:AST.LogicalExpression,operator:"||",left:left,right:this.logicalAND()};return left},logicalAND:function(){for(var left=this.equality();this.expect("&&");)left={type:AST.LogicalExpression,operator:"&&",left:left,right:this.equality()};return left},equality:function(){for(var token,left=this.relational();token=this.expect("==","!=","===","!==");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.relational()};return left},relational:function(){for(var token,left=this.additive();token=this.expect("<",">","<=",">=");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.additive()};return left},additive:function(){for(var token,left=this.multiplicative();token=this.expect("+","-");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.multiplicative()};return left},multiplicative:function(){for(var token,left=this.unary();token=this.expect("*","/","%");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.unary()};return left},unary:function(){var token;return(token=this.expect("+","-","!"))?{type:AST.UnaryExpression,operator:token.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var primary;this.expect("(")?(primary=this.filterChain(),this.consume(")")):this.expect("[")?primary=this.arrayDeclaration():this.expect("{")?primary=this.object():this.selfReferential.hasOwnProperty(this.peek().text)?primary=copy(this.selfReferential[this.consume().text]):this.options.literals.hasOwnProperty(this.peek().text)?primary={type:AST.Literal,value:this.options.literals[this.consume().text]}:this.peek().identifier?primary=this.identifier():this.peek().constant?primary=this.constant():this.throwError("not a primary expression",this.peek());for(var next;next=this.expect("(","[",".");)"("===next.text?(primary={type:AST.CallExpression,callee:primary,arguments:this.parseArguments()},this.consume(")")):"["===next.text?(primary={type:AST.MemberExpression,object:primary,property:this.expression(),computed:!0},this.consume("]")):"."===next.text?primary={type:AST.MemberExpression,object:primary,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return primary},filter:function(baseExpression){for(var args=[baseExpression],result={type:AST.CallExpression,callee:this.identifier(),arguments:args,filter:!0};this.expect(":");)args.push(this.expression());return result},parseArguments:function(){var args=[];if(")"!==this.peekToken().text)do args.push(this.filterChain());while(this.expect(","));return args},identifier:function(){var token=this.consume();return token.identifier||this.throwError("is not a valid identifier",token),{type:AST.Identifier,name:token.text}},constant:function(){return{type:AST.Literal,value:this.consume().value}},arrayDeclaration:function(){var elements=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;elements.push(this.expression())}while(this.expect(","));return this.consume("]"),{type:AST.ArrayExpression,elements:elements}},object:function(){var property,properties=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;property={type:AST.Property,kind:"init"},this.peek().constant?(property.key=this.constant(),property.computed=!1,this.consume(":"),property.value=this.expression()):this.peek().identifier?(property.key=this.identifier(),property.computed=!1,this.peek(":")?(this.consume(":"),property.value=this.expression()):property.value=property.key):this.peek("[")?(this.consume("["),property.key=this.expression(),this.consume("]"),property.computed=!0,this.consume(":"),property.value=this.expression()):this.throwError("invalid key",this.peek()),properties.push(property)}while(this.expect(","));return this.consume("}"),{type:AST.ObjectExpression,properties:properties}},throwError:function(msg,token){throw $parseMinErr("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",token.text,msg,token.index+1,this.text,this.text.substring(token.index))},consume:function(e1){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);var token=this.expect(e1);return token||this.throwError("is unexpected, expecting ["+e1+"]",this.peek()),token},peekToken:function(){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e1,e2,e3,e4){return this.peekAhead(0,e1,e2,e3,e4)},peekAhead:function(i,e1,e2,e3,e4){if(this.tokens.length>i){var token=this.tokens[i],t=token.text;if(t===e1||t===e2||t===e3||t===e4||!e1&&!e2&&!e3&&!e4)return token}return!1},expect:function(e1,e2,e3,e4){var token=this.peek(e1,e2,e3,e4);return!!token&&(this.tokens.shift(),token)},selfReferential:{this:{type:AST.ThisExpression},$locals:{type:AST.LocalsExpression}}},ASTCompiler.prototype={compile:function(expression,expensiveChecks){var self=this,ast=this.astBuilder.ast(expression);this.state={nextId:0,filters:{},expensiveChecks:expensiveChecks,fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]},findConstantAndWatchExpressions(ast,self.$filter);var assignable,extra="";if(this.stage="assign",assignable=assignableAST(ast)){this.state.computing="assign";var result=this.nextId();this.recurse(assignable,result),this.return_(result),extra="fn.assign="+this.generateFunction("assign","s,v,l")}var toWatch=getInputs(ast.body);self.stage="inputs",forEach(toWatch,function(watch,key){var fnKey="fn"+key;self.state[fnKey]={vars:[],body:[],own:{}},self.state.computing=fnKey;var intoId=self.nextId();self.recurse(watch,intoId),self.return_(intoId),self.state.inputs.push(fnKey),watch.watchId=key}),this.state.computing="fn",this.stage="main",this.recurse(ast);var fnString='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+extra+this.watchFns()+"return fn;",fn=new Function("$filter","ensureSafeMemberName","ensureSafeObject","ensureSafeFunction","getStringValue","ensureSafeAssignContext","ifDefined","plus","text",fnString)(this.$filter,ensureSafeMemberName,ensureSafeObject,ensureSafeFunction,getStringValue,ensureSafeAssignContext,ifDefined,plusFn,expression);return this.state=this.stage=void 0,fn.literal=isLiteral(ast),fn.constant=isConstant(ast),fn},USE:"use",STRICT:"strict",watchFns:function(){var result=[],fns=this.state.inputs,self=this;return forEach(fns,function(name){result.push("var "+name+"="+self.generateFunction(name,"s"))}),fns.length&&result.push("fn.inputs=["+fns.join(",")+"];"),result.join("")},generateFunction:function(name,params){return"function("+params+"){"+this.varsPrefix(name)+this.body(name)+"};"},filterPrefix:function(){var parts=[],self=this;return forEach(this.state.filters,function(id,filter){parts.push(id+"=$filter("+self.escape(filter)+")")}),parts.length?"var "+parts.join(",")+";":""},varsPrefix:function(section){return this.state[section].vars.length?"var "+this.state[section].vars.join(",")+";":""},body:function(section){return this.state[section].body.join("")},recurse:function(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck){var left,right,args,expression,computed,self=this;if(recursionFn=recursionFn||noop,!skipWatchIdCheck&&isDefined(ast.watchId))return intoId=intoId||this.nextId(),void this.if_("i",this.lazyAssign(intoId,this.computedMember("i",ast.watchId)),this.lazyRecurse(ast,intoId,nameId,recursionFn,create,!0));switch(ast.type){case AST.Program:forEach(ast.body,function(expression,pos){self.recurse(expression.expression,void 0,void 0,function(expr){right=expr}),pos!==ast.body.length-1?self.current().body.push(right,";"):self.return_(right)});break;case AST.Literal:expression=this.escape(ast.value),this.assign(intoId,expression),recursionFn(expression);break;case AST.UnaryExpression:this.recurse(ast.argument,void 0,void 0,function(expr){right=expr}),expression=ast.operator+"("+this.ifDefined(right,0)+")",this.assign(intoId,expression),recursionFn(expression);break;case AST.BinaryExpression:this.recurse(ast.left,void 0,void 0,function(expr){left=expr}),this.recurse(ast.right,void 0,void 0,function(expr){right=expr}),expression="+"===ast.operator?this.plus(left,right):"-"===ast.operator?this.ifDefined(left,0)+ast.operator+this.ifDefined(right,0):"("+left+")"+ast.operator+"("+right+")",this.assign(intoId,expression),recursionFn(expression);break;case AST.LogicalExpression:intoId=intoId||this.nextId(),self.recurse(ast.left,intoId),self.if_("&&"===ast.operator?intoId:self.not(intoId),self.lazyRecurse(ast.right,intoId)),recursionFn(intoId);break;case AST.ConditionalExpression:intoId=intoId||this.nextId(),self.recurse(ast.test,intoId),self.if_(intoId,self.lazyRecurse(ast.alternate,intoId),self.lazyRecurse(ast.consequent,intoId)),recursionFn(intoId);break;case AST.Identifier:intoId=intoId||this.nextId(),nameId&&(nameId.context="inputs"===self.stage?"s":this.assign(this.nextId(),this.getHasOwnProperty("l",ast.name)+"?l:s"),nameId.computed=!1,nameId.name=ast.name),ensureSafeMemberName(ast.name),self.if_("inputs"===self.stage||self.not(self.getHasOwnProperty("l",ast.name)),function(){self.if_("inputs"===self.stage||"s",function(){create&&1!==create&&self.if_(self.not(self.nonComputedMember("s",ast.name)),self.lazyAssign(self.nonComputedMember("s",ast.name),"{}")),self.assign(intoId,self.nonComputedMember("s",ast.name))})},intoId&&self.lazyAssign(intoId,self.nonComputedMember("l",ast.name))),(self.state.expensiveChecks||isPossiblyDangerousMemberName(ast.name))&&self.addEnsureSafeObject(intoId),recursionFn(intoId);break;case AST.MemberExpression:left=nameId&&(nameId.context=this.nextId())||this.nextId(),intoId=intoId||this.nextId(),self.recurse(ast.object,left,void 0,function(){self.if_(self.notNull(left),function(){create&&1!==create&&self.addEnsureSafeAssignContext(left),ast.computed?(right=self.nextId(),self.recurse(ast.property,right),self.getStringValue(right),self.addEnsureSafeMemberName(right),create&&1!==create&&self.if_(self.not(self.computedMember(left,right)),self.lazyAssign(self.computedMember(left,right),"{}")),expression=self.ensureSafeObject(self.computedMember(left,right)),self.assign(intoId,expression),nameId&&(nameId.computed=!0,nameId.name=right)):(ensureSafeMemberName(ast.property.name),create&&1!==create&&self.if_(self.not(self.nonComputedMember(left,ast.property.name)),self.lazyAssign(self.nonComputedMember(left,ast.property.name),"{}")),expression=self.nonComputedMember(left,ast.property.name),(self.state.expensiveChecks||isPossiblyDangerousMemberName(ast.property.name))&&(expression=self.ensureSafeObject(expression)),self.assign(intoId,expression),nameId&&(nameId.computed=!1,nameId.name=ast.property.name))},function(){self.assign(intoId,"undefined")}),recursionFn(intoId)},!!create);break;case AST.CallExpression:intoId=intoId||this.nextId(),ast.filter?(right=self.filter(ast.callee.name),args=[],forEach(ast.arguments,function(expr){var argument=self.nextId();self.recurse(expr,argument),args.push(argument)}),expression=right+"("+args.join(",")+")",self.assign(intoId,expression),recursionFn(intoId)):(right=self.nextId(),left={},args=[],self.recurse(ast.callee,right,left,function(){self.if_(self.notNull(right),function(){self.addEnsureSafeFunction(right),forEach(ast.arguments,function(expr){self.recurse(expr,self.nextId(),void 0,function(argument){args.push(self.ensureSafeObject(argument))})}),left.name?(self.state.expensiveChecks||self.addEnsureSafeObject(left.context),expression=self.member(left.context,left.name,left.computed)+"("+args.join(",")+")"):expression=right+"("+args.join(",")+")",expression=self.ensureSafeObject(expression),self.assign(intoId,expression)},function(){self.assign(intoId,"undefined")}),recursionFn(intoId)}));break;case AST.AssignmentExpression:if(right=this.nextId(),left={},!isAssignable(ast.left))throw $parseMinErr("lval","Trying to assign a value to a non l-value");this.recurse(ast.left,void 0,left,function(){self.if_(self.notNull(left.context),function(){self.recurse(ast.right,right),self.addEnsureSafeObject(self.member(left.context,left.name,left.computed)),self.addEnsureSafeAssignContext(left.context),expression=self.member(left.context,left.name,left.computed)+ast.operator+right,self.assign(intoId,expression),recursionFn(intoId||expression)})},1);break;case AST.ArrayExpression:args=[],forEach(ast.elements,function(expr){self.recurse(expr,self.nextId(),void 0,function(argument){args.push(argument)})}),expression="["+args.join(",")+"]",this.assign(intoId,expression),recursionFn(expression);break;case AST.ObjectExpression:args=[],computed=!1,forEach(ast.properties,function(property){property.computed&&(computed=!0)}),computed?(intoId=intoId||this.nextId(),this.assign(intoId,"{}"),forEach(ast.properties,function(property){property.computed?(left=self.nextId(),self.recurse(property.key,left)):left=property.key.type===AST.Identifier?property.key.name:""+property.key.value,right=self.nextId(),self.recurse(property.value,right),self.assign(self.member(intoId,left,property.computed),right)})):(forEach(ast.properties,function(property){self.recurse(property.value,ast.constant?void 0:self.nextId(),void 0,function(expr){args.push(self.escape(property.key.type===AST.Identifier?property.key.name:""+property.key.value)+":"+expr)})}),expression="{"+args.join(",")+"}",this.assign(intoId,expression)),recursionFn(intoId||expression);break;case AST.ThisExpression:this.assign(intoId,"s"),recursionFn("s");break;case AST.LocalsExpression:this.assign(intoId,"l"),recursionFn("l");break;case AST.NGValueParameter:this.assign(intoId,"v"),recursionFn("v")}},getHasOwnProperty:function(element,property){var key=element+"."+property,own=this.current().own;return own.hasOwnProperty(key)||(own[key]=this.nextId(!1,element+"&&("+this.escape(property)+" in "+element+")")),own[key]},assign:function(id,value){if(id)return this.current().body.push(id,"=",value,";"),id},filter:function(filterName){return this.state.filters.hasOwnProperty(filterName)||(this.state.filters[filterName]=this.nextId(!0)),this.state.filters[filterName]},ifDefined:function(id,defaultValue){return"ifDefined("+id+","+this.escape(defaultValue)+")"},plus:function(left,right){return"plus("+left+","+right+")"},return_:function(id){this.current().body.push("return ",id,";")},if_:function(test,alternate,consequent){if(test===!0)alternate();else{var body=this.current().body;body.push("if(",test,"){"),alternate(),body.push("}"),consequent&&(body.push("else{"),consequent(),body.push("}"))}},not:function(expression){return"!("+expression+")"},notNull:function(expression){return expression+"!=null"},nonComputedMember:function(left,right){var SAFE_IDENTIFIER=/^[$_a-zA-Z][$_a-zA-Z0-9]*$/,UNSAFE_CHARACTERS=/[^$_a-zA-Z0-9]/g;return SAFE_IDENTIFIER.test(right)?left+"."+right:left+'["'+right.replace(UNSAFE_CHARACTERS,this.stringEscapeFn)+'"]'},computedMember:function(left,right){return left+"["+right+"]"},member:function(left,right,computed){return computed?this.computedMember(left,right):this.nonComputedMember(left,right)},addEnsureSafeObject:function(item){this.current().body.push(this.ensureSafeObject(item),";")},addEnsureSafeMemberName:function(item){this.current().body.push(this.ensureSafeMemberName(item),";")},addEnsureSafeFunction:function(item){this.current().body.push(this.ensureSafeFunction(item),";")},addEnsureSafeAssignContext:function(item){this.current().body.push(this.ensureSafeAssignContext(item),";")},ensureSafeObject:function(item){return"ensureSafeObject("+item+",text)"},ensureSafeMemberName:function(item){return"ensureSafeMemberName("+item+",text)"},ensureSafeFunction:function(item){return"ensureSafeFunction("+item+",text)"},getStringValue:function(item){this.assign(item,"getStringValue("+item+")")},ensureSafeAssignContext:function(item){return"ensureSafeAssignContext("+item+",text)"},lazyRecurse:function(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck){var self=this;return function(){self.recurse(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck)}},lazyAssign:function(id,value){var self=this;return function(){self.assign(id,value)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,stringEscapeFn:function(c){return"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)},escape:function(value){if(isString(value))return"'"+value.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(isNumber(value))return value.toString();if(value===!0)return"true";if(value===!1)return"false";if(null===value)return"null";if("undefined"==typeof value)return"undefined";throw $parseMinErr("esc","IMPOSSIBLE")},nextId:function(skip,init){var id="v"+this.state.nextId++;return skip||this.current().vars.push(id+(init?"="+init:"")),id},current:function(){return this.state[this.state.computing]}},ASTInterpreter.prototype={compile:function(expression,expensiveChecks){var self=this,ast=this.astBuilder.ast(expression);this.expression=expression,this.expensiveChecks=expensiveChecks,findConstantAndWatchExpressions(ast,self.$filter);var assignable,assign;(assignable=assignableAST(ast))&&(assign=this.recurse(assignable));var inputs,toWatch=getInputs(ast.body);toWatch&&(inputs=[],forEach(toWatch,function(watch,key){var input=self.recurse(watch);watch.input=input,inputs.push(input),watch.watchId=key}));var expressions=[];forEach(ast.body,function(expression){expressions.push(self.recurse(expression.expression))});var fn=0===ast.body.length?noop:1===ast.body.length?expressions[0]:function(scope,locals){var lastValue;return forEach(expressions,function(exp){lastValue=exp(scope,locals)}),lastValue};return assign&&(fn.assign=function(scope,value,locals){return assign(scope,locals,value)}),inputs&&(fn.inputs=inputs),fn.literal=isLiteral(ast),fn.constant=isConstant(ast),fn},recurse:function(ast,context,create){var left,right,args,self=this;if(ast.input)return this.inputs(ast.input,ast.watchId);switch(ast.type){case AST.Literal:return this.value(ast.value,context);case AST.UnaryExpression:return right=this.recurse(ast.argument),this["unary"+ast.operator](right,context);case AST.BinaryExpression:return left=this.recurse(ast.left),right=this.recurse(ast.right),this["binary"+ast.operator](left,right,context);case AST.LogicalExpression:return left=this.recurse(ast.left),right=this.recurse(ast.right),this["binary"+ast.operator](left,right,context);case AST.ConditionalExpression:return this["ternary?:"](this.recurse(ast.test),this.recurse(ast.alternate),this.recurse(ast.consequent),context);case AST.Identifier:return ensureSafeMemberName(ast.name,self.expression),self.identifier(ast.name,self.expensiveChecks||isPossiblyDangerousMemberName(ast.name),context,create,self.expression);case AST.MemberExpression:return left=this.recurse(ast.object,!1,!!create),ast.computed||(ensureSafeMemberName(ast.property.name,self.expression),right=ast.property.name),ast.computed&&(right=this.recurse(ast.property)),ast.computed?this.computedMember(left,right,context,create,self.expression):this.nonComputedMember(left,right,self.expensiveChecks,context,create,self.expression);case AST.CallExpression:return args=[],forEach(ast.arguments,function(expr){args.push(self.recurse(expr))}),ast.filter&&(right=this.$filter(ast.callee.name)),ast.filter||(right=this.recurse(ast.callee,!0)),ast.filter?function(scope,locals,assign,inputs){for(var values=[],i=0;i<args.length;++i)values.push(args[i](scope,locals,assign,inputs));var value=right.apply(void 0,values,inputs);return context?{context:void 0,name:void 0,value:value}:value}:function(scope,locals,assign,inputs){var value,rhs=right(scope,locals,assign,inputs);if(null!=rhs.value){ensureSafeObject(rhs.context,self.expression),ensureSafeFunction(rhs.value,self.expression);for(var values=[],i=0;i<args.length;++i)values.push(ensureSafeObject(args[i](scope,locals,assign,inputs),self.expression));value=ensureSafeObject(rhs.value.apply(rhs.context,values),self.expression)}return context?{value:value}:value};case AST.AssignmentExpression:return left=this.recurse(ast.left,!0,1),right=this.recurse(ast.right),function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs);return ensureSafeObject(lhs.value,self.expression),ensureSafeAssignContext(lhs.context),lhs.context[lhs.name]=rhs,context?{value:rhs}:rhs};case AST.ArrayExpression:return args=[],forEach(ast.elements,function(expr){args.push(self.recurse(expr))}),function(scope,locals,assign,inputs){for(var value=[],i=0;i<args.length;++i)value.push(args[i](scope,locals,assign,inputs));return context?{value:value}:value};case AST.ObjectExpression:return args=[],forEach(ast.properties,function(property){property.computed?args.push({key:self.recurse(property.key),computed:!0,value:self.recurse(property.value)}):args.push({key:property.key.type===AST.Identifier?property.key.name:""+property.key.value,computed:!1,value:self.recurse(property.value)})}),function(scope,locals,assign,inputs){for(var value={},i=0;i<args.length;++i)args[i].computed?value[args[i].key(scope,locals,assign,inputs)]=args[i].value(scope,locals,assign,inputs):value[args[i].key]=args[i].value(scope,locals,assign,inputs);return context?{value:value}:value};case AST.ThisExpression:return function(scope){return context?{value:scope}:scope};case AST.LocalsExpression:return function(scope,locals){return context?{value:locals}:locals};case AST.NGValueParameter:return function(scope,locals,assign){return context?{value:assign}:assign}}},"unary+":function(argument,context){return function(scope,locals,assign,inputs){var arg=argument(scope,locals,assign,inputs);return arg=isDefined(arg)?+arg:0,context?{value:arg}:arg}},"unary-":function(argument,context){return function(scope,locals,assign,inputs){var arg=argument(scope,locals,assign,inputs);return arg=isDefined(arg)?-arg:0,context?{value:arg}:arg}},"unary!":function(argument,context){return function(scope,locals,assign,inputs){var arg=!argument(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary+":function(left,right,context){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs),arg=plusFn(lhs,rhs);return context?{value:arg}:arg}},"binary-":function(left,right,context){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs),arg=(isDefined(lhs)?lhs:0)-(isDefined(rhs)?rhs:0);return context?{value:arg}:arg}},"binary*":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)*right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary/":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)/right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary%":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)%right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary===":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)===right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary!==":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)!==right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary==":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)==right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary!=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)!=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary<":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)<right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary>":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)>right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary<=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)<=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary>=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)>=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary&&":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)&&right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary||":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)||right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"ternary?:":function(test,alternate,consequent,context){return function(scope,locals,assign,inputs){var arg=test(scope,locals,assign,inputs)?alternate(scope,locals,assign,inputs):consequent(scope,locals,assign,inputs);return context?{value:arg}:arg}},value:function(value,context){return function(){return context?{context:void 0,name:void 0,value:value}:value}},identifier:function(name,expensiveChecks,context,create,expression){return function(scope,locals,assign,inputs){var base=locals&&name in locals?locals:scope;create&&1!==create&&base&&!base[name]&&(base[name]={});var value=base?base[name]:void 0;return expensiveChecks&&ensureSafeObject(value,expression),context?{context:base,name:name,value:value}:value}},computedMember:function(left,right,context,create,expression){return function(scope,locals,assign,inputs){var rhs,value,lhs=left(scope,locals,assign,inputs);return null!=lhs&&(rhs=right(scope,locals,assign,inputs),rhs=getStringValue(rhs),ensureSafeMemberName(rhs,expression),create&&1!==create&&(ensureSafeAssignContext(lhs),lhs&&!lhs[rhs]&&(lhs[rhs]={})),value=lhs[rhs],ensureSafeObject(value,expression)),context?{context:lhs,name:rhs,value:value}:value}},nonComputedMember:function(left,right,expensiveChecks,context,create,expression){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs);create&&1!==create&&(ensureSafeAssignContext(lhs),lhs&&!lhs[right]&&(lhs[right]={}));var value=null!=lhs?lhs[right]:void 0;return(expensiveChecks||isPossiblyDangerousMemberName(right))&&ensureSafeObject(value,expression),context?{context:lhs,name:right,value:value}:value}},inputs:function(input,watchId){return function(scope,value,locals,inputs){return inputs?inputs[watchId]:input(scope,value,locals)}}};var Parser=function(lexer,$filter,options){this.lexer=lexer,this.$filter=$filter,this.options=options,this.ast=new AST(lexer,options),this.astCompiler=options.csp?new ASTInterpreter(this.ast,$filter):new ASTCompiler(this.ast,$filter)};Parser.prototype={constructor:Parser,parse:function(text){return this.astCompiler.compile(text,this.options.expensiveChecks)}};var $sceMinErr=minErr("$sce"),SCE_CONTEXTS={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},$templateRequestMinErr=minErr("$compile"),urlParsingNode=window.document.createElement("a"),originUrl=urlResolve(window.location.href);$$CookieReader.$inject=["$document"],$FilterProvider.$inject=["$provide"];var MAX_DIGITS=22,DECIMAL_SEP=".",ZERO_CHAR="0";currencyFilter.$inject=["$locale"],numberFilter.$inject=["$locale"];var DATE_FORMATS={yyyy:dateGetter("FullYear",4,0,!1,!0),yy:dateGetter("FullYear",2,0,!0,!0),y:dateGetter("FullYear",1,0,!1,!0),MMMM:dateStrGetter("Month"),MMM:dateStrGetter("Month",!0),MM:dateGetter("Month",2,1),M:dateGetter("Month",1,1),LLLL:dateStrGetter("Month",!1,!0),dd:dateGetter("Date",2),d:dateGetter("Date",1),HH:dateGetter("Hours",2),H:dateGetter("Hours",1),hh:dateGetter("Hours",2,-12),h:dateGetter("Hours",1,-12),mm:dateGetter("Minutes",2),m:dateGetter("Minutes",1),ss:dateGetter("Seconds",2),s:dateGetter("Seconds",1),sss:dateGetter("Milliseconds",3),EEEE:dateStrGetter("Day"),EEE:dateStrGetter("Day",!0),a:ampmGetter,Z:timeZoneGetter,ww:weekGetter(2),w:weekGetter(1),G:eraGetter,GG:eraGetter,GGG:eraGetter,GGGG:longEraGetter},DATE_FORMATS_SPLIT=/((?:[^yMLdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|L+|d+|H+|h+|m+|s+|a|Z|G+|w+))(.*)/,NUMBER_STRING=/^\-?\d+$/;dateFilter.$inject=["$locale"];var lowercaseFilter=valueFn(lowercase),uppercaseFilter=valueFn(uppercase);orderByFilter.$inject=["$parse"];var htmlAnchorDirective=valueFn({restrict:"E",compile:function(element,attr){if(!attr.href&&!attr.xlinkHref)return function(scope,element){if("a"===element[0].nodeName.toLowerCase()){var href="[object SVGAnimatedString]"===toString.call(element.prop("href"))?"xlink:href":"href";element.on("click",function(event){element.attr(href)||event.preventDefault()})}}}}),ngAttributeAliasDirectives={};forEach(BOOLEAN_ATTR,function(propName,attrName){function defaultLinkFn(scope,element,attr){scope.$watch(attr[normalized],function(value){attr.$set(attrName,!!value)})}if("multiple"!==propName){var normalized=directiveNormalize("ng-"+attrName),linkFn=defaultLinkFn;"checked"===propName&&(linkFn=function(scope,element,attr){attr.ngModel!==attr[normalized]&&defaultLinkFn(scope,element,attr)}),ngAttributeAliasDirectives[normalized]=function(){return{restrict:"A",priority:100,link:linkFn}}}}),forEach(ALIASED_ATTR,function(htmlAttr,ngAttr){ngAttributeAliasDirectives[ngAttr]=function(){return{priority:100,link:function(scope,element,attr){if("ngPattern"===ngAttr&&"/"===attr.ngPattern.charAt(0)){var match=attr.ngPattern.match(REGEX_STRING_REGEXP);if(match)return void attr.$set("ngPattern",new RegExp(match[1],match[2]))}scope.$watch(attr[ngAttr],function(value){attr.$set(ngAttr,value)})}}}}),forEach(["src","srcset","href"],function(attrName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){
return{priority:99,link:function(scope,element,attr){var propName=attrName,name=attrName;"href"===attrName&&"[object SVGAnimatedString]"===toString.call(element.prop("href"))&&(name="xlinkHref",attr.$attr[name]="xlink:href",propName=null),attr.$observe(normalized,function(value){return value?(attr.$set(name,value),void(msie&&propName&&element.prop(propName,attr[name]))):void("href"===attrName&&attr.$set(name,null))})}}}});var nullFormCtrl={$addControl:noop,$$renameControl:nullFormRenameControl,$removeControl:noop,$setValidity:noop,$setDirty:noop,$setPristine:noop,$setSubmitted:noop},SUBMITTED_CLASS="ng-submitted";FormController.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var formDirectiveFactory=function(isNgForm){return["$timeout","$parse",function($timeout,$parse){function getSetter(expression){return""===expression?$parse('this[""]').assign:$parse(expression).assign||noop}var formDirective={name:"form",restrict:isNgForm?"EAC":"E",require:["form","^^?form"],controller:FormController,compile:function(formElement,attr){formElement.addClass(PRISTINE_CLASS).addClass(VALID_CLASS);var nameAttr=attr.name?"name":!(!isNgForm||!attr.ngForm)&&"ngForm";return{pre:function(scope,formElement,attr,ctrls){var controller=ctrls[0];if(!("action"in attr)){var handleFormSubmission=function(event){scope.$apply(function(){controller.$commitViewValue(),controller.$setSubmitted()}),event.preventDefault()};addEventListenerFn(formElement[0],"submit",handleFormSubmission),formElement.on("$destroy",function(){$timeout(function(){removeEventListenerFn(formElement[0],"submit",handleFormSubmission)},0,!1)})}var parentFormCtrl=ctrls[1]||controller.$$parentForm;parentFormCtrl.$addControl(controller);var setter=nameAttr?getSetter(controller.$name):noop;nameAttr&&(setter(scope,controller),attr.$observe(nameAttr,function(newValue){controller.$name!==newValue&&(setter(scope,void 0),controller.$$parentForm.$$renameControl(controller,newValue),(setter=getSetter(controller.$name))(scope,controller))})),formElement.on("$destroy",function(){controller.$$parentForm.$removeControl(controller),setter(scope,void 0),extend(controller,nullFormCtrl)})}}}};return formDirective}]},formDirective=formDirectiveFactory(),ngFormDirective=formDirectiveFactory(!0),ISO_DATE_REGEXP=/^\d{4,}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z)$/,URL_REGEXP=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:/?#]+|\[[a-f\d:]+\])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i,EMAIL_REGEXP=/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/,NUMBER_REGEXP=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,DATE_REGEXP=/^(\d{4,})-(\d{2})-(\d{2})$/,DATETIMELOCAL_REGEXP=/^(\d{4,})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,WEEK_REGEXP=/^(\d{4,})-W(\d\d)$/,MONTH_REGEXP=/^(\d{4,})-(\d\d)$/,TIME_REGEXP=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,PARTIAL_VALIDATION_EVENTS="keydown wheel mousedown",PARTIAL_VALIDATION_TYPES=createMap();forEach("date,datetime-local,month,time,week".split(","),function(type){PARTIAL_VALIDATION_TYPES[type]=!0});var inputType={text:textInputType,date:createDateInputType("date",DATE_REGEXP,createDateParser(DATE_REGEXP,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":createDateInputType("datetimelocal",DATETIMELOCAL_REGEXP,createDateParser(DATETIMELOCAL_REGEXP,["yyyy","MM","dd","HH","mm","ss","sss"]),"yyyy-MM-ddTHH:mm:ss.sss"),time:createDateInputType("time",TIME_REGEXP,createDateParser(TIME_REGEXP,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:createDateInputType("week",WEEK_REGEXP,weekParser,"yyyy-Www"),month:createDateInputType("month",MONTH_REGEXP,createDateParser(MONTH_REGEXP,["yyyy","MM"]),"yyyy-MM"),number:numberInputType,url:urlInputType,email:emailInputType,radio:radioInputType,range:rangeInputType,checkbox:checkboxInputType,hidden:noop,button:noop,submit:noop,reset:noop,file:noop},inputDirective=["$browser","$sniffer","$filter","$parse",function($browser,$sniffer,$filter,$parse){return{restrict:"E",require:["?ngModel"],link:{pre:function(scope,element,attr,ctrls){if(ctrls[0]){var type=lowercase(attr.type);"range"!==type||attr.hasOwnProperty("ngInputRange")||(type="text"),(inputType[type]||inputType.text)(scope,element,attr,ctrls[0],$sniffer,$browser,$filter,$parse)}}}}}],CONSTANT_VALUE_REGEXP=/^(true|false|\d+)$/,ngValueDirective=function(){return{restrict:"A",priority:100,compile:function(tpl,tplAttr){return CONSTANT_VALUE_REGEXP.test(tplAttr.ngValue)?function(scope,elm,attr){attr.$set("value",scope.$eval(attr.ngValue))}:function(scope,elm,attr){scope.$watch(attr.ngValue,function(value){attr.$set("value",value)})}}}},ngBindDirective=["$compile",function($compile){return{restrict:"AC",compile:function(templateElement){return $compile.$$addBindingClass(templateElement),function(scope,element,attr){$compile.$$addBindingInfo(element,attr.ngBind),element=element[0],scope.$watch(attr.ngBind,function(value){element.textContent=isUndefined(value)?"":value})}}}}],ngBindTemplateDirective=["$interpolate","$compile",function($interpolate,$compile){return{compile:function(templateElement){return $compile.$$addBindingClass(templateElement),function(scope,element,attr){var interpolateFn=$interpolate(element.attr(attr.$attr.ngBindTemplate));$compile.$$addBindingInfo(element,interpolateFn.expressions),element=element[0],attr.$observe("ngBindTemplate",function(value){element.textContent=isUndefined(value)?"":value})}}}}],ngBindHtmlDirective=["$sce","$parse","$compile",function($sce,$parse,$compile){return{restrict:"A",compile:function(tElement,tAttrs){var ngBindHtmlGetter=$parse(tAttrs.ngBindHtml),ngBindHtmlWatch=$parse(tAttrs.ngBindHtml,function(val){return $sce.valueOf(val)});return $compile.$$addBindingClass(tElement),function(scope,element,attr){$compile.$$addBindingInfo(element,attr.ngBindHtml),scope.$watch(ngBindHtmlWatch,function(){var value=ngBindHtmlGetter(scope);element.html($sce.getTrustedHtml(value)||"")})}}}}],ngChangeDirective=valueFn({restrict:"A",require:"ngModel",link:function(scope,element,attr,ctrl){ctrl.$viewChangeListeners.push(function(){scope.$eval(attr.ngChange)})}}),ngClassDirective=classDirective("",!0),ngClassOddDirective=classDirective("Odd",0),ngClassEvenDirective=classDirective("Even",1),ngCloakDirective=ngDirective({compile:function(element,attr){attr.$set("ngCloak",void 0),element.removeClass("ng-cloak")}}),ngControllerDirective=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],ngEventDirectives={},forceAsyncEvents={blur:!0,focus:!0};forEach("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(eventName){var directiveName=directiveNormalize("ng-"+eventName);ngEventDirectives[directiveName]=["$parse","$rootScope",function($parse,$rootScope){return{restrict:"A",compile:function($element,attr){var fn=$parse(attr[directiveName],null,!0);return function(scope,element){element.on(eventName,function(event){var callback=function(){fn(scope,{$event:event})};forceAsyncEvents[eventName]&&$rootScope.$$phase?scope.$evalAsync(callback):scope.$apply(callback)})}}}}]});var ngIfDirective=["$animate","$compile",function($animate,$compile){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function($scope,$element,$attr,ctrl,$transclude){var block,childScope,previousElements;$scope.$watch($attr.ngIf,function(value){value?childScope||$transclude(function(clone,newScope){childScope=newScope,clone[clone.length++]=$compile.$$createComment("end ngIf",$attr.ngIf),block={clone:clone},$animate.enter(clone,$element.parent(),$element)}):(previousElements&&(previousElements.remove(),previousElements=null),childScope&&(childScope.$destroy(),childScope=null),block&&(previousElements=getBlockNodes(block.clone),$animate.leave(previousElements).then(function(){previousElements=null}),block=null))})}}}],ngIncludeDirective=["$templateRequest","$anchorScroll","$animate",function($templateRequest,$anchorScroll,$animate){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:angular.noop,compile:function(element,attr){var srcExp=attr.ngInclude||attr.src,onloadExp=attr.onload||"",autoScrollExp=attr.autoscroll;return function(scope,$element,$attr,ctrl,$transclude){var currentScope,previousElement,currentElement,changeCounter=0,cleanupLastIncludeContent=function(){previousElement&&(previousElement.remove(),previousElement=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&($animate.leave(currentElement).then(function(){previousElement=null}),previousElement=currentElement,currentElement=null)};scope.$watch(srcExp,function(src){var afterAnimation=function(){!isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll()},thisChangeId=++changeCounter;src?($templateRequest(src,!0).then(function(response){if(!scope.$$destroyed&&thisChangeId===changeCounter){var newScope=scope.$new();ctrl.template=response;var clone=$transclude(newScope,function(clone){cleanupLastIncludeContent(),$animate.enter(clone,null,$element).then(afterAnimation)});currentScope=newScope,currentElement=clone,currentScope.$emit("$includeContentLoaded",src),scope.$eval(onloadExp)}},function(){scope.$$destroyed||thisChangeId===changeCounter&&(cleanupLastIncludeContent(),scope.$emit("$includeContentError",src))}),scope.$emit("$includeContentRequested",src)):(cleanupLastIncludeContent(),ctrl.template=null)})}}}}],ngIncludeFillContentDirective=["$compile",function($compile){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(scope,$element,$attr,ctrl){return toString.call($element[0]).match(/SVG/)?($element.empty(),void $compile(jqLiteBuildFragment(ctrl.template,window.document).childNodes)(scope,function(clone){$element.append(clone)},{futureParentElement:$element})):($element.html(ctrl.template),void $compile($element.contents())(scope))}}}],ngInitDirective=ngDirective({priority:450,compile:function(){return{pre:function(scope,element,attrs){scope.$eval(attrs.ngInit)}}}}),ngListDirective=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(scope,element,attr,ctrl){var ngList=element.attr(attr.$attr.ngList)||", ",trimValues="false"!==attr.ngTrim,separator=trimValues?trim(ngList):ngList,parse=function(viewValue){if(!isUndefined(viewValue)){var list=[];return viewValue&&forEach(viewValue.split(separator),function(value){value&&list.push(trimValues?trim(value):value)}),list}};ctrl.$parsers.push(parse),ctrl.$formatters.push(function(value){if(isArray(value))return value.join(ngList)}),ctrl.$isEmpty=function(value){return!value||!value.length}}}},VALID_CLASS="ng-valid",INVALID_CLASS="ng-invalid",PRISTINE_CLASS="ng-pristine",DIRTY_CLASS="ng-dirty",UNTOUCHED_CLASS="ng-untouched",TOUCHED_CLASS="ng-touched",PENDING_CLASS="ng-pending",EMPTY_CLASS="ng-empty",NOT_EMPTY_CLASS="ng-not-empty",ngModelMinErr=minErr("ngModel"),NgModelController=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function($scope,$exceptionHandler,$attr,$element,$parse,$animate,$timeout,$rootScope,$q,$interpolate){this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$$rawModelValue=void 0,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=void 0,this.$name=$interpolate($attr.name||"",!1)($scope),this.$$parentForm=nullFormCtrl;var parserValid,parsedNgModel=$parse($attr.ngModel),parsedNgModelAssign=parsedNgModel.assign,ngModelGet=parsedNgModel,ngModelSet=parsedNgModelAssign,pendingDebounce=null,ctrl=this;this.$$setOptions=function(options){if(ctrl.$options=options,options&&options.getterSetter){var invokeModelGetter=$parse($attr.ngModel+"()"),invokeModelSetter=$parse($attr.ngModel+"($$$p)");ngModelGet=function($scope){var modelValue=parsedNgModel($scope);return isFunction(modelValue)&&(modelValue=invokeModelGetter($scope)),modelValue},ngModelSet=function($scope,newValue){isFunction(parsedNgModel($scope))?invokeModelSetter($scope,{$$$p:newValue}):parsedNgModelAssign($scope,newValue)}}else if(!parsedNgModel.assign)throw ngModelMinErr("nonassign","Expression '{0}' is non-assignable. Element: {1}",$attr.ngModel,startingTag($element))},this.$render=noop,this.$isEmpty=function(value){return isUndefined(value)||""===value||null===value||value!==value},this.$$updateEmptyClasses=function(value){ctrl.$isEmpty(value)?($animate.removeClass($element,NOT_EMPTY_CLASS),$animate.addClass($element,EMPTY_CLASS)):($animate.removeClass($element,EMPTY_CLASS),$animate.addClass($element,NOT_EMPTY_CLASS))};var currentValidationRunId=0;addSetValidityMethod({ctrl:this,$element:$element,set:function(object,property){object[property]=!0},unset:function(object,property){delete object[property]},$animate:$animate}),this.$setPristine=function(){ctrl.$dirty=!1,ctrl.$pristine=!0,$animate.removeClass($element,DIRTY_CLASS),$animate.addClass($element,PRISTINE_CLASS)},this.$setDirty=function(){ctrl.$dirty=!0,ctrl.$pristine=!1,$animate.removeClass($element,PRISTINE_CLASS),$animate.addClass($element,DIRTY_CLASS),ctrl.$$parentForm.$setDirty()},this.$setUntouched=function(){ctrl.$touched=!1,ctrl.$untouched=!0,$animate.setClass($element,UNTOUCHED_CLASS,TOUCHED_CLASS)},this.$setTouched=function(){ctrl.$touched=!0,ctrl.$untouched=!1,$animate.setClass($element,TOUCHED_CLASS,UNTOUCHED_CLASS)},this.$rollbackViewValue=function(){$timeout.cancel(pendingDebounce),ctrl.$viewValue=ctrl.$$lastCommittedViewValue,ctrl.$render()},this.$validate=function(){if(!isNumberNaN(ctrl.$modelValue)){var viewValue=ctrl.$$lastCommittedViewValue,modelValue=ctrl.$$rawModelValue,prevValid=ctrl.$valid,prevModelValue=ctrl.$modelValue,allowInvalid=ctrl.$options&&ctrl.$options.allowInvalid;ctrl.$$runValidators(modelValue,viewValue,function(allValid){allowInvalid||prevValid===allValid||(ctrl.$modelValue=allValid?modelValue:void 0,ctrl.$modelValue!==prevModelValue&&ctrl.$$writeModelToScope())})}},this.$$runValidators=function(modelValue,viewValue,doneCallback){function processParseErrors(){var errorKey=ctrl.$$parserName||"parse";return isUndefined(parserValid)?(setValidity(errorKey,null),!0):(parserValid||(forEach(ctrl.$validators,function(v,name){setValidity(name,null)}),forEach(ctrl.$asyncValidators,function(v,name){setValidity(name,null)})),setValidity(errorKey,parserValid),parserValid)}function processSyncValidators(){var syncValidatorsValid=!0;return forEach(ctrl.$validators,function(validator,name){var result=validator(modelValue,viewValue);syncValidatorsValid=syncValidatorsValid&&result,setValidity(name,result)}),!!syncValidatorsValid||(forEach(ctrl.$asyncValidators,function(v,name){setValidity(name,null)}),!1)}function processAsyncValidators(){var validatorPromises=[],allValid=!0;forEach(ctrl.$asyncValidators,function(validator,name){var promise=validator(modelValue,viewValue);if(!isPromiseLike(promise))throw ngModelMinErr("nopromise","Expected asynchronous validator to return a promise but got '{0}' instead.",promise);setValidity(name,void 0),validatorPromises.push(promise.then(function(){setValidity(name,!0)},function(){allValid=!1,setValidity(name,!1)}))}),validatorPromises.length?$q.all(validatorPromises).then(function(){validationDone(allValid)},noop):validationDone(!0)}function setValidity(name,isValid){localValidationRunId===currentValidationRunId&&ctrl.$setValidity(name,isValid)}function validationDone(allValid){localValidationRunId===currentValidationRunId&&doneCallback(allValid)}currentValidationRunId++;var localValidationRunId=currentValidationRunId;return processParseErrors()&&processSyncValidators()?void processAsyncValidators():void validationDone(!1)},this.$commitViewValue=function(){var viewValue=ctrl.$viewValue;$timeout.cancel(pendingDebounce),(ctrl.$$lastCommittedViewValue!==viewValue||""===viewValue&&ctrl.$$hasNativeValidators)&&(ctrl.$$updateEmptyClasses(viewValue),ctrl.$$lastCommittedViewValue=viewValue,ctrl.$pristine&&this.$setDirty(),this.$$parseAndValidate())},this.$$parseAndValidate=function(){function writeToModelIfNeeded(){ctrl.$modelValue!==prevModelValue&&ctrl.$$writeModelToScope()}var viewValue=ctrl.$$lastCommittedViewValue,modelValue=viewValue;if(parserValid=!isUndefined(modelValue)||void 0)for(var i=0;i<ctrl.$parsers.length;i++)if(modelValue=ctrl.$parsers[i](modelValue),isUndefined(modelValue)){parserValid=!1;break}isNumberNaN(ctrl.$modelValue)&&(ctrl.$modelValue=ngModelGet($scope));var prevModelValue=ctrl.$modelValue,allowInvalid=ctrl.$options&&ctrl.$options.allowInvalid;ctrl.$$rawModelValue=modelValue,allowInvalid&&(ctrl.$modelValue=modelValue,writeToModelIfNeeded()),ctrl.$$runValidators(modelValue,ctrl.$$lastCommittedViewValue,function(allValid){allowInvalid||(ctrl.$modelValue=allValid?modelValue:void 0,writeToModelIfNeeded())})},this.$$writeModelToScope=function(){ngModelSet($scope,ctrl.$modelValue),forEach(ctrl.$viewChangeListeners,function(listener){try{listener()}catch(e){$exceptionHandler(e)}})},this.$setViewValue=function(value,trigger){ctrl.$viewValue=value,ctrl.$options&&!ctrl.$options.updateOnDefault||ctrl.$$debounceViewValueCommit(trigger)},this.$$debounceViewValueCommit=function(trigger){var debounce,debounceDelay=0,options=ctrl.$options;options&&isDefined(options.debounce)&&(debounce=options.debounce,isNumber(debounce)?debounceDelay=debounce:isNumber(debounce[trigger])?debounceDelay=debounce[trigger]:isNumber(debounce.default)&&(debounceDelay=debounce.default)),$timeout.cancel(pendingDebounce),debounceDelay?pendingDebounce=$timeout(function(){ctrl.$commitViewValue()},debounceDelay):$rootScope.$$phase?ctrl.$commitViewValue():$scope.$apply(function(){ctrl.$commitViewValue()})},$scope.$watch(function(){var modelValue=ngModelGet($scope);if(modelValue!==ctrl.$modelValue&&(ctrl.$modelValue===ctrl.$modelValue||modelValue===modelValue)){ctrl.$modelValue=ctrl.$$rawModelValue=modelValue,parserValid=void 0;for(var formatters=ctrl.$formatters,idx=formatters.length,viewValue=modelValue;idx--;)viewValue=formatters[idx](viewValue);ctrl.$viewValue!==viewValue&&(ctrl.$$updateEmptyClasses(viewValue),ctrl.$viewValue=ctrl.$$lastCommittedViewValue=viewValue,ctrl.$render(),ctrl.$$runValidators(ctrl.$modelValue,ctrl.$viewValue,noop))}return modelValue})}],ngModelDirective=["$rootScope",function($rootScope){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:NgModelController,priority:1,compile:function(element){return element.addClass(PRISTINE_CLASS).addClass(UNTOUCHED_CLASS).addClass(VALID_CLASS),{pre:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0],formCtrl=ctrls[1]||modelCtrl.$$parentForm;modelCtrl.$$setOptions(ctrls[2]&&ctrls[2].$options),formCtrl.$addControl(modelCtrl),attr.$observe("name",function(newValue){modelCtrl.$name!==newValue&&modelCtrl.$$parentForm.$$renameControl(modelCtrl,newValue)}),scope.$on("$destroy",function(){modelCtrl.$$parentForm.$removeControl(modelCtrl)})},post:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0];modelCtrl.$options&&modelCtrl.$options.updateOn&&element.on(modelCtrl.$options.updateOn,function(ev){modelCtrl.$$debounceViewValueCommit(ev&&ev.type)}),element.on("blur",function(){modelCtrl.$touched||($rootScope.$$phase?scope.$evalAsync(modelCtrl.$setTouched):scope.$apply(modelCtrl.$setTouched))})}}}}}],DEFAULT_REGEXP=/(\s+|^)default(\s+|$)/,ngModelOptionsDirective=function(){return{restrict:"A",controller:["$scope","$attrs",function($scope,$attrs){var that=this;this.$options=copy($scope.$eval($attrs.ngModelOptions)),isDefined(this.$options.updateOn)?(this.$options.updateOnDefault=!1,this.$options.updateOn=trim(this.$options.updateOn.replace(DEFAULT_REGEXP,function(){return that.$options.updateOnDefault=!0," "}))):this.$options.updateOnDefault=!0}]}},ngNonBindableDirective=ngDirective({terminal:!0,priority:1e3}),ngOptionsMinErr=minErr("ngOptions"),NG_OPTIONS_REGEXP=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,ngOptionsDirective=["$compile","$document","$parse",function($compile,$document,$parse){function parseOptionsExpression(optionsExp,selectElement,scope){function Option(selectValue,viewValue,label,group,disabled){this.selectValue=selectValue,this.viewValue=viewValue,this.label=label,this.group=group,this.disabled=disabled}function getOptionValuesKeys(optionValues){var optionValuesKeys;if(!keyName&&isArrayLike(optionValues))optionValuesKeys=optionValues;else{optionValuesKeys=[];for(var itemKey in optionValues)optionValues.hasOwnProperty(itemKey)&&"$"!==itemKey.charAt(0)&&optionValuesKeys.push(itemKey)}return optionValuesKeys}var match=optionsExp.match(NG_OPTIONS_REGEXP);if(!match)throw ngOptionsMinErr("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",optionsExp,startingTag(selectElement));var valueName=match[5]||match[7],keyName=match[6],selectAs=/ as /.test(match[0])&&match[1],trackBy=match[9],valueFn=$parse(match[2]?match[1]:valueName),selectAsFn=selectAs&&$parse(selectAs),viewValueFn=selectAsFn||valueFn,trackByFn=trackBy&&$parse(trackBy),getTrackByValueFn=trackBy?function(value,locals){return trackByFn(scope,locals)}:function(value){return hashKey(value)},getTrackByValue=function(value,key){return getTrackByValueFn(value,getLocals(value,key))},displayFn=$parse(match[2]||match[1]),groupByFn=$parse(match[3]||""),disableWhenFn=$parse(match[4]||""),valuesFn=$parse(match[8]),locals={},getLocals=keyName?function(value,key){return locals[keyName]=key,locals[valueName]=value,locals}:function(value){return locals[valueName]=value,locals};return{trackBy:trackBy,getTrackByValue:getTrackByValue,getWatchables:$parse(valuesFn,function(optionValues){var watchedArray=[];optionValues=optionValues||[];for(var optionValuesKeys=getOptionValuesKeys(optionValues),optionValuesLength=optionValuesKeys.length,index=0;index<optionValuesLength;index++){var key=optionValues===optionValuesKeys?index:optionValuesKeys[index],value=optionValues[key],locals=getLocals(value,key),selectValue=getTrackByValueFn(value,locals);if(watchedArray.push(selectValue),match[2]||match[1]){var label=displayFn(scope,locals);watchedArray.push(label)}if(match[4]){var disableWhen=disableWhenFn(scope,locals);watchedArray.push(disableWhen)}}return watchedArray}),getOptions:function(){for(var optionItems=[],selectValueMap={},optionValues=valuesFn(scope)||[],optionValuesKeys=getOptionValuesKeys(optionValues),optionValuesLength=optionValuesKeys.length,index=0;index<optionValuesLength;index++){var key=optionValues===optionValuesKeys?index:optionValuesKeys[index],value=optionValues[key],locals=getLocals(value,key),viewValue=viewValueFn(scope,locals),selectValue=getTrackByValueFn(viewValue,locals),label=displayFn(scope,locals),group=groupByFn(scope,locals),disabled=disableWhenFn(scope,locals),optionItem=new Option(selectValue,viewValue,label,group,disabled);optionItems.push(optionItem),selectValueMap[selectValue]=optionItem}return{items:optionItems,selectValueMap:selectValueMap,getOptionFromViewValue:function(value){return selectValueMap[getTrackByValue(value)]},getViewValueFromOption:function(option){return trackBy?angular.copy(option.viewValue):option.viewValue}}}}}function ngOptionsPostLink(scope,selectElement,attr,ctrls){function addOptionElement(option,parent){var optionElement=optionTemplate.cloneNode(!1);parent.appendChild(optionElement),updateOptionElement(option,optionElement)}function updateOptionElement(option,element){option.element=element,element.disabled=option.disabled,option.label!==element.label&&(element.label=option.label,element.textContent=option.label),option.value!==element.value&&(element.value=option.selectValue)}function updateOptions(){var previousValue=options&&selectCtrl.readValue();if(options)for(var i=options.items.length-1;i>=0;i--){var option=options.items[i];jqLiteRemove(isDefined(option.group)?option.element.parentNode:option.element)}options=ngOptions.getOptions();var groupElementMap={};if(providedEmptyOption&&selectElement.prepend(emptyOption),options.items.forEach(function(option){var groupElement;isDefined(option.group)?(groupElement=groupElementMap[option.group],groupElement||(groupElement=optGroupTemplate.cloneNode(!1),listFragment.appendChild(groupElement),groupElement.label=null===option.group?"null":option.group,groupElementMap[option.group]=groupElement),addOptionElement(option,groupElement)):addOptionElement(option,listFragment)}),selectElement[0].appendChild(listFragment),ngModelCtrl.$render(),!ngModelCtrl.$isEmpty(previousValue)){var nextValue=selectCtrl.readValue(),isNotPrimitive=ngOptions.trackBy||multiple;(isNotPrimitive?equals(previousValue,nextValue):previousValue===nextValue)||(ngModelCtrl.$setViewValue(nextValue),ngModelCtrl.$render())}}for(var emptyOption,selectCtrl=ctrls[0],ngModelCtrl=ctrls[1],multiple=attr.multiple,i=0,children=selectElement.children(),ii=children.length;i<ii;i++)if(""===children[i].value){emptyOption=children.eq(i);break}var providedEmptyOption=!!emptyOption,unknownOption=jqLite(optionTemplate.cloneNode(!1));unknownOption.val("?");var options,ngOptions=parseOptionsExpression(attr.ngOptions,selectElement,scope),listFragment=$document[0].createDocumentFragment(),renderEmptyOption=function(){providedEmptyOption||selectElement.prepend(emptyOption),selectElement.val(""),emptyOption.prop("selected",!0),emptyOption.attr("selected",!0)},removeEmptyOption=function(){providedEmptyOption?emptyOption.removeAttr("selected"):emptyOption.remove()},renderUnknownOption=function(){selectElement.prepend(unknownOption),selectElement.val("?"),unknownOption.prop("selected",!0),unknownOption.attr("selected",!0)},removeUnknownOption=function(){unknownOption.remove()};multiple?(ngModelCtrl.$isEmpty=function(value){return!value||0===value.length},selectCtrl.writeValue=function(value){options.items.forEach(function(option){option.element.selected=!1}),value&&value.forEach(function(item){var option=options.getOptionFromViewValue(item);option&&(option.element.selected=!0)})},selectCtrl.readValue=function(){var selectedValues=selectElement.val()||[],selections=[];return forEach(selectedValues,function(value){var option=options.selectValueMap[value];option&&!option.disabled&&selections.push(options.getViewValueFromOption(option))}),selections},ngOptions.trackBy&&scope.$watchCollection(function(){if(isArray(ngModelCtrl.$viewValue))return ngModelCtrl.$viewValue.map(function(value){return ngOptions.getTrackByValue(value)})},function(){ngModelCtrl.$render()})):(selectCtrl.writeValue=function(value){var selectedOption=options.selectValueMap[selectElement.val()],option=options.getOptionFromViewValue(value);selectedOption&&selectedOption.element.removeAttribute("selected"),option?(selectElement[0].value!==option.selectValue&&(removeUnknownOption(),removeEmptyOption(),selectElement[0].value=option.selectValue,option.element.selected=!0),option.element.setAttribute("selected","selected")):null===value||providedEmptyOption?(removeUnknownOption(),renderEmptyOption()):(removeEmptyOption(),renderUnknownOption())},selectCtrl.readValue=function(){var selectedOption=options.selectValueMap[selectElement.val()];return selectedOption&&!selectedOption.disabled?(removeEmptyOption(),removeUnknownOption(),options.getViewValueFromOption(selectedOption)):null},ngOptions.trackBy&&scope.$watch(function(){return ngOptions.getTrackByValue(ngModelCtrl.$viewValue)},function(){ngModelCtrl.$render()})),providedEmptyOption?(emptyOption.remove(),$compile(emptyOption)(scope),emptyOption.removeClass("ng-scope")):emptyOption=jqLite(optionTemplate.cloneNode(!1)),selectElement.empty(),updateOptions(),scope.$watchCollection(ngOptions.getWatchables,updateOptions)}var optionTemplate=window.document.createElement("option"),optGroupTemplate=window.document.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","ngModel"],link:{pre:function(scope,selectElement,attr,ctrls){ctrls[0].registerOption=noop},post:ngOptionsPostLink}}}],ngPluralizeDirective=["$locale","$interpolate","$log",function($locale,$interpolate,$log){var BRACE=/{}/g,IS_WHEN=/^when(Minus)?(.+)$/;return{link:function(scope,element,attr){function updateElementText(newText){element.text(newText||"")}var lastCount,numberExp=attr.count,whenExp=attr.$attr.when&&element.attr(attr.$attr.when),offset=attr.offset||0,whens=scope.$eval(whenExp)||{},whensExpFns={},startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),braceReplacement=startSymbol+numberExp+"-"+offset+endSymbol,watchRemover=angular.noop;forEach(attr,function(expression,attributeName){var tmpMatch=IS_WHEN.exec(attributeName);if(tmpMatch){var whenKey=(tmpMatch[1]?"-":"")+lowercase(tmpMatch[2]);whens[whenKey]=element.attr(attr.$attr[attributeName])}}),forEach(whens,function(expression,key){whensExpFns[key]=$interpolate(expression.replace(BRACE,braceReplacement))}),scope.$watch(numberExp,function(newVal){var count=parseFloat(newVal),countIsNaN=isNumberNaN(count);if(countIsNaN||count in whens||(count=$locale.pluralCat(count-offset)),!(count===lastCount||countIsNaN&&isNumberNaN(lastCount))){watchRemover();var whenExpFn=whensExpFns[count];isUndefined(whenExpFn)?(null!=newVal&&$log.debug("ngPluralize: no rule defined for '"+count+"' in "+whenExp),watchRemover=noop,updateElementText()):watchRemover=scope.$watch(whenExpFn,updateElementText),lastCount=count}})}}}],ngRepeatDirective=["$parse","$animate","$compile",function($parse,$animate,$compile){var NG_REMOVED="$$NG_REMOVED",ngRepeatMinErr=minErr("ngRepeat"),updateScope=function(scope,index,valueIdentifier,value,keyIdentifier,key,arrayLength){scope[valueIdentifier]=value,keyIdentifier&&(scope[keyIdentifier]=key),scope.$index=index,scope.$first=0===index,scope.$last=index===arrayLength-1,scope.$middle=!(scope.$first||scope.$last),scope.$odd=!(scope.$even=0===(1&index))},getBlockStart=function(block){return block.clone[0]},getBlockEnd=function(block){return block.clone[block.clone.length-1]};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function($element,$attr){var expression=$attr.ngRepeat,ngRepeatEndComment=$compile.$$createComment("end ngRepeat",expression),match=expression.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!match)throw ngRepeatMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",expression);var lhs=match[1],rhs=match[2],aliasAs=match[3],trackByExp=match[4];if(match=lhs.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/),!match)throw ngRepeatMinErr("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",lhs);var valueIdentifier=match[3]||match[1],keyIdentifier=match[2];if(aliasAs&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(aliasAs)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(aliasAs)))throw ngRepeatMinErr("badident","alias '{0}' is invalid --- must be a valid JS identifier which is not a reserved name.",aliasAs);var trackByExpGetter,trackByIdExpFn,trackByIdArrayFn,trackByIdObjFn,hashFnLocals={$id:hashKey};return trackByExp?trackByExpGetter=$parse(trackByExp):(trackByIdArrayFn=function(key,value){return hashKey(value)},trackByIdObjFn=function(key){return key}),function($scope,$element,$attr,ctrl,$transclude){trackByExpGetter&&(trackByIdExpFn=function(key,value,index){return keyIdentifier&&(hashFnLocals[keyIdentifier]=key),hashFnLocals[valueIdentifier]=value,
hashFnLocals.$index=index,trackByExpGetter($scope,hashFnLocals)});var lastBlockMap=createMap();$scope.$watchCollection(rhs,function(collection){var index,length,nextNode,collectionLength,key,value,trackById,trackByIdFn,collectionKeys,block,nextBlockOrder,elementsToRemove,previousNode=$element[0],nextBlockMap=createMap();if(aliasAs&&($scope[aliasAs]=collection),isArrayLike(collection))collectionKeys=collection,trackByIdFn=trackByIdExpFn||trackByIdArrayFn;else{trackByIdFn=trackByIdExpFn||trackByIdObjFn,collectionKeys=[];for(var itemKey in collection)hasOwnProperty.call(collection,itemKey)&&"$"!==itemKey.charAt(0)&&collectionKeys.push(itemKey)}for(collectionLength=collectionKeys.length,nextBlockOrder=new Array(collectionLength),index=0;index<collectionLength;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],trackById=trackByIdFn(key,value,index),lastBlockMap[trackById])block=lastBlockMap[trackById],delete lastBlockMap[trackById],nextBlockMap[trackById]=block,nextBlockOrder[index]=block;else{if(nextBlockMap[trackById])throw forEach(nextBlockOrder,function(block){block&&block.scope&&(lastBlockMap[block.id]=block)}),ngRepeatMinErr("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",expression,trackById,value);nextBlockOrder[index]={id:trackById,scope:void 0,clone:void 0},nextBlockMap[trackById]=!0}for(var blockKey in lastBlockMap){if(block=lastBlockMap[blockKey],elementsToRemove=getBlockNodes(block.clone),$animate.leave(elementsToRemove),elementsToRemove[0].parentNode)for(index=0,length=elementsToRemove.length;index<length;index++)elementsToRemove[index][NG_REMOVED]=!0;block.scope.$destroy()}for(index=0;index<collectionLength;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],block=nextBlockOrder[index],block.scope){nextNode=previousNode;do nextNode=nextNode.nextSibling;while(nextNode&&nextNode[NG_REMOVED]);getBlockStart(block)!==nextNode&&$animate.move(getBlockNodes(block.clone),null,previousNode),previousNode=getBlockEnd(block),updateScope(block.scope,index,valueIdentifier,value,keyIdentifier,key,collectionLength)}else $transclude(function(clone,scope){block.scope=scope;var endNode=ngRepeatEndComment.cloneNode(!1);clone[clone.length++]=endNode,$animate.enter(clone,null,previousNode),previousNode=endNode,block.clone=clone,nextBlockMap[block.id]=block,updateScope(block.scope,index,valueIdentifier,value,keyIdentifier,key,collectionLength)});lastBlockMap=nextBlockMap})}}}}],NG_HIDE_CLASS="ng-hide",NG_HIDE_IN_PROGRESS_CLASS="ng-hide-animate",ngShowDirective=["$animate",function($animate){return{restrict:"A",multiElement:!0,link:function(scope,element,attr){scope.$watch(attr.ngShow,function(value){$animate[value?"removeClass":"addClass"](element,NG_HIDE_CLASS,{tempClasses:NG_HIDE_IN_PROGRESS_CLASS})})}}}],ngHideDirective=["$animate",function($animate){return{restrict:"A",multiElement:!0,link:function(scope,element,attr){scope.$watch(attr.ngHide,function(value){$animate[value?"addClass":"removeClass"](element,NG_HIDE_CLASS,{tempClasses:NG_HIDE_IN_PROGRESS_CLASS})})}}}],ngStyleDirective=ngDirective(function(scope,element,attr){scope.$watch(attr.ngStyle,function(newStyles,oldStyles){oldStyles&&newStyles!==oldStyles&&forEach(oldStyles,function(val,style){element.css(style,"")}),newStyles&&element.css(newStyles)},!0)}),ngSwitchDirective=["$animate","$compile",function($animate,$compile){return{require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(scope,element,attr,ngSwitchController){var watchExpr=attr.ngSwitch||attr.on,selectedTranscludes=[],selectedElements=[],previousLeaveAnimations=[],selectedScopes=[],spliceFactory=function(array,index){return function(){array.splice(index,1)}};scope.$watch(watchExpr,function(value){var i,ii;for(i=0,ii=previousLeaveAnimations.length;i<ii;++i)$animate.cancel(previousLeaveAnimations[i]);for(previousLeaveAnimations.length=0,i=0,ii=selectedScopes.length;i<ii;++i){var selected=getBlockNodes(selectedElements[i].clone);selectedScopes[i].$destroy();var promise=previousLeaveAnimations[i]=$animate.leave(selected);promise.then(spliceFactory(previousLeaveAnimations,i))}selectedElements.length=0,selectedScopes.length=0,(selectedTranscludes=ngSwitchController.cases["!"+value]||ngSwitchController.cases["?"])&&forEach(selectedTranscludes,function(selectedTransclude){selectedTransclude.transclude(function(caseElement,selectedScope){selectedScopes.push(selectedScope);var anchor=selectedTransclude.element;caseElement[caseElement.length++]=$compile.$$createComment("end ngSwitchWhen");var block={clone:caseElement};selectedElements.push(block),$animate.enter(caseElement,anchor.parent(),anchor)})})})}}}],ngSwitchWhenDirective=ngDirective({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(scope,element,attrs,ctrl,$transclude){ctrl.cases["!"+attrs.ngSwitchWhen]=ctrl.cases["!"+attrs.ngSwitchWhen]||[],ctrl.cases["!"+attrs.ngSwitchWhen].push({transclude:$transclude,element:element})}}),ngSwitchDefaultDirective=ngDirective({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(scope,element,attr,ctrl,$transclude){ctrl.cases["?"]=ctrl.cases["?"]||[],ctrl.cases["?"].push({transclude:$transclude,element:element})}}),ngTranscludeMinErr=minErr("ngTransclude"),ngTranscludeDirective=["$compile",function($compile){return{restrict:"EAC",terminal:!0,compile:function(tElement){var fallbackLinkFn=$compile(tElement.contents());return tElement.empty(),function($scope,$element,$attrs,controller,$transclude){function ngTranscludeCloneAttachFn(clone,transcludedScope){clone.length?$element.append(clone):(useFallbackContent(),transcludedScope.$destroy())}function useFallbackContent(){fallbackLinkFn($scope,function(clone){$element.append(clone)})}if(!$transclude)throw ngTranscludeMinErr("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",startingTag($element));$attrs.ngTransclude===$attrs.$attr.ngTransclude&&($attrs.ngTransclude="");var slotName=$attrs.ngTransclude||$attrs.ngTranscludeSlot;$transclude(ngTranscludeCloneAttachFn,null,slotName),slotName&&!$transclude.isSlotFilled(slotName)&&useFallbackContent()}}}}],scriptDirective=["$templateCache",function($templateCache){return{restrict:"E",terminal:!0,compile:function(element,attr){if("text/ng-template"===attr.type){var templateUrl=attr.id,text=element[0].text;$templateCache.put(templateUrl,text)}}}}],noopNgModelController={$setViewValue:noop,$render:noop},SelectController=["$element","$scope",function($element,$scope){var self=this,optionsMap=new HashMap;self.ngModelCtrl=noopNgModelController,self.unknownOption=jqLite(window.document.createElement("option")),self.renderUnknownOption=function(val){var unknownVal="? "+hashKey(val)+" ?";self.unknownOption.val(unknownVal),$element.prepend(self.unknownOption),$element.val(unknownVal)},$scope.$on("$destroy",function(){self.renderUnknownOption=noop}),self.removeUnknownOption=function(){self.unknownOption.parent()&&self.unknownOption.remove()},self.readValue=function(){return self.removeUnknownOption(),$element.val()},self.writeValue=function(value){self.hasOption(value)?(self.removeUnknownOption(),$element.val(value),""===value&&self.emptyOption.prop("selected",!0)):null==value&&self.emptyOption?(self.removeUnknownOption(),$element.val("")):self.renderUnknownOption(value)},self.addOption=function(value,element){if(element[0].nodeType!==NODE_TYPE_COMMENT){assertNotHasOwnProperty(value,'"option value"'),""===value&&(self.emptyOption=element);var count=optionsMap.get(value)||0;optionsMap.put(value,count+1),self.ngModelCtrl.$render(),chromeHack(element)}},self.removeOption=function(value){var count=optionsMap.get(value);count&&(1===count?(optionsMap.remove(value),""===value&&(self.emptyOption=void 0)):optionsMap.put(value,count-1))},self.hasOption=function(value){return!!optionsMap.get(value)},self.registerOption=function(optionScope,optionElement,optionAttrs,interpolateValueFn,interpolateTextFn){if(interpolateValueFn){var oldVal;optionAttrs.$observe("value",function(newVal){isDefined(oldVal)&&self.removeOption(oldVal),oldVal=newVal,self.addOption(newVal,optionElement)})}else interpolateTextFn?optionScope.$watch(interpolateTextFn,function(newVal,oldVal){optionAttrs.$set("value",newVal),oldVal!==newVal&&self.removeOption(oldVal),self.addOption(newVal,optionElement)}):self.addOption(optionAttrs.value,optionElement);optionElement.on("$destroy",function(){self.removeOption(optionAttrs.value),self.ngModelCtrl.$render()})}}],selectDirective=function(){function selectPreLink(scope,element,attr,ctrls){var ngModelCtrl=ctrls[1];if(ngModelCtrl){var selectCtrl=ctrls[0];if(selectCtrl.ngModelCtrl=ngModelCtrl,element.on("change",function(){scope.$apply(function(){ngModelCtrl.$setViewValue(selectCtrl.readValue())})}),attr.multiple){selectCtrl.readValue=function(){var array=[];return forEach(element.find("option"),function(option){option.selected&&array.push(option.value)}),array},selectCtrl.writeValue=function(value){var items=new HashMap(value);forEach(element.find("option"),function(option){option.selected=isDefined(items.get(option.value))})};var lastView,lastViewRef=NaN;scope.$watch(function(){lastViewRef!==ngModelCtrl.$viewValue||equals(lastView,ngModelCtrl.$viewValue)||(lastView=shallowCopy(ngModelCtrl.$viewValue),ngModelCtrl.$render()),lastViewRef=ngModelCtrl.$viewValue}),ngModelCtrl.$isEmpty=function(value){return!value||0===value.length}}}}function selectPostLink(scope,element,attrs,ctrls){var ngModelCtrl=ctrls[1];if(ngModelCtrl){var selectCtrl=ctrls[0];ngModelCtrl.$render=function(){selectCtrl.writeValue(ngModelCtrl.$viewValue)}}}return{restrict:"E",require:["select","?ngModel"],controller:SelectController,priority:1,link:{pre:selectPreLink,post:selectPostLink}}},optionDirective=["$interpolate",function($interpolate){return{restrict:"E",priority:100,compile:function(element,attr){if(isDefined(attr.value))var interpolateValueFn=$interpolate(attr.value,!0);else{var interpolateTextFn=$interpolate(element.text(),!0);interpolateTextFn||attr.$set("value",element.text())}return function(scope,element,attr){var selectCtrlName="$selectController",parent=element.parent(),selectCtrl=parent.data(selectCtrlName)||parent.parent().data(selectCtrlName);selectCtrl&&selectCtrl.registerOption(scope,element,attr,interpolateValueFn,interpolateTextFn)}}}}],requiredDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){ctrl&&(attr.required=!0,ctrl.$validators.required=function(modelValue,viewValue){return!attr.required||!ctrl.$isEmpty(viewValue)},attr.$observe("required",function(){ctrl.$validate()}))}}},patternDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var regexp,patternExp=attr.ngPattern||attr.pattern;attr.$observe("pattern",function(regex){if(isString(regex)&&regex.length>0&&(regex=new RegExp("^"+regex+"$")),regex&&!regex.test)throw minErr("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",patternExp,regex,startingTag(elm));regexp=regex||void 0,ctrl.$validate()}),ctrl.$validators.pattern=function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||isUndefined(regexp)||regexp.test(viewValue)}}}}},maxlengthDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var maxlength=-1;attr.$observe("maxlength",function(value){var intVal=toInt(value);maxlength=isNumberNaN(intVal)?-1:intVal,ctrl.$validate()}),ctrl.$validators.maxlength=function(modelValue,viewValue){return maxlength<0||ctrl.$isEmpty(viewValue)||viewValue.length<=maxlength}}}}},minlengthDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var minlength=0;attr.$observe("minlength",function(value){minlength=toInt(value)||0,ctrl.$validate()}),ctrl.$validators.minlength=function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||viewValue.length>=minlength}}}}};return window.angular.bootstrap?void(window.console&&console.log("WARNING: Tried to load angular more than once.")):(bindJQuery(),publishExternalAPI(angular),angular.module("ngLocale",[],["$provide",function($provide){function getDecimals(n){n+="";var i=n.indexOf(".");return i==-1?0:n.length-i-1}function getVF(n,opt_precision){var v=opt_precision;void 0===v&&(v=Math.min(getDecimals(n),3));var base=Math.pow(10,v),f=(n*base|0)%base;return{v:v,f:f}}var PLURAL_CATEGORY={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};$provide.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],STANDALONEMONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a",short:"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-¤",negSuf:"",posPre:"¤",posSuf:""}]},id:"en-us",localeID:"en_US",pluralCat:function(n,opt_precision){var i=0|n,vf=getVF(n,opt_precision);return 1==i&&0==vf.v?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}})}]),void jqLite(window.document).ready(function(){angularInit(window.document,bootstrap)}))}(window),!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>'),function(window,angular){"use strict";function shallowCopy(src,dst){if(isArray(src)){dst=dst||[];for(var i=0,ii=src.length;i<ii;i++)dst[i]=src[i]}else if(isObject(src)){dst=dst||{};for(var key in src)"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key])}return dst||src}function $RouteProvider(){function inherit(parent,extra){return angular.extend(Object.create(parent),extra)}function pathRegExp(path,opts){var insensitive=opts.caseInsensitiveMatch,ret={originalPath:path,regexp:path},keys=ret.keys=[];return path=path.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)(\*\?|[\?\*])?/g,function(_,slash,key,option){var optional="?"===option||"*?"===option?"?":null,star="*"===option||"*?"===option?"*":null;return keys.push({name:key,optional:!!optional}),slash=slash||"",""+(optional?"":slash)+"(?:"+(optional?slash:"")+(star&&"(.+?)"||"([^/]+)")+(optional||"")+")"+(optional||"")}).replace(/([\/$\*])/g,"\\$1"),ret.regexp=new RegExp("^"+path+"$",insensitive?"i":""),ret}isArray=angular.isArray,isObject=angular.isObject;var routes={};this.when=function(path,route){var routeCopy=shallowCopy(route);if(angular.isUndefined(routeCopy.reloadOnSearch)&&(routeCopy.reloadOnSearch=!0),angular.isUndefined(routeCopy.caseInsensitiveMatch)&&(routeCopy.caseInsensitiveMatch=this.caseInsensitiveMatch),routes[path]=angular.extend(routeCopy,path&&pathRegExp(path,routeCopy)),path){var redirectPath="/"===path[path.length-1]?path.substr(0,path.length-1):path+"/";routes[redirectPath]=angular.extend({redirectTo:path},pathRegExp(redirectPath,routeCopy))}return this},this.caseInsensitiveMatch=!1,this.otherwise=function(params){return"string"==typeof params&&(params={redirectTo:params}),this.when(null,params),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$templateRequest","$sce",function($rootScope,$location,$routeParams,$q,$injector,$templateRequest,$sce){function switchRouteMatcher(on,route){var keys=route.keys,params={};if(!route.regexp)return null;var m=route.regexp.exec(on);if(!m)return null;for(var i=1,len=m.length;i<len;++i){var key=keys[i-1],val=m[i];key&&val&&(params[key.name]=val)}return params}function prepareRoute($locationEvent){var lastRoute=$route.current;preparedRoute=parseRoute(),preparedRouteIsUpdateOnly=preparedRoute&&lastRoute&&preparedRoute.$$route===lastRoute.$$route&&angular.equals(preparedRoute.pathParams,lastRoute.pathParams)&&!preparedRoute.reloadOnSearch&&!forceReload,preparedRouteIsUpdateOnly||!lastRoute&&!preparedRoute||$rootScope.$broadcast("$routeChangeStart",preparedRoute,lastRoute).defaultPrevented&&$locationEvent&&$locationEvent.preventDefault()}function commitRoute(){var lastRoute=$route.current,nextRoute=preparedRoute;preparedRouteIsUpdateOnly?(lastRoute.params=nextRoute.params,angular.copy(lastRoute.params,$routeParams),$rootScope.$broadcast("$routeUpdate",lastRoute)):(nextRoute||lastRoute)&&(forceReload=!1,$route.current=nextRoute,nextRoute&&nextRoute.redirectTo&&(angular.isString(nextRoute.redirectTo)?$location.path(interpolate(nextRoute.redirectTo,nextRoute.params)).search(nextRoute.params).replace():$location.url(nextRoute.redirectTo(nextRoute.pathParams,$location.path(),$location.search())).replace()),$q.when(nextRoute).then(resolveLocals).then(function(locals){nextRoute===$route.current&&(nextRoute&&(nextRoute.locals=locals,angular.copy(nextRoute.params,$routeParams)),$rootScope.$broadcast("$routeChangeSuccess",nextRoute,lastRoute))},function(error){nextRoute===$route.current&&$rootScope.$broadcast("$routeChangeError",nextRoute,lastRoute,error)}))}function resolveLocals(route){if(route){var locals=angular.extend({},route.resolve);angular.forEach(locals,function(value,key){locals[key]=angular.isString(value)?$injector.get(value):$injector.invoke(value,null,null,key)});var template=getTemplateFor(route);return angular.isDefined(template)&&(locals.$template=template),$q.all(locals)}}function getTemplateFor(route){var template,templateUrl;return angular.isDefined(template=route.template)?angular.isFunction(template)&&(template=template(route.params)):angular.isDefined(templateUrl=route.templateUrl)&&(angular.isFunction(templateUrl)&&(templateUrl=templateUrl(route.params)),angular.isDefined(templateUrl)&&(route.loadedTemplateUrl=$sce.valueOf(templateUrl),template=$templateRequest(templateUrl))),template}function parseRoute(){var params,match;return angular.forEach(routes,function(route,path){!match&&(params=switchRouteMatcher($location.path(),route))&&(match=inherit(route,{params:angular.extend({},$location.search(),params),pathParams:params}),match.$$route=route)}),match||routes[null]&&inherit(routes[null],{params:{},pathParams:{}})}function interpolate(string,params){var result=[];return angular.forEach((string||"").split(":"),function(segment,i){if(0===i)result.push(segment);else{var segmentMatch=segment.match(/(\w+)(?:[?*])?(.*)/),key=segmentMatch[1];result.push(params[key]),result.push(segmentMatch[2]||""),delete params[key]}}),result.join("")}var preparedRoute,preparedRouteIsUpdateOnly,forceReload=!1,$route={routes:routes,reload:function(){forceReload=!0;var fakeLocationEvent={defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0,forceReload=!1}};$rootScope.$evalAsync(function(){prepareRoute(fakeLocationEvent),fakeLocationEvent.defaultPrevented||commitRoute()})},updateParams:function(newParams){if(!this.current||!this.current.$$route)throw $routeMinErr("norout","Tried updating route when with no current route");newParams=angular.extend({},this.current.params,newParams),$location.path(interpolate(this.current.$$route.originalPath,newParams)),$location.search(newParams)}};return $rootScope.$on("$locationChangeStart",prepareRoute),$rootScope.$on("$locationChangeSuccess",commitRoute),$route}]}function $RouteParamsProvider(){this.$get=function(){return{}}}function ngViewFactory($route,$anchorScroll,$animate){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(scope,$element,attr,ctrl,$transclude){function cleanupLastView(){previousLeaveAnimation&&($animate.cancel(previousLeaveAnimation),previousLeaveAnimation=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&(previousLeaveAnimation=$animate.leave(currentElement),previousLeaveAnimation.then(function(){previousLeaveAnimation=null}),currentElement=null)}function update(){var locals=$route.current&&$route.current.locals,template=locals&&locals.$template;if(angular.isDefined(template)){var newScope=scope.$new(),current=$route.current,clone=$transclude(newScope,function(clone){$animate.enter(clone,null,currentElement||$element).then(function(){!angular.isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll()}),cleanupLastView()});currentElement=clone,currentScope=current.scope=newScope,currentScope.$emit("$viewContentLoaded"),currentScope.$eval(onloadExp)}else cleanupLastView()}var currentScope,currentElement,previousLeaveAnimation,autoScrollExp=attr.autoscroll,onloadExp=attr.onload||"";scope.$on("$routeChangeSuccess",update),update()}}}function ngViewFillContentFactory($compile,$controller,$route){return{restrict:"ECA",priority:-400,link:function(scope,$element){var current=$route.current,locals=current.locals;$element.html(locals.$template);var link=$compile($element.contents());if(current.controller){locals.$scope=scope;var controller=$controller(current.controller,locals);current.controllerAs&&(scope[current.controllerAs]=controller),$element.data("$ngControllerController",controller),$element.children().data("$ngControllerController",controller)}scope[current.resolveAs||"$resolve"]=locals,link(scope)}}}var isArray,isObject,ngRouteModule=angular.module("ngRoute",["ng"]).provider("$route",$RouteProvider),$routeMinErr=angular.$$minErr("ngRoute");ngRouteModule.provider("$routeParams",$RouteParamsProvider),ngRouteModule.directive("ngView",ngViewFactory),ngRouteModule.directive("ngView",ngViewFillContentFactory),ngViewFactory.$inject=["$route","$anchorScroll","$animate"],ngViewFillContentFactory.$inject=["$compile","$controller","$route"]}(window,window.angular),function(window,angular){"use strict";function isValidDottedPath(path){return null!=path&&""!==path&&"hasOwnProperty"!==path&&MEMBER_NAME_REGEX.test("."+path)}function lookupDottedPath(obj,path){if(!isValidDottedPath(path))throw $resourceMinErr("badmember",'Dotted member path "@{0}" is invalid.',path);for(var keys=path.split("."),i=0,ii=keys.length;i<ii&&angular.isDefined(obj);i++){var key=keys[i];obj=null!==obj?obj[key]:void 0}return obj}function shallowClearAndCopy(src,dst){dst=dst||{},angular.forEach(dst,function(value,key){delete dst[key]});for(var key in src)!src.hasOwnProperty(key)||"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key]);return dst}var $resourceMinErr=angular.$$minErr("$resource"),MEMBER_NAME_REGEX=/^(\.[a-zA-Z_$@][0-9a-zA-Z_$@]*)+$/;angular.module("ngResource",["ng"]).provider("$resource",function(){var PROTOCOL_AND_DOMAIN_REGEX=/^https?:\/\/[^\/]*/,provider=this;this.defaults={stripTrailingSlashes:!0,cancellable:!1,actions:{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},delete:{method:"DELETE"}}},this.$get=["$http","$log","$q","$timeout",function($http,$log,$q,$timeout){function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function Route(template,defaults){this.template=template,this.defaults=extend({},provider.defaults,defaults),this.urlParams={}}function resourceFactory(url,paramDefaults,actions,options){function extractParams(data,actionParams){var ids={};return actionParams=extend({},paramDefaults,actionParams),forEach(actionParams,function(value,key){isFunction(value)&&(value=value(data)),ids[key]=value&&value.charAt&&"@"===value.charAt(0)?lookupDottedPath(data,value.substr(1)):value}),ids}function defaultResponseInterceptor(response){return response.resource}function Resource(value){shallowClearAndCopy(value||{},this)}var route=new Route(url,options);return actions=extend({},provider.defaults.actions,actions),Resource.prototype.toJSON=function(){var data=extend({},this);return delete data.$promise,delete data.$resolved,data},forEach(actions,function(action,name){var hasBody=/^(POST|PUT|PATCH)$/i.test(action.method),numericTimeout=action.timeout,cancellable=angular.isDefined(action.cancellable)?action.cancellable:options&&angular.isDefined(options.cancellable)?options.cancellable:provider.defaults.cancellable;numericTimeout&&!angular.isNumber(numericTimeout)&&($log.debug("ngResource:\n  Only numeric values are allowed as `timeout`.\n  Promises are not supported in $resource, because the same value would be used for multiple requests. If you are looking for a way to cancel requests, you should use the `cancellable` option."),delete action.timeout,numericTimeout=null),Resource[name]=function(a1,a2,a3,a4){var data,success,error,params={};switch(arguments.length){case 4:error=a4,success=a3;case 3:case 2:if(!isFunction(a2)){params=a1,data=a2,success=a3;break}if(isFunction(a1)){success=a1,error=a2;break}success=a2,error=a3;case 1:isFunction(a1)?success=a1:hasBody?data=a1:params=a1;break;case 0:break;default:throw $resourceMinErr("badargs","Expected up to 4 arguments [params, data, success, error], got {0} arguments",arguments.length)}var timeoutDeferred,numericTimeoutPromise,isInstanceCall=this instanceof Resource,value=isInstanceCall?data:action.isArray?[]:new Resource(data),httpConfig={},responseInterceptor=action.interceptor&&action.interceptor.response||defaultResponseInterceptor,responseErrorInterceptor=action.interceptor&&action.interceptor.responseError||void 0;forEach(action,function(value,key){switch(key){default:httpConfig[key]=copy(value);break;case"params":case"isArray":case"interceptor":case"cancellable":}}),!isInstanceCall&&cancellable&&(timeoutDeferred=$q.defer(),httpConfig.timeout=timeoutDeferred.promise,numericTimeout&&(numericTimeoutPromise=$timeout(timeoutDeferred.resolve,numericTimeout))),hasBody&&(httpConfig.data=data),route.setUrlParams(httpConfig,extend({},extractParams(data,action.params||{}),params),action.url);var promise=$http(httpConfig).then(function(response){var data=response.data;if(data){if(angular.isArray(data)!==!!action.isArray)throw $resourceMinErr("badcfg","Error in resource configuration for action `{0}`. Expected response to contain an {1} but got an {2} (Request: {3} {4})",name,action.isArray?"array":"object",angular.isArray(data)?"array":"object",httpConfig.method,httpConfig.url);if(action.isArray)value.length=0,forEach(data,function(item){"object"==typeof item?value.push(new Resource(item)):value.push(item)});else{var promise=value.$promise;shallowClearAndCopy(data,value),value.$promise=promise}}return response.resource=value,response},function(response){return(error||noop)(response),$q.reject(response)});return promise.finally(function(){value.$resolved=!0,!isInstanceCall&&cancellable&&(value.$cancelRequest=angular.noop,$timeout.cancel(numericTimeoutPromise),timeoutDeferred=numericTimeoutPromise=httpConfig.timeout=null)}),promise=promise.then(function(response){var value=responseInterceptor(response);return(success||noop)(value,response.headers),value},responseErrorInterceptor),isInstanceCall?promise:(value.$promise=promise,value.$resolved=!1,cancellable&&(value.$cancelRequest=timeoutDeferred.resolve),value)},Resource.prototype["$"+name]=function(params,success,error){isFunction(params)&&(error=success,success=params,params={});var result=Resource[name].call(this,params,this,success,error);return result.$promise||result}}),Resource.bind=function(additionalParamDefaults){return resourceFactory(url,extend({},paramDefaults,additionalParamDefaults),actions)},Resource}var noop=angular.noop,forEach=angular.forEach,extend=angular.extend,copy=angular.copy,isFunction=angular.isFunction;return Route.prototype={setUrlParams:function(config,params,actionUrl){var val,encodedVal,self=this,url=actionUrl||self.template,protocolAndDomain="",urlParams=self.urlParams={};forEach(url.split(/\W/),function(param){if("hasOwnProperty"===param)throw $resourceMinErr("badname","hasOwnProperty is not a valid parameter name.");!new RegExp("^\\d+$").test(param)&&param&&new RegExp("(^|[^\\\\]):"+param+"(\\W|$)").test(url)&&(urlParams[param]={isQueryParamValue:new RegExp("\\?.*=:"+param+"(?:\\W|$)").test(url)})}),url=url.replace(/\\:/g,":"),url=url.replace(PROTOCOL_AND_DOMAIN_REGEX,function(match){return protocolAndDomain=match,""}),params=params||{},forEach(self.urlParams,function(paramInfo,urlParam){val=params.hasOwnProperty(urlParam)?params[urlParam]:self.defaults[urlParam],angular.isDefined(val)&&null!==val?(encodedVal=paramInfo.isQueryParamValue?encodeUriQuery(val,!0):encodeUriSegment(val),url=url.replace(new RegExp(":"+urlParam+"(\\W|$)","g"),function(match,p1){return encodedVal+p1})):url=url.replace(new RegExp("(/?):"+urlParam+"(\\W|$)","g"),function(match,leadingSlashes,tail){return"/"===tail.charAt(0)?tail:leadingSlashes+tail})}),self.defaults.stripTrailingSlashes&&(url=url.replace(/\/+$/,"")||"/"),url=url.replace(/\/\.(?=\w+($|\?))/,"."),config.url=protocolAndDomain+url.replace(/\/\\\./,"/."),forEach(params,function(value,key){self.urlParams[key]||(config.params=config.params||{},config.params[key]=value)})}},resourceFactory}]})}(window,window.angular),function(window,angular){"use strict";function $SanitizeProvider(){function toMap(str,lowercaseKeys){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[lowercaseKeys?lowercase(items[i]):items[i]]=!0;return obj}function htmlParserImpl(html,handler){null===html||void 0===html?html="":"string"!=typeof html&&(html=""+html),inertBodyElement.innerHTML=html;var mXSSAttempts=5;do{if(0===mXSSAttempts)throw $sanitizeMinErr("uinput","Failed to sanitize html because the input is unstable");mXSSAttempts--,window.document.documentMode&&stripCustomNsAttrs(inertBodyElement),html=inertBodyElement.innerHTML,inertBodyElement.innerHTML=html}while(html!==inertBodyElement.innerHTML);for(var node=inertBodyElement.firstChild;node;){switch(node.nodeType){case 1:handler.start(node.nodeName.toLowerCase(),attrToMap(node.attributes));break;case 3:handler.chars(node.textContent)}var nextNode;if(!(nextNode=node.firstChild)&&(1===node.nodeType&&handler.end(node.nodeName.toLowerCase()),nextNode=node.nextSibling,!nextNode))for(;null==nextNode&&(node=node.parentNode,node!==inertBodyElement);)nextNode=node.nextSibling,1===node.nodeType&&handler.end(node.nodeName.toLowerCase());node=nextNode}for(;node=inertBodyElement.firstChild;)inertBodyElement.removeChild(node)}function attrToMap(attrs){for(var map={},i=0,ii=attrs.length;i<ii;i++){var attr=attrs[i];map[attr.name]=attr.value}return map}function encodeEntities(value){return value.replace(/&/g,"&amp;").replace(SURROGATE_PAIR_REGEXP,function(value){var hi=value.charCodeAt(0),low=value.charCodeAt(1);return"&#"+(1024*(hi-55296)+(low-56320)+65536)+";"}).replace(NON_ALPHANUMERIC_REGEXP,function(value){return"&#"+value.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function htmlSanitizeWriterImpl(buf,uriValidator){var ignoreCurrentElement=!1,out=bind(buf,buf.push);return{start:function(tag,attrs){tag=lowercase(tag),!ignoreCurrentElement&&blockedElements[tag]&&(ignoreCurrentElement=tag),ignoreCurrentElement||validElements[tag]!==!0||(out("<"),out(tag),forEach(attrs,function(value,key){
var lkey=lowercase(key),isImage="img"===tag&&"src"===lkey||"background"===lkey;validAttrs[lkey]!==!0||uriAttrs[lkey]===!0&&!uriValidator(value,isImage)||(out(" "),out(key),out('="'),out(encodeEntities(value)),out('"'))}),out(">"))},end:function(tag){tag=lowercase(tag),ignoreCurrentElement||validElements[tag]!==!0||voidElements[tag]===!0||(out("</"),out(tag),out(">")),tag==ignoreCurrentElement&&(ignoreCurrentElement=!1)},chars:function(chars){ignoreCurrentElement||out(encodeEntities(chars))}}}function stripCustomNsAttrs(node){if(node.nodeType===window.Node.ELEMENT_NODE)for(var attrs=node.attributes,i=0,l=attrs.length;i<l;i++){var attrNode=attrs[i],attrName=attrNode.name.toLowerCase();"xmlns:ns1"!==attrName&&0!==attrName.lastIndexOf("ns1:",0)||(node.removeAttributeNode(attrNode),i--,l--)}var nextNode=node.firstChild;nextNode&&stripCustomNsAttrs(nextNode),nextNode=node.nextSibling,nextNode&&stripCustomNsAttrs(nextNode)}var svgEnabled=!1;this.$get=["$$sanitizeUri",function($$sanitizeUri){return svgEnabled&&extend(validElements,svgElements),function(html){var buf=[];return htmlParser(html,htmlSanitizeWriter(buf,function(uri,isImage){return!/^unsafe:/.test($$sanitizeUri(uri,isImage))})),buf.join("")}}],this.enableSvg=function(enableSvg){return isDefined(enableSvg)?(svgEnabled=enableSvg,this):svgEnabled},bind=angular.bind,extend=angular.extend,forEach=angular.forEach,isDefined=angular.isDefined,lowercase=angular.lowercase,noop=angular.noop,htmlParser=htmlParserImpl,htmlSanitizeWriter=htmlSanitizeWriterImpl;var inertBodyElement,SURROGATE_PAIR_REGEXP=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,NON_ALPHANUMERIC_REGEXP=/([^#-~ |!])/g,voidElements=toMap("area,br,col,hr,img,wbr"),optionalEndTagBlockElements=toMap("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),optionalEndTagInlineElements=toMap("rp,rt"),optionalEndTagElements=extend({},optionalEndTagInlineElements,optionalEndTagBlockElements),blockElements=extend({},optionalEndTagBlockElements,toMap("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,section,table,ul")),inlineElements=extend({},optionalEndTagInlineElements,toMap("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),svgElements=toMap("circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,stop,svg,switch,text,title,tspan"),blockedElements=toMap("script,style"),validElements=extend({},voidElements,blockElements,inlineElements,optionalEndTagElements),uriAttrs=toMap("background,cite,href,longdesc,src,xlink:href"),htmlAttrs=toMap("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,valign,value,vspace,width"),svgAttrs=toMap("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan",!0),validAttrs=extend({},uriAttrs,svgAttrs,htmlAttrs);!function(window){var doc;if(!window.document||!window.document.implementation)throw $sanitizeMinErr("noinert","Can't create an inert html document");doc=window.document.implementation.createHTMLDocument("inert");var docElement=doc.documentElement||doc.getDocumentElement(),bodyElements=docElement.getElementsByTagName("body");if(1===bodyElements.length)inertBodyElement=bodyElements[0];else{var html=doc.createElement("html");inertBodyElement=doc.createElement("body"),html.appendChild(inertBodyElement),doc.appendChild(html)}}(window)}function sanitizeText(chars){var buf=[],writer=htmlSanitizeWriter(buf,noop);return writer.chars(chars),buf.join("")}var bind,extend,forEach,isDefined,lowercase,noop,htmlParser,htmlSanitizeWriter,$sanitizeMinErr=angular.$$minErr("$sanitize");angular.module("ngSanitize",[]).provider("$sanitize",$SanitizeProvider),angular.module("ngSanitize").filter("linky",["$sanitize",function($sanitize){var LINKY_URL_REGEXP=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/i,MAILTO_REGEXP=/^mailto:/i,linkyMinErr=angular.$$minErr("linky"),isDefined=angular.isDefined,isFunction=angular.isFunction,isObject=angular.isObject,isString=angular.isString;return function(text,target,attributes){function addText(text){text&&html.push(sanitizeText(text))}function addLink(url,text){var key,linkAttributes=attributesFn(url);html.push("<a ");for(key in linkAttributes)html.push(key+'="'+linkAttributes[key]+'" ');!isDefined(target)||"target"in linkAttributes||html.push('target="',target,'" '),html.push('href="',url.replace(/"/g,"&quot;"),'">'),addText(text),html.push("</a>")}if(null==text||""===text)return text;if(!isString(text))throw linkyMinErr("notstring","Expected string but received: {0}",text);for(var match,url,i,attributesFn=isFunction(attributes)?attributes:isObject(attributes)?function(){return attributes}:function(){return{}},raw=text,html=[];match=raw.match(LINKY_URL_REGEXP);)url=match[0],match[2]||match[4]||(url=(match[3]?"http://":"mailto:")+url),i=match.index,addText(raw.substr(0,i)),addLink(url,match[0].replace(MAILTO_REGEXP,"")),raw=raw.substring(i+match[0].length);return addText(raw),$sanitize(html.join(""))}}])}(window,window.angular),function(window,angular){"use strict";function $$CookieWriter($document,$log,$browser){function buildCookieString(name,value,options){var path,expires;options=options||{},expires=options.expires,path=angular.isDefined(options.path)?options.path:cookiePath,angular.isUndefined(value)&&(expires="Thu, 01 Jan 1970 00:00:00 GMT",value=""),angular.isString(expires)&&(expires=new Date(expires));var str=encodeURIComponent(name)+"="+encodeURIComponent(value);str+=path?";path="+path:"",str+=options.domain?";domain="+options.domain:"",str+=expires?";expires="+expires.toUTCString():"",str+=options.secure?";secure":"";var cookieLength=str.length+1;return cookieLength>4096&&$log.warn("Cookie '"+name+"' possibly not set or overflowed because it was too large ("+cookieLength+" > 4096 bytes)!"),str}var cookiePath=$browser.baseHref(),rawDocument=$document[0];return function(name,value,options){rawDocument.cookie=buildCookieString(name,value,options)}}angular.module("ngCookies",["ng"]).provider("$cookies",[function(){function calcOptions(options){return options?angular.extend({},defaults,options):defaults}var defaults=this.defaults={};this.$get=["$$cookieReader","$$cookieWriter",function($$cookieReader,$$cookieWriter){return{get:function(key){return $$cookieReader()[key]},getObject:function(key){var value=this.get(key);return value?angular.fromJson(value):value},getAll:function(){return $$cookieReader()},put:function(key,value,options){$$cookieWriter(key,value,calcOptions(options))},putObject:function(key,value,options){this.put(key,angular.toJson(value),options)},remove:function(key,options){$$cookieWriter(key,void 0,calcOptions(options))}}}]}]),angular.module("ngCookies").factory("$cookieStore",["$cookies",function($cookies){return{get:function(key){return $cookies.getObject(key)},put:function(key,value){$cookies.putObject(key,value)},remove:function(key){$cookies.remove(key)}}}]),$$CookieWriter.$inject=["$document","$log","$browser"],angular.module("ngCookies").provider("$$cookieWriter",function(){this.$get=$$CookieWriter})}(window,window.angular),function(angular){var mod=angular.module("route-segment",[]);mod.provider("$routeSegment",["$routeProvider",function $routeSegmentProvider($routeProvider){function camelCase(name){return name.replace(/([\:\-\_]+(.))/g,function(_,separator,letter,offset){return offset?letter.toUpperCase():letter})}function pointer(segment,parent){if(!segment)throw new Error("Invalid pointer segment");var lastAddedName;return{segment:function(name,params){return segment[camelCase(name)]={name:name,params:params},lastAddedName=name,this},within:function(childName){var child;if(childName=childName||lastAddedName,child=segment[camelCase(childName)])void 0==child.children&&(child.children={});else{if(options.strictMode)throw new Error("Cannot get into unknown `"+childName+"` segment");child=segment[camelCase(childName)]={params:{},children:{}}}return pointer(child.children,this)},up:function(){return parent},root:function(){return rootPointer}}}var $routeSegmentProvider=this,options=$routeSegmentProvider.options={autoLoadTemplates:!0,strictMode:!1},segments=this.segments={},rootPointer=pointer(segments,null),segmentRoutes={};$routeSegmentProvider.when=function(path,name,route){return void 0==route&&(route={}),route.segment=name,$routeProvider.when(path,route),segmentRoutes[name]=path,this},angular.extend($routeSegmentProvider,rootPointer),this.$get=["$rootScope","$q","$http","$templateCache","$route","$routeParams","$injector",function($rootScope,$q,$http,$templateCache,$route,$routeParams,$injector){function isDependenciesChanged(segment){var result=!1;return segment.params.dependencies&&angular.forEach(segment.params.dependencies,function(name){angular.equals($routeSegment.$routeParams[name],$routeParams[name])||(result=!0)}),result}function updateSegment(index,segment){return $routeSegment.chain[index]&&$routeSegment.chain[index].clearWatcher&&$routeSegment.chain[index].clearWatcher(),segment?(resolvingSemaphoreChain[index]=segment.name,segment.params.untilResolved?resolve(index,segment.name,segment.params.untilResolved).then(function(result){return void 0!=result.success&&broadcast(index),resolve(index,segment.name,segment.params)}):resolve(index,segment.name,segment.params)):(resolvingSemaphoreChain[index]=null,void broadcast(index))}function resolve(index,name,params){var locals=angular.extend({},params.resolve);return angular.forEach(locals,function(value,key){locals[key]=angular.isString(value)?$injector.get(value):$injector.invoke(value)}),params.template&&(locals.$template=params.template,angular.isFunction(locals.$template)&&(locals.$template=$injector.invoke(locals.$template))),options.autoLoadTemplates&&params.templateUrl&&(locals.$template=params.templateUrl,angular.isFunction(locals.$template)&&(locals.$template=$injector.invoke(locals.$template)),locals.$template=$http.get(locals.$template,{cache:$templateCache}).then(function(response){return response.data})),$q.all(locals).then(function(resolvedLocals){if(resolvingSemaphoreChain[index]!=name)return $q.reject();if($routeSegment.chain[index]={name:name,params:params,locals:resolvedLocals,reload:function(){var originalSegment=getSegmentInChain(index,$routeSegment.name.split("."));updateSegment(index,originalSegment).then(function(result){void 0!=result.success&&broadcast(index)})}},params.watcher){var getWatcherValue=function(){if(!angular.isFunction(params.watcher)&&!angular.isArray(params.watcher))throw new Error("Watcher is not a function in segment `"+name+"`");return $injector.invoke(params.watcher,{},{segment:$routeSegment.chain[index]})},lastWatcherValue=getWatcherValue();$routeSegment.chain[index].clearWatcher=$rootScope.$watch(getWatcherValue,function(value){value!=lastWatcherValue&&(lastWatcherValue=value,$routeSegment.chain[index].reload())})}return{success:index}},function(error){if(params.resolveFailed){var newResolve={error:function(){return $q.when(error)}};return resolve(index,name,angular.extend({resolve:newResolve},params.resolveFailed))}throw new Error("Resolving failed with a reason `"+error+"`, but no `resolveFailed` provided for segment `"+name+"`")})}function broadcast(index){$routeSegment.$routeParams=angular.copy($routeParams),$routeSegment.name="";for(var i=0;i<$routeSegment.chain.length;i++)$routeSegment.chain[i]&&($routeSegment.name+=$routeSegment.chain[i].name+".");$routeSegment.name=$routeSegment.name.substr(0,$routeSegment.name.length-1),$rootScope.$broadcast("routeSegmentChange",{index:index,segment:$routeSegment.chain[index]||null})}function getSegmentInChain(segmentIdx,segmentNameChain){if(!segmentNameChain)return null;if(segmentIdx>=segmentNameChain.length)return null;for(var nextName,curSegment=segments,i=0;i<=segmentIdx;i++)nextName=segmentNameChain[i],void 0!=curSegment[camelCase(nextName)]&&(curSegment=curSegment[camelCase(nextName)]),i<segmentIdx&&(curSegment=curSegment.children);return{name:nextName,params:curSegment.params,children:curSegment.children}}var $routeSegment={name:"",$routeParams:angular.copy($routeParams),chain:[],startsWith:function(val){var regexp=new RegExp("^"+val);return regexp.test($routeSegment.name)},contains:function(val){for(var i=0;i<this.chain.length;i++)if(this.chain[i]&&this.chain[i].name==val)return!0;return!1},getSegmentUrl:function(segmentName,routeParams){var url,i,m;if(!segmentRoutes[segmentName])throw new Error("Can not get URL for segment with name `"+segmentName+"`");routeParams=angular.extend({},$routeParams,routeParams||{}),url=segmentRoutes[segmentName];for(i in routeParams){var regexp=new RegExp(":"+i+"[*?]?","g");url=url.replace(regexp,routeParams[i])}if(url=url.replace(/\/\:.*?\?/g,""),m=url.match(/\/\:([^\/]*)/))throw new Error("Route param `"+m[1]+"` is not specified for route `"+segmentRoutes[segmentName]+"`");return url}},resolvingSemaphoreChain={};return $rootScope.$on("$routeChangeSuccess",function(event,args){var route=args.$route||args.$$route;if(route&&route.segment){for(var segmentName=route.segment,segmentNameChain=segmentName.split("."),updates=[],lastUpdateIndex=-1,i=0;i<segmentNameChain.length;i++){var newSegment=getSegmentInChain(i,segmentNameChain);(resolvingSemaphoreChain[i]!=newSegment.name||updates.length>0||isDependenciesChanged(newSegment))&&($routeSegment.chain[i]&&$routeSegment.chain[i].name==newSegment.name&&0==updates.length&&!isDependenciesChanged(newSegment)?resolvingSemaphoreChain[i]=newSegment.name:(updates.push({index:i,newSegment:newSegment}),lastUpdateIndex=i))}var curSegmentPromise=$q.when();if(updates.length>0)for(var i=0;i<updates.length;i++)!function(i){curSegmentPromise=curSegmentPromise.then(function(){return updateSegment(updates[i].index,updates[i].newSegment)}).then(function(result){if(void 0!=result.success){broadcast(result.success);for(var j=updates[i].index+1;j<$routeSegment.chain.length;j++)$routeSegment.chain[j]&&($routeSegment.chain[j].clearWatcher&&$routeSegment.chain[j].clearWatcher(),$routeSegment.chain[j]=null,updateSegment(j,null))}})}(i);curSegmentPromise.then(function(){if($routeSegment.chain.length>segmentNameChain.length){var oldLength=$routeSegment.chain.length,shortenBy=$routeSegment.chain.length-segmentNameChain.length;$routeSegment.chain.splice(-shortenBy,shortenBy);for(var i=segmentNameChain.length;i<oldLength;i++)updateSegment(i,null),lastUpdateIndex=$routeSegment.chain.length-1}}).then(function(){var defaultChildUpdatePromise=$q.when();if(lastUpdateIndex==$routeSegment.chain.length-1)for(var curSegment=getSegmentInChain(lastUpdateIndex,$routeSegment.name.split("."));curSegment;){var children=curSegment.children,index=lastUpdateIndex+1;curSegment=null;for(var i in children)!function(i,children,index){children[i].params.default&&(defaultChildUpdatePromise=defaultChildUpdatePromise.then(function(){return updateSegment(index,{name:children[i].name,params:children[i].params}).then(function(result){result.success&&broadcast(result.success)})}),curSegment=children[i],lastUpdateIndex=index)}(i,children,index)}return defaultChildUpdatePromise})}}),$routeSegment}]}]),mod.filter("routeSegmentUrl",["$routeSegment",function($routeSegment){var filter=function(segmentName,params){return $routeSegment.getSegmentUrl(segmentName,params)};return filter.$stateful=!0,filter}]),mod.filter("routeSegmentEqualsTo",["$routeSegment",function($routeSegment){var filter=function(value){return $routeSegment.name==value};return filter.$stateful=!0,filter}]),mod.filter("routeSegmentStartsWith",["$routeSegment",function($routeSegment){var filter=function(value){return $routeSegment.startsWith(value)};return filter.$stateful=!0,filter}]),mod.filter("routeSegmentContains",["$routeSegment",function($routeSegment){var filter=function(value){return $routeSegment.contains(value)};return filter.$stateful=!0,filter}]),mod.filter("routeSegmentParam",["$routeSegment",function($routeSegment){var filter=function(value){return $routeSegment.$routeParams[value]};return filter.$stateful=!0,filter}])}(angular),function(angular){angular.module("view-segment",["route-segment"]).directive("appViewSegment",["$route","$compile","$controller","$routeParams","$routeSegment","$q","$injector","$timeout","$animate",function($route,$compile,$controller,$routeParams,$routeSegment,$q,$injector,$timeout,$animate){return{restrict:"ECA",priority:400,transclude:"element",compile:function(tElement,tAttrs){return function($scope,element,attrs,ctrl,$transclude){function clearContent(){previousLeaveAnimation&&($animate.cancel(previousLeaveAnimation),previousLeaveAnimation=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&(previousLeaveAnimation=$animate.leave(currentElement),previousLeaveAnimation&&previousLeaveAnimation.then(function(){previousLeaveAnimation=null}),currentElement=null)}function update(segment){currentSegment=segment;var newScope=$scope.$new(),clone=$transclude(newScope,function(clone){segment&&clone.data("viewSegment",segment),$animate.enter(clone,null,currentElement||element),clearContent()});currentElement=clone,currentScope=newScope,currentScope.$emit("$viewContentLoaded"),currentScope.$eval(onloadExp)}var currentScope,currentElement,updatePromise,previousLeaveAnimation,currentSegment={},onloadExp=tAttrs.onload||"",viewSegmentIndex=parseInt(tAttrs.appViewSegment);$routeSegment.chain[viewSegmentIndex]?updatePromise=$timeout(function(){update($routeSegment.chain[viewSegmentIndex])},0):update(),$scope.$on("routeSegmentChange",function(event,args){updatePromise&&$timeout.cancel(updatePromise),args.index==viewSegmentIndex&&currentSegment!=args.segment&&update(args.segment)})}}}}]),angular.module("view-segment").directive("appViewSegment",["$route","$compile","$controller",function($route,$compile,$controller){return{restrict:"ECA",priority:-400,link:function($scope,element){var segment=element.data("viewSegment")||{},locals=angular.extend({},segment.locals),template=locals&&locals.$template;template&&element.html(template);var link=$compile(element.contents());if(segment.params&&segment.params.controller){locals.$scope=$scope;var controller=$controller(segment.params.controller,locals);segment.params.controllerAs&&($scope[segment.params.controllerAs]=controller),element.data("$ngControllerController",controller),element.children().data("$ngControllerController",controller)}link($scope)}}}])}(angular),angular.module("ui.jq",[]).value("uiJqConfig",{}).directive("uiJq",["uiJqConfig","$timeout",function(uiJqConfig,$timeout){return{restrict:"A",compile:function(tElm,tAttrs){if(!angular.isFunction(tElm[tAttrs.uiJq]))throw new Error('ui-jq: The "'+tAttrs.uiJq+'" function does not exist');var options=uiJqConfig&&uiJqConfig[tAttrs.uiJq];return function(scope,elm,attrs){function callPlugin(){$timeout(function(){elm[attrs.uiJq].apply(elm,linkOptions)},0,!1)}var linkOptions=[];attrs.uiOptions?(linkOptions=scope.$eval("["+attrs.uiOptions+"]"),angular.isObject(options)&&angular.isObject(linkOptions[0])&&(linkOptions[0]=angular.extend({},options,linkOptions[0]))):options&&(linkOptions=[options]),attrs.ngModel&&elm.is("select,input,textarea")&&elm.bind("change",function(){elm.trigger("input")}),attrs.uiRefresh&&scope.$watch(attrs.uiRefresh,function(){callPlugin()}),callPlugin()}}}}]),angular.module("ui.event",[]).directive("uiEvent",["$parse",function($parse){return function($scope,elm,attrs){var events=$scope.$eval(attrs.uiEvent);angular.forEach(events,function(uiEvent,eventName){var fn=$parse(uiEvent);elm.bind(eventName,function(evt){var params=Array.prototype.slice.call(arguments);params=params.splice(1),fn($scope,{$event:evt,$params:params}),$scope.$$phase||$scope.$apply()})})}}]),angular.module("ui.validate",[]).directive("uiValidate",function(){return{restrict:"A",require:"ngModel",link:function(scope,elm,attrs,ctrl){function apply_watch(watch){return angular.isString(watch)?void scope.$watch(watch,function(){angular.forEach(validators,function(validatorFn){validatorFn(ctrl.$modelValue)})}):angular.isArray(watch)?void angular.forEach(watch,function(expression){scope.$watch(expression,function(){angular.forEach(validators,function(validatorFn){validatorFn(ctrl.$modelValue)})})}):void(angular.isObject(watch)&&angular.forEach(watch,function(expression,validatorKey){angular.isString(expression)&&scope.$watch(expression,function(){validators[validatorKey](ctrl.$modelValue)}),angular.isArray(expression)&&angular.forEach(expression,function(intExpression){scope.$watch(intExpression,function(){validators[validatorKey](ctrl.$modelValue)})})}))}var validateFn,validators={},validateExpr=scope.$eval(attrs.uiValidate);validateExpr&&(angular.isString(validateExpr)&&(validateExpr={validator:validateExpr}),angular.forEach(validateExpr,function(exprssn,key){validateFn=function(valueToValidate){var expression=scope.$eval(exprssn,{$value:valueToValidate});return angular.isObject(expression)&&angular.isFunction(expression.then)?(expression.then(function(){ctrl.$setValidity(key,!0)},function(){ctrl.$setValidity(key,!1)}),valueToValidate):expression?(ctrl.$setValidity(key,!0),valueToValidate):(ctrl.$setValidity(key,!1),valueToValidate)},validators[key]=validateFn,ctrl.$formatters.push(validateFn),ctrl.$parsers.push(validateFn)}),attrs.uiValidateWatch&&apply_watch(scope.$eval(attrs.uiValidateWatch)))}}}),angular.module("ui.mask",[]).value("uiMaskConfig",{maskDefinitions:{9:/\d/,A:/[a-zA-Z]/,"*":/[a-zA-Z0-9]/}}).directive("uiMask",["uiMaskConfig","$parse",function(maskConfig,$parse){return{priority:100,require:"ngModel",restrict:"A",compile:function(){var options=maskConfig;return function(scope,iElement,iAttrs,controller){function initialize(maskAttr){return angular.isDefined(maskAttr)?(processRawMask(maskAttr),maskProcessed?(initializeElement(),bindEventListeners(),!0):uninitialize()):uninitialize()}function initPlaceholder(placeholderAttr){angular.isDefined(placeholderAttr)&&(maskPlaceholder=placeholderAttr,maskProcessed&&eventHandler())}function formatter(fromModelValue){return maskProcessed?(value=unmaskValue(fromModelValue||""),isValid=validateValue(value),controller.$setValidity("mask",isValid),isValid&&value.length?maskValue(value):void 0):fromModelValue}function parser(fromViewValue){return maskProcessed?(value=unmaskValue(fromViewValue||""),isValid=validateValue(value),controller.$viewValue=value.length?maskValue(value):"",controller.$setValidity("mask",isValid),""===value&&iAttrs.required&&controller.$setValidity("required",!1),isValid?value:void 0):fromViewValue}function uninitialize(){return maskProcessed=!1,unbindEventListeners(),angular.isDefined(originalPlaceholder)?iElement.attr("placeholder",originalPlaceholder):iElement.removeAttr("placeholder"),angular.isDefined(originalMaxlength)?iElement.attr("maxlength",originalMaxlength):iElement.removeAttr("maxlength"),iElement.val(controller.$modelValue),controller.$viewValue=controller.$modelValue,!1}function initializeElement(){value=oldValueUnmasked=unmaskValue(controller.$modelValue||""),valueMasked=oldValue=maskValue(value),isValid=validateValue(value);var viewValue=isValid&&value.length?valueMasked:"";iAttrs.maxlength&&iElement.attr("maxlength",2*maskCaretMap[maskCaretMap.length-1]),iElement.attr("placeholder",maskPlaceholder),iElement.val(viewValue),controller.$viewValue=viewValue}function bindEventListeners(){eventsBound||(iElement.bind("blur",blurHandler),iElement.bind("mousedown mouseup",mouseDownUpHandler),iElement.bind("input keyup click focus",eventHandler),eventsBound=!0)}function unbindEventListeners(){eventsBound&&(iElement.unbind("blur",blurHandler),iElement.unbind("mousedown",mouseDownUpHandler),iElement.unbind("mouseup",mouseDownUpHandler),iElement.unbind("input",eventHandler),iElement.unbind("keyup",eventHandler),iElement.unbind("click",eventHandler),iElement.unbind("focus",eventHandler),eventsBound=!1)}function validateValue(value){return!value.length||value.length>=minRequiredLength}function unmaskValue(value){var valueUnmasked="",maskPatternsCopy=maskPatterns.slice();return value=value.toString(),angular.forEach(maskComponents,function(component){value=value.replace(component,"")}),angular.forEach(value.split(""),function(chr){maskPatternsCopy.length&&maskPatternsCopy[0].test(chr)&&(valueUnmasked+=chr,maskPatternsCopy.shift())}),valueUnmasked}function maskValue(unmaskedValue){var valueMasked="",maskCaretMapCopy=maskCaretMap.slice();return angular.forEach(maskPlaceholder.split(""),function(chr,i){unmaskedValue.length&&i===maskCaretMapCopy[0]?(valueMasked+=unmaskedValue.charAt(0)||"_",unmaskedValue=unmaskedValue.substr(1),maskCaretMapCopy.shift()):valueMasked+=chr}),valueMasked}function getPlaceholderChar(i){var placeholder=iAttrs.placeholder;return"undefined"!=typeof placeholder&&placeholder[i]?placeholder[i]:"_"}function getMaskComponents(){return maskPlaceholder.replace(/[_]+/g,"_").replace(/([^_]+)([a-zA-Z0-9])([^_])/g,"$1$2_$3").split("_")}function processRawMask(mask){var characterCount=0;if(maskCaretMap=[],maskPatterns=[],maskPlaceholder="","string"==typeof mask){minRequiredLength=0;var isOptional=!1,splitMask=mask.split("");angular.forEach(splitMask,function(chr,i){linkOptions.maskDefinitions[chr]?(maskCaretMap.push(characterCount),maskPlaceholder+=getPlaceholderChar(i),maskPatterns.push(linkOptions.maskDefinitions[chr]),characterCount++,isOptional||minRequiredLength++):"?"===chr?isOptional=!0:(maskPlaceholder+=chr,characterCount++)})}maskCaretMap.push(maskCaretMap.slice().pop()+1),maskComponents=getMaskComponents(),maskProcessed=maskCaretMap.length>1}function blurHandler(){oldCaretPosition=0,oldSelectionLength=0,isValid&&0!==value.length||(valueMasked="",iElement.val(""),scope.$apply(function(){controller.$setViewValue("")}))}function mouseDownUpHandler(e){"mousedown"===e.type?iElement.bind("mouseout",mouseoutHandler):iElement.unbind("mouseout",mouseoutHandler)}function mouseoutHandler(){oldSelectionLength=getSelectionLength(this),iElement.unbind("mouseout",mouseoutHandler)}function eventHandler(e){e=e||{};var eventWhich=e.which,eventType=e.type;if(16!==eventWhich&&91!==eventWhich){var valMasked,val=iElement.val(),valOld=oldValue,valUnmasked=unmaskValue(val),valUnmaskedOld=oldValueUnmasked,valAltered=!1,caretPos=getCaretPosition(this)||0,caretPosOld=oldCaretPosition||0,caretPosDelta=caretPos-caretPosOld,caretPosMin=maskCaretMap[0],caretPosMax=maskCaretMap[valUnmasked.length]||maskCaretMap.slice().shift(),selectionLenOld=oldSelectionLength||0,isSelected=getSelectionLength(this)>0,wasSelected=selectionLenOld>0,isAddition=val.length>valOld.length||selectionLenOld&&val.length>valOld.length-selectionLenOld,isDeletion=val.length<valOld.length||selectionLenOld&&val.length===valOld.length-selectionLenOld,isSelection=eventWhich>=37&&eventWhich<=40&&e.shiftKey,isKeyLeftArrow=37===eventWhich,isKeyBackspace=8===eventWhich||"keyup"!==eventType&&isDeletion&&caretPosDelta===-1,isKeyDelete=46===eventWhich||"keyup"!==eventType&&isDeletion&&0===caretPosDelta&&!wasSelected,caretBumpBack=(isKeyLeftArrow||isKeyBackspace||"click"===eventType)&&caretPos>caretPosMin;if(oldSelectionLength=getSelectionLength(this),!isSelection&&(!isSelected||"click"!==eventType&&"keyup"!==eventType)){if("input"===eventType&&isDeletion&&!wasSelected&&valUnmasked===valUnmaskedOld){for(;isKeyBackspace&&caretPos>caretPosMin&&!isValidCaretPosition(caretPos);)caretPos--;for(;isKeyDelete&&caretPos<caretPosMax&&maskCaretMap.indexOf(caretPos)===-1;)caretPos++;var charIndex=maskCaretMap.indexOf(caretPos);valUnmasked=valUnmasked.substring(0,charIndex)+valUnmasked.substring(charIndex+1),valAltered=!0}for(valMasked=maskValue(valUnmasked),oldValue=valMasked,oldValueUnmasked=valUnmasked,iElement.val(valMasked),valAltered&&scope.$apply(function(){controller.$setViewValue(valUnmasked)}),isAddition&&caretPos<=caretPosMin&&(caretPos=caretPosMin+1),caretBumpBack&&caretPos--,caretPos=caretPos>caretPosMax?caretPosMax:caretPos<caretPosMin?caretPosMin:caretPos;!isValidCaretPosition(caretPos)&&caretPos>caretPosMin&&caretPos<caretPosMax;)caretPos+=caretBumpBack?-1:1;(caretBumpBack&&caretPos<caretPosMax||isAddition&&!isValidCaretPosition(caretPosOld))&&caretPos++,oldCaretPosition=caretPos,setCaretPosition(this,caretPos)}}}function isValidCaretPosition(pos){return maskCaretMap.indexOf(pos)>-1}function getCaretPosition(input){if(!input)return 0;if(void 0!==input.selectionStart)return input.selectionStart;if(document.selection){input.focus();var selection=document.selection.createRange();return selection.moveStart("character",input.value?-input.value.length:0),selection.text.length}return 0}function setCaretPosition(input,pos){if(!input)return 0;if(0!==input.offsetWidth&&0!==input.offsetHeight)if(input.setSelectionRange)input.focus(),input.setSelectionRange(pos,pos);else if(input.createTextRange){var range=input.createTextRange();range.collapse(!0),range.moveEnd("character",pos),range.moveStart("character",pos),range.select()}}function getSelectionLength(input){return input?void 0!==input.selectionStart?input.selectionEnd-input.selectionStart:document.selection?document.selection.createRange().text.length:0:0}var maskCaretMap,maskPatterns,maskPlaceholder,maskComponents,minRequiredLength,value,valueMasked,isValid,oldValue,oldValueUnmasked,oldCaretPosition,oldSelectionLength,maskProcessed=!1,eventsBound=!1,originalPlaceholder=iAttrs.placeholder,originalMaxlength=iAttrs.maxlength,linkOptions={};iAttrs.uiOptions?(linkOptions=scope.$eval("["+iAttrs.uiOptions+"]"),angular.isObject(linkOptions[0])&&(linkOptions=function(original,current){for(var i in original)Object.prototype.hasOwnProperty.call(original,i)&&(current[i]?angular.extend(current[i],original[i]):current[i]=angular.copy(original[i]));return current}(options,linkOptions[0]))):linkOptions=options,iAttrs.$observe("uiMask",initialize),iAttrs.$observe("placeholder",initPlaceholder);var modelViewValue=!1;iAttrs.$observe("modelViewValue",function(val){"true"===val&&(modelViewValue=!0)}),scope.$watch(iAttrs.ngModel,function(val){if(modelViewValue&&val){var model=$parse(iAttrs.ngModel);model.assign(scope,controller.$viewValue)}}),controller.$formatters.push(formatter),controller.$parsers.push(parser),iElement.bind("mousedown mouseup",mouseDownUpHandler),Array.prototype.indexOf||(Array.prototype.indexOf=function(searchElement){if(null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if(0===len)return-1;var n=0;if(arguments.length>1&&(n=Number(arguments[1]),
n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=len)return-1;for(var k=n>=0?n:Math.max(len-Math.abs(n),0);k<len;k++)if(k in t&&t[k]===searchElement)return k;return-1})}}}}]),function(window,angular,undefined){"use strict";angular.module("ui.sortable",[]).value("uiSortableConfig",{}).directive("uiSortable",["uiSortableConfig","$timeout","$log",function(uiSortableConfig,$timeout,$log){return{require:"?ngModel",scope:{ngModel:"=",uiSortable:"="},link:function(scope,element,attrs,ngModel){function combineCallbacks(first,second){return second&&"function"==typeof second?function(){first.apply(this,arguments),second.apply(this,arguments)}:first}function getSortableWidgetInstance(element){var data=element.data("ui-sortable");return data&&"object"==typeof data&&"ui-sortable"===data.widgetFullName?data:null}function hasSortingHelper(element,ui){var helperOption=element.sortable("option","helper");return"clone"===helperOption||"function"==typeof helperOption&&ui.item.sortable.isCustomHelperUsed()}function isFloating(item){return/left|right/.test(item.css("float"))||/inline|table-cell/.test(item.css("display"))}function getElementScope(elementScopes,element){for(var result=null,i=0;i<elementScopes.length;i++){var x=elementScopes[i];if(x.element[0]===element[0]){result=x.scope;break}}return result}function afterStop(e,ui){ui.item.sortable._destroy()}var savedNodes,opts={},directiveOpts={"ui-floating":undefined},callbacks={receive:null,remove:null,start:null,stop:null,update:null},wrappers={helper:null};return angular.extend(opts,directiveOpts,uiSortableConfig,scope.uiSortable),angular.element.fn&&angular.element.fn.jquery?(ngModel?(scope.$watch("ngModel.length",function(){$timeout(function(){getSortableWidgetInstance(element)&&element.sortable("refresh")},0,!1)}),callbacks.start=function(e,ui){if("auto"===opts["ui-floating"]){var siblings=ui.item.siblings(),sortableWidgetInstance=getSortableWidgetInstance(angular.element(e.target));sortableWidgetInstance.floating=isFloating(siblings)}ui.item.sortable={model:ngModel.$modelValue[ui.item.index()],index:ui.item.index(),source:ui.item.parent(),sourceModel:ngModel.$modelValue,cancel:function(){ui.item.sortable._isCanceled=!0},isCanceled:function(){return ui.item.sortable._isCanceled},isCustomHelperUsed:function(){return!!ui.item.sortable._isCustomHelperUsed},_isCanceled:!1,_isCustomHelperUsed:ui.item.sortable._isCustomHelperUsed,_destroy:function(){angular.forEach(ui.item.sortable,function(value,key){ui.item.sortable[key]=undefined})}}},callbacks.activate=function(e,ui){savedNodes=element.contents();var placeholder=element.sortable("option","placeholder");if(placeholder&&placeholder.element&&"function"==typeof placeholder.element){var phElement=placeholder.element();phElement=angular.element(phElement);var excludes=element.find('[class="'+phElement.attr("class")+'"]:not([ng-repeat], [data-ng-repeat])');savedNodes=savedNodes.not(excludes)}var connectedSortables=ui.item.sortable._connectedSortables||[];connectedSortables.push({element:element,scope:scope}),ui.item.sortable._connectedSortables=connectedSortables},callbacks.update=function(e,ui){if(!ui.item.sortable.received){ui.item.sortable.dropindex=ui.item.index();var droptarget=ui.item.parent();ui.item.sortable.droptarget=droptarget;var droptargetScope=getElementScope(ui.item.sortable._connectedSortables,droptarget);ui.item.sortable.droptargetModel=droptargetScope.ngModel,element.sortable("cancel")}hasSortingHelper(element,ui)&&!ui.item.sortable.received&&"parent"===element.sortable("option","appendTo")&&(savedNodes=savedNodes.not(savedNodes.last())),savedNodes.appendTo(element),ui.item.sortable.received&&(savedNodes=null),ui.item.sortable.received&&!ui.item.sortable.isCanceled()&&scope.$apply(function(){ngModel.$modelValue.splice(ui.item.sortable.dropindex,0,ui.item.sortable.moved)})},callbacks.stop=function(e,ui){!ui.item.sortable.received&&"dropindex"in ui.item.sortable&&!ui.item.sortable.isCanceled()?scope.$apply(function(){ngModel.$modelValue.splice(ui.item.sortable.dropindex,0,ngModel.$modelValue.splice(ui.item.sortable.index,1)[0])}):"dropindex"in ui.item.sortable&&!ui.item.sortable.isCanceled()||hasSortingHelper(element,ui)||savedNodes.appendTo(element),savedNodes=null},callbacks.receive=function(e,ui){ui.item.sortable.received=!0},callbacks.remove=function(e,ui){"dropindex"in ui.item.sortable||(element.sortable("cancel"),ui.item.sortable.cancel()),ui.item.sortable.isCanceled()||scope.$apply(function(){ui.item.sortable.moved=ngModel.$modelValue.splice(ui.item.sortable.index,1)[0]})},wrappers.helper=function(inner){return inner&&"function"==typeof inner?function(e,item){var innerResult=inner.apply(this,arguments);return item.sortable._isCustomHelperUsed=item!==innerResult,innerResult}:inner},scope.$watch("uiSortable",function(newVal){var sortableWidgetInstance=getSortableWidgetInstance(element);sortableWidgetInstance&&angular.forEach(newVal,function(value,key){return key in directiveOpts?("ui-floating"!==key||value!==!1&&value!==!0||(sortableWidgetInstance.floating=value),void(opts[key]=value)):(callbacks[key]?("stop"===key&&(value=combineCallbacks(value,function(){scope.$apply()}),value=combineCallbacks(value,afterStop)),value=combineCallbacks(callbacks[key],value)):wrappers[key]&&(value=wrappers[key](value)),opts[key]=value,void element.sortable("option",key,value))})},!0),angular.forEach(callbacks,function(value,key){opts[key]=combineCallbacks(value,opts[key]),"stop"===key&&(opts[key]=combineCallbacks(opts[key],afterStop))})):$log.info("ui.sortable: ngModel not provided!",element),void element.sortable(opts)):void $log.error("ui.sortable: jQuery should be included before AngularJS!")}}}])}(window,window.angular),function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";require("./module"),require("./directives"),require("./services")},{"./directives":50,"./module":59,"./services":61}],2:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/f-block-resizer.html",'\n<div class="blocks">\n    <div class="column-block" ng-repeat="x in $ctrl.range($ctrl.maxWidth)">\n        <div class="row-block" ng-repeat="y in $ctrl.range($ctrl.maxHeight)"\n            ng-class="{\n                \'selected\': x < $ctrl.width && y < $ctrl.height,\n                \'hover\': x <= $ctrl.includedX && y <= $ctrl.includedY\n            }"\n            ng-click="$ctrl.clickBlock(x, y)"\n            ng-mouseenter="$ctrl.mouseOver(x, y)">\n        </div>\n    </div>\n</div>\n\n<div class="size-label">\n    {{$ctrl.widthLabel()}} x {{$ctrl.heightLabel()}}\n</div>\n')}]),module.exports="/FTNT_SHARED/ng/directives/f-block-resizer.html"},{}],3:[function(require,module,exports){"use strict";function BlockResizer($scope,$element){this.mouseOver(-1,-1),$element.on("mouseleave",function(){$scope.$apply(function(){this.mouseOver(-1,-1)}.bind(this))}.bind(this))}require("./f-block-resizer.html");var ngModule=require("../module");BlockResizer.prototype.mouseOver=function(x,y){this.includedX=x,this.includedY=y},BlockResizer.prototype.clickBlock=function(x,y){this.mouseOver(-1,-1),this.onClick({width:x+1,height:y+1})},BlockResizer.prototype.widthLabel=function(){return this.includedX+1||Math.min(this.width,this.maxWidth)},BlockResizer.prototype.heightLabel=function(){return this.includedY+1||Math.min(this.height,this.maxHeight)},BlockResizer.prototype.range=function(value){for(var result=[],i=0;i<value;)result.push(i),i++;return result},ngModule.component("fBlockResizer",{templateUrl:"/FTNT_SHARED/ng/directives/f-block-resizer.html",bindings:{maxWidth:"<",maxHeight:"<",width:"<",height:"<",onClick:"&"},controller:BlockResizer})},{"../module":59,"./f-block-resizer.html":2}],4:[function(require,module,exports){"use strict";var ngModule=require("../module");ngModule.directive("fChart",function(){return{restrict:"A",scope:{params:"=fChart",resizing:"<?"},link:function(scope,elem){var chart=new Chart({element:elem});scope.$watchGroup(["params","params.data"],function(scopeParams){scopeParams[0]?chart.update(scopeParams[0],!0):chart.update({data:null})}),scope.$watch(function(){return{width:elem.width(),height:elem.height()}},function(dimensions){dimensions.height&&dimensions.width&&chart.check_needs_redraw()},!0),scope.$on("fChartSizeChangeStart",function(){chart.toggle_resizing(!0)}),scope.$on("fChartSizeChangeEnd",function(){chart.toggle_resizing(!1)}),scope.$watch("resizing",function(value){"boolean"==typeof value&&chart.toggle_resizing(value)}),chart.redraw_on_window_resize(!0),scope.$on("$destroy",function(){chart.redraw_on_window_resize(!1)})}}})},{"../module":59}],5:[function(require,module,exports){"use strict";var ngModule=require("../module");ngModule.directive("fCopyable",function(){return{restrict:"A",link:function(scope,element,attrs){if("INPUT"!==element[0].tagName)throw new Error("Copying from "+element[0].tagName+"is not implemented");attrs.$observe("fCopyable",function(expr){scope.$eval(expr,{$copyable:{element:element[0]}})})}}})},{"../module":59}],6:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/f-dashboard-widget.html",'<div class="widget-header">\n    <div class="widget-title" ng-transclude="title" ng-class="{disabled: $ctrl.disabled}"></div>\n    <div class="widget-controls">\n        <div ng-transclude="extra"></div>\n        <button type="button" class="button bare expansion-pinned-control"\n            title="{{::\'Expand & pin hidden content\' | lang}}"\n            ng-class="{primary: $ctrl._expansionPinned}"\n            ng-disabled="$ctrl.isZoomed"\n            ng-click="$ctrl.pinExpansion()">\n            <div class="flex-button-content">\n                <f-icon class="fa-thumb-tack"></f-icon>\n            </div>\n        </button>\n        <button type="button" class="button bare" ng-if="$ctrl.supportsZoom"\n            ng-class="{primary: $ctrl.isZoomed}" ng-click="$ctrl.toggleZoom()">\n            <f-icon class="ftnt-full-screen"></f-icon>\n        </button>\n        <button type="button" class="button bare" ng-disabled="$ctrl.isZoomed"\n            f-pop-up-menu-toggle="$ctrl.controlMenu" no-toggle-icon>\n            <f-icon class="fa-ellipsis-v"></f-icon>\n        </button>\n        <div f-pop-up-menu="$ctrl.controlMenu">\n            <div f-menu-item-submenu="$ctrl.sizeMenu">\n                <f-icon class="fa-arrows"></f-icon>\n                <span>{{::\'Resize\' | lang}}</span>\n            </div>\n            <div f-pop-up-menu="$ctrl.sizeMenu">\n                <f-block-resizer max-width="$ctrl.maxWidth"\n                    max-height="$ctrl.dashboardController.fixed ? $ctrl.maxHeight : 1"\n                    width="$ctrl.realizedWidth"\n                    height="$ctrl.realizedHeight"\n                    on-click="$ctrl.updateSize(width, height)">\n                </f-block-resizer>\n            </div>\n\n            <div f-menu-item-button ng-show="$ctrl.hasSettings" ng-click="$ctrl.onSettings({widget: $ctrl.widgetModel})">\n                <f-icon class="fa-cog"></f-icon>\n                <span>{{::\'Settings\' | lang}}</span>\n            </div>\n\n            <div class="separator" ng-show="$ctrl.columnSpanOptions.length > 1 || $ctrl.hasSettings">\n            </div>\n\n            <div f-menu-item-button ng-if="!$ctrl.permanent" click="$ctrl.remove()">\n                <f-icon class="fa-times"></f-icon>\n                <span>{{::\'Remove\' | lang}}</span>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class="widget-content-container" ng-class="{\'widget-loading\': $ctrl.loading, disabled: $ctrl.disabled}">\n    <div class="widget-loading-indication flex-centered">\n        <f-icon class="fa-loading icon-xxl"></f-icon>\n    </div>\n    <div class="widget-content" ng-transclude="content"></div>\n    <div class="overflow-indication">\n        <f-icon class="fa-angle-down"></f-icon>\n    </div>\n</div>\n<div class="widget-absolute" ng-class="{\'widget-loading\': $ctrl.loading}"\n    ng-transclude="absolute">\n</div>\n')}]),module.exports="/FTNT_SHARED/ng/directives/f-dashboard-widget.html"},{}],7:[function(require,module,exports){"use strict";function DashboardWidget($scope,$element,$timeout){var deregisterLoadingWatch;this._$scope=$scope,this._$element=$element,this._$contentContainer=$element.find(".widget-content-container"),this._$content=$element.find(".widget-content"),this._$timeout=$timeout,this._headerHover=!1,this._contentContainerHeight=null,this._contentHeight=null,this._isExpanded=!1,this._expansionPinned=!1,this.isZoomed=!1,this._verifyBindings(),this._setupHeaderHover(),this._setupContentExpansion(),this._setupSupportedDimensionsWatch(),deregisterLoadingWatch=$scope.$watch("$ctrl.loading",function(loading){loading||(this.dashboardController.widgetFinishedLoading(this.widgetModel.getID()),deregisterLoadingWatch())}.bind(this)),this.dashboardWidget=this}require("./f-dashboard-widget.html");var ngModule=require("../module");DashboardWidget.prototype.remove=function(){this.dashboardController.removeWidget(this.widgetModel.getID())},DashboardWidget.prototype.updateSize=function(width,height){this.sizeMenu.hide(),this.controlMenu.hide(),this.dashboardController.updateWidgetSize(this.widgetModel.getID(),width,height)},DashboardWidget.prototype.toggleZoom=function(){this.isZoomed?this.dashboardController.stopZooming():(this._expandContent(),this.dashboardController.zoomWidget(this.widgetModel.getID()),this._headerHover=!1),this.isZoomed=this.isZoomed=!this.isZoomed},DashboardWidget.prototype._verifyBindings=function(){if(!this.widgetModel)throw new Error("widgetModel not provided.")},DashboardWidget.prototype._setupSupportedDimensionsWatch=function(){this._$scope.$watchGroup(["$ctrl.widgetModel.getWidth()","$ctrl.widgetModel.getHeight()","$ctrl.dashboardController._numColumns","$ctrl.dashboardController._numRowsInView"],function(results){var width=results[0],height=results[1],numColumns=results[2],numRows=results[3];width>numColumns&&(width=numColumns),height>numColumns&&(height=numColumns),this.realizedWidth=width,this.realizedHeight=height,this.maxWidth=numColumns,this.maxHeight=numRows}.bind(this))},DashboardWidget.prototype._setupHeaderHover=function(){var $header=this._$element.find(".widget-header");$header.on("mouseover",function(){this.isZoomed||this._$scope.$apply(function(){this._headerHover=!0}.bind(this))}.bind(this)),$header.on(".widget-header").on("mouseleave",function(){this.isZoomed||this._$scope.$apply(function(){this._headerHover=!1}.bind(this))}.bind(this)),this._$scope.$watchGroup(["$ctrl._headerHover","$ctrl.dashboardController.currentDraggingID"],function(values){var headerHover=values[0],currentDraggingID=values[1],hint=headerHover||this.widgetModel.getID()===currentDraggingID;this._$element.toggleClass("header-hover",hint)}.bind(this))},DashboardWidget.prototype._expandContent=function(shouldPin){var currentHeight;!this._isExpanded&&this._contentHeight>this._contentContainerHeight&&(currentHeight=this._$contentContainer.height(),this._$element.removeClass("overflowing").addClass("grow-vertically"),ftnt_shared.animation.toAutoHeightVerticalExpand(this._$contentContainer[0],currentHeight),this._isExpanded=!0),this._isExpanded&&!this._expansionPinned&&shouldPin&&(this._expansionPinned=!0,this._$element.addClass("expansion-pinned"),this._$timeout(function(){this.dashboardController.expandedPinnedID=this.widgetModel.getID()}.bind(this)))},DashboardWidget.prototype._setOverflowCSS=function(){this._$element.removeClass("grow-vertically").removeClass("expansion-pinned"),this._$element.toggleClass("overflowing",this._contentHeight>this._contentContainerHeight)},DashboardWidget.prototype._collapseContent=function(evenIfPinned,immediately){var done=function(){this._$contentContainer.css("height",""),this._setOverflowCSS(),this._isExpanded=!1,this._expansionPinned&&this.dashboardController.expandedPinnedID===this.widgetModel.getID()&&this._$timeout(function(){this.dashboardController.expandedPinnedID=null}.bind(this)),this._expansionPinned=!1}.bind(this);!this._isExpanded||this._expansionPinned&&!evenIfPinned||(immediately?done():ftnt_shared.animation.fromAutoHeightVerticalShrink(this._$contentContainer[0],this._contentContainerHeight).then(done))},DashboardWidget.prototype._setupContentExpansion=function(){var expand=!1,debouncedExpand=ftnt_shared.util.debounce(500,function(){expand&&this._expandContent()}.bind(this));this._$scope.$watch(function(){return{contentHeight:this._$content.height(),containerHeight:this._$contentContainer.height()}}.bind(this),function(result){this._isExpanded||this.isZoomed||(this._contentHeight=result.contentHeight,this._contentContainerHeight=result.containerHeight,this._setOverflowCSS())}.bind(this),!0),this._$contentContainer.on("mouseover",function(){this.isZoomed||(expand=!0,debouncedExpand())}.bind(this)),this._$contentContainer.on("mouseleave",function(){this.isZoomed||(expand=!1,this._collapseContent())}.bind(this)),this._$scope.$watchGroup(["$ctrl.dashboardController.currentDraggingID","$ctrl.dashboardController.expandedPinnedID"],function(values){var currentDraggingID=values[0],expandedPinnedID=values[1];this._expansionPinned&&(currentDraggingID||expandedPinnedID!==this.widgetModel.getID())&&this._collapseContent(!0,null!=currentDraggingID)}.bind(this)),this._$scope.$on("resizingDashboardWidget",function(){this._expansionPinned&&this._collapseContent(!0,!0)}.bind(this))},DashboardWidget.prototype.pinExpansion=function(){this._expansionPinned?this._collapseContent(!0):this._expandContent(!0)},ngModule.component("fDashboardWidget",{templateUrl:"/FTNT_SHARED/ng/directives/f-dashboard-widget.html",transclude:{extra:"?extraControls",title:"widgetTitle",content:"widgetContent",absolute:"?widgetAbsolute"},bindings:{dashboardWidget:"=?",widgetModel:"<",minWidth:"<",minHeight:"<",hasSettings:"<",onSettings:"&",loading:"<",supportsZoom:"<",disabled:"<disabledWidget",permanent:"<"},require:{dashboardController:"^fDashboard"},controller:DashboardWidget})},{"../module":59,"./f-dashboard-widget.html":6}],8:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/f-dashboard.html",'<div class="flex-centered loading-indication"\n    ng-class="{\'dashboard-invisible\': !$ctrl.loading, masking: $ctrl.loading && $ctrl._initialized}">\n    <f-icon class="fa-loading icon-xxl"></f-icon>\n</div>\n\n<div class="flex-centered no-widgets" ng-if="!$ctrl.loading && $ctrl._initialized && $ctrl._numWidgets === 0">\n    {{::\'No widgets\' | lang}}\n</div>\n\n<div class="controls-mask masking" ng-if="$ctrl.showControls"></div>\n\n<div class="module-container dashboard-invisible"\n    ng-class="{\'dashboard-invisible\': !$ctrl._initialized, loading: $ctrl.loading}">\n    <ul class="module-list" ng-class="{\'dragging\': $ctrl.currentDraggingID}">\n        <li class="position-highlight">\n            <div class="widget-drop-target"></div>\n        </li>\n    </ul>\n</div>\n\n<div class="dashboard-controls" ng-transclude="controls"\n    ng-class="{\'dashboard-hidden\': !$ctrl._controlsVisible && !$ctrl.showControls}">\n</div>\n')}]),module.exports="/FTNT_SHARED/ng/directives/f-dashboard.html"},{}],9:[function(require,module,exports){"use strict";function Dashboard($scope,$element,$attrs,$compile,$window,$timeout,DashboardWidgetModel){this._id=ftnt_shared.util.uniqueID();var $win=angular.element($window),resizeEvent="resize.dashboard."+this._id;this._$scope=$scope,this._$element=$element,this._$compile=$compile,this._$timeout=$timeout,this._DashboardWidgetModel=DashboardWidgetModel,this._initialized=!1,this._widgets={},this._numWidgets=0,this._$moduleContainer=$element.find(".module-container"),this._$moduleList=$element.find(".module-list"),this._gridList=null,this._numColumns=null,this._numRowsInView=null,this._actualWidgetSize=null,this._widthHeightRatio=null,this._controlsVisible=!1,this._mouseMoveTimeout=null,this._zoomedWidgetID=null,this._zoomedWidgetPreviousStyle=null,this._moduleListPreviousStyle=null,this.currentDraggingID=null,this.expandedPinnedID=null,this._setupWatches(),this._setupDragListeners(),this._setupMouseMoveTimeout(),$win.on(resizeEvent,ftnt_shared.util.debounce(1e3,function(){this._initialized&&!this._zoomedWidgetID&&$scope.$apply(function(){this._reinstantiateGrid()}.bind(this))}.bind(this))),$scope.$on("$destroy",function(){$win.off(resizeEvent)}),this.dashboard=this}require("./f-dashboard.html");var ngModule=require("../module"),WIDGET_SPACING=10,DEFAULT_WIDGET_SIZE=300,DEFAULT_FIXED_COLUMNS=4,FADE_CONTROLS_TIMEOUT=2e3,WIDGET_ID_ATTRIBUTE="data-widget-id";Dashboard.prototype.addWidget=function(widgetModel){if(!(widgetModel instanceof this._DashboardWidgetModel))throw new Error('"widgetModel" must be an instance of "DashboardWidgetModel"');var id=widgetModel.getID(),scope=this._$scope.$new(!0),widget=document.createElement(widgetModel.getComponentTag()),element=document.createElement("li");scope.id=id,scope.widgetModel=widgetModel,widget.setAttribute("widget-model","::widgetModel"),element.setAttribute(WIDGET_ID_ATTRIBUTE,id),element.classList.add("just-added"),element.appendChild(widget),this._widgets[id]={scope:scope,element:element,linkFunction:this._$compile(element),widgetModel:widgetModel},this._setWidgetDimensionAttributes(this._widgets[id]),this._numWidgets++,this._$moduleList.append(element),this._initialized&&(this._reinstantiateGrid(),this._linkWidget(id))},Dashboard.prototype.getFirstAvailablePosition=function(widgetWidth,widgetHeight){var x,y,startX,valid,key,occupiedSet,startY=0,maxX=this._numColumns-1;if(!this.fixed)return{x:this._numWidgets,y:0};for(occupiedSet=this._getGridPositionsState().occupiedSet;;){for(startX=0;startX<=maxX;startX++){valid=!0;attempt:for(y=startY;y<startY+widgetHeight;y++)for(x=startX;x<startX+widgetWidth;x++)if(key=x+":"+y,x>maxX||occupiedSet.has(key)){valid=!1;break attempt}if(valid)return{x:startX,y:startY}}startY++}},Dashboard.prototype._convertRelativeToActual=function(relative){return Math.ceil(relative*(this.widgetSize||DEFAULT_WIDGET_SIZE)/(this._actualWidgetSize-WIDGET_SPACING))},Dashboard.prototype.convertRelativeWidgetWidthToActual=function(relativeWidth){return this._convertRelativeToActual(relativeWidth)},Dashboard.prototype.convertRelativeWidgetHeightToActual=function(relativeHeight){return this._convertRelativeToActual(relativeHeight)},Dashboard.prototype.setWidgets=function(widgetModels){Array.isArray(widgetModels)&&(Object.keys(this._widgets).forEach(function(id){this._destroyWidget(id)}.bind(this)),this._initialized||this._resetLayout(),this._reorderWidgetModels(widgetModels).forEach(function(widgetModel){this.addWidget(widgetModel)}.bind(this)),this._initialized||this._initialize())},Dashboard.prototype.removeWidget=function(id){var widget=this._getWidget(id);this._destroyWidget(id),this.onWidgetRemoved({widget:widget.widgetModel})},Dashboard.prototype.reinstantiateWidget=function(id,modelData){var widgetModel=this._getWidget(id).widgetModel;modelData&&widgetModel.extendModelData(modelData),this._destroyWidget(id),this.addWidget(widgetModel)},Dashboard.prototype.widgetFinishedLoading=function(id){var widget=this._getWidget(id);this._$timeout(function(){widget.element.classList.remove("just-added")},!1)},Dashboard.prototype.zoomWidget=function(id){var moduleListElement=this._$moduleList[0];this._zoomedWidgetID=id,this._moduleListPreviousStyle=moduleListElement.getAttribute("style"),moduleListElement.setAttribute("style","height: 100%;"),this._$moduleList.children(".ui-draggable").draggable("disable"),Object.keys(this._widgets).forEach(function(widgetID){var widget=this._widgets[widgetID];widgetID===this._zoomedWidgetID?(this._zoomedWidgetPreviousStyle=widget.element.getAttribute("style"),widget.element.setAttribute("style",""),widget.element.classList.add("zoomed-widget","frontmost-widget")):widget.element.classList.add("non-zoomed-widget")}.bind(this)),this._resizingChartsForTransition()},Dashboard.prototype.stopZooming=function(){Object.keys(this._widgets).forEach(function(widgetID){var widget=this._widgets[widgetID];widgetID===this._zoomedWidgetID?(widget.element.classList.remove("zoomed-widget"),widget.element.setAttribute("style",this._zoomedWidgetPreviousStyle),widget.element.style.zIndex="",this._onWidgetTransitionComplete(widget,function(){widget.element.classList.remove("frontmost-widget")})):widget.element.classList.remove("non-zoomed-widget")}.bind(this)),this._resizingChartsForTransition(),this._$moduleList[0].setAttribute("style",this._moduleListPreviousStyle),this._moduleListPreviousStyle=null,this._zoomedWidgetID=null,this._zoomedWidgetPreviousStyle=null,this._$moduleList.children(".ui-draggable").draggable("enable")},Dashboard.prototype._resizeWidget=function(widget){var width=widget.widgetModel.getWidth(),height=this.fixed?widget.widgetModel.getHeight():1;this._$scope.$broadcast("resizingDashboardWidget"),this._scaleWidget(widget),this._$moduleList.gridList("resizeItem",widget.element,{w:width,h:height}),this._resizingChartsForTransition(widget)},Dashboard.prototype._updateRelativeWidgetDimensions=function(widget){var width=widget.widgetModel.getWidth(),height=widget.widgetModel.getHeight();widget.widgetModel.updateRelativeWidth(this._widgetDimensionToRelative(width)),widget.widgetModel.updateRelativeHeight(this._widgetDimensionToRelative(height,!0))},Dashboard.prototype.updateWidgetSize=function(id,width,height){var widget=this._getWidget(id);widget.widgetModel.updateWidth(width),widget.widgetModel.updateHeight(height),this._updateRelativeWidgetDimensions(widget),this._resizeWidget(widget)},Dashboard.prototype._initialize=function(){this._createGridList(),this.fixed&&this._doesCollisionExist()&&this._resizeGrid(),this._linkAllWidgets(),this._$timeout(function(){this._initialized=!0}.bind(this))},Dashboard.prototype._notifyChartsResizing=function(resizing){var event=resizing?"fChartSizeChangeStart":"fChartSizeChangeEnd";Object.keys(this._widgets).forEach(function(widgetID){var widget=this._widgets[widgetID];widget.scope.$broadcast(event)}.bind(this))},Dashboard.prototype._resetLayout=function(){var containerBoundingRect,widgetWithSpacing,containerHeight,containerWidth,extra,extraPerwidget;this._$moduleContainer[0].style.height=null,this._$moduleContainer[0].style.width=null,containerBoundingRect=this._$moduleContainer[0].getBoundingClientRect(),containerHeight=containerBoundingRect.height-WIDGET_SPACING,containerWidth=containerBoundingRect.width-WIDGET_SPACING,this.fixed?(this._numColumns=this.fixedColumns||DEFAULT_FIXED_COLUMNS,widgetWithSpacing=Math.floor(containerWidth/this._numColumns),this._numRowsInView=Math.round(containerHeight/widgetWithSpacing),0===this._numRowsInView?(this._numRowsInView=1,this._widthHeightRatio=1):(extra=containerHeight-widgetWithSpacing*this._numRowsInView+1,extraPerwidget=extra/this._numRowsInView,this._widthHeightRatio=1/((widgetWithSpacing+extraPerwidget)/widgetWithSpacing)),this._actualWidgetSize=widgetWithSpacing):(widgetWithSpacing=(this.widgetSize||DEFAULT_WIDGET_SIZE)+WIDGET_SPACING,this._numColumns=Math.floor(containerWidth/widgetWithSpacing),extra=containerWidth-widgetWithSpacing*this._numColumns,extraPerwidget=extra/this._numColumns,this._widthHeightRatio=(widgetWithSpacing+extraPerwidget)/widgetWithSpacing,this._actualWidgetSize=widgetWithSpacing+extraPerwidget,this._nextX=0,this._nextY=0)},Dashboard.prototype._setupWatches=function(){var deregisterInitialWatch;this._$scope.$watchGroup(["$ctrl.fixed","$ctrl.fixedColumns","$ctrl.widgetSize"],function(){this._initialized&&this._reinstantiateGrid()}.bind(this)),deregisterInitialWatch=this._$scope.$watch("$ctrl.initialWidgets",function(widgets){!this._initialized&&widgets&&Array.isArray(widgets)&&(this.setWidgets(widgets),deregisterInitialWatch())}.bind(this))},Dashboard.prototype._getAndUpdateWidgetsFromGridItems=function(gridItems){var widgets=[];return gridItems.forEach(function(item,index){var widgetModel,widgetID=item.$element[0].getAttribute(WIDGET_ID_ATTRIBUTE),widget=this._widgets[widgetID];widget&&(widgetModel=widget.widgetModel,widgetModel.updateWidth(item.w),widgetModel.updateHeight(this.fixed?item.h:1),this.fixed?(widgetModel.updateXPosition(item.x),widgetModel.updateYPosition(item.y)):(widgetModel.updateXPosition(index),widgetModel.updateYPosition(0)),widgets.push(widget))}.bind(this)),widgets},Dashboard.prototype._getGridPositionsState=function(){var i,x,y,widgetModel,startX,startY,width,height,key,widgetIDs=Object.keys(this._widgets),occupied=new Set,collisionExists=!1,maxX=this._numColumns-1;for(i=0;i<widgetIDs.length;i++)for(widgetModel=this._widgets[widgetIDs[i]].widgetModel,startX=widgetModel.getXPosition(),startY=widgetModel.getYPosition(),width=widgetModel.getWidth(),height=widgetModel.getHeight(),y=startY;y<startY+height;y++)for(x=startX;x<startX+width;x++)x>maxX&&(collisionExists=!0),key=x+":"+y,occupied.has(key)?collisionExists=!0:occupied.add(key);return{occupiedSet:occupied,collisionExists:collisionExists}},Dashboard.prototype._doesCollisionExist=function(){return this._getGridPositionsState().collisionExists},Dashboard.prototype._getAndUpdateWidgetsFromResponsiveOrder=function(){var gridItems=[];return this._gridList.gridList.grid.forEach(function(row){var previousID;row.forEach(function(item){var id;item&&(id=item.$element[0].getAttribute(WIDGET_ID_ATTRIBUTE),id!==previousID&&(gridItems.push(item),previousID=id))})}),this._getAndUpdateWidgetsFromGridItems(gridItems)},Dashboard.prototype._widgetDimensionToRelative=function(value,isHeight){var ratioAdjust=isHeight?1/this._widthHeightRatio:1;return(this._actualWidgetSize*value*ratioAdjust-WIDGET_SPACING)/(this.widgetSize||DEFAULT_WIDGET_SIZE)},Dashboard.prototype._scaleWidget=function(widget){var fontSize=this._widgetDimensionToRelative(widget.widgetModel.getWidth());fontSize=fontSize>=1?"100%":(100*fontSize).toFixed(2)+"%",widget.element.style.fontSize=fontSize},Dashboard.prototype._setWidgetDimensionAttributes=function(widget){var x,y,width,wantedWidth,element=widget.element,widgetModel=widget.widgetModel;this.fixed?(element.setAttribute("data-w",widgetModel.getWidth()),element.setAttribute("data-h",widgetModel.getHeight()),element.setAttribute("data-x",widgetModel.getXPosition()||0),element.setAttribute("data-y",widgetModel.getYPosition()||0)):(wantedWidth=widgetModel.getWidth(),width=wantedWidth>this._numColumns?this._numColumns:wantedWidth,this._nextX+width<=this._numColumns?(x=this._nextX,y=this._nextY):(x=0,y=this._nextY+1),element.setAttribute("data-w",width),element.setAttribute("data-h",1),element.setAttribute("data-x",x),element.setAttribute("data-y",y),this._nextX=x+width,this._nextY=y),this._scaleWidget(widget),this._updateRelativeWidgetDimensions(widget)},Dashboard.prototype._getWidget=function(id){var widget=this._widgets[id];if(!widget)throw new Error('No widget with id "'+id+'" is registered.');return widget},Dashboard.prototype._destroyWidget=function(id){var widget=this._getWidget(id);widget.element.parentElement.removeChild(widget.element),widget.scope.$destroy(),delete this._widgets[id],
this._numWidgets--},Dashboard.prototype._reinstantiateGrid=function(){var widgetModels=Object.keys(this._widgets).map(function(id){return this._widgets[id].widgetModel}.bind(this));this._resetLayout(),this._reorderWidgetModels(widgetModels).forEach(function(widgetModel){var id=widgetModel.getID(),widget=this._widgets[id];this._setWidgetDimensionAttributes(widget)}.bind(this)),this._createGridList(),this.fixed&&this._doesCollisionExist()&&this._resizeGrid(),this._resizingChartsForTransition()},Dashboard.prototype._linkWidget=function(id){var widget=this._getWidget(id);widget.linkFunction(widget.scope)},Dashboard.prototype._linkAllWidgets=function(){Object.keys(this._widgets).forEach(function(id){this._linkWidget(id)}.bind(this))},Dashboard.prototype._createGridList=function(){this._$moduleList.gridList({direction:"vertical",lanes:this._numColumns,widthHeightRatio:this._widthHeightRatio,onChange:function(changed){this._$timeout(function(){var widgets;changed.length&&(widgets=this.fixed?this._getAndUpdateWidgetsFromGridItems(changed):this._getAndUpdateWidgetsFromResponsiveOrder(),this.onWidgetsUpdated({widgets:widgets.map(function(widget){return widget.widgetModel})}))}.bind(this))}.bind(this)},{handle:".widget-header"}),this._gridList=this._$moduleList.data("_gridList")},Dashboard.prototype._resizingChartsForTransition=function(widget){this._notifyChartsResizing(!0),this._onWidgetTransitionComplete(widget,function(){this._$scope.$apply(function(){this._notifyChartsResizing(!1)}.bind(this))}.bind(this))},Dashboard.prototype._resizeGrid=function(){Object.keys(this._widgets).forEach(function(id){var widget=this._widgets[id],widgetModel=widget.widgetModel;widgetModel.getWidth()>this._numColumns&&this.updateWidgetSize(id,this._numColumns,widgetModel.getHeight())}.bind(this)),this._$moduleList.gridList("resize",this._numColumns),this._resizingChartsForTransition()},Dashboard.prototype._reorderWidgetModels=function(widgetModels){return this.fixed?widgetModels:widgetModels.slice().sort(function(a,b){return a.getXPosition()-b.getXPosition()})},Dashboard.prototype._setupDragListeners=function(){this._$moduleList.on("dragstart",function(event,ui){this._$scope.$apply(function(){this.currentDraggingID=ui.helper[0].getAttribute(WIDGET_ID_ATTRIBUTE)}.bind(this))}.bind(this)),this._$moduleList.on("dragstop",function(){this._$scope.$apply(function(){this.currentDraggingID=null}.bind(this))}.bind(this))},Dashboard.prototype._setupMouseMoveTimeout=function(){var resetTimeout=function(){this._$timeout.cancel(this._mouseMoveTimeout),this._controlsVisible||this._$scope.$apply(function(){this._controlsVisible=!0}.bind(this)),this._mouseMoveTimeout=this._$timeout(function(){this._controlsVisible&&this._$scope.$apply(function(){this._controlsVisible=!1}.bind(this))}.bind(this),FADE_CONTROLS_TIMEOUT,!1)}.bind(this),deregister=this._$scope.$watch("$ctrl._initialized",function(initialized){initialized&&(deregister(),this._$timeout(resetTimeout,0,!1))}.bind(this));this._$element[0].addEventListener("mousemove",function(){this._initialized&&resetTimeout()}.bind(this))},Dashboard.prototype._onWidgetTransitionComplete=function(widget,callback){var EVENT="transitionend",oneCompleted=!1,elements=widget?[widget.element]:Object.keys(this._widgets).map(function(id){return this._widgets[id].element}.bind(this)),onComplete=function(){oneCompleted||(elements.forEach(function(element){element.removeEventListener(EVENT,onComplete)}),oneCompleted=!0,callback())};elements.forEach(function(element){element.addEventListener(EVENT,onComplete)})},ngModule.component("fDashboard",{templateUrl:"/FTNT_SHARED/ng/directives/f-dashboard.html",bindings:{dashboard:"=?",fixed:"<",fixedColumns:"<",widgetSize:"<",onWidgetRemoved:"&",onWidgetsUpdated:"&",onReorder:"&",loading:"<?",initialWidgets:"<",showControls:"<"},transclude:{controls:"?dashboardControls"},controller:Dashboard})},{"../module":59,"./f-dashboard.html":8}],10:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/f-dialog.html",'<div ng-class="{\'loading\': dialog.loading, \'absolute\': !dialog.relative}" class="dialog"\n        ng-cloak f-scrolling id="ng-base">\n    <form method="post" ng-submit="dialog.submit($event)" name="dialog.form" novalidate autocomplete="off">\n        <div class="title-bar" ng-if="::!dialog.getHideTitle()">\n            <h1>{{dialog.getTitle()}}</h1>\n            <span ng-transclude="titleContent"></span>\n        </div>\n        <div class="content" ng-class="{\'full-height\': dialog.fullHeight}">\n            <div ng-transclude="content" ng-class=\'{"slot-filled": dialog.hasCustomDialogContent}\'></div>\n            <!-- Fall back to single transclude if individual transclude components aren\'t provided -->\n            <div ng-transclude ng-class=\'{"slot-filled": !dialog.hasCustomDialogContent}\'></div>\n        </div>\n        <div class="footer" ng-show="!dialog.getHideFooter()" ng-transclude="footer">\n            <div ng-include="dialog.getFooterTemplate()"></div>\n        </div>\n    </form>\n</div>\n')}]),module.exports="/FTNT_SHARED/ng/directives/f-dialog.html"},{}],11:[function(require,module,exports){"use strict";function FDialogConfig(){this.defaults=angular.copy(this),this.setDefaults=function(newConfig){angular.merge(this.defaults,newConfig)},this.getDefaults=function(){return this.defaults}}function Dialog($scope,fDialogConfig,$q,$attrs,fFieldConfig,$transclude){this.config=fDialogConfig.getDefaults(),this._$q=$q,this._$scope=$scope,this._$attrs=$attrs,this._fFieldConfig=fFieldConfig,this._$transclude=$transclude,this.hasCustomDialogContent=this._$transclude.isSlotFilled("titleContent")||this._$transclude.isSlotFilled("content")||this._$transclude.isSlotFilled("footer")}require("./f-dialog.html"),require("./f-dialog/ok_cancel.html"),require("./f-dialog/apply.html"),require("./f-dialog/return.html"),require("./f-dialog/close.html");var ngModule=require("../module"),TEMPLATE_URL="/FTNT_SHARED/ng/directives/f-dialog.html",FOOTER_TEMPLATE_URLS={okCancel:"/FTNT_SHARED/ng/directives/f-dialog/ok_cancel.html",apply:"/FTNT_SHARED/ng/directives/f-dialog/apply.html",return:"/FTNT_SHARED/ng/directives/f-dialog/return.html",close:"/FTNT_SHARED/ng/directives/f-dialog/close.html"};ngModule.service("fDialogConfig",FDialogConfig),FDialogConfig.prototype={dialogTitle:null,hideTitle:!1,hideFooter:!1,footerType:"okCancel",readOnly:!1,onCancel:angular.noop,buttonText:{ok:"OK",cancel:"Cancel",apply:"Apply",return:"Return",close:"Close"}},ngModule.component("fDialog",{transclude:{content:"?dialogContent",footer:"?dialogFooter",titleContent:"?titleContent"},templateUrl:TEMPLATE_URL,controllerAs:"dialog",controller:Dialog,bindings:{loading:"<",relative:"<",dialogTitle:"<",hideTitle:"<",hideFooter:"<",footerType:"<",readOnly:"<",fullHeight:"<",validSubmit:"&",outerSubmit:"&submit",outerCancel:"&?cancel",form:"=?"},require:{fSlideContainer:"?^^"}}),Dialog.prototype={getTitle:function(){var dialogTitle=this.config.dialogTitle;return null!=this.dialogTitle&&(dialogTitle=this.dialogTitle),dialogTitle},getHideTitle:function(){var hideTitle=this.config.hideTitle;return null!=this.hideTitle&&(hideTitle=this.hideTitle),hideTitle},getHideFooter:function(){var hideFooter=this.config.hideFooter;return null!=this.hideFooter&&(hideFooter=this.hideFooter),!this.hideFooter&&"apply"===this._getFooterType()&&this.getReadOnly()&&(hideFooter=!0),hideFooter},_getFooterType:function(){return this.footerType||this.config.footerType},getFooterTemplate:function(){return FOOTER_TEMPLATE_URLS[this._getFooterType()]},getReadOnly:function(){var readOnly=this.config.readOnly;return null!=this.readOnly&&(readOnly=this.readOnly),readOnly},cancel:function(){"function"==typeof this.outerCancel?this.outerCancel():"function"==typeof this.config.onCancel&&this.config.onCancel()},_doSubmit:function($event){var submit=this._$attrs.validSubmit?this.validSubmit:this.outerSubmit;if(submit===this.validSubmit&&!this.form.$valid)return void this._$scope.$broadcast(this._fFieldConfig.messages.forceValidation);var promise=submit({$event:$event});if(promise){this.submitButtonBusy=!0;var slide=this.fSlideContainer&&this.fSlideContainer.slide;promise=this._$q.when(promise).finally(function(){this.submitButtonBusy=!1}.bind(this)),slide&&promise.then(function(value){return slide.done(value)}.bind(this))}},submit:function($event){if(this.getReadOnly())return!1;if(void 0===this.form.$valid){this.submitButtonBusy=!0;var unwatch=this._$scope.$watch("dialog.form.$valid",function(valid){void 0!==valid&&(this._doSubmit($event),unwatch())}.bind(this))}else this._doSubmit($event)}}},{"../module":59,"./f-dialog.html":10,"./f-dialog/apply.html":12,"./f-dialog/close.html":13,"./f-dialog/ok_cancel.html":14,"./f-dialog/return.html":15}],12:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/f-dialog/apply.html",'<button class="primary" id="submit_apply" type="submit" ng-show="!dialog.getReadOnly()"\n        ng-class="(dialog.submitButtonBusy || submitButtonBusy) && \'busy\'"\n        ng-disabled="dialog.submitButtonBusy || submitButtonBusy">\n    <f-icon class="fa-loading busy-only"></f-icon>\n    <span>{{::dialog.config.buttonText.apply}}</span>\n</button>\n')}]),module.exports="/FTNT_SHARED/ng/directives/f-dialog/apply.html"},{}],13:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/f-dialog/close.html",'<button class="button" id="submit_return" type="button"\n        ng-click="dialog.cancel()">\n    {{::dialog.config.buttonText.close}}\n</button>\n')}]),module.exports="/FTNT_SHARED/ng/directives/f-dialog/close.html"},{}],14:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/f-dialog/ok_cancel.html",'<button class="primary" id="submit_ok" type="submit" ng-show="!dialog.getReadOnly()"\n        ng-class="(dialog.submitButtonBusy || submitButtonBusy) && \'busy\'"\n        ng-disabled="(dialog.submitButtonBusy || submitButtonBusy)">\n    <f-icon class="fa-loading busy-only"></f-icon>\n    <span>{{::dialog.config.buttonText.ok}}</span>\n</button>\n<button id="submit_cancel" type="button" ng-click="dialog.cancel()"\n        ng-show="!dialog.getReadOnly()">\n    {{::dialog.config.buttonText.cancel}}\n</button>\n<button id="submit_return" type="button" ng-click="dialog.cancel()"\n        ng-show="dialog.getReadOnly()">\n    {{::dialog.config.buttonText.return}}\n</button>\n')}]),module.exports="/FTNT_SHARED/ng/directives/f-dialog/ok_cancel.html"},{}],15:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/f-dialog/return.html",'<button class="button" id="submit_return" type="button"\n        ng-click="dialog.cancel()">\n    {{::dialog.config.buttonText.return}}\n</button>\n')}]),module.exports="/FTNT_SHARED/ng/directives/f-dialog/return.html"},{}],16:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/f-duplicate-check.html",'<div class="warning-message"\n     ng-if="$ctrl.showWarning">\n    <f-icon class="fa-warning"></f-icon>\n    <label class="message-content" ng-transclude>\n        {{ $ctrl.warningLabel }}\n        <ul>\n            <li ng-repeat="object in $ctrl.duplicates | limitTo: 10">\n                <a ng-click="$ctrl.edit(object);">\n                    <f-object-formatted mkey="{{::object.q_origin_key}}" datasource="{{::$ctrl.datasource }}"></f-object-formatted>\n                </a>\n            </li>\n        </ul>\n    </label>\n</div>')}]),module.exports="/FTNT_SHARED/ng/directives/f-duplicate-check.html"},{}],17:[function(require,module,exports){"use strict";function flatten(object){return Array.isArray(object)?object.map(flatten):object&&(object.name||object[Omniselect.prototype.ENTRY_ID_KEY])||object}function pluckKeyValues(object,keys){var result={};return Object.keys(keys).forEach(function(key){if(keys[key]){var keyFn=angular.isFunction(keys[key])&&keys[key],value=flatten(keyFn?keyFn(object,key):object[key]);null!=value&&(result[key]=value)}}),result}function pluckValues(object,keys){return Object.keys(keys).filter(function(key){return keys[key]}).map(function(key){var keyFn=angular.isFunction(keys[key])&&keys[key];return flatten(keyFn&&keyFn(object)||object[key])})}function matchObject(target,existing,keys,idKey){return Object.keys(keys).filter(function(key){return keys[key]}).every(function(key){var keyFn=angular.isFunction(keys[key])&&keys[key],targetValue=flatten(keyFn&&keyFn(target)||target[key]),existingValue=flatten(keyFn&&keyFn(existing)||existing[key]);Array.isArray(targetValue)||(targetValue=[targetValue]),Array.isArray(existingValue)||(existingValue=[existingValue]);var existingValueSet=new Set(existingValue);return targetValue.filter(function(val){return existingValueSet.has(val)}).length>0})&&(target&&target[idKey])!==existing[idKey]}function DuplicateCheck($scope,$q){this.scope=$scope,this.$q=$q,this.showWarning=!1,this.duplicates=[],this.update(this.scope)}require("./f-duplicate-check.html");var ngModule=require("../module");DuplicateCheck.prototype.update=function(scope){var that=this;return this.$q.when(Omniselect.getSourceData(this.datasource)).then(function(existingObjects){that._existingObjects={},that.sourceData=existingObjects,existingObjects.forEach(function(object){var stringified=JSON.stringify(pluckKeyValues(object,that.matchKeys)),existing=that._existingObjects[stringified];existing?that._existingObjects[stringified].push(object):that._existingObjects[stringified]=[object]}),that.watch=that.watch||scope.$watch(function(){return pluckValues(that.target,that.matchKeys)},ftnt_shared.util.debounce(500,function(){scope.$apply(function(){that.check()})}),!0)})},DuplicateCheck.prototype.check=function(){var idKey=this.idKey||Omniselect.prototype.ENTRY_ID_KEY,stringified=JSON.stringify(pluckKeyValues(this.target,this.matchKeys));this.duplicates=(this._existingObjects[stringified]||[]).filter(function(existingObject){return(this.target&&this.target[idKey])!==existingObject[idKey]}.bind(this)),this.duplicates.length||(this.duplicates=this.sourceData.filter(function(existingObject){return matchObject(this.target,existingObject,this.matchKeys,idKey)}.bind(this))),this.showWarning=!!this.duplicates.length},DuplicateCheck.prototype.edit=function(existingObject){return this.$q.when(Omniselect.inlineEdit(existingObject)).then(function(){return this.update(this.scope)}.bind(this)).then(function(){return this.check()}.bind(this))},ngModule.component("fDuplicateCheck",{templateUrl:"/FTNT_SHARED/ng/directives/f-duplicate-check.html",bindings:{target:"<",idKey:"@",datasource:"@",matchKeys:"<",duplicates:"=?",warningLabel:"@"},transclude:!0,controller:DuplicateCheck})},{"../module":59,"./f-duplicate-check.html":16}],18:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/f-field.html",'<label ng-transclude="label" for="{{ $ctrl.labelFor || $ctrl._innerId }}"></label>\n<div ng-transclude="value"></div>\n<label class="error"\n    ng-if="!$ctrl._showValidationMessage"\n    ng-repeat="m in $ctrl._validationMessages track by $index">\n    {{ m }}\n</label>')}]),module.exports="/FTNT_SHARED/ng/directives/f-field.html"},{}],19:[function(require,module,exports){"use strict";function FFieldConfig(){this.errorTranslationMap={},this.messages={}}function Field($scope,$element,$attrs,fFieldConfig,lang){this._di={config:fFieldConfig,lang:lang,$attrs:$attrs,$scope:$scope},this._validationData={},this._validationStatuses={},this._validationStatusMap=new Map,this._innerIdAttrs=new MapSequence,$scope.$watch("$ctrl.allErrors()",this._setValidationMessage.bind(this),!0),$scope.$on(fFieldConfig.messages.forceValidation,this.showValidationMessages.bind(this))}function ValidationStatus(ngModel,attrs){this.errorKey=ngModel.$name||attrs.ngModel.replace(/^\$/,"\\$"),this.id=attrs.id}function ngModel(){return{require:["ngModel","^?fField"],link:function(scope,element,attrs,ctrls){var status,model=ctrls.shift(),field=ctrls.shift();field&&(status=field._add(model,attrs),element.on("blur",function(){scope.$apply(function(){status.showMessageOnBlur&&(status.showMessage=!0)})}),scope.$on("$destroy",function(){field._remove(model,attrs)}))}}}function errAttrValue(attr){return function(){return{require:"^?fField",restrict:"A",link:function(scope,element,attrs,field){field&&attrs.$observe(attr,function(value){field.setValidationData(attr,value)})}}}}var ngModule=require("../module"),MapSequence=ftnt_shared.MapSequence;require("./f-field.html"),FFieldConfig.prototype={errorTranslationMap:null,addErrorTranslations:function(errorTranslations){angular.extend(this.errorTranslationMap,errorTranslations)},setForceValidationMessageName:function(messageName){this.messages.forceValidation=messageName}};var fField={controller:Field,templateUrl:"/FTNT_SHARED/ng/directives/f-field.html",scope:!0,transclude:{label:"?fieldLabel",value:"fieldValue"},bindings:{hideValidation:"<?",errorMessages:"<?",labelFor:"@"}};Field.prototype={_validationStatusMap:null,_validationStatuses:null,_innerIdAttrs:null,_validationMessages:null,_validationData:null,_di:null,_showValidationMessage:!1,_innerId:null,getValidationStatus:function(ngModel){return this._validationStatusMap.get(ngModel)},_add:function(ngModel,attrs){var newStatus=new ValidationStatus(ngModel,attrs),status=this._validationStatuses[newStatus.errorKey];return status||(this._validationStatuses[newStatus.errorKey]=newStatus,status=newStatus),this._validationStatusMap.set(ngModel,status),this._updateInnerId(attrs),status},_remove:function(ngModel,attrs){this._validationStatusMap.delete(ngModel),this._updateInnerId(attrs,!1)},allErrors:function(){var errors={};return this._validationStatusMap.forEach(function(status,ngModel){status.showMessage&&!status.ignoreValidation&&(errors[status.errorKey]=ngModel.$error)}),errors},_setValidationMessage:function(ctrlErrors){function translate(errorKey){return id=this.errorMessages&&this.errorMessages[errorKey]||this._di.config.errorTranslationMap[errorKey],id?this._di.lang(id,this._validationData[errorKey]):null}function notNull(value){return null!==value}var name,errors,errorKeys,id,messages=[];for(name in ctrlErrors)errors=ctrlErrors[name],errorKeys=Object.keys(errors),errorKeys.length&&(messages=messages.concat(errorKeys.map(translate.bind(this))));this._validationMessages=messages.filter(notNull)},setValidationData:function(errorKey,data){this._validationData[errorKey]=Array.isArray(data)?data:[data]},showValidationMessages:function(){this._validationStatusMap.forEach(function(status,ngModel){ngModel.$setDirty(),status.showMessage=!0})},_updateInnerId:function(attrs,remove){attrs&&(remove?this._innerIdAttrs.has(attrs)&&(this._innerIdAttrs.get(attrs)(),this._innerIdAttrs.delete(attrs)):void 0!==attrs.id&&this._innerIdAttrs.set(attrs,attrs.$observe("id",this._updateInnerId.bind(this,null,null))));var ids=this._innerIdAttrs.map(function(unobserve,attrs){return attrs.id}).filter(function(id){return null!=id}).toArray();this._innerId=1===ids.length?ids[0]:null}},ValidationStatus.prototype={errorKey:null,showMessage:!1,showMessageOnBlur:!0,ignoreValidation:!1,id:null},ngModule.directive({ngModel:ngModel,max:errAttrValue("max"),min:errAttrValue("min"),maxlength:errAttrValue("maxlength"),minlength:errAttrValue("minlength")}),ngModule.component("fField",fField),ngModule.service("fFieldConfig",FFieldConfig)},{"../module":59,"./f-field.html":18}],20:[function(require,module,exports){"use strict";var ngModule=require("../module");ngModule.directive("fFileInput",function(){return{restrict:"A",scope:{options:"<fFileInput",filesChanged:"&"},bindToController:!0,controllerAs:"$ctrl",requires:"?ngModel",controller:function($scope,$element){function changed(event){$scope.$apply(function(){this.filesChanged({$files:Array.from(event.target.files)})}.bind(this))}var options=angular.copy(this.options)||{};"fileNameLabelTextSelector"in options||(options.fileNameLabelTextSelector=null),$element.addClass("hidden");var dispose=ftnt_shared.enhanceFileInput($element[0],options);$element.on("change.fFileInput",changed.bind(this)),$scope.$on("destroy",function(){dispose(),$element.off("change.fFileInput")}),this.filesChanged({$files:Array.prototype.slice.call($element[0].files)})}}})},{"../module":59}],21:[function(require,module,exports){"use strict";function InputHighlightCtrl($element,$timeout,$route,$location,$http,$attrs){var duration=this.duration,highlight=$route.current.params.hasOwnProperty("highlight")&&$location.hash()===$attrs.id,highlightFn=function(){$http.pendingRequests.length>0?$timeout(highlightFn):$element.highlight(duration)};highlight&&highlightFn()}var ngModule=require("../module");ngModule.directive("fHighlight",function(){return{restrict:"A",scope:{duration:"="},bindToController:!0,controllerAs:"inputHighlightCtrl",controller:InputHighlightCtrl}})},{"../module":59}],22:[function(require,module,exports){"use strict";function fIpSubnet(){return{restrict:"A",require:{ngModel:"ngModel",fField:"^^?"},scope:{ipVersion:"<?",ipVersionChange:"&",noZeroSubnet:"=?"},controller:IpSubnet,bindToController:!0,controllerAs:"fIpSubnetController"}}function IpSubnet(lang){this._di={lang:lang}}function getSubnetParts(value){var IpAddress=goog.net.IpAddress,parts=value&&value.split(/[\/ ]/),addr=parts&&IpAddress.fromString(parts[0]);return{parts:parts,addr:addr,prefix:parts&&parseInt(parts[1],10),addrVersion:addr?addr.getVersion():null}}var ngModule=require("../module"),IpMask=ftnt_shared.IpMask;ngModule.directive("fIpSubnet",fIpSubnet);var VALIDATION_KEY="f-ip-subnet",VERSION_VALIDATION_KEY="f-ip-subnet-version",NOT_ZERO_VALIDATION_KEY="f-ip-subnet-zero";IpSubnet.prototype={$onInit:function(){function validateNoZeroSubnet(modelValue,viewValue){if(void 0===(modelValue||viewValue))return!0;if(!parseOrValidate(!0,modelValue,viewValue)||!validateVersion(modelValue,viewValue))return!0;var parts=getSubnetParts(modelValue||viewValue);return!ctrl.noZeroSubnet||!parts.addr||!parts.addr.toInteger().isZero()&&0!==parts.prefix}function validateVersion(modelValue,viewValue){if(setValidationData(VERSION_VALIDATION_KEY,null),parseOrValidate(!0,modelValue,viewValue)){var parts=getSubnetParts(modelValue||viewValue);return setValidationData(VERSION_VALIDATION_KEY,parts.ipVersion),!ctrl.ipVersion||!parts.addrVersion||ctrl.ipVersion===parts.addrVersion}return!0}function parseOrValidate(phase,modelValue,viewValue){var value=modelValue||viewValue,validating=phase===PHASE.VALIDATING,parts=getSubnetParts(value),fail=!validating&&null,succeed=!!validating||(value||"");if(validating&&setValidationData(VALIDATION_KEY,parts.addrVersion),ctrl.ngModel.$isEmpty(value))return succeed;if(!parts.parts||2!==parts.parts.length)return fail;if(ctrl._ipVersion!==parts.addrVersion&&ctrl.ipVersionChange({$value:parts.addrVersion}),ctrl._ipVersion=parts.addrVersion,!parts.addr)return fail;if(4===parts.addrVersion)try{value=IpMask.parse(value).fullNetwork()}catch(ex){value=fail}else 6===parts.addrVersion?(isNaN(parts.prefix)||parts.prefix<0||parts.prefix>128)&&(value=fail):value=fail;return phase!==PHASE.PARSING||validateVersion(modelValue,viewValue)&&validateNoZeroSubnet(modelValue,viewValue)||(value=fail),value}function setValidationData(validationKey,v){ctrl.fField&&ctrl.fField.setValidationData(validationKey,[v,ctrl.ipVersion,v?lang("IPv"+v):"",ctrl.ipVersion?lang("IPv"+ctrl.ipVersion):""])}var lang=this._di.lang,ctrl=this,PHASE={VALIDATING:{},FORMATTING:{},PARSING:{}};[VALIDATION_KEY,VERSION_VALIDATION_KEY].forEach(function(k){setValidationData(k,null)}),this.ngModel.$formatters.push(parseOrValidate.bind(this,PHASE.FORMATTING)),this.ngModel.$parsers.push(parseOrValidate.bind(this,PHASE.PARSING)),this.ngModel.$validators[NOT_ZERO_VALIDATION_KEY]=validateNoZeroSubnet,this.ngModel.$validators[VERSION_VALIDATION_KEY]=validateVersion,this.ngModel.$validators[VALIDATION_KEY]=parseOrValidate.bind(this,PHASE.VALIDATING)}}},{"../module":59}],23:[function(require,module,exports){"use strict";function parse_ng_repeat(expression){var ex=/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/,match=expression.match(ex),rhs=match[2],lhs=match[1];return{collection:rhs,item:lhs}}function new_collection_item(collection){var item,Constructor=collection.$constructor,factory=collection.$factory;return item=Constructor?new Constructor:factory?collection.$factory():{}}function get_expr(attr,virtualScroll){var expr=parse_ng_repeat(attr.ngRepeat);return virtualScroll&&(expr.collection=virtualScroll.collectionExpr()),expr.constraints=attr.fListEdit,expr}function fListEditItem(){function ListEditItem($scope,$element){this.buttons={},this._scope=$scope,this._$element=$element}return ListEditItem.prototype={init:function(expr,virtualScroll){if(this.expr)throw new Error("expr already set");this.expr=expr,this._scope.$watch(this.expr.collection,function(value){this.collection=value}.bind(this)),this._scope.$watch(this.expr.constraints,function(value){this.constraints=value}.bind(this),!0),this._virtualScroll=virtualScroll},addButton:function(button){return this.buttons[button.type]=button,!0},remove:function(index){if(this._virtualScroll){var sw=this._virtualScroll.scrollWindow();index+=sw.start}var evt=this._scope.$emit("list_edit_item_removing",this.collection[index],this.collection,index);evt.defaultPrevented||this.collection.splice(index,1)},can_remove:function(){return!this.constraints.min||this.collection.length>this.constraints.min},hover:function(type,active){this._$element.toggleClass("hover-"+type,active)}},{controller:ListEditItem,require:["fListEditItem","?^fVirtualScroll"],link:function(scope,elem,attr,ctrls){var ctrl=ctrls.shift(),virtualScroll=ctrls.shift();ctrl.init(get_expr(attr,virtualScroll),virtualScroll)}}}function fListEdit($log){function link(scope,elem,attr,ctrls){var collection_special,fListEditContainer=ctrls.shift(),virtualScroll=ctrls.shift(),expr=get_expr(attr,virtualScroll);fListEditContainer&&fListEditContainer.init(expr,virtualScroll),scope.$watch(expr.collection,function(value){value&&(value&&!collection_special&&(collection_special={$constructor:value.$constructor,$factory:value.$factory}),collection_special&&collection_special.$factory!==value.$factory&&(value.$factory=collection_special.$factory),collection_special&&collection_special.$constructor!==value.$constructor&&(value.$constructor=collection_special.$constructor))})}return{priority:1001,require:["?^fListEditContainer","?^fVirtualScroll"],scope:!0,compile:function(tElement,tAttrs){return tElement.addClass("f-list-edit-item"),tAttrs.ngRepeat?link:void $log.error("Unable to apply fListEdit directive, element must have ngRepeat directive as well",tElement)}}}function fListEditContainer($log,$parse){function ListEditContainer($scope){var ctrl=this;$scope.$list_edit_add=function(){},$scope.$list_edit_can_add=function(){var collection=$parse(ctrl.expr.collection)($scope),constraints=$parse(ctrl.expr.constraints)($scope)||{};return void 0===constraints.max||collection.length<constraints.max},this.buttons={},this._scope=$scope,$scope.$on("subform_auto_edit",function(event){if(!$scope.$emit("list_edit_auto_edit",this.collection).defaultPrevented){if(!ctrl.can_add)return;ctrl.add()}event.preventDefault()}.bind(this))}return ListEditContainer.prototype={init:function(expr,virtualScroll){this.expr=expr,this._scope.$watch(this.expr.collection,function(value){this.collection=value}.bind(this)),this._scope.$watch(this.expr.constraints,function(value){this.constraints=value}.bind(this),!0),this._virtualScroll=virtualScroll},addButton:function(button){this.buttons[button.type]=this.buttons[button.type]||[],this.buttons[button.type].push(button)},removeButton:function(button){var buttons=this.buttons[button.type];if(buttons){var index=buttons.indexOf(button);index>-1&&buttons.splice(index,1),buttons.length||delete this.buttons[button.type]}},add:function($event){$event&&$event.stopPropagation();var item=new_collection_item(this.collection),evt=this._scope.$emit("list_edit_item_adding",item,this.collection);evt.defaultPrevented||this.collection.push(item)},can_add:function(index,item){if(this._virtualScroll&&void 0!==index){var sw=this._virtualScroll.scrollWindow();index+=sw.start}if(!this.expr)return!1;var have_outer=this.buttons.add&&item;return this.collection&&(!have_outer||!(item&&item.can_remove()))&&(!this.constraints.max||this.collection.length<this.constraints.max)&&(void 0===index||index===this.collection.length-1)}},{controller:ListEditContainer,scope:!0,require:"fListEditContainer"}}function fListEditButton($parse,$log){function ListEditButton(){}function link(scope,elem,attr,ctrls){var container=ctrls[0],item=ctrls[1],button=ctrls[2];button.init(attr.fListEditButton,item,button),item&&item.addButton(button)||container.addButton(button),scope.$on("$destroy",function(){container.removeButton(button)}),item&&elem.on("mouseover.f-list-edit-button, mouseout.f-list-edit-button",function(event){item.hover(attr.fListEditButton,"mouseover"===event.type)}),scope.$lang=void 0===attr.noText?attr.fListEditButton:"",scope.$class=icons[attr.fListEditButton],scope.$type=attr.fListEditButton,angular.extend(scope,{$visible:function(){return button._scope_apply(this,"$list_edit_can_"+button.type,arguments)},$action:function(){return button._scope_apply(this,"$list_edit_"+button.type,arguments)},$list_edit_add:function($event){return container.add($event)},$list_edit_can_add:function(){var index=$parse("$index")(scope);return container.can_add(index,item)},$list_edit_remove:function($event){$event.stopPropagation(),$event.preventDefault();var index=$parse("$index")(scope);return item.remove(index)},$list_edit_can_remove:function(){return item&&item.can_remove()}})}var button_tmpl='<button class="f-list-edit-button" ng-click="$action($event)"      ng-class="$type" ng-show="$visible()"      type="button"   ><f-icon ng-class="$class"></f-icon><span f-lang="{{ $lang }}" ng-if="$lang"></span></button>',icons={add:"fa-plus-circle",remove:"fa-dismiss",edit:"fa-pencil"};return ListEditButton.prototype={_scope_apply:function(scope,scope_fn,args){var fn=$parse(scope_fn)(scope);return fn?fn.apply(scope,args):void $log.error("No scope function",scope_fn," f-list-edit-button type ",this.type,"is not supported")},init:function(type,item,button){this.type=type,this.item=item,this.button=button}},{controller:ListEditButton,scope:!0,template:button_tmpl,replace:!0,require:["^fListEditContainer","?^fListEditItem","fListEditButton"],link:link}}var ngModule=require("../module");ngModule.directive({fListEdit:fListEdit,fListEditItem:fListEditItem,fListEditContainer:fListEditContainer,fListEditButton:fListEditButton})},{"../module":59}],24:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){
$templateCache.put("/FTNT_SHARED/ng/directives/f-mutable-edit-sequence-grouping.html",'<f-dialog hide-title="::true" form="$ctrl.form" submit="$ctrl.submit()" cancel="$ctrl.cancel()">\n    <section>\n        <div class="field">\n            <label for="name">\n                {{::\'Sequence Grouping Name\' | lang}}\n            </label>\n            <div>\n                <input type="text" name="name" ng-model="$ctrl.label" required\n                    ng-pattern="::$ctrl.XSS_REGEX" mutable-unique-sequence-group>\n            </div>\n            <label class="error" ng-if="$ctrl.form.name.$error.pattern">\n                {{::\'Invalid characters < > ( ) # \\\' "\' | lang}}\n            </label>\n            <label class="error" ng-if="$ctrl.form.name.$error.mutableUniqueSequenceGroup">\n                {{::\'Duplicate Entry Found\' | lang}}\n            </label>\n        </div>\n    </section>\n</f-dialog>\n')}]),module.exports="/FTNT_SHARED/ng/directives/f-mutable-edit-sequence-grouping.html"},{}],25:[function(require,module,exports){"use strict";function MutableEditSequenceGrouping(slide){this.label=this.existing||"",this.slide=slide.get("editSequenceGrouping").slide}var ngModule=require("../module");require("./f-mutable-edit-sequence-grouping.html");var TEMPLATE_URL="/FTNT_SHARED/ng/directives/f-mutable-edit-sequence-grouping.html";MutableEditSequenceGrouping.prototype.XSS_REGEX=/^[^<>()#'"]*$/,MutableEditSequenceGrouping.prototype.submit=function(){this.form.$valid?this.slide.done(this.label):angular.forEach(this.form.$error,function(controls){angular.forEach(controls,function(control){control.$setDirty()})})},MutableEditSequenceGrouping.prototype.cancel=function(){this.slide.close()},ngModule.component("fMutableEditSequenceGrouping",{templateUrl:TEMPLATE_URL,bindings:{existing:"<",used:"<"},controller:MutableEditSequenceGrouping}),ngModule.directive("mutableUniqueSequenceGroup",function(){return{require:["ngModel","^fMutableEditSequenceGrouping"],link:function($scope,elem,attributes,controllers){var ngModel=controllers[0],editSequenceGrouping=controllers[1];ngModel.$validators.mutableUniqueSequenceGroup=function(modelValue){return!(!ngModel.$isEmpty(modelValue)&&modelValue!==editSequenceGrouping.existing)||!editSequenceGrouping.used.has(modelValue)}}}})},{"../module":59,"./f-mutable-edit-sequence-grouping.html":24}],26:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/f-mutable-insert-sequence-grouping.html",'<div f-menu-item-button click="$ctrl.click()" ng-if="$ctrl.isVisible()">\n    <f-icon ng-class="{\n        \'fa-plus\': $ctrl.insert,\n        \'fa-pencil\': !$ctrl.insert,\n    }"></f-icon>\n    <span ng-if="$ctrl.insert">{{::\'Insert Sequence Grouping\' | lang}}</span>\n    <span ng-if="!$ctrl.insert">{{::\'Rename Sequence Grouping\' | lang}}</span>\n</div>\n')}]),module.exports="/FTNT_SHARED/ng/directives/f-mutable-insert-sequence-grouping.html"},{}],27:[function(require,module,exports){"use strict";function MutableInsertSequenceGrouping($scope,$rootScope,slide,lang){this._$scope=$scope,this._$rootScope=$rootScope,this._slide=slide,this._lang=lang,this.row=null,this.section=null,this.insert=!0,$scope.$watch("$ctrl.menu.rowInstances",function(rows){var row;Array.isArray(rows)&&1===rows.length?(row=rows[0],this.row=row,this.section=row.section,this.insert=!this.section||!this.section.firstRow.getSequenceGroupingValue()||this.section.firstRow!==row):(this.row=null,this.section=null,this.insert=!0)}.bind(this))}var ngModule=require("../module");require("./f-mutable-insert-sequence-grouping.html");var TEMPLATE_URL="/FTNT_SHARED/ng/directives/f-mutable-insert-sequence-grouping.html";MutableInsertSequenceGrouping.prototype.isVisible=function(){var settings,section,table=this.menu&&this.menu.muTableInstance;return!(!table||(settings=table.getSettings(),!settings||!settings.customSequenceGrouping||(section=this.row&&this.row.section,section&&section.firstRow.isImplicitSequenceGrouping())))},MutableInsertSequenceGrouping.prototype.click=function(){var scope=this._$rootScope.$new(!0);scope.existing=this.insert?"":this.section.firstRow.getSequenceGroupingValue(),scope.used=this.menu.muTableInstance.getAllSectionValues(),this._slide.open("editSequenceGrouping",{template:'<f-mutable-edit-sequence-grouping existing="::existing" used="::used"></f-mutable-edit-sequence-grouping>',parentScope:scope,options:{title:this._lang(this.insert?"Insert Sequence Grouping":"Rename Sequence Grouping").toString(),fullHeight:!0}}).then(function(label){this.menu.muTableInstance.setRowSequenceGroupingValue(this.row,label)}.bind(this)).finally(function(){scope.$destroy()})},ngModule.component("fMutableInsertSequenceGrouping",{templateUrl:TEMPLATE_URL,require:{menu:"?^fPopUpMenu"},controller:MutableInsertSequenceGrouping})},{"../module":59,"./f-mutable-insert-sequence-grouping.html":26}],28:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/f-mutable-search.html",'<div class="search-container" ng-class="{\'mini-hide\': $ctrl.miniHideInput}">\n    <input type="text" class="search-input" placeholder="{{::\'Search\' | lang}}"\n        ng-model="$ctrl.searchValue" ng-keydown="$ctrl.keyDown($event)"\n        ng-blur="$ctrl.search()">\n    <f-icon class="fa-times clear-search" ng-show="$ctrl.searchValue"\n        ng-click="$ctrl.clearSearch()">\n    </f-icon>\n</div>\n<button type="button" class="do-search" ng-disabled="$ctrl.muTable.loading"\n    ng-click="$ctrl.search()">\n    <div class="flex-menu-content">\n        <f-icon ng-class="{\n            \'fa-search\': !$ctrl.searching,\n            \'fa-loading\': $ctrl.searching\n        }"></f-icon>\n    </div>\n</button>\n')}]),module.exports="/FTNT_SHARED/ng/directives/f-mutable-search.html"},{}],29:[function(require,module,exports){"use strict";function MuTableSearch($element){$element.addClass("menu-item menu-item-search"),this.lastSearch="",this.searchValue="",this.searching=!1,this.miniHideInput=!0}var ngModule=require("../module");require("./f-mutable-search.html");var TEMPLATE_URL="/FTNT_SHARED/ng/directives/f-mutable-search.html";MuTableSearch.prototype.search=function(){this.miniHideInput=!1,this.searchValue!==this.lastSearch&&(this.lastSearch=this.searchValue,this.searching=!0,this.muTable.search(this.searchValue).then(function(){this.searching=!1}.bind(this)))},MuTableSearch.prototype.clearSearch=function(){this.searchValue="",this.search()},MuTableSearch.prototype.keyDown=function(event){13===event.keyCode&&this.search()},ngModule.component("fMutableSearch",{require:{muTable:"^fMutable"},templateUrl:TEMPLATE_URL,controller:MuTableSearch})},{"../module":59,"./f-mutable-search.html":28}],30:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/f-mutable.html",'<div class="mutable-view-container" ng-class="::{inline: $ctrl.inline}">\n    <div class="mutable-menu" ng-show="$ctrl._menus.length">\n        <div f-menu-bar>\n            <f-mutable-menu-transclude menu="::menu" mutable="::$ctrl" class="menu-bar-component">\n            </f-mutable-menu-transclude>\n        </div>\n        <div f-pop-up-menu ng-if="::$ctrl.contextMenu">\n            <f-mutable-menu-transclude menu="::menu" mutable="::$ctrl">\n            </f-mutable-menu-transclude>\n        </div>\n    </div>\n</div>\n')}]),module.exports="/FTNT_SHARED/ng/directives/f-mutable.html"},{}],31:[function(require,module,exports){"use strict";function MuTableController($scope,$element,$q,$transclude,$injector){this._$scope=$scope,this._$element=$element,this._$q=$q,this._$transclude=$transclude,this._table=this.instance=new MuTable({inline:this.inline,ngScope:$scope,ngInjector:$injector}),this._menus=[],this.loading=!0}function MutableMenuTransclude($element){this._$element=$element}var ngModule=require("../module");require("./f-mutable.html");var TEMPLATE_URL="/FTNT_SHARED/ng/directives/f-mutable.html";MuTableController.prototype.$onInit=function(){if(void 0===this.contextMenu)throw new Error('"context-menu" boolean must be explicitly set');this._$element.find(".mutable-view-container").append(this._table.element),this._startWatches(),this._listenOnLoading(),this._listenOnSelectionChange(),this._listenForDoubleClick(),this._listenForContextMenu(),this._watchInlineElementWidth()},MuTableController.prototype.search=function(searchValue){return this._$q.when(this._table.search(searchValue))},MuTableController.prototype.addMenu=function(mutableMenu){if(mutableMenu instanceof MutableMenuTransclude)return function(){return mutableMenu.menu.muTableInstance=this.instance,this._menus.push(mutableMenu.menu),this._$transclude.apply(this,arguments)}.bind(this)},MuTableController.prototype._startWatches=function(){this._$scope.$watch("$ctrl.source",function(source){this._table.updateSource(source)}.bind(this)),this._$scope.$watch("$ctrl.settings",function(settings){settings&&this._table.updateSettings(settings)}.bind(this))},MuTableController.prototype._listenOnLoading=function(){this._table.onLoading(function(loading){this._$scope.$apply(function(){this.loading=loading}.bind(this))}.bind(this))},MuTableController.prototype._listenOnSelectionChange=function(){this._table.onSelectionChange(function(selection){this._$scope.$apply(function(){this._menus.forEach(function(menu){menu.entries=selection.entries,menu.lastSelectedEntry=selection.lastSelectedEntry,menu.rowInstances=selection.rows,menu.targetColumnID=selection.targetColumnID,menu.targetColumnValuePromise=selection.targetColumnValuePromise})}.bind(this))}.bind(this))},MuTableController.prototype._listenForDoubleClick=function(){this._table.onDoubleClickRow(function(){this._$scope.$apply(function(){this._menus.forEach(function(menu){menu.menuBar&&menu.triggerTableDoubleClick()})}.bind(this))}.bind(this))},MuTableController.prototype._listenForContextMenu=function(){this.contextMenu&&this._table.setContextMenuCallback(function(event){this._$scope.$apply(function(){this._menus.forEach(function(menu){menu.popUpMenu&&menu.toggle({top:event.pageY,left:event.pageX})})}.bind(this))}.bind(this))},MuTableController.prototype._watchInlineElementWidth=function(){var viewContainer;this.inline&&(viewContainer=this._$element[0].children[0],this._$scope.$watch(function(){return viewContainer.offsetWidth},function(width,previous){width&&width!==previous&&this._table.notifyParentElementWidthChange()}.bind(this)))},ngModule.component("fMutable",{bindings:{source:"<",settings:"<",inline:"<?",contextMenu:"<",instance:"=?"},transclude:!0,templateUrl:TEMPLATE_URL,controller:MuTableController}),MutableMenuTransclude.prototype.$onInit=function(){var $transclude=this.mutable.addMenu(this);$transclude(function(cloned,scope){scope.menu=this.menu,this._$element.append(cloned)}.bind(this))},ngModule.component("fMutableMenuTransclude",{bindings:{menu:"<",mutable:"<"},controller:MutableMenuTransclude})},{"../module":59,"./f-mutable.html":30}],32:[function(require,module,exports){"use strict";function fNgModelSync(){return{require:{ngModel:"ngModel",field:"?^fField"},controllerAs:"$fNgModelSync",bindToController:{host:"<fNgModelSync"},controller:NgModelSync}}function NgModelSync($attrs){this._di={$attrs:$attrs}}function ngModelSyncHostFactory($rootScope,$parse){function NgModelSyncHost(){this.targets=new SetSequence}return NgModelSyncHost.prototype={model:null,_validationStatus:null,targets:null,init:function(ngModel,validationStatus){function propertyWatchFunction(){return parsedExpr(ngModel)}function modelWatchFunction(){return this.model}function modelWatchAction(value,oldValue){value!==oldValue&&ngModel.$setViewValue(value)}if(this._validationStatus=validationStatus,$rootScope.$watch(modelWatchFunction.bind(this),modelWatchAction),ngModel.$render!==angular.noop)throw new Error("Not Implemented. Don't set ngModel.$render,  or implement this with proxy pattern if you actually need it");ngModel.$render=function(){this.model=ngModel.$modelValue}.bind(this);var expr=["error","pending","untouched","touched","pristine","dirty","valid","invalid"].map(function(property){return property+":$"+property}).join(","),parsedExpr=$parse("{"+expr+"}");$rootScope.$watch(propertyWatchFunction,this._updateTargets.bind(this),!0),validationStatus&&$rootScope.$watch(this._targetValidationStatuses.bind(this),this._updateValidationStatus.bind(this),!0)},_addTarget:function(passwordInput){this.targets.add(passwordInput),this._updateTargets()},_removeTarget:function(passwordInput){this.targets.delete(passwordInput)},_targetValidationStatuses:function(){return this.targets.map(function(t){return t.getValidationStatus()}).toArray()},_updateValidationStatus:function(statuses){function pluckShowMessage(vs){return vs.showMessage}statuses.length&&(this._validationStatus.showMessage=statuses.some(pluckShowMessage))},_updateTargets:function(properties,oldProperties){function add$(obj){return function(result,property){return result["$"+property]=obj[property],result}}function setModelValidity(ngModel,validityMap){return function(validationErrorKey){ngModel.$setValidity(validationErrorKey,!validityMap[validationErrorKey])}}var actions={$valid:"$validate",$dirty:"$setDirty",$pristine:"$setPristine",$touched:"$setTouched",$untouched:"$setUntouched"};if(properties=properties||this._currentModelProperties){this._currentModelProperties=properties;for(var i,property,ngModel,errorKeys,targets=this.targets.values(),$properties=Object.keys(properties).reduce(add$(properties),{}),$oldProperties=Object.keys(oldProperties||{}).reduce(add$(oldProperties),{$error:{}});!(i=targets.next()).done;){ngModel=i.value.ngModel,errorKeys=new Set(Object.keys(ngModel.$error).concat(Object.keys($properties.$error)).concat(Object.keys($oldProperties.$error))),Object.assign(ngModel,$properties),errorKeys.forEach(setModelValidity(ngModel,$properties.$error));for(property in actions)$properties[property]&&ngModel[actions[property]]()}}}},NgModelSyncHost}var ngModule=require("../module"),SetSequence=ftnt_shared.SetSequence;NgModelSync.prototype={$onInit:function(){this.host._addTarget(this),this.field&&(this.field._add(this.ngModel,this._di.$attrs).ignoreValidation=!0)},$onDestroy:function(){this.host._removeTarget(this)},getValidationStatus:function(){return this.field&&this.field.getValidationStatus(this.ngModel)}},ngModule.directive("fNgModelSync",fNgModelSync),ngModule.factory("NgModelSyncHost",ngModelSyncHostFactory)},{"../module":59}],33:[function(require,module,exports){"use strict";function fNumberModel(){return{restrict:"A",require:{ngModel:"ngModel"},controller:NumberModel,bindToController:!0,controllerAs:"fNumberModelController"}}function NumberModel(){}var ngModule=require("../module");ngModule.directive("fNumberModel",fNumberModel),NumberModel.prototype={$onInit:function(){this.ngModel.$parsers.push(function(value){return parseFloat(value)})}}},{"../module":59}],34:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/f-password-input.html",'<div class="input-container" ng-if="$ctrl.editing">\n    <input type="text" placeholder="{{$ctrl.placeholder}}" ng-model="$ctrl.syncHost.model"\n        id="{{$ctrl.pwId}}" f-ng-model-sync="$ctrl.syncHost"\n        name="{{$ctrl.modelName(\'-show\')}}"\n        ng-model-options="$ctrl.ngModelOptions" ng-if="$ctrl.showPassword">\n    <input type="password" placeholder="{{$ctrl.placeholder}}" ng-model="$ctrl.syncHost.model"\n        name="{{$ctrl.modelName()}}"\n        id="{{$ctrl.pwId}}" f-ng-model-sync="$ctrl.syncHost"\n        ng-model-options="$ctrl.ngModelOptions"\n        ng-if="!$ctrl.showPassword">\n</div>\n<input type="checkbox" class="visual-toggle password" ng-model="$ctrl.showPassword"\n    id="f-password-input_show_{{$ctrl.$id}}"\n    ng-if="$ctrl.editing  && $ctrl.plainTextToggle">\n<label for="f-password-input_show_{{$ctrl.$id}}"\n    ng-if="$ctrl.editing && $ctrl.plainTextToggle"></label>\n<span class="static-password" ng-if="!$ctrl.editing">••••••••</span>\n<button ng-if="!$ctrl.editing" type="button" f-lang="Change"\n    ng-click="$ctrl.editing = true" id="{{$ctrl.pwId}}"></button>')}]),module.exports="/FTNT_SHARED/ng/directives/f-password-input.html"},{}],35:[function(require,module,exports){"use strict";function PasswordInput($scope,$attrs,NgModelSyncHost){this._di={$scope:$scope,$attrs:$attrs},this.syncHost=new NgModelSyncHost,this.passwordInputs=new Set,this.$id=$scope.$id,this.ngModelOptions=angular.copy($scope.$eval($attrs.ngModelOptions))||{},this.pwId=this.pwId||"f-password-input_pw-input_"+this.$id,$scope.$watch("$ctrl.editing",function(newValue,oldValue){newValue&&!oldValue&&(this._ngModel.$setViewValue(void 0,!1),this.syncHost.model="")}.bind(this))}var ngModule=require("../module");require("./f-password-input.html"),require("./f-ng-model-sync");var fPasswordInput={controller:PasswordInput,templateUrl:"/FTNT_SHARED/ng/directives/f-password-input.html",scope:!0,require:{_ngModel:"ngModel",field:"?^fField"},bindings:{pwId:"@",editing:"=?",placeholder:"<?",showPassword:"=?",plainTextToggle:"<?"}};PasswordInput.prototype={_di:null,editing:!1,showPassword:!1,plainTextToggle:!0,modelName:function(suffix){return suffix=suffix||"",this._ngModel.$name&&this._ngModel.$name+"-password-input-show-"+suffix+this.$id},$onInit:function(){this.syncHost.init(this._ngModel,this.field&&this.field._add(this._ngModel,this._di.$attrs)),void 0===this.plainTextToggle&&delete this.plainTextToggle},$onDestroy:function(){this.field&&this.field._remove(this._ngModel,this._di.$attrs)}},ngModule.component("fPasswordInput",fPasswordInput)},{"../module":59,"./f-ng-model-sync":32,"./f-password-input.html":34}],36:[function(require,module,exports){"use strict";function SeverityProgressBar($scope){$scope.$watchGroup(["$ctrl.none","$ctrl.low","$ctrl.medium","$ctrl.high","$ctrl.critical","$ctrl.total"],function(updated){var noneCount=updated[0]||0,lowCount=updated[1]||0,mediumCount=updated[2]||0,highCount=updated[3]||0,criticalCount=updated[4]||0,totalCount=updated[5]||0,summedCount=noneCount+lowCount+mediumCount+highCount+criticalCount;this.nonePercentage=this.toCSSPercentage(noneCount,totalCount),this.lowPercentage=this.toCSSPercentage(lowCount,totalCount),this.mediumPercentage=this.toCSSPercentage(mediumCount,totalCount),this.highPercentage=this.toCSSPercentage(highCount,totalCount),this.criticalPercentage=this.toCSSPercentage(criticalCount,totalCount),this.totalPercentage=this.toCSSPercentage(summedCount,totalCount),this.displayPercentage=this.toDisplayPercentage(summedCount,totalCount)}.bind(this))}function DiscreteLevelBar(){this.bar=this.getBarInfo(this.levels,this.value)}function RiskLevelBar(){this.levels=[{name:"low",class:"level-none"},{name:"elevated",class:"level-low"},{name:"medium",class:"level-medium"},{name:"high",class:"level-high"},{name:"critical",class:"level-critical"}]}function VulnerabilityScoreBar(){this.levels=[{name:"info",class:"level-none"},{name:"low",class:"level-low"},{name:"medium",class:"level-medium"},{name:"high",class:"level-high"},{name:"critical",class:"level-critical"}]}function ThreatScoreBar(){this.levels=[{name:"low",class:"level-low"},{name:"medium",class:"level-medium"},{name:"high",class:"level-high"},{name:"critical",class:"level-critical"}]}function ThreatFormatter(){var LEVEL_MAP={1:"low",2:"medium",3:"high",4:"critical"};this.levelValue=LEVEL_MAP[this.entry.level]||"none"}var ngModule=require("../module"),pbDirectiveConfig={restrict:"A",scope:{percentage:"=fProgressBar",showPercentage:"="},template:'<div class="progress-bar-value" ng-style="{width: normalizedPercentage}"></div><div class="progress-bar-label" ng-show="showPercentage" ng-style="{width: normalizedPercentage}"><span>{{normalizedPercentage}}</span></div>',link:function(scope,element){element.addClass("progress-bar"),scope.normalizedPercentage="";var normalizePercentage=function(){var value=scope.percentage;isNaN(value)?scope.normalizedPercentage="0%":(value<0&&(value=0),value>100&&(value=100),value=Math.round(value),scope.normalizedPercentage=value+"%")};scope.$watch("percentage",normalizePercentage),normalizePercentage()}};ngModule.directive("fProgressBar",function(){return angular.copy(pbDirectiveConfig)}),ngModule.directive("fResourceBar",function(){function curvedBlend(input,exponent){exponent=exponent||6;var output=Math.pow(input,exponent);return Math.min(1,Math.max(0,output))}var dc=angular.copy(pbDirectiveConfig);return dc.scope=angular.extend({},dc.scope,{percentage:"=fResourceBar"}),dc.template='<div class="resource-bar-base" ng-style="{width: normalizedPercentage}"></div><div class="resource-bar-mid" ng-style="{width: normalizedPercentage, opacity: midBlend}"></div><div class="resource-bar-limit" ng-style="{width: normalizedPercentage, opacity: limitBlend}"></div>'+dc.template,dc.link=function(scope,element){element.addClass("resource-bar"),pbDirectiveConfig.link.apply(this,arguments),scope.$watch("percentage",function(value){var curveMid=1-curvedBlend(.5,4),unitValue=value/100,midDistance=curveMid-unitValue;unitValue>curveMid?(scope.limitBlend=Math.abs(midDistance)/(1-curveMid),scope.midBlend=1):(scope.midBlend=curvedBlend(1-midDistance),scope.limitBlend=0)})},dc}),SeverityProgressBar.prototype._toPercentage=function(current,total){return 100*(current/total||0)},SeverityProgressBar.prototype.toCSSPercentage=function(current,total){return this._toPercentage(current,total).toFixed(2)+"%"},SeverityProgressBar.prototype.toDisplayPercentage=function(current,total){return this._toPercentage(current,total).toFixed(0)+" %"},ngModule.component("fSeverityProgressBar",{bindings:{none:"<?",low:"<?",medium:"<?",high:"<?",critical:"<?",total:"<",showPercentage:"<?"},template:'<div class="bar-value none" ng-style="{width: $ctrl.nonePercentage}"></div><div class="bar-value low" ng-style="{width: $ctrl.lowPercentage}"></div><div class="bar-value medium" ng-style="{width: $ctrl.mediumPercentage}"></div><div class="bar-value high" ng-style="{width: $ctrl.highPercentage}"></div><div class="bar-value critical" ng-style="{width: $ctrl.criticalPercentage}"></div><div class="severity-percentage" ng-style="{width: $ctrl.totalPercentage}" ng-show="$ctrl.showPercentage"><span>{{$ctrl.displayPercentage}}</span></div>',controller:SeverityProgressBar}),DiscreteLevelBar.prototype.getCells=function(total,activeLevel){var i,cells=[];for(i=0;i<total;i++)cells.push(i<=activeLevel);return cells},DiscreteLevelBar.prototype.getBarInfo=function(levels,value){var length=(levels||[]).length,index=levels.findIndex(function(level){return level.name===value});if(index===-1)return{cells:this.getCells(length,-1)};var level=levels[index];return{cells:this.getCells(length,index),color:level.color,colorClass:level.class||""}},ngModule.component("fDiscreteLevelBar",{bindings:{levels:"<",value:"<"},template:'<div class="discrete-level-bar"><div ng-repeat="active in $ctrl.bar.cells track by $index" class="bar-cell" ng-class="active ? $ctrl.bar.colorClass : \'inactive\'" ng-style="active && $ctrl.bar.color && {\'background-color\': $ctrl.bar.color}"></div></div>',controller:DiscreteLevelBar}),ngModule.component("fRiskLevelBar",{bindings:{value:"<"},template:'<f-discrete-level-bar class="small" levels="$ctrl.levels" value="$ctrl.value"></f-discrete-level-bar>',controller:RiskLevelBar}),ngModule.component("fVulnerabilityScoreBar",{bindings:{value:"<"},template:'<f-discrete-level-bar class="small" levels="$ctrl.levels" value="$ctrl.value"></f-discrete-level-bar>',controller:VulnerabilityScoreBar}),ngModule.component("fThreatScoreBar",{bindings:{value:"<"},template:'<f-discrete-level-bar class="small" levels="$ctrl.levels" value="$ctrl.value"></f-discrete-level-bar>',controller:ThreatScoreBar}),ngModule.component("fThreatFormatter",{bindings:{entry:"<"},template:'<div ng-if="$ctrl.entry.score > 0">  <f-threat-score-bar value="$ctrl.levelValue"></f-threat-score-bar>  <span>{{ $ctrl.entry.score }}</span></div>',controller:ThreatFormatter})},{"../module":59}],37:[function(require,module,exports){"use strict";var ngModule=require("../module");ngModule.directive("fRadioGroup",function(){return{restrict:"E",scope:!1,controller:function(){},link:function(scope,elem){elem.addClass("radio-group")}}}),ngModule.directive("input",function($compile){var lastId=0,ID_PREFIX="f-radio-group-radio-",TEMPLATE='<label for="{{ attr.id }}"><f-icon ng-if="attr.radioIcon" ng-class="attr.radioIcon"></f-icon><span ng-if="attr.radioLabel">{{ attr.radioLabel }}</span></label>',compiled=$compile(TEMPLATE);return{restrict:"E",require:"?^^fRadioGroup",scope:!1,link:function(scope,elem,attr,fRadioGroup){function getId(){return ID_PREFIX+scope.$id+"-"+ ++lastId}var templateScope=scope.$new();fRadioGroup&&"radio"===attr.type&&(attr.id||(attr.id=getId(),elem.prop("id",attr.id)),templateScope.attr=attr,compiled(templateScope,function($label){elem.after($label)}))}}})},{"../module":59}],38:[function(require,module,exports){"use strict";var ngModule=require("../module"),ENTER_KEY_CODE=13,TEMPLATE='<input type="text" placeholder="{{ctrl.inputPlaceholder}}" ng-model="ctrl.model" ng-model-options="ctrl.modelOptions" ng-disabled="ctrl.disabled"><f-icon class="search-indicator" ng-class="ctrl.indicatorIcon"></f-icon><f-icon class="clear-search fa-dismiss" ng-show="ctrl.model" ng-click="ctrl.clear()"></f-icon>';ngModule.directive("fSearchInput",function(){return{restrict:"E",scope:{model:"=",enabled:"=",loading:"=",inputPlaceholder:"=",showFocus:"=",onKeyUp:"&",onKeyDown:"&",onEnter:"&",onEmptyBlur:"&"},template:TEMPLATE,bindToController:!0,controllerAs:"ctrl",controller:function($scope,$element,$attrs,$timeout){var ctrl=this,$input=$element.find('input[type="text"]');ctrl.modelOptions={},$attrs.debounce&&(ctrl.modelOptions.debounce=Number($attrs.debounce)),$scope.$watchGroup(["ctrl.loading","ctrl.enabled"],function(values){var loading=values[0],disabled=values[1]===!1;ctrl.indicatorIcon=loading?"fa-loading":"fa-search",ctrl.disabled=disabled||loading,$element.toggleClass("disabled",disabled)}),$scope.$watch("ctrl.showFocus",function(showFocus){showFocus&&$timeout(function(){$input.focus()})}),$input.on("keyup",function(event){event.keyCode===ENTER_KEY_CODE?$scope.$apply(function(){ctrl.onEnter()}):$scope.$apply(function(){ctrl.onKeyUp({event:event})})}),$input.on("keydown",function(event){$scope.$apply(function(){ctrl.onKeyDown({$event:event})})}),$input.on("blur",function(){ctrl.model||$scope.$apply(function(){ctrl.onEmptyBlur()})}),this.clear=function(){ctrl.model=""}}}})},{"../module":59}],39:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/f-select.html",'<button type="button" class="bare" ng-if="$ctrl.showInlineEditShortcut()"\n    ng-disabled="$ctrl.inlineEditDisabled || $ctrl.ngModel.$isEmpty($ctrl.ngModel.$modelValue)"\n    ng-click="$ctrl.inlineEdit()" title="{{::$ctrl.editText}}">\n    <f-icon class="fa-pencil"></f-icon>\n</button>\n')}]),module.exports="/FTNT_SHARED/ng/directives/f-select.html"},{}],40:[function(require,module,exports){"use strict";function OmniselectController($scope,$element,$q){this.$scope=$scope,this.$element=$element,this.$q=$q,this.editText=Omniselect.prototype.EDIT_TEXT,this.select=null}var ngModule=require("../module");require("./f-select.html");var TEMPLATE_URL="/FTNT_SHARED/ng/directives/f-select.html";OmniselectController.prototype.$onInit=function(){this.ngModel.$isEmpty=function(value){return!value||Array.isArray(value)&&!value.length},this.ngModel.$render=function(){var value=this.ngModel.$modelValue;void 0!==value&&this.select&&this.select.update({selected:value})}.bind(this),this.startWatches(),this.startListenerWatches()},OmniselectController.prototype.$onDestroy=function(){this.select&&this.select.destroy()},OmniselectController.prototype.startWatches=function(){this.$scope.$watch("$ctrl.settings",function(settings){settings&&(this.select?this.select.update({settings:settings}):this.initializeSelect())}.bind(this)),this.$scope.$watch("$ctrl.disabled",function(value,previous){value!==previous&&this.select&&this.select.disable(value)}.bind(this))},OmniselectController.prototype.initializeSelect=function(){var onChange=function(selected){this.$scope.$apply(function(){this.ngModel.$$lastCommittedViewValue=this.ngModel.$viewValue=selected,this.ngModel.$$parseAndValidate(),this.changeEvent&&this.$scope.$root.$broadcast(this.changeEvent,selected)}.bind(this))}.bind(this),onPreprocessComplete=function(){this.$scope.$apply(function(){this.onPreprocessComplete()}.bind(this))}.bind(this),selected=this.ngModel.$modelValue,settings=this.settings;void 0!==selected&&""!==selected||(selected=this.settings.singleSelect?null:[]),this.ngModel.$modelValue=selected,this.fSlideContainer&&(settings=Object.assign({insideSlide:!0},settings)),this.select=new Omniselect({includeInput:!0,changeCallback:onChange,onPreprocessComplete:onPreprocessComplete,settings:settings,selected:this.ngModel.$modelValue}),this.disabled&&this.select.disable(!0),this.$element.addClass("f-omniselect"),this.$element.prepend(this.select.$element)},OmniselectController.prototype.startListenerWatches=function(){var reProcess=ftnt_shared.util.debounce(300,function(){this.select.update({reProcess:!0})}.bind(this)),reload=ftnt_shared.util.debounce(300,function(){this.select.update({reload:!0})}.bind(this)),LISTENERS={reProcessOn:reProcess,reloadOn:reload},deregistration={};Object.keys(LISTENERS).forEach(function(key){this.$scope.$watch("$ctrl."+key,function(value){deregistration[key]&&(deregistration[key].forEach(function(deregister){deregister()}),delete deregistration[key]),value&&(Array.isArray(value)||(value=[value]),deregistration[key]=value.map(function(eventName){return this.$scope.$on(eventName,LISTENERS[key])}.bind(this)))}.bind(this))}.bind(this))},OmniselectController.prototype.showInlineEditShortcut=function(){return this.inlineEditShortcut&&this.settings&&this.settings.singleSelect&&this.select&&this.select.inlineEditSupported()},OmniselectController.prototype.inlineEdit=function(){var value=this.ngModel.$modelValue,entry=Array.isArray(value)?value[0]:value;this.inlineEditDisabled=!0,this.$q.when(this.select.inlineEdit(entry)).finally(function(){this.inlineEditDisabled=!1}.bind(this))},ngModule.directive("fOmniselect",function(){return{restrict:"A",templateUrl:TEMPLATE_URL,scope:{settings:"<fOmniselect",disabled:"<",changeEvent:"@",reProcessOn:"<",reloadOn:"<",onPreprocessComplete:"&",inlineEditShortcut:"<"},bindToController:!0,controllerAs:"$ctrl",require:{ngModel:"ngModel",fSlideContainer:"^^?"},controller:OmniselectController}})},{"../module":59,"./f-select.html":39}],41:[function(require,module,exports){"use strict";function SignalStrengthBar($scope,$sce){this.$onInit=function(){$scope.$watch("$ctrl.signalStrength",function(value){null!=value&&(this.barHtml=$sce.trustAsHtml(ftnt_shared.formatters.signalStrengthBar(value,this.barSize,this.title,this.reverse)))}.bind(this))}}var ngModule=require("../module");ngModule.component("fSignalStrengthBar",{controller:SignalStrengthBar,bindings:{signalStrength:"=",barSize:"@",title:"=",reverse:"<"},template:'<div ng-bind-html="$ctrl.barHtml"></div>'})},{"../module":59}],42:[function(require,module,exports){"use strict";var ngModule=require("../module"),fSlideContainer={
bindings:{slide:"<"}};ngModule.component("fSlideContainer",fSlideContainer)},{"../module":59}],43:[function(require,module,exports){"use strict";function SlideIn($element,$attrs,$scope){this.$onInit=function(){function hide(hide){hide=void 0===hide?!showing:hide,$element[0].classList[hide===!1?"remove":"add"]("ng-hide")}var showing=null;$scope.$watch("fSlideInCtrl.fSlideIn",function(value,oldValue){var side=this.slideFrom||"right";if(!validSides.has(side))throw new Error("Invalid side for slide-in slide-side attribute: "+side);showing=value,value!==oldValue?value?(hide(!1),ftnt_shared.animation.slideInAnimate($element[0],side).then(this.slideComplete.bind(this))):ftnt_shared.animation.slideOutAnimate($element[0],side).then(hide).then(this.slideComplete.bind(this)):value||hide()}.bind(this))}}var ngModule=require("../module"),validSides=new Set(["left","right"]),fSlideIn={bindToController:{fSlideIn:"=",slideFrom:"@",slideComplete:"&"},controllerAs:"fSlideInCtrl",controller:SlideIn};ngModule.directive("fSlideIn",function(){return fSlideIn})},{"../module":59}],44:[function(require,module,exports){"use strict";function Tip($scope,$element){this.$scope=$scope,this.$element=$element,this.targetElement=null,this.contentsElement=null,this.tooltip=null}function TipTarget($scope,$element){this.element=$element[0]}var ngModule=require("../module"),DEFAULT_DISPLAY_OPTIONS={};Tip.prototype.getDisplayOptions=function(){return Object.assign({},DEFAULT_DISPLAY_OPTIONS,this.displayOptions)},Tip.prototype.setupTooltip=function(){var container=this.selfContained?this.targetElement:null,tooltip=new Tooltip(this.getDisplayOptions(),null,container),title=this.$element[0].getAttribute("title");title&&(this.$element[0].setAttribute("original-title",title),this.$element[0].removeAttribute("title")),tooltip.setContent(title||this.contentsElement),tooltip.showOnElementHover(this.targetElement),tooltip.onShow(function(){this.onShow({tooltip:tooltip})}.bind(this)),tooltip.onHide(function(){this.onHide({tooltip:tooltip})}.bind(this)),this.tooltip=tooltip},Tip.prototype.startWatches=function(){this.$scope.$watch("$ctrl.enabled",function(enabled){var doEnable=null==enabled||enabled;doEnable?this.tooltip||this.setupTooltip():this.tooltip&&(this.tooltip.destroy(),this.tooltip=null)}.bind(this)),this.$scope.$watch("$ctrl.displayOptions",function(displayOptions){displayOptions&&this.tooltip&&this.tooltip.setDisplayOptions(this.getDisplayOptions())}.bind(this)),this.$scope.$on("fTipHide",function(){this.tooltip&&this.tooltip.visible&&this.tooltip.hide(!0)}.bind(this))},Tip.prototype.$postLink=function(){this.startWatches()},Tip.prototype.$onDestroy=function(){this.tooltip&&(this.tooltip.destroy(),this.tooltip=null)},ngModule.directive("fTip",function(){return{transclude:!0,controller:Tip,controllerAs:"$ctrl",bindToController:!0,scope:{enabled:"<",displayOptions:"<",onShow:"&",onHide:"&",selfContained:"<"},require:["fTip","?^fTipTarget"],link:function($scope,$element,attrs,controllers,$transclude){var tipController=controllers[0],targetController=controllers[1];tipController.targetElement=targetController?targetController.element:$element[0],$transclude(function($clonedNodes){var contentsElement=document.createElement("div");$clonedNodes.each(function(index,element){contentsElement.appendChild(element)}),tipController.contentsElement=contentsElement})}}}),TipTarget.prototype.$onDestroy=function(){this.element=null},ngModule.directive("fTipTarget",function(){return{controller:TipTarget}})},{"../module":59}],45:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/f-tree-view.html",'<ul>\n    <li ng-repeat="node in treeView.nodeList | limitTo:treeView._toggledLimit track by node.id"\n        ng-if="node.visible"\n        ng-class="{\n            \'has-children\': node.children.length > 0,\n            \'has-expansion-control\': treeView.expansionControls\n        }">\n        <div class="edges-container">\n            <div class="edges" ng-repeat="ancestorId in node.path">\n                <div class="edge to-self" ng-if="$last">\n                </div>\n                <div class="edge last-child" ng-if="$last && treeView.isLast(ancestorId, $parent.$index)">\n                </div>\n                <div class="edge to-sibling" ng-if="!treeView.isLast(ancestorId, $parent.$index)">\n                </div>\n            </div>\n            <div class="edges expansion-control" ng-if="treeView.expansionControls">\n                <button type="button"\n                    class="compact-visual-toggle"\n                    ng-if="node.children.length > 0"\n                    ng-class="{\n                        \'active\': node.expanded\n                    }"\n                    ng-click="node.toggleExpansion()">\n                </button>\n                <div class="edge to-child" ng-if="node.children.length > 0 && node.expanded">\n                </div>\n                <div class="edge to-self" ng-if="node.path.length > 0 && node.children.length === 0">\n                </div>\n            </div>\n        </div>\n        <div class="tree-node-container">\n            <div class="indent" ng-repeat="ancestorId in node.path"></div>\n            <div class="indent" ng-if="treeView.expansionControls"></div>\n            <f-tree-node source="node.source">\n                <div class="edge to-child" ng-if="node.children.length > 0 && !treeView.expansionControls">\n                </div>\n            </f-tree-node>\n        </div>\n    </li>\n    <li ng-if="treeView.limit && (treeView.nodeList.length > treeView.limit)">\n        <a href="#" ng-click="treeView.toggleLimit($event)">\n            <button type="button"\n                class="compact-visual-toggle"\n                ng-class="{\n                    \'active\': !treeView._toggledLimit\n                }">\n            </button>\n            <span ng-if="treeView._toggledLimit">\n                {{ \'{0} more\' | lang:[treeView.nodeList.length - treeView._toggledLimit] }}\n            </span>\n            <span ng-if="!treeView._toggledLimit">\n                {{:: \'Collapse\' | lang }}\n            </span>\n        </a>\n    </li>\n</ul>\n')}]),module.exports="/FTNT_SHARED/ng/directives/f-tree-view.html"},{}],46:[function(require,module,exports){"use strict";function Node(id,parentId,source){this.id=id,this.parentId=parentId,this.source=source,this.ancestors=[],this.path=[],this.children=[],this.expanded=!0,this.visible=!0}function TreeView($scope,$transclude){if(this._transcludeFn=$transclude,this.limit&&this.expansionControls)throw new Error("Cannot use both limit and expansionControls in same tree view.");this.limit=Number(this.limit)||void 0,this._toggledLimit=this.limit,$scope.$watch("treeView._getSourceKeys()",function(){this.nodeList=this._processSource(),this.expansionControls&&this.collapsedRoot&&this._collapseAllNodes()}.bind(this),!0)}function TreeNode($scope,$element){this.$onInit=function(){if($scope.treeView=this.treeView,this.treeView._transcludeFn($scope,function(clone){$element.append(clone)}),$scope.treeView.nodeClick){var clickHandler=function(event){$scope.treeView.nodeClick({$event:event,node:this.source})}.bind(this);$element.on("click",clickHandler)}if($scope.treeView.nodeContextClick){var contextClickHandler=function(event){$scope.treeView.nodeContextClick({$event:event,node:this.source})}.bind(this);$element.on("contextmenu",contextClickHandler)}}}require("./f-tree-view.html");var ngModule=require("../module"),TEMPLATE_URL="/FTNT_SHARED/ng/directives/f-tree-view.html",fTreeView={templateUrl:TEMPLATE_URL,bindings:{source:"=",key:"@",parentKey:"@",nodeClick:"&?",nodeContextClick:"&?",expansionControls:"<",collapsedRoot:"<",limit:"@"},transclude:!0,controllerAs:"treeView",controller:TreeView};ngModule.component("fTreeView",fTreeView);var nodeComparator=function(nodeA,nodeB){for(var lca,valA=nodeA.id,valB=nodeB.id,pathA=nodeA.path,pathB=nodeB.path,distanceA=pathA.length,distanceB=pathB.length,length=Math.min(distanceA,distanceB),i=0;i<length;){var ancestorA=pathA[i],ancestorB=pathB[i];if(ancestorA!==ancestorB)break;lca=ancestorA,i++}var lcaChildA=pathA[pathA.indexOf(lca)+1]||valA,lcaChildB=pathB[pathB.indexOf(lca)+1]||valB;return lcaChildA===lcaChildB?distanceA<distanceB?-1:distanceB<distanceA?1:0:lcaChildA<lcaChildB?-1:1};Node.prototype.addAncestor=function(ancestor){this.ancestors.unshift(ancestor),this.path.unshift(ancestor.id)},Node.prototype.propagateExpansion=function(){this.expanded&&this.children.forEach(function(child){child.toggleVisibility(!0),child.propagateExpansion()})},Node.prototype.hideChildren=function(){this.children.forEach(function(child){child.toggleVisibility(!1),child.hideChildren()})},Node.prototype.toggleExpansion=function(force){this.expanded=force||!this.expanded,this.expanded?this.propagateExpansion():this.hideChildren()},Node.prototype.toggleVisibility=function(visible){this.visible=visible},Node.prototype.addChild=function(node){this.children.push(node)},TreeView.prototype._getSourceKeys=function(){var key=this.key,parentKey=this.parentKey;return(this.source||[]).map(function(item){return{id:item[key],parentId:item[parentKey]}})},TreeView.prototype._processSource=function(){var nodeMap={},key=this.key,parentKey=this.parentKey,nodeList=[];return(this.source||[]).forEach(function(item){var id=item[key];if(id){var parentId=item[parentKey],node=new Node(id,parentId,item);nodeMap[id]=node,nodeList.push(node)}}),nodeList.forEach(function(node){if(!node.ancestors.length){var parentNode=nodeMap[node.parentId];for(parentNode&&parentNode.addChild(node);parentNode;)node.addAncestor(parentNode),parentNode=nodeMap[parentNode.parentId]}}),nodeList.sort(nodeComparator)},TreeView.prototype._collapseAllNodes=function(){this.nodeList.forEach(function(node){node.toggleExpansion(!1)})},TreeView.prototype.isLast=function(ancestorId,index){for(var i=index+1;i<this.nodeList.length;++i){var node=this.nodeList[i];if(node.parentId===ancestorId)return!1}return!0},TreeView.prototype.toggleLimit=function($event){$event.preventDefault(),this._toggledLimit=this._toggledLimit?void 0:this.limit};var fTreeNode={require:{treeView:"^^fTreeView"},bindings:{source:"="},controller:TreeNode,controllerAs:"treeNode"};ngModule.component("fTreeNode",fTreeNode)},{"../module":59,"./f-tree-view.html":45}],47:[function(require,module,exports){"use strict";function UniqueItems(){this._registeredControllers=new Set,this._invalidPairs=[]}function UniqueItem($attrs){this.$attrs=$attrs}var ngModule=require("../module");UniqueItems.prototype.registerControllers=function(controller){this._registeredControllers.add(controller)},UniqueItems.prototype.unregisterControllers=function(controller){this._updatePairs(!0),this._registeredControllers.delete(controller),this._removeInvalidPairs(controller),this._updatePairs(!1)},UniqueItems.prototype._removeInvalidPairs=function(controller){this._invalidPairs=this._invalidPairs.filter(function(pair){var isFirstPair=pair[0].modelCtrl===controller.modelCtrl,isSecondPair=pair[1].modelCtrl===controller.modelCtrl;return!(isFirstPair||isSecondPair)})},UniqueItems.prototype._updatePairs=function(valid){this._invalidPairs.forEach(function(pair){this._updatePair(pair,valid)}.bind(this))},UniqueItems.prototype._updatePair=function(pair,valid){pair.forEach(function(one){this._updateController(one,valid)}.bind(this))},UniqueItems.prototype._updateController=function(controller,valid){controller.modelCtrl.$setValidity("f_unique_items",valid),controller.fieldCtrl.showValidationMessages()},UniqueItems.prototype.validate=function(modelValue,viewValue,candidate){this._removeInvalidPairs(candidate);var value=modelValue||viewValue;return!value||(this._registeredControllers.forEach(function(registered){if(this._updateController(registered,!0),registered.modelCtrl!==candidate.modelCtrl){var unique;unique=candidate.$attrs.fUniqueItem?candidate.distinctFn({$value:candidate.modelCtrl.$viewValue,$other:registered.modelCtrl.$viewValue}):candidate.modelCtrl.$viewValue!==registered.modelCtrl.$viewValue,unique||this._invalidPairs.push([candidate,registered])}}.bind(this)),this._updatePairs(!1),!0)},ngModule.directive("fUniqueItems",function(){return{restrict:"A",controller:UniqueItems}}),UniqueItem.prototype.$onInit=function(){this.controller={$attrs:this.$attrs,distinctFn:this.distinctFn,modelCtrl:this.modelCtrl,fieldCtrl:this.fieldCtrl},this.allUniqueCtrl.registerControllers(this.controller),this.modelCtrl.$validators.allUniqueItems=function(modelValue,viewValue){return this.allUniqueCtrl.validate(modelValue,viewValue,this.controller)}.bind(this)},UniqueItem.prototype.$onDestroy=function(){this.allUniqueCtrl.unregisterControllers(this.controller)},ngModule.directive("fUniqueItem",function(){return{restrict:"A",require:{modelCtrl:"ngModel",fieldCtrl:"^fField",allUniqueCtrl:"^fUniqueItems"},scope:{distinctFn:"&fUniqueItem"},bindToController:!0,controller:UniqueItem,controllerAs:"ctrl"}})},{"../module":59}],48:[function(require,module,exports){"use strict";function VerticalCollapse($scope,$element,$attrs,$parse){this._$scope=$scope,this._$attrs=$attrs,this._element=$element[0],this._$parse=$parse,this._watchAttributes()}var ngModule=require("../module");VerticalCollapse.prototype._isEnabled=function(){var enabled=!0,attribute=this._$attrs.fVerticalCollapse;return attribute&&(enabled=this._$parse(attribute)(this._$scope)),enabled},VerticalCollapse.prototype._expand=function(){ftnt_shared.animation.toAutoHeightVerticalExpand(this._element,0)},VerticalCollapse.prototype._collapse=function(){ftnt_shared.animation.fromAutoHeightVerticalShrink(this._element,0)},VerticalCollapse.prototype._watchAttributes=function(){var attrs=["ngShow","ngHide"],unwatch={};attrs.forEach(function(attr){function watchAction(value,oldValue){function transition(visible){visible?this._expand():this._collapse()}if(value!==oldValue&&this._isEnabled()){var visible="ngShow"===attr?value:!value,skipAnimation=this.fVirtualScroll&&!!this.fVirtualScroll.justScrolled;skipAnimation?ftnt_shared.animation.noanimation(this._element,transition.bind(this,visible)):transition.call(this,visible)}}unwatch[attr]=angular.noop,this._$attrs.$observe(attr,function(expr){unwatch[attr](),unwatch=this._$scope.$watch(expr,watchAction.bind(this))}.bind(this))}.bind(this))},ngModule.directive("fVerticalCollapse",function(){return{controller:VerticalCollapse,controllerAs:"fVerticalCollapse",bindToController:{},require:{fVirtualScroll:"^^?"}}})},{"../module":59}],49:[function(require,module,exports){"use strict";function VirtualScroll($scope,$element,$attrs,$timeout){this.count=parseFloat($attrs.items),this.$element=$element,this.makeSlices=this.makeSlices.bind(this,$scope,$timeout),this.updateScroll=this.updateScroll.bind(this,$timeout,$element),this.collectionExpr=this.collectionExpr.bind(this,$attrs),this.$elems={before:[],visible:[],after:[]},this._elemsSorted={},$scope.$virtualScroll=this,this.scrollTop=$element[0].scrollTop;var updating=!1;$element.on("scroll",function(){$scope.$apply(function(){updating||($scope.$evalAsync(function(){updating=!1,this.updateScroll()}.bind(this)),updating=!0)}.bind(this))}.bind(this)),$scope.$evalAsync(this.updateScroll),$scope.$watchCollection($attrs.fVirtualScroll,this.makeSlices)}function fVirtualScroll(){return{controller:VirtualScroll,requires:"fVirtualScroll",scope:!0,link:function(scope,elem){elem.addClass("f-virtual-scroll")}}}function vsItem(location){return{link:function(scope,elem){scope.$virtualScroll.add(elem,location),scope.$on("$destroy",function(){scope.$virtualScroll.remove(elem,location)})}}}function fVirtualScrollAfter(){return vsItem("after")}function fVirtualScrollBefore(){return vsItem("before")}function fVirtualScrollVisible(){return vsItem("visible")}var ngModule=require("../module");VirtualScroll.prototype={scrollTop:null,emptyArray:[],collectionExpr:function($attrs){return $attrs.fVirtualScroll},makeSlices:function($scope,$timeout,value){value?this._lastValue=value:value=this._lastValue,value&&Array.isArray(value)&&($scope.$VSSliceBefore=this.slice("before",value),$scope.$VSSliceVisible=this.slice("visible",value),$scope.$VSSliceAfter=this.slice("after",value)),$timeout.cancel(this.justScrolled),this.justScrolled=$timeout(function(){this.justScrolled=!1}.bind(this))},slice:function(location,items){var sw=this.scrollWindow();switch(location){case"before":return items.slice(0,sw.start);case"visible":return items.slice(sw.start,sw.start+sw.count);case"after":return items.slice(sw.start+sw.count)}},scrollWindow:function(){if(this._scrollWindow)return this._scrollWindow;var start=this.findStart(),sw={start:start||0,count:this.count};return null!==start&&(this._scrollWindow=sw),sw},updateScroll:function($timeout,$element,value){value=value||this.$element[0].scrollTop,this._scrollTop!==value&&(this._scrollWindow=null,this._scrollTop=value,this.makeSlices())},findStart:function(){function flatten(result,arr){return result.concat(arr)}var locations=Object.keys(this.$elems),start=null,containerTop=this.$element.offset().top;if(0===this.$element[0].offsetHeight)return null;var offset=0;locations.forEach(function(l){this._elemsSorted[l]||this.$elems[l].sort(this.elemSort)}.bind(this));var elems=[this.$elems.before,this.$elems.visible,this.$elems.after].reduce(flatten,[]),pos=0,oldPos=null,len=elems.length,min=0,max=len,a=null,b=null,guard=100*len;if(!len)return!1;do{if(null!==a&&null!==b&&(oldPos=pos,a>0?(max=pos,pos-=Math.round((pos-min)/2)):b<0?(min=pos,pos+=Math.round((max-pos)/2)):0===b&&(min=pos,pos+=1),pos<0))throw console.error({pos:pos,len:len,a:a,b:b,oldPos:oldPos}),new Error("Calculated invalid search position");if(a=elems[pos].offset().top-containerTop,b=pos+1>=len?a+1:elems[pos+1].offset().top-containerTop,a>b)throw new Error("List not sorted");if(a<=0&&b>0&&(start=pos+offset),--guard<=0)throw new Error("Binary Search Failed!")}while(pos+1<len&&pos!==oldPos&&null===start);return null===start&&pos+1>=len&&(start=len-this.count),start},add:function(elem,location){this.$elems[location].push(elem),this._elemsSorted[location]=!1,this._scrollWindow=null},remove:function(elem,location){var locElems=this.$elems[location],index=locElems.indexOf(elem);index>-1&&locElems.splice(index,1)},elemSort:function(a,b){var a0=a[0],b0=b[0];return a0.offsetParent===b0.offsetParent?a0.offsetTop-b0.offsetTop:a.position().top-b.position().top}},ngModule.directive({fVirtualScroll:fVirtualScroll,fVirtualScrollBefore:fVirtualScrollBefore,fVirtualScrollAfter:fVirtualScrollAfter,fVirtualScrollVisible:fVirtualScrollVisible})},{"../module":59}],50:[function(require,module,exports){"use strict";require("./f-block-resizer"),require("./f-chart"),require("./f-copyable"),require("./f-dashboard"),require("./f-dashboard-widget"),require("./f-dialog"),require("./f-field"),require("./f-file-input"),require("./f-highlight"),require("./f-ip-subnet"),require("./f-list-edit"),require("./f-number-model"),require("./f-password-input"),require("./f-progress-bar"),require("./f-radio-group"),require("./f-search-input"),require("./f-select"),require("./f-slide-container"),require("./f-slide-in"),require("./f-duplicate-check"),require("./f-tree-view"),require("./f-unique-items"),require("./f-vertical-collapse"),require("./f-virtual-scroll"),require("./f-signal-strength-bar"),require("./f-tip"),require("./f-mutable"),require("./f-mutable-search"),require("./f-mutable-insert-sequence-grouping"),require("./f-mutable-edit-sequence-grouping"),require("./menu")},{"./f-block-resizer":3,"./f-chart":4,"./f-copyable":5,"./f-dashboard":9,"./f-dashboard-widget":7,"./f-dialog":11,"./f-duplicate-check":17,"./f-field":19,"./f-file-input":20,"./f-highlight":21,"./f-ip-subnet":22,"./f-list-edit":23,"./f-mutable":31,"./f-mutable-edit-sequence-grouping":25,"./f-mutable-insert-sequence-grouping":27,"./f-mutable-search":29,"./f-number-model":33,"./f-password-input":35,"./f-progress-bar":36,"./f-radio-group":37,"./f-search-input":38,"./f-select":40,"./f-signal-strength-bar":41,"./f-slide-container":42,"./f-slide-in":43,"./f-tip":44,"./f-tree-view":46,"./f-unique-items":47,"./f-vertical-collapse":48,"./f-virtual-scroll":49,"./menu":51}],51:[function(require,module,exports){"use strict";require("./menu"),require("./menu_items"),require("./qlist_config_controller")},{"./menu":52,"./menu_items":53,"./qlist_config_controller":58}],52:[function(require,module,exports){"use strict";function MenuBar($scope,$element,$attrs,$transclude){var transcludeScope;this._$scope=$scope,$element.addClass("menu-bar"),this.menuBar=!0,this.muTableInstance=null,this.entries=[],this.lastSelectedEntry=null,this.rowInstances=[],this.targetColumnID=null,this.targetColumnValuePromise=null,this.$qlist=null,this.rows=[],this.$sectionRow=null,this.$td=null,this.columnSelector=null,this.columnValue=null,$attrs.qlistSelector?$scope.$watch("qlistSelector",function(qlistSelector){qlistSelector&&this.setupQlistEvents(qlistSelector)}.bind(this)):$attrs.qlistElement&&$scope.$watch("qlistElement.element",function(qlistElement){qlistElement&&this.setupQlistEvents(qlistElement)}.bind(this)),transcludeScope=$scope.$parent.$new(),transcludeScope.menu=this,$transclude(transcludeScope,function(clone){$element.append(clone)})}function PopUpMenuController($scope,$element,$attrs,$templateCache,$window,$q,$http,$compile,$timeout,popUpMenuUtil){this._$scope=$scope,this._$attrs=$attrs,this._$templateCache=$templateCache,this._$window=angular.element($window),this._$q=$q,this._$http=$http,this._$compile=$compile,this._$timeout=$timeout,this._popUpMenuUtil=popUpMenuUtil,this._menuId="popUpMenu"+$scope.$id,this._children=[],this._leftAdjusted=!1,this._appendedTo=null,this.toggleDefer=null,this.popUpMenu=!0,this.$element=$element,this.visible=!1,this.metaInfo=null,this.toggleMeta=null,this.buttonToggled=!1,this.muTableInstance=null,this.entries=[],this.lastSelectedEntry=null,this.rowInstances=[],this.targetColumnID=null,this.targetColumnValuePromise=null,this.$qlist=null,this.rows=[],this.$sectionRow=null,this.$td=null,this.columnSelector=null,this.columnValue=null,$attrs.qlistSelector?$scope.$watch("qlistSelector",function(qlistSelector){qlistSelector&&this._setupQlistEvents(qlistSelector)}.bind(this)):$attrs.qlistElement&&$scope.$watch("qlistElement.element",function(qlistElement){qlistElement&&this._setupQlistEvents(qlistElement)}.bind(this)),$attrs.fPopUpMenu&&($scope.popUpMenu=this),this._setupAutoPositioning(),this._show(!1),this._$scope.$on("$destroy",function(){this._show(!1)}.bind(this))}require("./partials/pop_up_toggle.html"),require("./partials/qlist_config.html");var ngModule=require("../../module"),$=jQuery,QLIST_SELECT_ROWS_EVENT="qlist_select_rows",QLIST_DOUBLE_CLICK_ROW_EVENT="qlist_dblclick_row",QLIST_CONTEXT_MENU_EVENT="qlist_contextmenu",QLIST_CONFIGURATION_MENU_EVENT="qlist_config_menu",namespaceEvent=function(eventName,scope){return eventName+".menu"+scope.$id},addQlistEventData=function(menu,data){data.event&&(menu.$target=angular.element(data.event.target)),data.muTableInstance&&(menu.muTableInstance=data.muTableInstance),menu.lastSelectedEntry=data.last_selected,menu.entries=data.entries||[],menu.rows=data.rows||[],menu.rowInstances=data.row_instances||[],menu.$sectionRow=data.$section_row,menu.$categoryRow=data.$category_row,menu.$td=data.$td,menu.columnSelector=menu.targetColumnID=data.column_selector,menu.columnValue=data.column_value,menu.targetColumnValuePromise=data.column_value_promise};MenuBar.prototype.setTableDoubleClickHandler=function(callback){this._tableDoubleClickHandler=callback},MenuBar.prototype.triggerTableDoubleClick=function(){"function"==typeof this._tableDoubleClickHandler?this._tableDoubleClickHandler():"function"==typeof this.qlistDoubleClickHandler&&this.qlistDoubleClickHandler()},MenuBar.prototype.setupQlistEvents=function(qlist){var selectEvent,dblclickEvent,$qlist=$(qlist);if(!$qlist.length)throw new Error('Qlist selector "'+this._$scope.qlistSelector+'" failed to locate element');selectEvent=namespaceEvent(QLIST_SELECT_ROWS_EVENT,this._$scope),dblclickEvent=namespaceEvent(QLIST_DOUBLE_CLICK_ROW_EVENT,this._$scope),$qlist.off(selectEvent).on(selectEvent,function(event,data){this._$scope.$evalAsync(function(){addQlistEventData(this,data)}.bind(this))}.bind(this)),$qlist.off(dblclickEvent).on(dblclickEvent,function(event,data){this._$scope.$apply(function(){addQlistEventData(this,data),angular.isFunction(this.qlistDoubleClickHandler)&&this.qlistDoubleClickHandler.apply(this,arguments)}.bind(this))}.bind(this)),this._$scope.$on("$destroy",function(){$qlist.off(selectEvent).off(dblclickEvent)}),this.$qlist=$qlist,this._$scope.$on("clearQlistSelection",function(){addQlistEventData(this,{})}.bind(this))},ngModule.directive("fMenuBar",function(){return{restrict:"A",transclude:!0,scope:{qlistSelector:"=",qlistElement:"="},controller:MenuBar}}),ngModule.factory("popUpMenuUtil",function(){var $mask,service={},visible={};return service.getMask=function(){return $mask||($mask=angular.element("<div/>").addClass("pop-up-menu-mask").appendTo("body")),$mask},service.setVisible=function(id,container,show){show?visible[id]=!0:delete visible[id];var hidden=0===Object.keys(visible).length;this.getMask().detach().appendTo(container).toggleClass("hidden",hidden)},service}),PopUpMenuController.prototype._show=function(show){this.visible=show,this.pendingVisible=!1,this.$element.toggleClass("hidden",!show),this._popUpMenuUtil.setVisible(this._menuId,this._appendedTo,show),show||(this._children.forEach(function(childMenu){childMenu._show(!1)}.bind(this)),this._leftAdjusted=!1,this.toggleDefer&&(this.toggleDefer.resolve(this.toggleMeta),this.toggleMeta=null))},PopUpMenuController.prototype._setPosition=function(position,$target){var WINDOW_BUFFER=5;if(position||this.visible){this.visible||this.$element.css({top:0,left:0,visibility:"hidden"}).removeClass("hidden"),position=position||this.$element.offset();var buffer=null!=this._$scope.windowBuffer?this._$scope.windowBuffer:WINDOW_BUFFER,containerOffset=this._appendedTo.offset(),top=position.top-containerOffset.top,left=position.left-containerOffset.left,containerWidth=this._appendedTo.width(),containerHeight=this._appendedTo.height(),maxWidth=containerWidth-2*buffer,maxHeight=containerHeight-(this.buttonToggled?top:0)-2*buffer,width=ftnt_shared.browser.responsive.isSmall()?maxWidth:Math.min(this.$element.width(),maxWidth),height=Math.min(this.$element.height(),maxHeight),leftOver=left+width+buffer-containerWidth,topOver=top+height+buffer-containerHeight;if(leftOver>0&&(!this._leftAdjusted&&position.leftOverAdjust?(left-=position.leftOverAdjust+width+2,this._leftAdjusted=!0):left-=leftOver,left<buffer&&(left=buffer)),topOver>0&&(top-=topOver,top<buffer&&(top=buffer)),this.$element.css({left:left,top:top,width:ftnt_shared.browser.responsive.isSmall()?width:void 0,"max-width":maxWidth,"max-height":maxHeight,visibility:"visible","overflow-y":this.$element[0].scrollHeight>maxHeight?"scroll":"hidden"}),$target&&$target.length){var isTargetMasked=this._isTargetMasked(left,top,width,height,$target);$target.toggleClass("is-masked-by-popup-menu",isTargetMasked)}position.minWidth&&this.$element.css("min-width",position.minWidth)}},PopUpMenuController.prototype._setupQlistEvents=function(selector){var configMenuElement,configMenuScope,$qlist=angular.element(selector),contextEvent=namespaceEvent(QLIST_CONTEXT_MENU_EVENT,this._$scope),configMenuEvent=namespaceEvent(QLIST_CONFIGURATION_MENU_EVENT,this._$scope),dblclickEvent=namespaceEvent(QLIST_DOUBLE_CLICK_ROW_EVENT,this._$scope),configMenuScopeKey="qlistConfigContextMenu",configMenuContent=this._$templateCache.get("/FTNT_SHARED/ng/directives/menu/partials/qlist_config.html");if(!$qlist.length)throw new Error('Qlist selector "'+selector+'" failed to locate element');$qlist.on(contextEvent,function(event,data){this._$scope.$apply(function(){addQlistEventData(this,data)}.bind(this)),this._$timeout(function(){var x,y;data.event.pageX&&data.event.pageY?(x=data.event.pageX,y=data.event.pageY):data.event.pointers&&(x=data.event.pointers[0].pageX,y=data.event.pointers[0].pageY),this._setPosition({left:x,top:y},this.$target),this._show(!0)}.bind(this))}.bind(this)),$qlist.on(dblclickEvent,function(event,data){this._$scope.$apply(function(){addQlistEventData(this,data),this._$scope.qlistDoubleClick({entry:this.lastSelectedEntry,menu:this,event:data.event})}.bind(this))}.bind(this)),$qlist.on(configMenuEvent,function(event,data){configMenuScope&&(configMenuScope.$destroy(),configMenuElement.remove()),configMenuScope=this._$scope.$new(!0),configMenuScope.menu=this,configMenuScope.options=data.options,configMenuElement=this._$compile('<div f-pop-up-menu="'+configMenuScopeKey+'">'+configMenuContent+"</div>")(configMenuScope),configMenuScope.$watch(configMenuScopeKey,function(popUpMenu){popUpMenu&&this._$timeout(function(){popUpMenu.toggle({left:data.event.pageX,top:data.event.pageY}).then(function(meta){var action=meta.action;"cancel"!==action&&(action||(action="update_columns"),$qlist.qlist(action,meta.chosen))})})}.bind(this))}.bind(this)),this._$scope.$on("clearQlistSelection",function(){addQlistEventData(this,{})}.bind(this)),this._$scope.$on("$destroy",function(){$qlist.off(contextEvent).off(configMenuEvent).off(dblclickEvent)}),this.$qlist=$qlist},PopUpMenuController.prototype._setupAutoPositioning=function(){var $mask=this._popUpMenuUtil.getMask(),clickEvent="click.popUpMenu-"+this._menuId+" contextmenu.popUpMenu-"+this._menuId,debouncedSetPosition=ftnt_shared.util.debounce(50,function(){this._setPosition()}.bind(this));this._$window.on("resize",debouncedSetPosition),$mask.on(clickEvent,function(event){event.preventDefault(),this.visible&&this._show(!1)}.bind(this)),this._$scope.$on("$destroy",function(){$mask.off(clickEvent)})},PopUpMenuController.prototype._addChild=function(childMenu){this._children.push(childMenu),childMenu._parent=this},PopUpMenuController.prototype._removeChild=function(childMenu){this._children.splice(this._children.indexOf(childMenu),1),childMenu._parent=null},PopUpMenuController.prototype._getElementAndChildren=function(){var result=[this.$element];return this._children.forEach(function(childMenu){result=result.concat(childMenu._getElementAndChildren())}),result},PopUpMenuController.prototype._isTargetMasked=function(left,top,width,height,$target){if(!$target||!$target.length)return!1;var bottom=top+height,right=left+width,targetOffset=$target.offset();return targetOffset.bottom=targetOffset.top+$target.outerHeight(),targetOffset.right=targetOffset.left+$target.outerWidth(),!(targetOffset.right<=left||targetOffset.left>=right||targetOffset.bottom-1<=top||targetOffset.top>=bottom)},PopUpMenuController.prototype.toggle=function(position,element){var show=angular.isObject(position),defer=this._$q.defer();return show?(this.toggleDefer=defer,this.pendingVisible=!0,this._$timeout(function(){this._setPosition(position,element),this._show(!0)}.bind(this))):(this._show(!1),defer.reject()),defer.promise},PopUpMenuController.prototype.hide=function(parent){this._show(!1),parent&&this._parent&&this._parent.hide(!0)};var togglePopupAt=function(popUpMenu,element){var offset;popUpMenu.visible?popUpMenu.toggle(!1):(offset=element.offset(),element.addClass("pop-up-toggled"),popUpMenu.buttonToggled=!0,popUpMenu.$element.addClass("button-toggled"),popUpMenu.toggle({top:offset.top+element.outerHeight()-1,left:offset.left,minWidth:element.outerWidth()},element).then(function(){element.removeClass("pop-up-toggled")}))};ngModule.directive("fPopUpMenu",function(){return{restrict:"A",transclude:!0,scope:{popUpMenu:"=fPopUpMenu",qlistSelector:"=",qlistElement:"=",qlistDoubleClick:"&",windowBuffer:"=",buttonSelector:"@?"},controller:PopUpMenuController,link:function(scope,element,attrs,controller,transclude){
var clickEvent=namespaceEvent("click",scope),appendTo=element.closest(".slider-content-container");appendTo.length||(appendTo=angular.element("body")),appendTo.append(element),controller._appendedTo=appendTo,element.addClass("pop-up-menu"),element.on("contextmenu",function(event){event.preventDefault()});var transcludeScope=scope.$parent.$new();transcludeScope.menu=controller,transclude(transcludeScope,function(clone){element.append(clone)}),scope.buttonSelector&&appendTo.off(clickEvent).on(clickEvent,scope.buttonSelector,function(event){scope.$apply(function(){var target=angular.element(event.target).closest(scope.buttonSelector);target.length&&togglePopupAt(controller,target)})}),scope.$on("$destroy",function(){element.remove(),scope.buttonSelector&&appendTo.off(clickEvent)})}}}),ngModule.directive("fPopUpMenuToggle",function(){return{restrict:"A",templateUrl:"/FTNT_SHARED/ng/directives/menu/partials/pop_up_toggle.html",transclude:!0,scope:{popUpMenu:"=fPopUpMenuToggle",metaInfo:"=",isContextMenu:"<",onlyIf:"&"},link:function(scope,element,attrs){var handleButtonClick=!1,isContextMenu=scope.isContextMenu,clickEvent=isContextMenu?"contextmenu":"click";scope.$watch(function(){return null==attrs.onlyIf||scope.onlyIf()},function(shouldHandleButtonClick){handleButtonClick=shouldHandleButtonClick,scope.showCaret=null==attrs.noToggleIcon&&handleButtonClick}),element.on(clickEvent,function(event){handleButtonClick&&(isContextMenu&&event.preventDefault(),scope.$apply(function(){scope.popUpMenu.metaInfo=scope.metaInfo,togglePopupAt(scope.popUpMenu,element)}))})}}})},{"../../module":59,"./partials/pop_up_toggle.html":55,"./partials/qlist_config.html":56}],53:[function(require,module,exports){"use strict";require("./partials/button.html"),require("./partials/radio_options.html");var ngModule=require("../../module"),createDisabledFunction=function(scope,attrs){return function(){var disabled=!1;return attrs.enabled&&(disabled=!scope.enabled),disabled}};ngModule.directive("fMenuItemButton",function(){return{restrict:"A",transclude:!0,scope:{enabled:"=",selected:"=",click:"&",extraClass:"@"},templateUrl:"/FTNT_SHARED/ng/directives/menu/partials/button.html",require:["?^fPopUpMenu","?^fMenuBar"],link:function(scope,element,attrs,controllers){element.addClass("menu-item"),scope.disabled=createDisabledFunction(scope,attrs),scope.onClick=function($event){var popUpMenu=controllers[0],menu=controllers[1],entries=popUpMenu?popUpMenu.entries:menu&&menu.entries;scope.click({$event:$event,$entries:entries}),null==attrs.popUpStayOpen&&popUpMenu&&popUpMenu.hide(!0)}}}}),ngModule.directive("fMenuItemToggle",function(){return{restrict:"A",transclude:!0,scope:{selected:"=fMenuItemToggle",enabled:"=",click:"&"},templateUrl:"/FTNT_SHARED/ng/directives/menu/partials/button.html",require:["?^fPopUpMenu","?^fMenuBar"],link:function(scope,element,attrs){element.addClass("menu-item").addClass("menu-item-toggle"),scope.disabled=createDisabledFunction(scope,attrs),scope.onClick=function(){scope.selected=!scope.selected,scope.click({$toggleSelected:scope.selected})}}}}),ngModule.directive("fMenuItemSubmenu",function($window){return{restrict:"A",transclude:!0,scope:{menu:"=fMenuItemSubmenu",selected:"=",enabled:"="},templateUrl:"/FTNT_SHARED/ng/directives/menu/partials/button.html",require:"?^fPopUpMenu",link:function(scope,element,attrs,popUpMenu){element.addClass("menu-item").addClass("menu-item-submenu"),scope.disabled=createDisabledFunction(scope,attrs);var toggle=function(){var relativeElement,offset,position,parentPopUpMenuWidth;scope.menu?(scope.menu.visible||scope.menu.pendingVisible||(popUpMenu?(relativeElement=element,offset=element.offset(),parentPopUpMenuWidth=popUpMenu.$element.width(),position={left:offset.left+parentPopUpMenuWidth,top:offset.top,leftOverAdjust:parentPopUpMenuWidth}):(relativeElement=element.find("button"),offset=relativeElement.offset(),element.find("button").addClass("pop-up-toggled"),scope.menu.$element.addClass("button-toggled"),position={left:offset.left,top:offset.top+relativeElement.outerHeight()-1,minWidth:relativeElement.outerWidth()})),scope.menu.toggle(position,element).then(function(){element.find("button").removeClass("pop-up-toggled")})):ftnt_shared.log.error("Can't toggle pop up menu that doesn't exist")};if(scope.onClick=function(){toggle()},popUpMenu){var $win=angular.element($window),parentMenuElement=popUpMenu.$element,mouseEvent="mousemove.menuItemSubmenu"+scope.$id,deregister=scope.$watch("menu",function(menu){menu&&(popUpMenu._addChild(menu),deregister())});$win.on(mouseEvent,function(event){var insideParentMenu,toggleOffset,toggleHeight,insideToggle=element.is(":hover")&&!scope.disabled();scope.menu&&scope.menu.visible?(insideParentMenu=parentMenuElement.is(":hover"),insideParentMenu&&!insideToggle&&("scroll"===parentMenuElement.css("overflow-y")?(toggleOffset=element.offset(),toggleHeight=element.height(),(event.pageY<toggleOffset.top||event.pageY>toggleOffset.top+toggleHeight)&&toggle()):toggle())):insideToggle&&toggle()}),scope.$on("$destroy",function(){$win.off(mouseEvent),popUpMenu._removeChild(scope.menu)})}var caretClass=popUpMenu?"caret-right":"caret-down";element.find(".flex-button-content").append('<span class="flex-filler"></span>').append('<span class="'+caretClass+'"></span>')}}}),ngModule.directive("fMenuItemRadio",function(){return{restrict:"A",templateUrl:"/FTNT_SHARED/ng/directives/menu/partials/radio_options.html",scope:{options:"=fMenuItemRadio",selected:"="},link:function(scope,element){element.addClass("menu-item"),scope.selected||(scope.selected=scope.options[0].value),scope.setSelected=function(value){scope.selected=value}}}})},{"../../module":59,"./partials/button.html":54,"./partials/radio_options.html":57}],54:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/menu/partials/button.html",'<button type="button" ng-class="{\'selected\': selected}" class="{{::extraClass}}"\n    ng-disabled="disabled()" ng-click="onClick($event)">\n    <div class="flex-button-content" ng-transclude></div>\n</button>\n')}]),module.exports="/FTNT_SHARED/ng/directives/menu/partials/button.html"},{}],55:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/menu/partials/pop_up_toggle.html",'<div class="flex-button-content">\n    <div class="flex-button-content" ng-transclude></div>\n    <div class="caret-container" ng-show="showCaret">\n        <span class="caret-down"></span>\n    </div>\n</div>\n')}]),module.exports="/FTNT_SHARED/ng/directives/menu/partials/pop_up_toggle.html"},{}],56:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/menu/partials/qlist_config.html",'<div ng-controller="QlistContextMenuConfig">\n    <div class="heading">\n        {{\'Selected Columns\' | lang}}\n    </div>\n    <ul class="chosen-columns-list" ui-sortable="sortableOptions" ng-model="chosen">\n        <li ng-repeat="entry in chosen" class="flex-row-centered" ng-class="{\'not-sortable\': entry.fixed}">\n            <div class="menu-item button-style reorderable" ng-class="{\'disabled\': entry.fixed}"\n                ui-event="{\'mouseup\': \'removeMouseUp($event, entry)\'}">\n                <f-icon ng-if="!!entry.icon" ng-class="entry.icon"></f-icon>\n                <span>{{entry.value}}</span>\n            </div>\n        </li>\n    </ul>\n\n    <div class="info-text" ng-show="chosen.length === 0">\n        ...\n    </div>\n    <div class="heading">\n        {{\'Available Columns\' | lang}}\n    </div>\n    <div f-menu-item-button pop-up-stay-open ng-repeat="entry in available | orderBy:\'value\'"\n        click="addAvailable(entry)">\n        <f-icon ng-if="!!entry.icon" ng-class="entry.icon"></f-icon>\n        <span>\n            {{entry.value}}\n        </span>\n    </div>\n    <div class="info-text" ng-show="available.length === 0">\n        ...\n    </div>\n\n    <div class="separator"></div>\n    <div f-menu-item-button click="setAction(\'reset_columns\')">\n        <f-icon class="fa-reset"></f-icon>\n        {{\'col_rst\' | lang}}\n    </div>\n    <div f-menu-item-button click="setAction(\'clear_filters\')">\n        <f-icon class="fa-trash-o"></f-icon>\n        {{\'Remove All Filters\' | lang}}\n    </div>\n    <div class="separator"></div>\n    <div f-menu-item-button click="setAction(null)">\n        <f-icon class="fa-apply"></f-icon>\n        {{\'Apply\' | lang}}\n    </div>\n    <div f-menu-item-button click="setAction(\'cancel\')">\n        <f-icon class="fa-cancel"></f-icon>\n        {{\'Cancel\' | lang}} </div>\n</div>\n')}]),module.exports="/FTNT_SHARED/ng/directives/menu/partials/qlist_config.html"},{}],57:[function(require,module,exports){var ngModule;try{ngModule=angular.module("ftnt-gui")}catch(e){ngModule=angular.module("ftnt-gui",[])}ngModule.run(["$templateCache",function($templateCache){$templateCache.put("/FTNT_SHARED/ng/directives/menu/partials/radio_options.html",'<div class="radio-buttons">\n    <div f-menu-item-button ng-repeat="option in options"\n        extra-class="radio-button"\n        click="setSelected(option.value)"\n        selected="selected === option.value">\n        {{option.label | lang}}\n        <span ng-if="option.count" class="number-bubble">{{ option.count }}</span>\n    </div>\n</div>\n')}]),module.exports="/FTNT_SHARED/ng/directives/menu/partials/radio_options.html"},{}],58:[function(require,module,exports){"use strict";var ngModule=require("../../module");ngModule.controller("QlistContextMenuConfig",function($scope,lang){var movingChosen=!1,chosen_map={},updateChosen=function(){$scope.menu.toggleMeta.chosen=$scope.chosen.map(function(entry){return entry.selector})},removeChosen=function(entry){$scope.chosen.splice($scope.chosen.indexOf(entry),1),$scope.available.push(entry),updateChosen()};$scope.menu.toggleMeta={chosen:[],action:null},$scope.chosen=[],$scope.available=[],$scope.options.chosen_columns.forEach(function(selector){chosen_map[selector]=!0}),$scope.options.columns.forEach(function(column){var selector=column.selector,entry={selector:selector,value:null===column.lang_key?"":lang(column.lang_key||selector),fixed:!!column.fixed,icon:column.icon};chosen_map[selector]?$scope.chosen.push(entry):column.hidden||$scope.available.push(entry)}),$scope.setAction=function(action){$scope.menu.toggleMeta.action=action},$scope.addAvailable=function(entry){$scope.available.splice($scope.available.indexOf(entry),1),$scope.chosen.push(entry),updateChosen()},$scope.removeMouseUp=function(event,entry){movingChosen||entry.fixed||removeChosen(entry)},$scope.sortableOptions={start:function(event,ui){movingChosen=!0;var $menuItem=ui.item.find(".menu-item"),$contextMenu=$scope.menu.$element;$contextMenu.css({width:Math.max($contextMenu.width(),$menuItem.outerWidth())+"px","overflow-x":"hidden"}),$menuItem.css("cursor","move")},stop:function(event,ui){movingChosen=!1;var $contextMenu=$scope.menu.$element;$contextMenu.css({width:"","overflow-x":""}),ui.item.find(".menu-item").css("cursor","")},items:"li:not(.not-sortable)"},$scope.$watchCollection("chosen",function(){updateChosen()})})},{"../../module":59}],59:[function(require,module,exports){"use strict";module.exports=angular.module("ftnt-gui",["ngSanitize"])},{}],60:[function(require,module,exports){"use strict";function DashboardWidgetModel(params){this._id=ftnt_shared.util.uniqueID(),this._componentTag=params.componentTag,this.updateWidth(params.width||1),this.updateHeight(params.height||1),this.updateXPosition(params.xPosition),this.updateYPosition(params.yPosition),this._modelData={},params.modelData&&this.extendModelData(params.modelData)}var ngModule=require("../module");DashboardWidgetModel.prototype.extendModelData=function(modelData){angular.extend(this._modelData,modelData)},DashboardWidgetModel.prototype.getModelData=function(){return this._modelData},DashboardWidgetModel.prototype.updateWidth=function(width){this._width=width},DashboardWidgetModel.prototype.getWidth=function(){return this._width},DashboardWidgetModel.prototype.updateRelativeWidth=function(relativeWidth){this._relativeWidth=relativeWidth},DashboardWidgetModel.prototype.getRelativeWidth=function(){return this._relativeWidth},DashboardWidgetModel.prototype.updateHeight=function(height){this._height=height},DashboardWidgetModel.prototype.getHeight=function(){return this._height},DashboardWidgetModel.prototype.updateRelativeHeight=function(relativeHeight){this._relativeHeight=relativeHeight},DashboardWidgetModel.prototype.getRelativeHeight=function(){return this._relativeHeight},DashboardWidgetModel.prototype.updateXPosition=function(xPosition){this._xPosition=xPosition},DashboardWidgetModel.prototype.getXPosition=function(){return this._xPosition},DashboardWidgetModel.prototype.updateYPosition=function(yPosition){this._yPosition=yPosition},DashboardWidgetModel.prototype.getYPosition=function(){return this._yPosition},DashboardWidgetModel.prototype.getID=function(){return this._id},DashboardWidgetModel.prototype.getComponentTag=function(){return this._componentTag},ngModule.factory("DashboardWidgetModel",function(){return DashboardWidgetModel})},{"../module":59}],61:[function(require,module,exports){"use strict";require("./dashboard-widget-model"),require("./lang"),require("./slide")},{"./dashboard-widget-model":60,"./lang":62,"./slide":63}],62:[function(require,module,exports){"use strict";function langFactory($rootScope,$q,$sce){function Translated(value,trusted){if(!(this instanceof Translated))throw new Error("Please use the new keyword to create a new lang.Translated object");this.trusted=trusted,this.value=value}function lang(id,interpolate,silent){function isTrusted(value){return value instanceof Translated&&value.trusted||"number"==typeof value}var result,trusted=!0;return id instanceof Translated?result=id:(lang._prefix&&id&&0!==id.indexOf(lang._prefix)&&!reportedNotPrefixed[id]&&(ftnt_shared.log.warn('Translated key is not prefixed with "'+lang._prefix+'": "'+id+'"'),reportedNotPrefixed[id]=!0),result=ftnt_shared.lang.translate(id,null,{strict:!0,silent:silent}),null==result&&(trusted=!1,result=id)),interpolate&&(result=lang.format(result,interpolate),trusted=trusted&&interpolate.every(isTrusted)),result=result instanceof Translated?result:translated[result]||new Translated(result,trusted),translated[result.value]=result,result}function resetTranslated(){translated={}}var translated={},reportedNotPrefixed={},sceGetTrustedHtml=$sce.getTrustedHtml,sceValueOf=$sce.valueOf,decoder=document.createElement("textarea");return $sce.valueOf=function(maybeTrusted){return maybeTrusted instanceof Translated&&(maybeTrusted=String(maybeTrusted),decoder.innerHTML=maybeTrusted,maybeTrusted=decoder.value),sceValueOf.call(this,maybeTrusted)},$sce.getTrustedHtml=function(value){if(value instanceof Translated){var trusted=value.trusted;value=String(value),trusted&&(value=$sce.trustAsHtml(value))}return sceGetTrustedHtml.call(this,value)},Translated.prototype.toString=function(){return String(this.value)},Translated.prototype.valueOf=function(){return this.value},Object.getOwnPropertyNames(String.prototype).forEach(function(functionName){var fn=String.prototype[functionName];"function"!=typeof fn||functionName in Translated.prototype||(Translated.prototype[functionName]=function(){return fn.apply(this.value||"",arguments)})}),$rootScope.$on("$routeChangeSuccess",resetTranslated),lang.format=ftnt_shared.lang.stringInterpolate,lang.getPrefixedKey=function(prefix,key){var translateOptions={strict:!0,silent:!0};Array.isArray(prefix)||(prefix=[prefix]);for(var i=0;i<prefix.length;i++)if(lang(prefix[i]+key,null,translateOptions).trusted)return prefix[i]+key;return key},lang.checkPrefixed=function(prefix){lang._prefix=prefix},lang.Translated=Translated,lang}var ngModule=require("../module");ngModule.factory("lang",langFactory),ngModule.directive("fLang",function(lang,$sce){return function(scope,element,attr){function getStringValue(){return lang(attr.fLang)||""}scope.$watch(getStringValue,function(value){element.html($sce.getTrustedHtml(value))})}}),ngModule.filter("lang",function(lang){return function(input,interpolate,silent){return input=input||"",lang(input,interpolate,silent)}}),ngModule.filter("langPrefixed",function(lang){return function(input,prefix,interpolate){return input=input||"",lang(lang.getPrefixedKey(prefix,input),interpolate)}})},{"../module":59}],63:[function(require,module,exports){"use strict";function Slide($q,$rootScope,$compile,$templateCache,$http,lang){this._$q=$q,this._$rootScope=$rootScope,this._$compile=$compile,this._$templateCache=$templateCache,this._$http=$http,this._lang=lang,this._slides={}}function Dialog(slide){this._slide=slide}var ngModule=require("../module"),dom=ftnt_shared.dom,slideUtil=ftnt_shared.slideUtil;Slide.prototype.open=function(id,params){var deferred=this._$q.defer();void 0===params&&(params=id,id=Math.random().toString(36));var open=function(html){var compiled,current={},element=document.createElement("f-slide-container");element.setAttribute("slide","$$slide"),current.scope=(params.parentScope||this._$rootScope).$new(),current.scope.insideSlide=!0,current.data=params.data,angular.isFunction(params._scopePreconfigure)&&params._scopePreconfigure(current.scope),this._slides[id]=current;var title=params.options.title;title instanceof this._lang.Translated&&(params.options.title=title.trusted?title.valueOf():dom.escapeHTML(title.valueOf())),current.slide=new Sliderin(params.options),current.scope.$$slide=current.slide,element.innerHTML=html,compiled=this._$compile(element),current.slide.ready(function($contentContainer){$contentContainer.append(element),compiled(current.scope),current.scope.$apply()}),current.slide.open(),this._$q.when(current.slide.promise).then(function(slideValue){deferred.resolve(current.data||slideValue)},function(slideReason){deferred.reject(current.data||slideReason)}).finally(function(){current.scope.$destroy(),delete this._slides[id]}.bind(this))}.bind(this);if(this._slides[id])throw new Error("Slide already defined: "+id);return params.templateUrl?this._get_template(params.templateUrl).then(open):open(params.template),deferred.promise},Slide.prototype.get=function(id){var slide=this._slides[id];if(!slide)throw new Error('Slide "'+id+"\" doesn't exist");return slide},Slide.prototype.alert=function(){return this._$q.when(slideUtil.alert.apply(null,arguments))},Slide.prototype.confirm=function(){return this._$q.when(slideUtil.confirm.apply(null,arguments))},Slide.prototype._get_template=function(template){var deferred=this._$q.defer(),html=this._$templateCache.get(template);return html?deferred.resolve(html):this._$http.get(template).success(function(data){this._$templateCache.put(template,data),deferred.resolve(data)}.bind(this)),deferred.promise},Dialog.prototype.open=function(id,params){ftnt_shared.log.warn('Using deprecated service "dialog"'),params.model=params.model||{};var settings={templateUrl:params.template,data:params.model,_scopePreconfigure:function(scope){this._scopePreconfigure(id,params,scope)}.bind(this),options:{title:params.title,fullHeight:params.full_height,buttons:!0}},labels=params.button_labels||[],classes=params.button_classes||[];return params.disable_ok_button?settings.options.okButton=!1:(settings.options.okButtonLabel=labels[0]||void 0,settings.options.okButtonClass=null==classes[0]?"primary":classes[0],settings.options.okButtonClick=function(){var handler=params.submit_handler,current=this._slide.get(id);"function"==typeof handler?(current.slide.setLoading(!0),handler(params.model,current.scope).then(function(){current.slide.done()}).finally(function(){current.slide.setLoading(!1)})):current.slide.done()}.bind(this)),params.disable_cancel_button?settings.options.cancelButton=!1:(settings.options.cancelButtonLabel=labels[1]||void 0,settings.options.cancelButtonClass=null==classes[1]?void 0:classes[1]),this._slide.open(id,settings)},Dialog.prototype._scopePreconfigure=function(id,params,scope){angular.extend(scope,params.scope),scope.model=params.model,scope.disable_dialog_button=function(index,disable){var current=this._slide.get(id),options={},key=0===index?"okButtonDisabled":"cancelButtonDisabled";options[key]=disable,current.slide.update(options)}.bind(this),scope.hide_dialog_button=function(index,hide){var current=this._slide.get(id),options={},key=0===index?"okButton":"cancelButton";options[key]=!hide,current.slide.update(options)}.bind(this),scope.change_dialog_title=function(title){var current=this._slide.get(id);current.slide.update({title:title})}.bind(this),scope.change_dialog_button_labels=function(labels){var current=this._slide.get(id);current.slide.update({okButtonLabel:labels[0],cancelButtonLabel:labels[1]})}.bind(this),scope.close_dialog=function(){var current=this._slide.get(id);current.slide.close()}.bind(this)},ngModule.service({slide:Slide,dialog:Dialog})},{"../module":59}]},{},[1]),window.angular}),define("ng/templates",["ng/ftnt"],function(module){"use strict";module.run(function($templateCache){$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/templates/base.html",'<div ng-cloak f-scrolling id="ng-base"><div class="content" ng-include="dialog_template || \'main.html\' | cache_path"></div></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/templates/base_dialog.html",'<f-dialog dialog-title="$root.page_title | lang" loading="loading" hide-footer="$root.hide_footer_button" footer-type="$root.dialogFooterType" read-only="$root.ADMIN_RO" submit="submit()" form="form"><div ng-include="dialog_template || \'main.html\' | cache_path"></div></f-dialog>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/templates/base_list.html",'<div class="qlist-view-container"><div class="qlist-menu-bar"><div f-menu-bar qlist-element="qlistElement"><div ng-include="(menuItemsTemplate || \'/ng/directives/menu/menu_items.html\') | cache_path"></div></div><div f-pop-up-menu qlist-element="qlistElement"><div ng-include="(menuItemsTemplate || \'/ng/directives/menu/menu_items.html\') | cache_path"></div></div></div><div ng-include="extraContent | cache_path" ng-if="extraContent"></div><f-qlist qlist-element="qlistElement" source="qlistSource" options="qlistOptions" filters="qlistFilters"></f-qlist></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/templates/base_prompt.html",'<div class="dlg prompt"><div class="content" ng-include="dialog_template || \'main.html\' | cache_path"></div></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/directives/f-list.html",'<div class="qlist-view-container"><div class="qlist-menu-bar" ng-show="$ctrl.transcludeFilled"><div f-menu-bar qlist-element="$ctrl.qlistElement"><f-list-menu-transclude menu="menu" list="$ctrl" class="menu-bar-component"></f-list-menu-transclude></div><div f-pop-up-menu qlist-element="$ctrl.qlistElement"><f-list-menu-transclude menu="menu" list="$ctrl"></f-list-menu-transclude></div></div><f-qlist ng-show="!$ctrl.loading" qlist-element="$ctrl.qlistElement" source="$ctrl.source" options="$ctrl.options" filters="$ctrl.filters" qlist-ctrl="$ctrl.qlist"></f-qlist><div ng-if="$ctrl.loading" class="absolute-fill flex-centered"><div class="flex-column-centered"><f-icon class="fa-loading icon-xxxl"></f-icon><div>{{ $ctrl.loadingMessage() }}</div></div></div></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/directives/f-system-power.html",'<f-dialog hide-title="$ctrl.hideTitle" submit="$ctrl.submit()"><section><div class="warning-message"><f-icon class="fa-warning"></f-icon><div class="message-content">{{:: "Are you sure you want to {ACTION} the device?" | lang:[$ctrl.powerType] }}</div></div></section><section><div class="field"><label><span>{{:: \'Event log message\' | lang }}</span></label><div><div class="textarea-wrapper"><textarea rows="1" expand ng-model="$ctrl.logMsg"></textarea></div></div></div></section></f-dialog>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/prompt/default-password/f-default-password-prompt.html",'<div class="prompt" ng-class="{\'prompt-dialog\': $ctrl.showPasswordChange}"><div class="content"><div class="prompt-header"><h1>{{:: \'Password Change\' | lang }}</h1></div><div class="prompt-body"><span ng-show="!$ctrl.showPasswordChange"><div class="warning-message"><f-icon class="fa-warning"></f-icon><div class="message-content">{{:: \'This account is using the default password, it is strongly recommended that you change your password.\' | lang }}</div></div><div class="button-actions"><button class="primary" type="button" ng-click="$ctrl.changePassword()">{{:: \'change_passwd\' | lang }}</button> <button type="button" ng-click="$ctrl.continue()">{{:: \'Later\' | lang }}</button></div></span><div class="success-message" ng-show="$ctrl.successMessage"><div class="message-content">{{ $ctrl.successMessage | lang }}</div></div><div class="error-message" ng-show="$ctrl.errorMessage"><div class="message-content">{{ $ctrl.errorMessage | lang }}</div></div><f-password-change ng-show="$ctrl.showPasswordChange" relative="::true" hide-username="::true" change-success="$ctrl.changeSuccess()" change-failure="$ctrl.changeFailure(message)" class="prompt-dialog-component"></f-password-change></div></div></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/prompt/partials/power_prompt.html",'<div class="prompt"><div class="content"><h1>{{:: $ctrl.title }}</h1><div class="message" ng-if="!$ctrl.errorMessage"><f-icon ng-if="$ctrl.loading" class="fa-loading icon-xl"></f-icon><div class="message-content">{{:: $ctrl.message }}</div></div><div class="error-message" ng-if="$ctrl.errorMessage"><f-icon class="fa-error icon-xl"></f-icon><div class="message-content">{{:: $ctrl.errorMessage | lang }}</div></div></div></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/prompt/vm-license/f-vm-license-prompt.html",'<div class="prompt"><div class="content"><h1>{{:: \'FortiGate VM License\' | lang }}</h1><div class="message" ng-if="!$ctrl.errorMessage"><f-icon class="fa-loading icon-xl"></f-icon><div class="message-content">{{:: \'VM::License::status.vm_wait_auth\' | lang }}</div></div><div class="error-message" ng-if="$ctrl.errorMessage"><f-icon class="fa-error icon-xl"></f-icon><div class="message-content"><p>{{ $ctrl.errorMessage | lang }}</p><p ng-if="$ctrl.showCliConsole()"><button type="button" ng-click="$ctrl.cliConsole()">{{:: \'cli_console\' | lang}}</button></p></div></div></div></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/system/csf/f-csf-extension-devices-info.html",'<div class="flex-centered" ng-if="$ctrl.loading"><f-icon class="fa-loading"></f-icon></div><div class="extension-devices-info" ng-if="!$ctrl.loading"><div class="device" ng-class="{clickable: $ctrl.csfStatus.redirUrl}" f-tip-target ng-click="$ctrl.toggleRedirMenu($ctrl.redirPopUpMenu, $event, $ctrl.csfStatus)"><f-icon class="ftnt-fortigate-telemetry icon-xl" ng-class="$ctrl.csfStatus.severity"></f-icon><span ng-if="$ctrl.csfStatus.summary.totalConnected >= 0" class="count-overlay">{{ $ctrl.csfStatus.summary.totalConnected }}</span><div f-tip><table class="table key-value slightly-condensed"><tbody><tr class="section-header"><td colspan="2">{{::\'FortiGate Telemetry\' | lang}}</td></tr><tr><td>{{::\'status\' | lang}}</td><td><f-icon ng-class="$ctrl.csfStatus.icon"></f-icon><span>{{$ctrl.csfStatus.langKey | lang}}</span></td></tr></tbody></table></div></div><div class="device" ng-class="{clickable: $ctrl.fazStatus.redirUrl}" f-tip-target ng-click="$ctrl.toggleRedirMenu($ctrl.redirPopUpMenu, $event, $ctrl.fazStatus)" ng-if="$ctrl.hasFazPermission"><f-icon class="ftnt-fortianalyzer icon-xl" ng-class="$ctrl.fazStatus.severity"></f-icon><div f-tip><table class="table key-value slightly-condensed"><tbody><tr class="section-header"><td colspan="2">{{::\'fortianalyzer\' | lang}}</td></tr><tr><td>{{::\'status\' | lang}}</td><td><f-icon ng-class="$ctrl.fazStatus.icon"></f-icon><span>{{$ctrl.fazStatus.langKey | lang}}</span></td></tr><tr ng-if="$ctrl.fazStatus.server"><td>{{::\'Server\' | lang}}</td><td>{{$ctrl.fazStatus.server}}</td></tr></tbody></table></div></div><div class="device" ng-class="{clickable: $ctrl.sandboxStatus.redirUrl}" f-tip-target ng-if="$ctrl.hasFsaPermission" ng-click="$ctrl.toggleRedirMenu($ctrl.redirPopUpMenu, $event, $ctrl.sandboxStatus)"><f-icon class="ftnt-fortisandbox icon-xl" ng-class="$ctrl.sandboxStatus.severity"></f-icon><div f-tip><table class="table key-value slightly-condensed"><tbody><tr class="section-header"><td colspan="2">{{\'sandbox_type::\' + $ctrl.sandboxStatus.type | lang}}</td></tr><tr><td>{{::\'status\' | lang}}</td><td><f-icon ng-class="$ctrl.sandboxStatus.icon"></f-icon><span>{{$ctrl.sandboxStatus.langKey | lang}}</span></td></tr><tr ng-if="$ctrl.sandboxStatus.server"><td>{{::\'Server\' | lang}}</td><td>{{$ctrl.sandboxStatus.server}}</td></tr><tr ng-if="$ctrl.sandboxStatus.account"><td>{{::\'Account\' | lang}}</td><td>{{$ctrl.sandboxStatus.account}}</td></tr></tbody></table></div></div><div class="device" ng-class="{clickable: $ctrl.fmgStatus.redirUrl}" f-tip-target ng-click="$ctrl.toggleRedirMenu($ctrl.redirPopUpMenu, $event, $ctrl.fmgStatus)"><f-icon class="ftnt-fortimanager icon-xl" ng-class="$ctrl.fmgStatus.severity"></f-icon><div f-tip><table class="table key-value slightly-condensed"><tbody><tr class="section-header"><td colspan="2">{{::\'fmg\' | lang}}</td></tr><tr><td>{{::\'status\' | lang}}</td><td><f-icon ng-class="$ctrl.fmgStatus.icon"></f-icon><span>{{$ctrl.fmgStatus.langKey | lang}}</span></td></tr><tr ng-if="$ctrl.fmgStatus.server"><td>{{::\'Server\' | lang}}</td><td>{{$ctrl.fmgStatus.server}}</td></tr><tr ng-if="$ctrl.fmgStatus.mode"><td>{{::\'Mode\' | lang}}</td><td>{{ ($ctrl.fmgStatus.mode === \'normal\' ? \'cmgmt\' : $ctrl.fmgStatus.mode) | lang}}</td></tr></tbody></table></div></div><div class="device" ng-repeat="status in $ctrl.managedDeviceStatus" ng-class="{clickable: status.redirUrl}" f-tip-target ng-if="$ctrl.hasWifiSwitchCtrlPermission" ng-click="$ctrl.toggleRedirMenu($ctrl.redirPopUpMenu, $event, status)"><f-icon class="icon-lg" ng-class="[status.icon, status.severity]"></f-icon><span ng-if="status.summary.totalConnected > 0" class="count-overlay">{{ status.summary.totalConnected }}</span></div><div class="device" ng-class="{clickable: $ctrl.fctStatus.redirUrl}" f-tip-target ng-if="$ctrl.hasFctPermission" ng-click="$ctrl.toggleRedirMenu($ctrl.redirPopUpMenu, $event, $ctrl.fctStatus)"><f-icon class="ftnt-forticlient icon-lg" ng-class="$ctrl.fctStatus.severity"></f-icon><span ng-if="$ctrl.fctStatus.summary.totalConnected > 0" class="count-overlay">{{ $ctrl.fctStatus.summary.totalConnected }}</span><div f-tip><table class="table key-value slightly-condensed"><tbody><tr class="section-header"><td colspan="2">{{::\'FortiClient\' | lang}}</td></tr><tr><td class="v-align-top">{{::\'Vulnerabilities\' | lang}}</td><td ng-if="!$ctrl.fctStatus.vulnerabilities.vuln_count">{{:: \'None\' | lang}}</td><td ng-if="$ctrl.fctStatus.vulnerabilities.vuln_count"><f-vulnerability-number-bubbles counts-by-type="$ctrl.fctStatus.vulnerabilities"></f-vulnerability-number-bubbles></td></tr></tbody></table></div></div></div><div f-pop-up-menu="$ctrl.redirPopUpMenu"><div f-menu-item-button click="$ctrl.redirTo($ctrl.selectedStatus.redirUrl)"><f-icon class="fa-external-link"></f-icon><span ng-if="$ctrl.selectedStatus === $ctrl.csfStatus ||\n            $ctrl.selectedStatus === $ctrl.sandboxStatus">{{::\'Configure settings in Security Fabric > Settings\' | lang}} </span><span ng-if="$ctrl.selectedStatus === $ctrl.fazStatus">{{ :: $ctrl.getFazLogRedirLabel() }} </span><span ng-if="$ctrl.managedDeviceStatus.indexOf($ctrl.selectedStatus) >= 0">{{::\'Show in Security Fabric > Physical Topology\' | lang}} </span><span ng-if="$ctrl.selectedStatus === $ctrl.fmgStatus">{{::\'Configure settings in System > Settings\' | lang}} </span><span ng-if="$ctrl.selectedStatus === $ctrl.fctStatus">{{::\'Show in User & Device > Device Inventory\' | lang}}</span></div></div>');
})}),define("ng/directives/menu/templates",["ng/ftnt"],function(module){"use strict";module.run(function($templateCache){$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/directives/menu/menu_items.html",'<div ng-controller="QlistCustomMenuItems" ng-include="\'/ng/directives/menu/menu_items_base.html\' | cache_path"></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/directives/menu/menu_items_base.html",'<div class="left-menu-items" ng-include="leftMenuItemsTemplate || \'/ng/directives/menu/partials/defaults.html\' | cache_path"></div><div class="center-menu-items" ng-hide="menu.popUpMenu"><div f-menu-item-qlist-search ng-show="showSearch"></div></div><div class="right-menu-items" ng-hide="menu.popUpMenu"></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/directives/menu/menu_items_search.html",'<div ng-controller="QlistCustomMenuItems" ng-init="showSearch = true" ng-include="\'/ng/directives/menu/menu_items_base.html\' | cache_path"></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/directives/menu/partials/clone.html",'<div f-menu-item-button click="clone()" enabled="_enabled" ng-if="!$root.ADMIN_RO"><f-icon class="ftnt-copy"></f-icon>{{\'clone\' | lang}}</div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/directives/menu/partials/create_new.html",'<div f-menu-item-button click="createNew()" enabled="_enabled !== false" ng-if="!$root.ADMIN_RO && menu.menuBar"><f-icon class="fa-plus"></f-icon>{{ (isAdd ? \'add\' : \'Create New\') | lang}}</div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/directives/menu/partials/defaults.html",'<div f-menu-item-create create-fn="create" ng-hide="hideCreate" is-add="createIsAdd" enabled="createEnabled()"></div><div f-menu-item-edit edit-fn="edit" ng-hide="hideEdit" enabled="editEnabled($entries)"></div><div f-menu-item-edit-cli edit-cli-fn="editCli" ng-show="showEditCli" enabled="editCliEnabled($entries)"></div><div f-menu-item-clone clone-fn="clone" ng-show="showClone" enabled="cloneEnabled($entries)"></div><div f-menu-item-delete delete-fn="delete" ng-hide="hideDelete" enabled="deleteEnabled($entries)" delete-entries-fn="deleteEntriesFn"></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/directives/menu/partials/delete.html",'<div f-menu-item-button click="delete()" enabled="_enabled" ng-if="!$root.ADMIN_RO"><f-icon class="fa-trash-o"></f-icon>{{::(labelKey || \'del\') | lang}}</div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/directives/menu/partials/edit.html",'<div f-menu-item-button click="edit()" enabled="_enabled"><f-icon ng-class="{\'fa-pencil\': !$root.ADMIN_RO && !_viewOnly, \'ftnt-view\': $root.ADMIN_RO || _viewOnly}"></f-icon><span ng-if="$root.ADMIN_RO || _viewOnly">{{::\'view\' | lang}} </span><span ng-if="!$root.ADMIN_RO && !_viewOnly">{{::\'edit\' | lang}}</span></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/directives/menu/partials/editcli.html",'<div f-menu-item-button click="editCli()" enabled="_enabled" class="mini-hide" ng-if="!$root.ADMIN_RO && menu.popUpMenu"><f-icon class="fa-terminal"></f-icon><span>{{::\'Edit in CLI\' | lang}}</span></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/directives/menu/partials/expand_all.html","<div f-menu-item-button click=\"expandCollapse()\"><f-icon ng-class=\"{'fa-plus': !collapse, 'fa-minus': collapse}\"></f-icon>{{collapse ? 'collapse_all' : 'expand_all' | lang}}</div>"),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/directives/menu/partials/fsw-quarantine.html",'<div f-menu-item-button click="$ctrl.openSlide()" ng-if="$ctrl.canQuarantine() && !$root.ADMIN_RO"><f-icon class="ftnt-quarantine"></f-icon><span>{{:: \'Quarantine Host on FortiSwitch\' | lang}}</span></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/directives/menu/partials/log-source-information.html",'<div class="menu-item menu-item-padded" f-tip-target f-menu-item-submenu="logDeviceMenu"><f-icon ng-class="[\'icon-lg\', $ctrl.showWarning ? \'fa-warning\' : $ctrl.DEVICE_ICONS[$ctrl.device]]"></f-icon><div f-tip display-options="$ctrl.ftip_options"><div><div class="flex-row-centered"><span f-lang="Log location:"></span><f-icon ng-show="$ctrl.device === \'fortianalyzer\'" ng-class="$ctrl.DEVICE_ICONS[$ctrl.device]"></f-icon><span ng-if="$ctrl.thisFortigate.serial === $ctrl.serial"><span>{{ $ctrl.DEVICE_LABELS[$ctrl.device] || $ctrl.device | lang }}</span> <span ng-if="$ctrl.device === \'fortianalyzer\'">({{ $ctrl.devices[$ctrl.device].server }})</span></span></div><div ng-if="$ctrl.thisFortigate.serial !== $ctrl.serial"><span>{{ \'HA Cluster: {serial}\' | lang:[$ctrl.serial] }}</span></div><ul class="unstyled" ng-if="$ctrl.thisFortigate.serial === $ctrl.serial"><li ng-repeat="fortigate in $ctrl.fortigates"><div class="flex-row-centered"><f-icon ng-class="fortigate.getIconClass()"></f-icon><span>{{ fortigate.getLabel() }}</span></div></li></ul><div class="warning-message" ng-show="$ctrl.showWarning"><f-icon class="fa-warning"></f-icon><div class="message-content"><a href="/ng/log/settings">{{:: \'Selected log location is currently disabled.\' | lang }}</a></div></div></div></div></div><div f-pop-up-menu="logDeviceMenu"><div f-menu-item-button ng-repeat="option in $ctrl.logDeviceOptions" click="$ctrl.setDevice(option)" selected="option === $ctrl.device"><span>{{ :: option | lang }}</span><f-icon ng-show="!$ctrl.logDeviceState[option].is_available" class="fa-warning"></f-icon><f-icon ng-show="option === $ctrl.defaultDevice" class="fa-favorite"></f-icon></div></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/directives/menu/partials/quarantine-options.html",'<f-menu-item-fsw-quarantine menu="quarOpt.menu"></f-menu-item-fsw-quarantine><div f-menu-item-quarantine ng-if="quarOpt.canQuarantineSourceIp()" srcip-col-name="quarOpt.sourceIpColumnName()"></div><div f-menu-item-button ng-if="quarOpt.canQuarantineDevice()" click="quarOpt.quarantineDevice()"><f-icon class="ftnt-quarantine"></f-icon><span f-lang="Quarantine FortiClient Device"></span></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/directives/menu/partials/quarantine.html",'<div f-menu-item-button click="quarantine(menu.entries)" ng-if="state.adminHasWritePermission(state.ACCESS_GROUP.USER_DEVICE)"><f-icon class="ftnt-quarantine"></f-icon><span>{{:: \'Ban IP\' | lang}}</span> <span ng-show="addrs.length">&nbsp;({{ addrs.length == 1 ? addrs[0] : \'{ADDRESS}...\' | lang:[addrs[0]] }})</span></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/directives/menu/partials/quarantine_dlg.html",'<div class="dialog"><form><div class="info-message"><f-icon class="fa-info-circle"></f-icon><div ng-hide="fortigate" class="message-content" f-lang="An IP ban will be created..."></div><div ng-show="fortigate" class="message-content" ng-bind-html="::\'An IP ban will be created on FortiGate...\' | lang:[fortigate]"></div></div><section><div class="field"><label f-lang="Ban Type"></label><div><div class="radio-group"><input type="radio" ng-value="false" id="quarantine-temporary" ng-model="model.permanent"><label for="quarantine-temporary" f-lang="Temporary"></label><input type="radio" ng-value="true" id="quarantine-permanent" ng-model="model.permanent"><label for="quarantine-permanent" f-lang="Permanent"></label></div></div></div><div class="field" ng-hide="model.permanent"><label for="quarantine-duration" f-lang="Duration"></label><div><input type="number" min="1" name="quarantine-duration" ng-model="model.duration"><select name="multiplier" ng-model="model.interval" ng-options="opt.value as opt.label_key|lang for opt in intervals"></select></div></div></section></form></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/directives/menu/partials/search.html",'<div class="search-container" ng-class="{\'mini-hide\': miniHideInput}"><input type="text" class="search-input" placeholder="{{\'search\' | lang}}" ng-model="searchValue" ng-focus="searchFocussed()"><f-icon class="fa-times clear-search" title="{{\'clear_search\' | lang}}" ng-show="searchValue" ng-click="clearSearch()"></f-icon></div><button type="button" class="do-search" ng-disabled="searching" ng-click="search()"><div class="flex-menu-content"><f-icon ng-class="{\n            \'fa-search\': !searching,\n            \'fa-loading\': searching\n        }"></f-icon></div></button>')})}),define("ng/structure/templates",["ng/ftnt"],function(module){"use strict";module.run(function($templateCache){$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/structure/directives/f-firmware-upgrade.html",'<div class="prompt unbounded masking" ng-if="$ctrl.firmwareUpgrade.running"><div class="content"><h1><span ng-if="!$ctrl.firmwareUpgrade.image.olderThanCurrent">{{::\'Upgrading to {0}\' | lang:[$ctrl.firmwareUpgrade.image.getLabel()]}} </span><span ng-if="$ctrl.firmwareUpgrade.image.olderThanCurrent">{{::\'Downgrading to {0}\' | lang:[$ctrl.firmwareUpgrade.image.getLabel()]}}</span></h1><div ng-if="$ctrl.firmwareUpgrade.currentStep === $ctrl.firmwareUpgrade.STEPS.CONFIRM"><div class="warning-message"><f-icon class="fa-warning icon-lg"></f-icon><div class="message-content"><span ng-if="!$ctrl.firmwareUpgrade.image.olderThanCurrent">{{::\'confirm_image_upgrade\' | lang}} </span><span ng-if="$ctrl.firmwareUpgrade.image.olderThanCurrent">{{::\'confirm_image_downgrade\' | lang}}</span></div></div></div><div ng-if="$ctrl.firmwareUpgrade.currentStep === $ctrl.firmwareUpgrade.STEPS.BACKUP_CONFIG"><div class="message"><f-icon class="fa-loading icon-lg"></f-icon><div class="message-content">{{::\'Backing up your current configuration\' | lang}}</div></div></div><div ng-if="$ctrl.firmwareUpgrade.currentStep === $ctrl.firmwareUpgrade.STEPS.RUN_UPGRADE &&\n            !$ctrl.firmwareUpgrade.uploadComplete"><div class="message"><f-icon class="fa-loading icon-lg"></f-icon><div class="message-content"><div>{{::\'Uploading image\' | lang}}</div></div></div><div f-progress-bar="$ctrl.firmwareUpgrade.uploadPercentage" show-percentage="::true" class="fast-update"></div></div><div ng-if="$ctrl.firmwareUpgrade.currentStep === $ctrl.firmwareUpgrade.STEPS.RUN_UPGRADE &&\n            $ctrl.firmwareUpgrade.uploadComplete"><div class="message"><f-icon class="fa-loading icon-lg"></f-icon><div class="message-content" ng-if="$ctrl.firmwareUpgrade.image.source === \'fortiguard\'">{{::\'Downloading and installing image\' | lang}}</div><div class="message-content" ng-if="$ctrl.firmwareUpgrade.image.source === \'upload\'">{{::\'Validating and installing image\' | lang}}</div><div class="message-content" ng-if="$ctrl.firmwareUpgrade.image.source === \'usb\'">{{::\'Transferring image from USB and installing\' | lang}}</div></div></div><div class="button-actions" ng-if="$ctrl.firmwareUpgrade.currentStep === $ctrl.firmwareUpgrade.STEPS.CONFIRM"><button type="button" ng-click="$ctrl.firmwareUpgrade.nextStep()">{{::\'Continue\' | lang}}</button> <button type="button" ng-click="$ctrl.firmwareUpgrade.cancel()">{{::\'Cancel\' | lang}}</button></div></div></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/structure/partials/f-disconnection-notice.html",'<div class="prompt unbounded masking" ng-if="$ctrl.connection.disconnected"><div class="content"><h1>{{\'Lost Connection to {0} - {1}\' | lang: [ $ctrl.state.model_name, $ctrl.formatDuration($ctrl.connection.disconnectedDuration) ]}}</h1><div class="message"><f-icon class="fa-loading icon-xl"></f-icon><div class="message-content">{{::\'Attempting to reconnect\'}}</div></div></div></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/structure/partials/f-embedded-iframe.html",'<iframe name="embedded-iframe" ng-class="{\'loading\': embeddedIframe.loading}"></iframe><div class="loading-placeholder" ng-show="embeddedIframe.loading"><f-icon class="fa-loading icon-xxxl"></f-icon></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/structure/partials/f-fullscreen-toggle.html",'<div class="flex-column-centered" id="screen-mode-wrapper"><div class="tooltip-style small-hide" ng-mouseenter="$ctrl.toggleExitFullScreenButton(true)" ng-mouseleave="$ctrl.toggleExitFullScreenButton(false)"><div class="fullscreen-container"><div class="fullscreen-button-wrapper" ng-class="{\'pop-out\': $ctrl.showButton}"><button type="button" ng-click="$ctrl.closeFullscreen()"><span>{{ ::(\'Exit Full Screen Mode\' | lang) }}</span></button></div><div class="invis-trigger"></div></div></div><div class="tooltip-style small-show"><button type="button" ng-click="$ctrl.closeFullscreen()"><span>{{ ::(\'Exit Full Screen Mode\' | lang) }}</span></button></div></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/structure/partials/f-shortcuts-help.html",'<div class="prompt unbounded masking" ng-show="shortcutsHelp.shortcuts.showHelp"><div class="content"><h1>{{::\'Keyboard Shortcuts Help\' | lang}}</h1><div class="shortcuts-help" f-with="shortcutsHelp.bindings.view.length as viewDefined"><div><h2 ng-show="viewDefined">{{::\'general\' | lang}}</h2><table class="table bordered"><thead><tr><th>Shortcut</th><th>Action</th></tr></thead><tbody><tr ng-repeat="binding in shortcutsHelp.bindings.global"><td><span ng-repeat="label in ::binding.labels">{{::label}} <span class="or" ng-hide="::$last">{{::\'or\' | lang}}</span></span></td><td>{{::binding.help | lang}}</td></tr></tbody></table></div><div ng-show="viewDefined"><h2>{{::\'Current Page\' | lang}}</h2><table class="table bordered"><thead><tr><th>Shortcut</th><th>Action</th></tr></thead><tbody><tr ng-repeat="binding in shortcutsHelp.bindings.view"><td><span ng-repeat="label in ::binding.labels">{{::label}} <span class="or" ng-hide="::$last">{{::\'or\' | lang}}</span></span></td><td>{{::binding.help | lang}}</td></tr></tbody></table></div></div><div class="button-actions"><button type="button" ng-click="shortcutsHelp.shortcuts.showHelp = false">{{::\'Close\' | lang}}</button></div></div></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/structure/partials/guestadmin_header.html",'<div class="platform"><div>{{ \'guest_user_management\' | lang }}</div></div><div class="expand"><button type="button" class="bare" ng-click="structure.toggleResponsiveMenu()" title="{{\'Show menu\' | lang}}"><f-icon class="ftnt-hamburger icon-lg"></f-icon></button></div><div class="expandable" ng-class="{expanded: structure.responsiveMenu}" ng-controller="AppControls"><button type="button" class="bare" ng-click="openHelp()" title="{{\'help\' | lang}}"><f-icon class="ftnt-help-o icon-lg"></f-icon></button> <button type="button" class="bare" f-pop-up-menu-toggle="adminPopUpMenu"><div class="small-hide">{{state.admin.login_name}}</div><f-icon class="ftnt-user-o icon-lg small-show"></f-icon></button><div f-pop-up-menu="adminPopUpMenu"><div f-menu-item-button click="changePassword()"><f-icon class="fa-lock"></f-icon>{{\'change_passwd\' | lang}}</div><div class="separator"></div><div f-menu-item-button click="logout()"><f-icon class="fa-sign-out"></f-icon>{{\'Logout\' | lang}}</div></div></div><div class="error-message-container"><div class="error-message"><f-icon class="fa-exclamation-triangle"></f-icon>{{state.platform_error | lang}}</div></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/structure/partials/navbar.html",'<div ng-if="navbarCtrl.state.vdom_mode && navbarCtrl.state.admin.vdoms.length > 1" ng-hide="navbarCtrl.loading" class="vdom-selection" f-omniselect="navbarCtrl.VDOM_SELECTION_CONFIG" ng-model="navbarCtrl.vdom" reload-on="state.LOADED_EVENT"></div><div class="loading-container" ng-show="navbarCtrl.loading || navbarCtrl.loadingVdom"><f-icon class="fa-loading icon-lg"></f-icon></div><ul class="root" ng-hide="navbarCtrl.loadingVdom"><li class="no-matches" ng-if="navbarCtrl.navbar._searchValue && !navbarCtrl.navbar.tree.items.length">{{::\'no_entries\' | lang}}</li><li class="level-0" ng-if="navbarCtrl.favorites.list.length && !navbarCtrl.navbar._searchValue" ng-class="{\'expanded-menu\': navbarCtrl.navbar.isExpanded(navbarCtrl.navbar.FAVORITE_MENU_NAME)}"><div class="submenu"><div class="submenu-label" ng-click="navbarCtrl.navbar.entryClicked()"><f-icon class="fa-favorite menu-item-icon"></f-icon><span>{{::\'favorites\' | lang }}</span> <span class="spacer"></span><f-icon class="fa-angle-right" ng-class="{\n                        \'rotate-0\': !navbarCtrl.navbar.isExpanded(navbarCtrl.navbar.FAVORITE_MENU_NAME),\n                        \'rotate-90\': navbarCtrl.navbar.isExpanded(navbarCtrl.navbar.FAVORITE_MENU_NAME)\n                    }"></f-icon></div><ul ng-show="navbarCtrl.navbar.isExpanded(navbarCtrl.navbar.FAVORITE_MENU_NAME)" ui-sortable="navbarCtrl.favoriteSortingOptions" ng-model="navbarCtrl.favorites.list" f-vertical-collapse><li class="level-1" ng-repeat="entry in navbarCtrl.favorites.list"><div f-navbar-menu-item="::entry" reorderable-favorite></div></li></ul></div></li><li ng-repeat="entry in navbarCtrl.navbar.tree.items" class="level-0" ng-class="{\'expanded-menu\': navbarCtrl.navbar.isExpanded(entry.name),\n            \'navbar-selected\': navbarCtrl.navbar.isSelected(entry)}"><div f-navbar-menu-item="::entry"></div><div class="submenu" ng-if="::!entry.uri"><div class="submenu-label" ng-click="navbarCtrl.navbar.entryClicked(entry)"><f-icon class="menu-item-icon" ng-class="::entry.icon"></f-icon><span>{{::entry.label}}</span> <span class="spacer"></span><f-icon class="fa-angle-right" ng-class="{\n                        \'rotate-0\': !navbarCtrl.navbar.isExpanded(entry.name),\n                        \'rotate-90\': navbarCtrl.navbar.isExpanded(entry.name)\n                    }"></f-icon></div><f-navbar-menu menu="::entry" level="::1"></f-navbar-menu></div></li></ul><div class="navigation-search"><div class="button-style bare" ng-click="navbarCtrl.searchInputVisible = true" ng-hide="navbarCtrl.searchInputVisible"><f-icon class="fa-search"></f-icon></div><f-search-input input-placeholder="::\'What are you looking for?\' | lang" debounce="500" ng-show="navbarCtrl.searchInputVisible" model="navbarCtrl.searchModel" show-focus="navbarCtrl.searchInputVisible" on-empty-blur="navbarCtrl.searchInputVisible = false" on-key-down="navbarCtrl.onSearchKeyDown($event)"></f-search-input></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/structure/partials/navbar_menu.html",'<ul ng-show="navbarMenuCtrl.level > 1 || navbarMenuCtrl.navbar.isExpanded(navbarMenuCtrl.menu.outermostParent)" ui-sortable="navbarMenuCtrl.menu.sortableOptions" ng-model="navbarMenuCtrl.menu.items" f-vertical-collapse="::navbarMenuCtrl.level === 1"><li ng-repeat="entry in navbarMenuCtrl.menu.items" ng-class="::{\'has-children\': !entry.uri}" class="level-{{::navbarMenuCtrl.level}}"><div f-navbar-menu-item="::entry"></div><div class="submenu" ng-if="::!entry.uri"><div class="submenu-label" ng-hide="::!entry.showLabel"><f-icon class="menu-item-icon"></f-icon><span>{{::entry.label}}</span></div><f-navbar-menu menu="::entry" level="::navbarMenuCtrl.level + 1"></f-navbar-menu></div></li></ul>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/structure/partials/navbar_menu_item.html",'<a ng-href="{{::menuItemCtrl.entry.uri | ngURI}}" ng-if="::menuItemCtrl.entry.uri" ng-class="{\n        selected: menuItemCtrl.navbar.isSelected(menuItemCtrl.entry),\n        \'nav-focused\': menuItemCtrl.isIndexedResult\n    }"><div class="menu-item-icons"><f-icon class="reorderable-icon ftnt-drag" ng-if="(menuItemCtrl.reorderableFavorite || menuItemCtrl.entry.reorderableItem) &&\n            !menuItemCtrl.currentlyReordering"></f-icon><f-icon class="menu-item-icon" ng-class="menuItemCtrl.menuItemIcon"></f-icon></div><span ng-bind-html="::menuItemCtrl.entry.htmlLabel"></span></a><f-icon class="favorite-icon" ng-if="::menuItemCtrl.entry.uri && !menuItemCtrl.entry.temporary" ng-class="menuItemCtrl.favoriteIcon" title="{{menuItemCtrl.isFavorite ? \'Remove Favorite\' : \'Add Favorite\' | lang}}" ng-click="menuItemCtrl.toggleFavorite($event)"></f-icon>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/structure/partials/section.html",'<nav f-navbar ng-if="showStructure && showNavigation" ng-class="{expanded: structure.responsiveMenu}"></nav><div class="view-container" ng-view ng-cloak f-include-cloak ng-if="!$routeIsSegment"></div><div class="view-container" ng-if="$routeIsSegment"><div app-view-segment="0"></div></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/structure/partials/timeout.html",'<div><div class="warning-message"><f-icon class="fa-exclamation-triangle"></f-icon><div class="message-content"><b>{{::\'session_expires_soon_heading\' | lang}}</b> {{::\'session_expires_soon_message\' | lang}}<div ng-bind-html="\'session_expires_soon_count\' | lang: [ctrl.timeout.count]"></div></div></div></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/structure/partials/usb_disk.html",'<div class="info-text" ng-show="usbDiskAutoInstall"><a href="/ng/system/advanced?vdom="><span ng-show="!usbDisk.data.auto_install_conf && usbDisk.data.auto_install_image">{{ ::\'FortiOS image file on USB will be loaded on next boot\' | lang }} </span><span ng-show="usbDisk.data.auto_install_conf && !usbDisk.data.auto_install_image">{{ ::\'Config file on USB will be loaded on next boot\' | lang }} </span><span ng-show="usbDisk.data.auto_install_conf && usbDisk.data.auto_install_image">{{ ::\'FortiOS image and config file on USB will be loaded on next boot\' | lang }}</span></a></div><div class="info-key-value"><div><span>{{ ::\'USB Disk\' | lang }}</span> <span><span>{{ usbDisk.data.disk_size | binaryBytes }}</span> <span>{{ usbDisk.data.model }}</span></span></div><div><span>{{ ::\'Available\' | lang }}</span> <span>{{ usbDisk.data.avail_space | binaryBytes }}</span></div><div ng-show="state.current_vdom && usbDisk.isDiskModel"><span>{{ ::\'Log Size\' | lang }}</span> <span><span ng-if="usbDisk.data.log_size > 0">~{{ usbDisk.data.log_size | binaryBytes }}</span> <span ng-if="!usbDisk.data.log_size">0</span> (<span>{{ usbDisk.data.log_file_no || 0 }}</span> files)</span></div></div><div ng-show="usbDisk.data.is_copying"><div f-progress-bar="usbDisk.data.progress" show-percentage="true"></div></div><div class="info-text" ng-show="usbDisk.isInsufficientSpace()"><span>{{ ::\'Insufficient USB disk space\' | lang }}</span></div><div class="separator"></div><div><div f-menu-item-button pop-up-stay-open click="usbDisk.startCopy()" ng-show="usbDisk.copyEnabled()">{{ ::\'Copy to USB\' | lang }}</div><div f-menu-item-button pop-up-stay-open click="usbDisk.stopCopy()" ng-show="usbDisk.stopEnabled()">{{ ::\'Stop\' | lang }}</div><div f-menu-item-button>{{ ::\'Close\' | lang }}</div></div>'),$templateCache.put("/30cf633bfb2210af603f817d96aeaf32/ng/structure/partials/header.html",'<div class="fortinet-grid-icon"><f-icon class="ftnt-fortinet-grid icon-xxl"></f-icon></div><div class="platform"><div>{{::state.model_name}} {{::state.model_number}}</div><div class="hostname small-hide"><span f-object-tooltip mkey="{{::state.serial}}" datasource="csfFortiGates">{{state.hostname}}</span></div></div><div class="expand"><button type="button" class="bare" ng-click="structure.toggleResponsiveMenu()" title="{{\'Show menu\' | lang}}"><f-icon class="ftnt-hamburger icon-lg"></f-icon></button></div><div class="expandable" ng-class="{expanded: structure.responsiveMenu}" ng-controller="AppControls" f-with="state.readOnlyAdmin() as readOnlyAdmin;\n            usbDisk.data.auto_install_conf || usbDisk.data.auto_install_image as usbDiskAutoInstall"><button type="button" class="bare" ng-if="::!state.admin.guest_admin && (state.centrally_managed || state.fortimanager_backup_mode)" f-pop-up-menu-toggle="$parent.fortimanagerPopUpMenu"><f-icon class="icon-lg" ng-class="{\'ftnt-cmgmt-ro-o\': readOnlyAdmin, \'ftnt-cmgmt-rw-o\': !readOnlyAdmin}" ng-if="::state.centrally_managed"></f-icon><f-icon class="icon-lg ftnt-fmg-backup-mode" ng-if="::state.fortimanager_backup_mode"></f-icon></button><div f-pop-up-menu="$parent.fortimanagerPopUpMenu" ng-if="::!state.admin.guest_admin && (state.centrally_managed || state.fortimanager_backup_mode)"><div class="heading"><span ng-if="::state.centrally_managed">{{::\'Managed by FortiManager\' | lang}} </span><span ng-if="::state.fortimanager_backup_mode">{{::\'Configuration backup mode\' | lang}}</span></div><div class="info-key-value"><div><span>{{::\'fmg\' | lang}}</span> <span>{{state.fortimanager}}</span></div><div ng-if="::state.centrally_managed"><span>{{::\'Login Mode\' | lang}}</span> <span ng-if="::readOnlyAdmin">{{::\'Read-only\' | lang}} </span><span ng-if="::!readOnlyAdmin">{{::\'Read-write\' | lang}}</span></div></div><div f-with="state.admin.global_admin && state.adminHasWritePermission(state.ACCESS_GROUP.SYSTEM) &&\n            state.centrally_managed as canChangeLoginMode"><div class="separator" ng-if="canChangeLoginMode"></div><div f-menu-item-button click="centrallyManagedPrompt()" ng-if="canChangeLoginMode"><f-icon class="fa-sign-in"></f-icon>{{::\'Change Login Mode\' | lang}}</div></div></div><button type="button" class="bare" ng-if="usbDisk.isVisible()" f-pop-up-menu-toggle="$parent.usbPopUpMenu" ng-class="{\'shake-once\': usbDisk.copyDoneNotified}"><f-icon ng-show="usbDiskAutoInstall" class="ftnt-usb-warn-o icon-lg"></f-icon><f-icon ng-show="!usbDiskAutoInstall" class="ftnt-usb-o icon-lg"></f-icon></button><div f-pop-up-menu="$parent.usbPopUpMenu" ng-if="usbDisk.isVisible()"><div ng-include="\'/ng/structure/partials/usb_disk.html\' | cache_path"></div></div><button type="button" class="bare" f-pop-up-menu-toggle="notificationPopUpMenu"><f-icon class="fa-notification icon-lg"></f-icon><span class="count-overlay severity-{{notification.highestSeverityLevel}}" ng-show="notification.failCount">{{notification.failCount}}</span></button><div class="notification-pop-up" f-pop-up-menu="notificationPopUpMenu"><div class="info-text" ng-hide="notification.failCount">{{::\'No notifications at this time\' | lang}}</div><div ng-repeat="item in notification.failedNotificationItems"><div ng-if="item.MULTIPLE"><div f-menu-item-button ng-repeat="_ in ::item._messages track by $index" click="item.onClick($index)" enabled="item.canClick()"><f-icon class="fa-severity-{{::item.SEVERITY_LEVEL}}"></f-icon><span>{{::item.getMessage($index)}}</span></div></div><div ng-if="!item.MULTIPLE"><div f-menu-item-button click="item.onClick()" enabled="item.canClick()"><f-icon class="fa-severity-{{::item.SEVERITY_LEVEL}}"></f-icon><span>{{::item.getMessage()}}</span></div></div></div></div><button type="button" class="bare" f-pop-up-menu-toggle="helpPopUpMenu"><f-icon class="ftnt-help-o icon-lg"></f-icon><span class="count-overlay severity-low" ng-show="help.videos.length">{{help.videos.length}}</span></button><div f-pop-up-menu="helpPopUpMenu"><div f-menu-item-button click="openHelp()"><f-icon class="fa-book"></f-icon><span>{{::\'Online Help\' | lang}}</span></div><div f-menu-item-button click="openVideo()"><f-icon class="fa-video-camera"></f-icon><span>{{::\'Video Tutorials\' | lang}}</span></div><div class="separator" ng-show="help.videos.length"></div><div f-menu-item-button ng-repeat="video in help.videos" click="openVideo(video)"><f-icon class="fa-play-circle-o help-video-icon"></f-icon>{{video.description}}</div></div><button type="button" class="bare" ng-click="cliConsole()"><f-icon class="fa-terminal icon-lg"></f-icon></button> <button type="button" class="bare" ng-click="openFullscreen()"><f-icon class="ftnt-full-screen icon-lg"></f-icon></button> <button type="button" class="bare" f-pop-up-menu-toggle="adminPopUpMenu"><div class="small-hide">{{state.admin.login_name}}</div><f-icon class="ftnt-user-o icon-lg small-show"></f-icon></button><div f-pop-up-menu="adminPopUpMenu"><div f-menu-item-submenu="$parent.systemPopUpMenu" ng-if="::powerControlsVisible"><f-icon class="fa-cog"></f-icon>{{::\'system\' | lang}}</div><div f-menu-item-submenu="$parent.configurationPopUpMenu" ng-if="::configurationVisible"><f-icon class="fa-file-o"></f-icon>{{::\'Configuration\' | lang}}</div><div class="separator"></div><div f-menu-item-button click="changePassword()" ng-if="::!state.admin.pki_admin && !state.admin.remote_admin"><f-icon class="fa-lock"></f-icon>{{::\'change_passwd\' | lang}}</div><div f-menu-item-button click="changePassword()" ng-if="::state.admin.remote_admin && !state.admin.remote_wildcard_admin"><f-icon class="fa-lock"></f-icon>{{::\'Change Backup Password\' | lang}}</div><div f-menu-item-button click="logout()"><f-icon class="fa-sign-out"></f-icon>{{::\'Logout\' | lang}}</div></div><div f-pop-up-menu="$parent.systemPopUpMenu" ng-if="::powerControlsVisible"><div f-menu-item-button ng-if="::powerControlsVisible" click="powerDevice(\'reboot\')"><f-icon class="fa-repeat"></f-icon>{{::\'Reboot\' | lang}}</div><div f-menu-item-button ng-if="::powerControlsVisible" click="powerDevice(\'shutdown\')"><f-icon class="ftnt-shutdown"></f-icon>{{::\'Shutdown\' | lang}}</div></div><div f-pop-up-menu="$parent.configurationPopUpMenu" ng-if="::configurationVisible"><div f-menu-item-button click="backupConfiguration()"><f-icon class="fa-file-o"></f-icon>{{::\'backup\' | lang}}</div><div f-menu-item-button click="restoreConfiguration()"><f-icon class="fa-undo"></f-icon>{{::\'Restore\' | lang}}</div><div f-menu-item-button click="configurationRevisions()" ng-if="configurationRevisionsVisible"><f-icon class="fa-list"></f-icon>{{::\'Revisions\' | lang}}</div></div></div><div class="error-message-container"><div class="error-message"><f-icon class="fa-exclamation-triangle"></f-icon>{{state.platform_error | lang}}</div></div>')})}),define("ng/ftnt",["angular"],function(angular){"use strict";return angular.module("ftnt",[])}),define("ng/services/injector",["angular","ng/ftnt"],function(angular,module){"use strict";function Injector($injector){function invoked(){return Array.prototype.slice.call(arguments)}this.bind=function(fn,context,locals){$injector.annotate(fn),invoked.$inject=fn.$inject;var args=$injector.invoke(invoked,context,locals);return fn.bind.apply(fn,[context].concat(args))},this.partial=function(fn,context,positional,locals){function remove_positional(arg){return positional.indexOf(arg)===-1}$injector.annotate(fn),invoked.$inject=fn.$inject.filter(remove_positional);var args=$injector.invoke(invoked,context,locals);return fn.bind.apply(fn,[context].concat(args))},this.injectMarked=function(context,locals){var key,property;for(key in context)if(property=context[key],angular.isFunction(property)&&property.$injectMark){var result=$injector.invoke(property,context,locals);context[key]="function"==typeof result?result.bind(context):result}}}return module.service("injector",Injector),{mark:function(fn){return fn.$injectMark=!0,fn}}}),define("ng/admin/password/f-password-change",["module","ng/ftnt","ng/services/injector","notify"],function(module,ngModule,inject,Notify){"use strict";function PasswordChange(injector,$scope){injector.injectMarked(this,{$scope:$scope}),this.setup()}var PASSWORD_CHANGE_URI="/api/v2/monitor/system/change-password",INVALID_OLD_PASS_ERROR="-31",GENERAL_PASSWORD_ERROR="Failed to change password",CHANGE_SUCCESS="Administrator password changed";PasswordChange.prototype.setup=inject.mark(function(state,passwordPolicyService){return function(){this.loading=!0,this.admin=this.admin?this.admin:state.admin,this.isGuestAdmin=this.admin?"enable"===this.admin["guest-auth"]:state.admin.guest_admin,this.passwordPolicy={status:"disable","apply-to":[]},passwordPolicyService.getAllPolicies().then(function(){this.requiresOldPassword(this.admin,this.isGuestAdmin)&&(this.oldPasswordRequired=!0),this.loading=!1}.bind(this))}}),PasswordChange.prototype.requiresOldPassword=inject.mark(function(state,passwordPolicyService){return function(targetAdmin,isGuestAdmin){var currentAdmin=state.admin,changeCurrentUserPwd=!targetAdmin||currentAdmin.name===targetAdmin.name,policies=passwordPolicyService.policies,policy=isGuestAdmin?policies["guest-admin"]:policies.admin;
return"enable"===policy.status&&"enable"===policy["change-4-characters"]||(state.fips_cc_enabled?changeCurrentUserPwd:!currentAdmin.super_admin)}}),PasswordChange.prototype.passwordPolicyIsActive=function(applyTo){return"enable"===this.passwordPolicy.status&&this.passwordPolicy["apply-to"].indexOf(applyTo)!==-1},PasswordChange.prototype.changeSuccess=inject.mark(function(lang){return function(){Notify.post(lang(CHANGE_SUCCESS).toString(),"success")}}),PasswordChange.prototype.changeFailure=inject.mark(function(lang){return function(message){Notify.post(lang(message).toString(),"error")}}),PasswordChange.prototype.submit=inject.mark(function($q,$http){return function(){var data={mkey:this.admin.name,new_password:this.newPassword};if(this.newPassword===this.confirmPassword){this.oldPassword&&(data.old_password=this.oldPassword.value);var result=$http.post(PASSWORD_CHANGE_URI,data).then(function(res){var message=GENERAL_PASSWORD_ERROR,results=res.data.results;if(!results.change_status)return results.valid||(message=INVALID_OLD_PASS_ERROR),$q.reject(message)});return result.then(this.changeSuccess,this.changeFailure),result}}}),ngModule.component("fPasswordChange",{templateUrl:function(loader){return loader.base_path("f-password-change.html",module)},controller:PasswordChange,bindings:{relative:"<",admin:"<",hideUsername:"<",changeSuccess:"&?",changeFailure:"&?"}})}),define("ng/services/loader",["angular","ng/ftnt","jquery","fweb","./injector"],function(angular,module,$,fweb){"use strict";function FOSError_factory(lang){function FOSError(err_no){if(!this)throw new Error("Use new keyword to create FOSError");this.name="FOSError",isNaN(Number(err_no))?(this.message=err_no,this.err_no=null):(this.message=err_no+": "+lang(String(err_no)),this.err_no=err_no);try{try{throw new Error}catch(ex){this._stack=ex.stack.split("\n").slice(2,99999)}}catch(ex){}}return angular.extend(FOSError,{NO_PERMISSIONS:-37}),FOSError}function normalize_path(path,pre_slash,post_slash){return path.replace(/^\/?(.+?)\/?$/,(pre_slash?"/":"")+"$1"+(post_slash?"/":""))}function Loader(){}function LoaderProvider($compileProvider,$controllerProvider,$provide){var called_modules;this._called_modules=called_modules=[],this.$get=function($injector){var service=$injector.instantiate(LoaderService);return this.providers=service.providers=protoLoader.providers={$compile:$compileProvider,$controller:$controllerProvider,$provide:$provide,$injector:$injector},service._called_modules=called_modules,service},this.base_path=protoLoader.base_path.bind(protoLoader),this.resolve=resolve_modules,this.initModules=init_modules.bind(this,null,null),this.providers={$compile:$compileProvider,$controller:$controllerProvider,$provide:$provide}}function init_modules($q,$log,modules,baseModule){var $injector=this.providers&&this.providers.$injector,$qnoop={resolve:angular.noop,reject:angular.noop},result=$q?$q.defer():$qnoop,called=this._called_modules||[];try{if(!modules.length)throw new Error("Must provide at least one lazy module when calling loader.initModules().");var promises=modules.filter(angular.isFunction).map(register_new_modules(called,this.providers,this)),moduleIDs=modules.filter(angular.isString);if(moduleIDs.length){var resolvables=resolve_modules(moduleIDs,baseModule);promises.push($injector.invoke(resolvables.required_dependencies))}$q&&$q.all(promises).then(function(){result.resolve()},function(reason){throw new Error("A RequireJS module returned a rejected promise. Reason: "+reason)})}catch(ex){if(!$q)throw ex;$log&&$log.error(ex),result.reject(ex)}return result.promise}function register_new_modules(memo,providers,loader,preRegister){return function(module){function matchModule(item){return item.module===module}var found=memo.filter(matchModule)[0];if(void 0===found)found={module:module,result:module(providers,loader)},preRegister&&(found.result?found.result=found.result.then(function(){var args=toArray(arguments);return[found.module].concat(args.reduce(flatten,[]))}):found.result=found.module),memo.push(found);else if(preRegister)return null;return found.result}}function flatten(result,other){return result.concat(Array.isArray(other)?other:[other])}function resolve_module_names(modules,baseModule,loader){function normalizeParentDirs(path){function removeDotDot(names,next){return".."===next?names.pop():names.push(next),names}return path.split("/").reduce(removeDotDot,[]).join("/")}function moduleGetPath(module){return module.id?module.id.split("/").slice(0,-1).join("/")+"/":""}var route_path;baseModule||(route_path=loader&&loader.route_path(),route_path||(baseModule={id:""}));var path=baseModule?moduleGetPath(baseModule):route_path;return modules.slice().map(function(module){var resolved_path=modules?normalizeParentDirs(path+module):path+module;return"/"===module[0]?module.substr(1):resolved_path})}function resolve_modules(modules,baseModule){return{required_dependencies:function($q,$rootScope,loader,$route,$injector,$log){loader._use_current_route(!1);var module_names=resolve_module_names(modules,baseModule,loader),deferred=$q.defer();return require(module_names,function(){function resolve(m){loader._use_current_route(),deferred.resolve(m)}function fail(ex){throw $log&&$log.error(ex),new Error("Unable to load modules")}var modules=$.makeArray(arguments);modules.length?loader.initModules(modules,baseModule).then(resolve,fail):resolve(),$rootScope.$broadcast("loader.modulesLoaded",$route.$current,modules)},function(ex){$log.error(ex),deferred.reject(ex)}),deferred.promise}}}function LoaderService($route,lang,$rootScope,$timeout,injector){this._use_current_route=injector.partial(this._use_current_route,this,["use_current"]),this.initModules=injector.partial(this.initModules,this,["modules","baseModule"]),this.$route=$route,this.$route_history=$route.current?[$route.current]:[],this.FOSError=FOSError_factory(lang);var loader=this;$rootScope.$on("$routeChangeStart",function(){loader._use_current_route()}),$rootScope.$on("$routeChangeSuccess",function(){0===loader.$route_history.length&&loader._use_current_route()})}function cache_path_filter(loader){return function(input){return input=input||"",loader.cache_path(input,!0)}}var toArray=Function.prototype.call.bind(Array.prototype.slice);Loader.prototype={_config:{root:"/"+fweb.CONFIG_GUI_NO+"/",ng_path:"ng"},base_path:function(path,relative_to_module){if("/"===path.substr(0,1))return this._config.root+path.substr(1);if(relative_to_module){var module_path=relative_to_module.id.replace(/\/[^\/]+\/?$/,"/");return this._config.root+module_path+path}return this._config.root+path},config:function(newConfig){this._config=angular.extend(this._config,newConfig)}};var protoLoader=new Loader;LoaderService.prototype=protoLoader,LoaderService.prototype.initModules=init_modules,LoaderService.prototype._use_current_route=function($route,use_current){use_current===!1?this.$route_history.shift():$route.current&&(this.$route_history.unshift($route.current),this.$route_history.length>2&&(this.$route_history.length=2))},LoaderService.prototype.route_path=function(use_last,route){var route_path;return(route=route||use_last&&this.$route_history[0]||this.$route.current)?(route_path=route.$$route.path,route_path||(route_path=route.$$route.originalPath.replace(/:.*$/,"")),normalize_path(this._config.ng_path+route_path,!1,!0)):null},LoaderService.prototype.cache_path=function(path,use_last,route){return"/"!==path[0]&&(path=this.route_path(use_last,route)+path),this.base_path(path)},module.provider("loader",LoaderProvider),module.factory("FOSError",FOSError_factory),module.filter("cache_path",cache_path_filter);var preLoader=Object.create(protoLoader);return preLoader.preloadModules=function(modules){function noop(result,prop){return result[prop]=angular.noop,result}function preload_modules(modules,baseModule){function register(){var result=this,modules=toArray(arguments).map(register_new_modules(memo,providers,loader,!0));$.when.apply($,modules).then(function(){var args=toArray(arguments).filter(notNull);result.resolve.apply(result,args.reduce(flatten,[]).filter(notNull))})}function notNull(m){return null!==m}var module_names=modules.filter(isString);modules=modules.filter(isFunction),module_names=resolve_module_names(module_names,baseModule);var name_result=$.Deferred(),fn_result=$.Deferred();return modules.length?register.apply(fn_result,modules):fn_result.resolve([]),module_names.length?require(module_names,register.bind(name_result)):name_result.resolve([]),$.when(name_result,fn_result).then(function(){return toArray(arguments).reduce(flatten,[])})}function isString(m){return"string"==typeof m}function isFunction(m){return"function"==typeof m}var providers={$controller:{register:angular.noop},$compile:{directive:angular.noop},$provide:["provide","service","factory","constant","value"].reduce(noop,{})},loader={initModules:preload_modules},memo=[];return preload_modules.call(this,modules)},preLoader}),define("ng/services/ftnt_route",["angular","ng/ftnt","fweb.util/objects"],function(angular,ngModule,f_obj){"use strict";function FtntRoute($route){this.$route=$route}ngModule.service({ftntRoute:FtntRoute}),FtntRoute.ENCODED_SLASH=new RegExp(encodeURIComponent("/"),"g"),FtntRoute.INTERP_EXPR=/(^|\/):([^\/$]+)/g,FtntRoute.OPT_OR_GREEDY_EXPR=/[\*\?]+$/,FtntRoute.prototype={interpolate:function(path,routeParams,dontEncode){function rpSub(match,slash,name){var value,optOrGreedy=FtntRoute.OPT_OR_GREEDY_EXPR.exec(name),opt=!1,greedy=!1;return optOrGreedy&&(name=name.replace(FtntRoute.OPT_OR_GREEDY_EXPR,""),opt=optOrGreedy[0].indexOf("?")>-1,greedy=optOrGreedy[0].indexOf("*")>-1),value=routeParams[name],opt&&null==value?(value="",slash=""):value=dontEncode?value:encodeURIComponent(value),greedy&&(value=value.replace(FtntRoute.ENCODED_SLASH,"/")),slash+value}return path.replace(FtntRoute.INTERP_EXPR,rpSub)},extractVars:function(path){for(var m,ex=new RegExp(FtntRoute.INTERP_EXPR),result=[];null!==(m=ex.exec(path));)result.push(m[2].replace(FtntRoute.OPT_OR_GREEDY_EXPR,""));return result},extractVarMap:function(path){return this.extractVars(path).reduce(function(result,name){return result[name]=name,result},{})},findBySegment:function(segment,withParams,includeVDOM){function pluckName(key){return key.name}function noVDOM(key){return includeVDOM||"vdom"!==key}return withParams=withParams&&f_obj.makeSet(withParams.filter(noVDOM)),Object.keys(this.$route.routes).filter(function(r){var route=this.$route.routes[r];return route.segment===segment&&(!withParams||withParams.equalToSet(route.keys.map(pluckName)))}.bind(this))[0]}}}),define("ng/services/ftnt_copy",["angular","ng/ftnt","fweb"],function(angular,ngModule){"use strict";function FtntCopy(){}ngModule.service({ftntCopy:FtntCopy}),FtntCopy.prototype={fastCopy:function(object){var storage={},copy=angular.copy(this.strip$Properties(object,storage));return angular.extend(copy,storage)},strip$Properties:function(subject,storage){var i,result;if(Array.isArray(subject)){if(result=subject.slice(),storage)for(i in subject)"$"===i[0]&&(storage[i]=subject[i])}else{result={};for(i in subject)"$"!==i[0]?result[i]=subject[i]:storage&&(storage[i]=subject[i])}return result}}}),define("ng/services/cmdb",["angular","ng/ftnt","fweb","jquery","cmdb","notify","./loader","./ftnt_route","./ftnt_copy"],function(angular,module,fweb,$,CMDB_JS,notify){"use strict";function factory($http,$q,$injector,$rootScope,$log,$cacheFactory,loader,ftntCopy,ftntRoute,lang){function thisError(object){return new loader.FOSError("Use new keyword to create "+object)}function CMDBError(response,message,config){var CFG_ERR={cmdb_no_permissions:CMDBError.NO_PERMISSIONS};if(!(this instanceof CMDBError))throw thisError("CMDBError");var responseType=typeof response;if(this.message="",response&&["string","object"].includes(responseType))if("string"===responseType)message=response,response=void 0;else if("number"==typeof response.error)loader.FOSError.call(this,response.error);else if("number"==typeof response.status)loader.FOSError.call(this,response.status);else if("http_status"in response)angular.extend(this,response),response=null;else{var err_no=CFG_ERR[response.error];void 0!==err_no?loader.FOSError.call(this,err_no):(this.err_no=null,this.message=response.error||this.message)}else message="Error creating CMDBError: Expected response argument to be an object or string, got "+(JSON.stringify(response)||responseType),response=void 0;this.response=response,message&&(this.message&&(this.message+="\n"),this.message+=message),response&&response.message&&(this.message&&(this.message+="\n"),this.message+="("+response.message+")"),this.config=config}function response_filter(response){var cmdb_response=response.data;return response.data?cmdb_response&&"success"===cmdb_response.status?"GET"===response.config.method?cmdb_response.results:cmdb_response:$q.reject(new CMDB.Error(cmdb_response)):$q.reject(new CMDB.Error(response,"Response data is "+response.data))}function mkey_valid(mkey){return"string"==typeof mkey?!!mkey:"number"==typeof mkey?mkey%1===0&&mkey<=4294967295&&mkey>=0:mkey instanceof $q}function CMDB(path_or_cmdb_or_prefs,name_or_prefs,preferences){if(!(this instanceof CMDB))throw thisError("CMDB instance.");var path,name;if(1===arguments.length||path_or_cmdb_or_prefs instanceof CMDB){var extraPreferences=null;"object"==typeof name_or_prefs&&(extraPreferences=name_or_prefs),preferences=path_or_cmdb_or_prefs,preferences instanceof CMDB&&(preferences=angular.copy(preferences.parameters),Object.assign(preferences,extraPreferences))}else path=path_or_cmdb_or_prefs,name=name_or_prefs;var parameters={cache:!1,path:path,name:name},instance=this;this.parameters=angular.extend(parameters,preferences);var bound=["fetch","defaults","schema","_cached_schema"];bound.forEach(function(fn){instance[fn]=instance[fn].bind(instance)}),this._shortcuts=this._get_shortcuts(),this._models=angular.extend({},CMDB._models)}function ResourceBase(){}function newResourceClass(model){function Resource(data,cmdb,model,promise){this.$cmdb=cmdb.parameters,this.$$cmdb=cmdb,Object.defineProperty(this,"$$cmdb",{enumerable:!1}),Resource.init(this,data,model,promise)}return Resource.init=function(resource,data,model,promise){var $cmdb=resource.$cmdb,$$cmdb=resource.$$cmdb,$promise=resource.$promise;angular.copy(data||{},resource),resource.$promise=$promise,resource.$cmdb=$cmdb,resource.$$cmdb=$$cmdb,resource.$$original=data,resource.$original=data,model&&(promise=promise.then(function(){return resource}),model.prototype instanceof CMDBResourceModel?$injector.invoke(model,resource,{$initPromise:promise}):model.enhance&&model.enhance(resource,promise))},model&&model.prototype instanceof CMDBResourceModel?(Resource.prototype=Object.create(model.prototype),Resource.constructor=Resource):model?Resource.prototype=new CMDBResourceModel(model.prototype):Resource.prototype=new ResourceBase,Resource}function CMDBUnion(){if(!this)throw thisError("CMDBUnion");var args;args=1===arguments.length?arguments[0]:$.makeArray(arguments),this.tables=args}function CMDB_batch(){function resolve(result){if(arguments.length>0){collect.push(result);var progress=collect.length/(collect.length+operations.length);deferred.notify({successful:collect,last:result,progress:progress})}if(operations.length){var operation=operations.shift();if(!angular.isFunction(operation))return $q.reject(new CMDBError("Batch operation is not a function "+operation));operation().$promise.then(resolve,reject)}else deferred.resolve(collect);return result}function reject(error){return deferred.reject(error)}var operations=$.isArray(arguments[0])?arguments[0]:$.makeArray(arguments),collect=[],deferred=$q.defer();return resolve(),deferred.promise}function CMDBResourceModel(protoSpec){for(var prop in protoSpec){var desc=Object.getOwnPropertyDescriptor(protoSpec,prop);Object.defineProperty(this,prop,desc)}}function CMDBModel(path,name,prototype,enhance,enhance_schema){if(!(this instanceof CMDBModel))throw thisError("CMDBError");this.path=path,this.name=name,this.prototype=prototype,this.enhance=enhance,this.enhance_schema=enhance_schema,this.Resource=newResourceClass(this)}function CMDB_model(){for(var i=0,len=arguments.length;i<len;++i){var models=$injector.invoke(arguments[i]);angular.isArray(models)||(models=[models]);for(var m=0,len2=models.length;m<len2;++m){var model=models[m];CMDB._models[model.path+"."+model.name]=model}}}function CMDB_get_cache(){var LRU_CACHE_COUNT=15;return CMDB._cache||(CMDB._cache=$cacheFactory("CMDB",{number:LRU_CACHE_COUNT}))}function CMDB_columnFormatPrefs(columns,prefs,with_meta){var result=prefs||{};return result.format=columns.join("|"),result.with_meta=!!with_meta,result}function notifyFailure(error){return CMDB_JS.notify_failure(error.response||error)}function notifyFailureMessage(lang_key,level){var fn=CMDB_JS.notify_failure_message(lang_key,level);return function(error){return fn(error.response||error)}}function notifySuccess(){notify.post(lang("Settings Saved Successfully").toString(),notify.LEVEL.SUCCESS)}CMDBError.prototype=Object.create(Error.prototype),CMDBError.prototype.name="CMDBError",CMDBError.prototype.constructor=CMDBError,CMDBError.NO_PERMISSIONS=loader.FOSError.NO_PERMISSIONS;var API_URL="/api/v2/cmdb/:path/:name/:mkey?/:children?*",COMPLEX_OBJECTS=new Set(["alertemail.setting","endpoint-control.settings","ftp-proxy.explicit","ips.global","log.disk.setting","log.eventfilter","log.fortianalyzer.override-setting","log.fortianalyzer.setting","log.fortiguard.override-setting","log.fortiguard.setting","log.gui-display","log.memory.setting","log.null-device.setting","log.setting","log.syslogd.override-setting","log.syslogd.setting","log.threat-weight","nsx.setting","report.setting","router.bgp","router.multicast","router.ospf","router.rip","switch-controller.quarantine","system.auto-install","system.autoupdate.push-update","system.autoupdate.schedule","system.central-management","system.csf","system.email-server","system.fortiguard","system.fortisandbox","system.gi-gk","system.global","system.ha","system.modem","system.nat64","system.ntp","system.password-policy","system.password-policy-guest-admin","system.resource-limits","system.settings","system.snmp.sysinfo","system.virtual-wan-link","vpn.l2tp","wanopt.webcache","web-proxy.explicit","web-proxy.global","wireless-controller.global","wireless-controller.setting"]),FallbackResource=newResourceClass(null);return CMDB.INVALID_MKEY=null,CMDB.PRUNE_RECURSIVE={__prune_array_items__:!1},CMDB.prototype={_get_mkey:function(entry){if(this._is_complex_object())return $q.when(CMDB.INVALID_MKEY);var result=entry.$mkey;if(mkey_valid(result)||(result=entry.q_origin_key),!mkey_valid(result)){var schema=entry.$schema||this._cached_schema();result=schema.$promise.then(function(schema){var result=entry[schema.mkey];return mkey_valid(result)||(result=CMDB.INVALID_MKEY),result})}return $q.when(result)},_get_shortcuts:function(){var _shortcuts={$delete:CMDB.ResourceModel.prototype.$delete,$save:CMDB.ResourceModel.prototype.$save,$move:CMDB.ResourceModel.prototype.$move};return _shortcuts},_set_mkey:function(entry,value){function resolve(schema){if(!mkey_valid(value))throw $log.error("Mkey supplied to _set_mkey is invalid",entry,value,schema),new CMDBError("mkey is invalid: "+value);return entry.$mkey=entry[schema.mkey]=value,"q_origin_key"in entry&&(entry.q_origin_key=value),value}var schema=entry.$schema||this._cached_schema();return schema.$resolved?(resolve(schema),null):schema.$promise.then(resolve)},fetch:function(preferences){return this._fetch(preferences)},_fetch:function(preferences,returnSingle){function shortcuts(entry,resource){delete entry.$save,delete entry.$move,delete entry.$delete,delete entry.$defaults,entry.$save=entry.$save||cmdb._shortcuts.$save.bind(entry),entry.$move=entry.$move||cmdb._shortcuts.$move.bind(entry),entry.$delete=entry.$delete||cmdb._shortcuts.$delete.bind(entry),entry.$defaults=entry.$defaults||cmdb.defaults,entry.$schema=cmdb._cached_schema(),cmdb._get_mkey(entry).then(function(mkey){entry.$mkey=mkey}),resource&&(resource.$defaults=resource.$defaults||entry.$defaults,resource.$schema=entry.$schema)}var parameters={with_meta:!0},isArray=!this._is_complex_object(),cmdb=this;return parameters=this._params(parameters,preferences),this._request(parameters,"GET",isArray,returnSingle,shortcuts,this._get_model(parameters))},_is_complex_object:function(){var path_name=this.parameters.path+"."+this.parameters.name;return COMPLEX_OBJECTS.has(path_name)},_update_mkey_from_result:function(value){var complex=this._is_complex_object();return function(result){var mkey=result.mkey;return value.$new&&(value.$new=!1),complex||this._set_mkey(value,mkey),fweb.util.cmdb.record_cmdb_edit(this.parameters.path,this.parameters.name,mkey),result}.bind(this)},edit:function(mkey,value,preferences){var result,parameters={json:value,shortcuts:!1};if(this._is_complex_object()||(parameters.mkey=mkey),Array.isArray(value))throw new CMDBError("Unable to edit multiple objects with a single request.\nPlease use CMDB.batch with multiple edit calls.");if(parameters=this._params(parameters,preferences),mkey===CMDB.INVALID_MKEY&&!this._is_complex_object())throw new CMDBError("Entry cannot be saved with no mkey because it is not a complex object.");return result=this._request(parameters,"PUT"),result.$promise.then(function(){fweb.util.cmdb.record_cmdb_edit(this.parameters.path,this.parameters.name,mkey)}.bind(this)),result.$promise=result.$promise.then(this._update_mkey_from_result(value)),result},append:function(value,preferences){var result,parameters={json:value,shortcuts:!1};if(Array.isArray(value))throw new Error("Unable to append multiple objects with a single request.\nPlease use CMDB.batch with multiple edit calls.");return parameters=this._params(parameters,preferences,!1),result=this._request(parameters,"POST"),result.$promise=result.$promise.then(this._update_mkey_from_result(value)),result},get:function(mkey,preferences){var parameters={mkey:mkey,with_meta:!0};return preferences=angular.extend(parameters,preferences),this._fetch(preferences,!0)},del:function(mkey,preferences){var parameters={mkey:mkey,shortcuts:!1};return parameters=this._params(parameters,preferences),this._request(parameters,"DELETE")},move:function(mkey_or_entry,destination,insert_before,preferences){var model=this._params({},preferences).model,Resource=model?model.Resource:FallbackResource;destination instanceof Resource&&(destination=this._get_mkey(destination));var entry=mkey_or_entry instanceof Resource?mkey_or_entry:null,mkey=entry?this._get_mkey(entry):mkey_or_entry,parameters={mkey:mkey,url_params:{action:"move",before:insert_before?destination:void 0,after:insert_before?void 0:destination},shortcuts:!1};return parameters=this._params(parameters,preferences),this._request(parameters,"PUT")},defaults:function(preferences){function shortcuts(entry,resource){entry.$save=entry.$save||cmdb._shortcuts.$save.bind(entry),entry.$delete=entry.$delete||function(prefs){if(entry.$new===!1)return cmdb._shortcuts.$delete.call(entry,prefs);throw new CMDBError("Cannot delete unsaved entries")},entry.$defaults=entry.$defaults||cmdb.defaults,entry.$new=!0,(resource||entry).$schema=cmdb._cached_schema()}var parameters={action:"default",cache:!0,with_meta:!0},cmdb=this;return parameters=this._params(parameters,preferences),this._request(parameters,"GET",null,null,shortcuts,this._get_model(parameters))},schema:function(preferences){var parameters={action:"schema",cache:!0},cmdb=this;parameters=this._params(parameters,preferences);var result,model=this._get_model(parameters);return model&&model.prototype instanceof CMDBResourceModel&&(delete parameters.model,model=null),result=this._request(parameters,"GET",!1),model&&model.enhance_schema&&(result.$promise=result.$promise.then(function(){return model.enhance_schema(result,cmdb),result})),result},_cached_schema_resource:null,_cached_schema:function(){var result=this._cached_schema_resource;return result||(result=this._cached_schema_resource=this.schema()),result},_get_model:function(parameters){return parameters=parameters||this.parameters,void 0!==parameters.model?parameters.model:this._models[parameters.path+"."+parameters.name]},_request:function(parameters,method,isArray,returnSingle,shortcuts,model){function stealParams(url,params){var urlParams=ftntRoute.extractVars(url),result=ftntRoute.interpolate(url,params);return urlParams.forEach(function(key){delete params[key]}),result}function addShortcuts(shortcuts,resource){function finish(resource){for(var i=0,len=entries.length;i<len;++i)shortcuts(entries[i]);return resource}function onError(error){function make_error_fn(shortcut){entries[i][shortcut]=function(){throw new CMDBError(error,"Can't "+shortcut+" entry is invalid.")}}for(var i=0,len=entries.length;i<len;++i)keys.forEach(make_error_fn);return error}var keys,dummy={},isArray=angular.isArray(resource),entries=isArray?resource:[resource];shortcuts(dummy,resource),keys=Object.keys(dummy),resource.$promise.then(finish,onError),keys.forEach(function(shortcut){function not_resolved(){throw new CMDBError("Unable to call shortcut, "+shortcut+": resource is not resolved",null,this)}if(angular.isFunction(dummy[shortcut]))for(var i=0,len=entries.length;i<len;++i)entries[i][shortcut]=not_resolved})}function resolve(data){function assignMkey(resource){return data&&"schema"!==action&&"GET"===method&&cmdb._get_mkey(resource).then(function(mkey){resource.$mkey=mkey}),resource}var newPromise;if(angular.isArray(data)!==isArray){var error=new CMDBError({data:data,parameters:parameters},"CMDB Configuration Error. Expected result to be an "+(isArray?"Array":"Object")+" but got an "+(isArray?"Object":"Array"));return $q.reject(error)}if(isArray&&!returnSingle){result.length=0;for(var i=0,len=data.length;i<len;++i)model&&model.prototype&&CMDBResourceModel.putPrototype(model,data[i]),result.push(assignMkey(new Resource(data[i],cmdb,model,result.$promise)));result.filter=function(){var filteredArray=Array.prototype.filter.apply(this,arguments);return["$defaults","$promise","$resolved","$schema","filter"].forEach(function(key){filteredArray[key]=this[key]}.bind(this)),filteredArray}}else{var promise=result.$promise;if(isArray&&returnSingle){if(0===data.length)return reject(new CMDBError({data:data,parameters:parameters},"Entry not found"));data=data[0]}model&&model.prototype&&CMDBResourceModel.putPrototype(model,data,!0),result.$promise=void 0,Resource.init(result,data,model,promise),newPromise=result.$promise,result.$promise=promise,assignMkey(result)}return result.$resolved=!0,"GET"!==method&&new_original&&json_data&&(json_data.$original=new_original),newPromise||result}function reject(response){return response instanceof CMDBError?response.config=parameters:response=new CMDBError(response.data),result.$resolved=!0,$q.reject(response)}function prune(recurse,original,entry){function pruneItem(item,i){return original?prune(recurse,original[i]||{},item):item}if(angular.isArray(entry))return CMDB.PRUNE_RECURSIVE.__prune_array_items__?entry.map(pruneItem):entry;var result={};return angular.forEach(entry,function(value,key){"$"===key.substr(0,1)||angular.equals(original[key],value)||(recurse&&"object"==typeof value&&"object"==typeof original[key]?result[key]=prune(recurse,original[key],value):result[key]=value)}),result}model&&!model.Resource&&(model.Resource=newResourceClass(model));var json_data,cmdb=this,do_prune=parameters.prune,new_original=null,action=parameters.action,orig_parameters=parameters,Resource=model?model.Resource:FallbackResource;if(isArray=!!isArray,parameters.shortcuts===!1&&(shortcuts=null),parameters.model&&(model=parameters.model,model.enhance_schema))throw new CMDBError("enhance_schema not implemented for model overrides! (FIXME)");"GET"!==method&&(model=null),delete parameters.model,delete parameters.shortcuts,delete parameters.prune,parameters.url_params&&(parameters.url_params=$q.all(parameters.url_params).then(function(url_params){return parameters.url_params=url_params,url_params}));var result_promise=$q.all(parameters).then(function(parameters){["with_meta","skip","datasource"].forEach(function(k){k in parameters&&(parameters[k]=parameters[k]?1:0)});var result_promise,cache_id,cache,http_params={method:method,url:stealParams(API_URL,parameters),cache:parameters.cache||!1,responseType:"json"},url_params=parameters.url_params;if(delete parameters.url_params,http_params.cache=parameters.cache||!1,delete parameters.cache,"GET"===method)http_params.params=url_params||parameters;else{if(parameters.json){if(json_data=parameters.json,new_original=parameters.json=ftntCopy.fastCopy(parameters.json),do_prune&&parameters.json){var recurse=do_prune===CMDB.PRUNE_RECURSIVE,original=parameters.json.$original;parameters.json=prune(recurse,original,parameters.json)}http_params.data=ftntCopy.strip$Properties(parameters.json),delete parameters.json}http_params.params=Object.assign({},url_params,parameters)}return orig_parameters.ng_cache&&"GET"===method&&(cache_id=angular.toJson(orig_parameters),cache=CMDB._get_cache(),result_promise=cache.get(cache_id)),result_promise||(result_promise=$http(http_params),cache&&cache.put(cache_id,result_promise)),result_promise}),result=isArray&&!returnSingle?[]:new Resource(null,cmdb);return result.$resolved=!1,result.$promise=result_promise.then(response_filter).then(resolve,reject),shortcuts&&!result.$resolved&&addShortcuts(shortcuts,result),result},_params:function(parameters,preferences){var result=angular.extend({},this.parameters);return angular.extend(result,parameters),angular.extend(result,preferences)}},CMDBUnion.prototype={fetch:function(){function resolve(datas){result.length=0;for(var i=0,len=datas.length;i<len;++i)result.splice.apply(result,[result.length,0].concat(datas[i]));return result.$resolved=!0,result}function reject(error){return result.$resolved=!0,$q.reject(error)}var result=[],promises=this.tables.map(function(table){return table.fetch().$promise});return result.$promise=$q.all(promises).then(resolve,reject),result.$resolved=!1,result}},CMDBResourceModel.putPrototype=function(Model,entry,copy){if(Model.prototype){var is_fn=angular.isFunction(Model.prototype),ctor=Model.Resource;if(is_fn&&entry){var new_proto=Model.prototype(entry);copy?angular.copy(new_proto,ctor.prototype):ctor.prototype=new_proto}}},CMDBResourceModel.Resource=null,CMDBResourceModel.prototype={$save:function(preferences){function throw_invalid_mkey(){throw new CMDBError("Cannot save defaults without valid mkey or id")}var result,entry=this,cmdb=this.$$cmdb,_shortcuts=cmdb._shortcuts,complex=cmdb._is_complex_object(),mkey=this.$new?CMDB.INVALID_MKEY:cmdb._get_mkey(entry);return complex||this.$new||mkey_valid(mkey)?(!complex&&mkey instanceof $q&&(mkey=mkey.then(function(mkey){return mkey_valid(mkey)||throw_invalid_mkey(),mkey})),result=!complex&&entry.$new?cmdb.append(entry,preferences):cmdb.edit(mkey,entry,preferences),delete this.$delete,delete this.$move,this.$delete||(this.$delete=_shortcuts.$delete.bind(this)),this.$move||(this.$move=_shortcuts.$move.bind(this)),result):void throw_invalid_mkey()},$move:function(destination,insert_before,preferences){if(this.$$cmdb._is_complex_object())throw new CMDBError("Cannot move a complex object");return this.$$cmdb.move(this,destination,insert_before,preferences)},$delete:function(preferences){function error_fn(){throw error}var result,entry=this,cmdb=this.$$cmdb,error=new CMDBError("Entry has been deleted ");if(!mkey_valid(entry.$mkey)){var msg=cmdb._is_complex_object()?"Unable to delete Complex Objects":"Entry cannot be deleted. mkey is invalid: "+String(entry.$mkey);throw new CMDBError(msg)}return result=cmdb.del(entry.$mkey,preferences),result.$promise=result.$promise.then(function(result){return angular.copy({$promise:$q.reject(error),$resolved:!0,$delete:error_fn,$get:error_fn},entry),entry.$mkey=CMDB.INVALID_MKEY,result}),result}},$rootScope.$on("$routeChangeStart",function(){
CMDB._models={},CMDB_get_cache().removeAll()}),angular.extend(CMDB,{_models:{},Union:CMDBUnion,Error:CMDBError,ResourceModel:CMDBResourceModel,batch:CMDB_batch,columnFormatPrefs:CMDB_columnFormatPrefs,_get_cache:CMDB_get_cache,notifyFailure:notifyFailure,notifyFailureMessage:notifyFailureMessage,notifySuccess:notifySuccess,Model:CMDBModel,model:CMDB_model}),CMDB}return module.factory("CMDB",factory)}),define("ng/services/csf_topology",["angular","ng/ftnt","ng/services/injector","fweb","select_setup","ftnt_shared"],function(angular,module,inject,fweb,select_setup,ftnt_shared){"use strict";function FortiGate(injector,csfTopology,fortigateResponseEntry){injector.injectMarked(this),this.serial=fortigateResponseEntry.serial,this.isCurrent=!fortigateResponseEntry.path&&!fortigateResponseEntry.parent_serial,this.path=fortigateResponseEntry.path,this.parentSerial=fortigateResponseEntry.parent_serial,this.parentDownstreamIP=fortigateResponseEntry.ip_str,this.childrenSerials=[],this.parentDownstreamInterfaceName=fortigateResponseEntry.upstream_intf,this.upstreamInterfaceName=fortigateResponseEntry.downstream_intf,this.adminPort=fortigateResponseEntry.admin_port,this.viaRouterNat=!1,this.viaVPN=!1,this.model=null,this.version=null,this.build=null,this._interfaceInfoPopulated=!1,this.upstreamIP=null,this.upstreamInterface=null,this.parentDownstreamInterface=null,this.interfaces=[],this.interfaceMap={},this.fortiswitches=[],this.fortiswitchMapping={},this.fortiaps=[],this.fortiapMapping={},this.ha=[],this.forticlients=[],this.state=null}function FortiSwitch(injector,parentFortigateSerial,monitorResponseEntry){injector.injectMarked(this),this.parentFortigateSerial=parentFortigateSerial,this.name=monitorResponseEntry.name,this.serial=monitorResponseEntry.serial,this.version=monitorResponseEntry.os_version,this.ports=monitorResponseEntry.ports,this.state=monitorResponseEntry.state,this.status=monitorResponseEntry.status,this.connectionIP=monitorResponseEntry.connecting_from}function FortiAp(injector,parentFortigateSerial,monitorResponseEntry){injector.injectMarked(this),this.parentFortigateSerial=parentFortigateSerial,this.name=monitorResponseEntry.name,this.serial=monitorResponseEntry.serial,this.version=monitorResponseEntry.os_version,this.mac=monitorResponseEntry.board_mac,this.ip=monitorResponseEntry.connecting_from,this.meshHopCount=monitorResponseEntry.mesh_hop_count,this.parentFortiApSerial=monitorResponseEntry.parent_wtp_id,this.fortilinkSwitchId=monitorResponseEntry.fortilink_switch_id,this.fortilinkPortId=monitorResponseEntry.fortilink_port_id,this.uplinkInterfaceName=monitorResponseEntry.mesh_uplink_intf,this._populateSsids(monitorResponseEntry)}function HA(injector,peerFortigateSerial,monitorResponseEntry){injector.injectMarked(this),this.peerFortigateSerial=peerFortigateSerial,this.hostname=monitorResponseEntry.hostname,this.serial=monitorResponseEntry.serial_no}function Topology(injector,$rootScope){injector.injectMarked(this),this._ongoingPromise=null,this._ongoingType=null,this._currentRevision=null,this.csfEnabled=!1,this.isRootFortigate=!1,this.upstreamSerial=null,this.csfLoggingMode=null,this.fortigates=[],this.fortigateMapping={},this.thisFortigate=null,this.selectedFortigate=null,$rootScope.$on("$routeChangeSuccess",function(){this.selectedFortigate=this.thisFortigate}.bind(this)),Object.defineProperty(this,"selectedFortigateIsThisFortigate",{get:function(){return!this.selectedFortigate||this.selectedFortigate.serial===this.thisFortigate.serial}.bind(this)}),Object.defineProperty(this,"selectedFortigatePath",{get:function(){return this.selectedFortigate&&this.selectedFortigate.path||void 0}.bind(this)})}var CSF_INFO_URI="/api/v2/monitor/system/csf",STATE_URI="/api/v2/monitor/web-ui/state",FORTISWITCHES_URI="/api/v2/monitor/system/fsw",FORTIAPS_URI="/api/v2/monitor/wifi/managed_ap",HA_URI="/api/v2/monitor/system/ha-statistics",FORTICLIENTS_URI="/api/v2/monitor/endpoint-control/record-list/select",CMDB_CSF_URI="/api/v2/cmdb/system/csf",EMPTY_IP="0.0.0.0",RESOURCE_USAGE_URL="/api/v2/monitor/system/resource/usage",SUPPORTED_OMNISELECT_CSF_PROXY_SOURCES=["detectedDevices","firewall.address","firewall.addrgrp","firewall.internet-service","firewall.internet-service-custom","firewallInterfaces","user.group","user.local"],TooltipKey=ftnt_shared.TooltipKey,MAX_STATE_RESPONSE_TIME=5e3;FortiGate.prototype.isRoot=inject.mark(function(csfTopology){return function(){return this.isCurrent&&csfTopology.isRootFortigate}}),FortiGate.prototype.getIconClass=function(){var fortigateType="ftnt-security-fabric-fortigate";return this.state&&(fortigateType=this.state.is_vm?"ftnt-vm":"FortiWiFi"===this.state.model_name?"ftnt-fortiwifi":"ftnt-security-fabric-fortigate"),fortigateType+(this.isCurrent?" current":"")+(this.isRoot()?" ftnt-root-fortigate":"")},FortiGate.prototype.getLabel=function(){return this.state.hostname||this.serial},FortiGate.prototype.getVersionLabel=inject.mark(function($filter){var buildNumberFilter=$filter("buildNumber");return function(){var label;return this.version&&this.build&&(label=this.version+" build"+buildNumberFilter(this.build)),label}}),FortiGate.prototype.getManagementIPLabel=inject.mark(function(lang){var translate=function(key){return lang(key).toString()};return function(){var intf=this.upstreamInterface||{},outgoingIP=intf.ipv4_addresses&&intf.ipv4_addresses[0]&&intf.ipv4_addresses[0].ip,str=this.managementIP!==EMPTY_IP?this.managementIP:outgoingIP||this.parentDownstreamIP||"";return this.viaVPN?str+="<br>"+translate("This FortiGate connects to upstream FortiGate via a VPN"):this.viaRouterNat&&(str+="<br>"+translate("This FortiGate is behind Router/NAT device")),str}}),FortiGate.prototype.createCSFURI=function(uri,interceptor){var result=uri;return this.isCurrent||(result="/csf/"+(interceptor?":snPath":this.path)+uri),result},FortiGate.prototype.getInterfaceByName=function(name){return this.interfaceMap[name]},FortiGate.prototype._populateCSFInterfaces=function(parentFortigate){if(parentFortigate&&this.parentDownstreamInterfaceName&&(this.parentDownstreamInterface=parentFortigate.getInterfaceByName(this.parentDownstreamInterfaceName),this.parentDownstreamInterface&&this.parentDownstreamInterface.is_tunnel&&(this.viaVPN=!0)),this.upstreamInterfaceName&&(this.upstreamInterface=this.getInterfaceByName(this.upstreamInterfaceName),this.upstreamInterface))if(this.upstreamInterface.is_tunnel)this.viaVPN=!0;else{var intf=this.upstreamInterface,interfaceIP=intf.ipv4_addresses&&intf.ipv4_addresses[0]&&intf.ipv4_addresses[0].ip;this.viaRouterNat=interfaceIP&&this.parentDownstreamIP!==interfaceIP}},FortiGate.prototype._getStateInformation=inject.mark(function($http,$q,state){return function(){var promise;return this.isCurrent?(this.model=state.model_name+" "+state.model_number,this.version=state.version,this.build=state.build,this.state=angular.copy(state.responseData),promise=$q.resolve()):promise=$http.get(this.createCSFURI(STATE_URI),{timeout:MAX_STATE_RESPONSE_TIME}).then(function(response){var data=response.data,results=data.results;return results?(this.model=results.model_name+" "+results.model_number,this.version=data.version,this.build=data.build,void(this.state=results)):$q.reject("Invalid response")}.bind(this)),promise}}),FortiGate.prototype._getResourceInformation=inject.mark(function($http,state){return function(){function saveResponse(response){that.resources=response.data.results}var params={},that=this;return state.vdom_mode&&""!==state.current_vdom||(params.scope="global"),that.isCurrent?$http.get(RESOURCE_USAGE_URL,{params:params}).then(saveResponse):$http.get(that.createCSFURI(RESOURCE_USAGE_URL),{params:params}).then(saveResponse,angular.noop)}}),FortiGate.prototype._getInterfaceInformation=inject.mark(function($http,$q){return function(){var child,promises;return this._interfaceInfoPopulated?$q.resolve():(child=!this.isRoot(),promises=[fweb.util.firewallInterfaces.get(!1,this.path)],child&&promises.push($http.get(this.createCSFURI(CMDB_CSF_URI))),$q.all(promises).then(function(responses){this.interfaces=responses[0];var csfResponse=responses[1];if(this.interfaces.forEach(function(intf){this.interfaceMap[intf.name]=intf}.bind(this)),child){var results=csfResponse.data.results;results&&(this.upstreamIP=results["upstream-ip"],this.managementIP=results["management-ip"])}this._interfaceInfoPopulated=!0}.bind(this)))}}),FortiGate.prototype._getConnectedFortiSwitches=inject.mark(function($http,$injector){return function(){return $http.get(this.createCSFURI(FORTISWITCHES_URI)).then(function(response){function hasFgtPeerPort(port){return port["fortilink-port"]&&port["fgt-peer-port-name"]}var switches=[],mapping={},results=response.data.results||[],fortiswitches=results.sort(function(a,b){var aDirectlyConnected=a.ports.some(hasFgtPeerPort),bDirectlyConnected=b.ports.some(hasFgtPeerPort);return bDirectlyConnected-aDirectlyConnected});return fortiswitches.forEach(function(entry){if("Authorized"===entry.state&&"Connected"===entry.status){var fortiswitch=$injector.instantiate(FortiSwitch,{parentFortigateSerial:this.serial,monitorResponseEntry:entry});switches.push(fortiswitch),mapping[fortiswitch.serial]=fortiswitch}}.bind(this)),this.fortiswitches=switches,this.fortiswitchMapping=mapping,this.fortiswitches.forEach(function(fsw){fsw.populateParentDownstreamInterface()}),this.fortiswitches}.bind(this),angular.noop)}}),FortiGate.prototype._getConnectedFortiAps=inject.mark(function($http,$injector){return function(){return $http.get(this.createCSFURI(FORTIAPS_URI)).then(function(response){var results=response.data.results||[],fortiaps=[],mapping={};return results.forEach(function(entry){if("authorized"===entry.state&&"connected"===entry.status){var fortiap=$injector.instantiate(FortiAp,{parentFortigateSerial:this.serial,monitorResponseEntry:entry});fortiaps.push(fortiap),mapping[fortiap.serial]=fortiap}}.bind(this)),this.fortiaps=fortiaps,this.fortiapMapping=mapping,this.fortiaps.sort(function(a,b){var aHopCount=a.meshHopCount||0,bHopCount=b.meshHopCount||0;return aHopCount-bHopCount}),this.fortiaps}.bind(this),angular.noop)}}),FortiGate.prototype._getHA=inject.mark(function($http,$injector,$q){var symbols=fweb.BUILD.SYMBOLS;return function(){var ha_list=[];return this.state.hasOwnProperty("ha_mode")&&[symbols.HA_AA,symbols.HA_AP].indexOf(this.state.ha_mode)>-1?$http.get(this.createCSFURI(HA_URI)).then(function(response){var results=response.data.results||[];results.forEach(function(entry){if(this.serial!==entry.serial_no){var ha=$injector.instantiate(HA,{peerFortigateSerial:this.serial,monitorResponseEntry:entry});ha_list.push(ha)}}.bind(this)),this.ha=ha_list}.bind(this),angular.noop):$q.resolve()}}),FortiGate.prototype._getFortiClients=inject.mark(function($http){return function(){return $http.get(this.createCSFURI(FORTICLIENTS_URI)).then(function(response){return this.forticlients=response.data.results,this.forticlients}.bind(this),angular.noop)}}),FortiGate.prototype._getConnectedExtensionDevices=inject.mark(function($q){return function(){return $q.all([this._getConnectedFortiSwitches(),this._getConnectedFortiAps(),this._getHA(),this._getFortiClients()])}}),FortiSwitch.prototype.getLabel=function(){return this.name||this.serial},FortiSwitch.prototype.populateParentDownstreamInterface=inject.mark(function(csfTopology){return function(){var fortigate=csfTopology.fortigateMapping[this.parentFortigateSerial],fortiswitchMapping=fortigate.fortiswitchMapping,hasFortilink=this.ports.some(function(port){var isFortiLink=port["fortilink-port"];if(isFortiLink){var fgtPeerIntfName=port["fgt-peer-port-name"];this.parentDownstreamInterface=fortigate.getInterfaceByName(fgtPeerIntfName)}return isFortiLink}.bind(this));if(!hasFortilink){var peerPorts=this.ports.filter(function(port){return port["isl-peer-port-name"]&&port["isl-peer-device-name"]});if(peerPorts.forEach(function(port){var islPeerIntfName=port["isl-peer-port-name"],islPeerFswSerial=port["isl-peer-device-name"],pFsw=fortiswitchMapping[islPeerFswSerial];if(pFsw){var fortigateInterface=pFsw.parentDownstreamInterface;fortigateInterface&&!pFsw.parentFortiswitchSerial&&(this.parentFortiswitchSerial=islPeerFswSerial,this.parentDownstreamInterface={name:islPeerIntfName,vdom:fortigateInterface.vdom,ip:pFsw.connectionIP},port["uplink-peer-port"]=!0)}}.bind(this)),!this.parentDownstreamInterface&&!this.parentFortiswitchSerial){var firstDirectlyConnectedFsw=fortigate.fortiswitches.find(function(fsw){return fsw.parentDownstreamInterface});firstDirectlyConnectedFsw&&(this.parentDownstreamInterface=angular.extend({},firstDirectlyConnectedFsw.parentDownstreamInterface),fweb.log.info("Un-recognized FortiSwitch topology for "+this.serial+", treat it as a standalone FortiSwitch."))}}}}),FortiAp.prototype.getLabel=function(){return this.name||this.serial},FortiAp.prototype._populateSsids=function(monitorResponseEntry){var radios=monitorResponseEntry.radio||[],ssids={};radios.forEach(function(radio){var ssidObj=radio.ssid||{};Object.keys(ssidObj).forEach(function(ifName){var ssid=ssidObj[ifName],mapKey=ifName+ssid;ssids[mapKey]={ifName:ifName,ssid:ssid}})}),this.ssids=Object.keys(ssids).map(function(key){return ssids[key]})},Topology.prototype.BUILD_TYPES={STANDARD:1,WITH_EXTENSION_DEVICES:2,WITH_RESOURCE_STATS:4},Topology.prototype.buildIfNecessary=inject.mark(function($q){return function(){return this._currentRevision&&!this._ongoingPromise?$q.resolve():this.build()}}),Topology.prototype.build=inject.mark(function($q){return function(wantedBuildType){wantedBuildType=wantedBuildType||this.BUILD_TYPES.STANDARD;var promise,typeBuildFunctions=[];return this._ongoingPromise?promise=this._ongoingPromise:(promise=$q.resolve(),typeBuildFunctions.push(this._buildTopology),typeBuildFunctions.push(this._buildInterfaces)),this._shouldIncludeNonCachedBuildType(this.BUILD_TYPES.WITH_EXTENSION_DEVICES,wantedBuildType)&&typeBuildFunctions.push(this._buildExtensionDevices),this._shouldIncludeNonCachedBuildType(this.BUILD_TYPES.WITH_RESOURCE_STATS,wantedBuildType)&&typeBuildFunctions.push(this._buildResourceStats),this._ongoingType=wantedBuildType,promise=this._ongoingPromise=promise.then(function(){return typeBuildFunctions.reduce(function(previous,current){return previous.then(function(){return current()})},$q.resolve()).then(function(){promise===this._ongoingPromise&&(this._ongoingPromise=null,this._ongoingType=null)}.bind(this))}.bind(this))}}),Topology.prototype._shouldIncludeNonCachedBuildType=function(buildType,wantedType){return 0!==(wantedType&buildType)&&(!this._ongoingType||0===(this._ongoingType&buildType))},Topology.prototype._createFortiGate=inject.mark(function($injector){return function(fortigateResponseEntry){return $injector.instantiate(FortiGate,{fortigateResponseEntry:fortigateResponseEntry})}}),Topology.prototype._removeFortiGate=function(serial){var parentFortigate,childIndex,fortigate=this.fortigateMapping[serial];this.fortigates.splice(this.fortigates.indexOf(fortigate),1),delete this.fortigateMapping[serial],fortigate.parentSerial&&(parentFortigate=this.fortigateMapping[fortigate.parentSerial],parentFortigate&&(childIndex=parentFortigate.childrenSerials.indexOf(fortigate.serial),parentFortigate.childrenSerials.splice(childIndex,1)))},Topology.prototype._addChildParentReferences=function(){this.fortigates.forEach(function(fortigate){var parentFortigate;fortigate.parentSerial&&(parentFortigate=this.fortigateMapping[fortigate.parentSerial],parentFortigate&&parentFortigate.childrenSerials.indexOf(fortigate.serial)<0&&parentFortigate.childrenSerials.push(fortigate.serial))}.bind(this))},Topology.prototype.addOmniselectProxySources=function(sourceID){var SOURCES=Omniselect.prototype.SOURCES;this.fortigates.forEach(function(fortigate){if(fortigate.path){var sourceConfig,extension,alias,csfSource=select_setup.getCSFProxySourceID(sourceID,fortigate.path);SOURCES[csfSource]||(sourceConfig=SOURCES[sourceID],extension={csfPath:fortigate.path,fortigate:fortigate},alias=sourceConfig.aliasFor,alias?Array.isArray(alias)?extension.aliasFor=alias.concat([sourceID]):extension.aliasFor=[alias,sourceID]:extension.aliasFor=sourceID,SOURCES[csfSource]=angular.merge({},SOURCES[sourceID],extension))}})},Topology.prototype.addCSFOmniselectSources=function(){this.addCSFOmniselectFortiGatesSource(),this.addCSFOmniselectFortiGatesSourceWithStats(),this.addCSFOmniselectFortiSwitchesSource(),this.addCSFOmniselectFortiAPsSource()},Topology.prototype.addCSFOmniselectFortiAPsSource=inject.mark(function(lang){var translate=function(key){return lang(key).toString()};return function(){var csfTopology=this,sourceName="csfFortiAPs";Omniselect.prototype.SOURCES[sourceName]={name:translate("FortiAP"),valueFunction:function(entry){return entry.getLabel()},formatFunction:function(entry,value){return'<f-icon class="ftnt-fortiap"></f-icon><span>'+value+"</span>"},data:function(){return csfTopology.build(csfTopology.BUILD_TYPES.WITH_EXTENSION_DEVICES).then(function(){var results=[];return csfTopology.fortigates.forEach(function(fortigate){fortigate.fortiaps.forEach(function(fortiap){fortiap.q_origin_key=fortiap.serial,fortiap.datasource=sourceName,results.push(fortiap)})}),results})}.bind(this),tooltipKeys:{serial:new TooltipKey(translate("sn")),name:new TooltipKey(translate("name")),version:new TooltipKey(translate("ver_firmware"))},searchKeys:{serial:!0,name:!0,version:!0}}}}),Topology.prototype.addCSFOmniselectFortiSwitchesSource=inject.mark(function(lang){var translate=function(key){return lang(key).toString()};return function(){var csfTopology=this,sourceName="csfFortiSwitches";Omniselect.prototype.SOURCES[sourceName]={name:translate("FortiSwitch"),valueFunction:function(entry){return entry.getLabel()},formatFunction:function(entry,value){return'<f-icon class="ftnt-fortiswitch"></f-icon><span>'+value+"</span>"},data:function(){return csfTopology.build(csfTopology.BUILD_TYPES.WITH_EXTENSION_DEVICES).then(function(){var results=[];return csfTopology.fortigates.forEach(function(fortigate){fortigate.fortiswitches.forEach(function(fortiswitch){fortiswitch.q_origin_key=fortiswitch.serial,fortiswitch.datasource=sourceName,results.push(fortiswitch)})}),results})}.bind(this),tooltipKeys:{serial:new TooltipKey(translate("sn")),name:new TooltipKey(translate("name")),version:new TooltipKey(translate("ver_firmware"))},searchKeys:{serial:!0,name:!0,version:!0}}}}),Topology.prototype.addCSFOmniselectFortiGatesSourceWithStats=inject.mark(function(lang){var translate=function(key){return lang(key).toString()};return function(){function getAverageResourceUsage(resourceType,timeOption){return function(entry){var usage,res=entry.resources,data=res&&res[resourceType];return data=data&&data[0]&&data[0].historical&&data[0].historical[timeOption]&&data[0].historical[timeOption].values,data&&data.length>0&&(usage=data.reduce(function(acc,value){return acc+value[1]},0)/data.length,usage=Math.round(usage)),!isNaN(usage)&&usage+"%"}}select_setup.createExtensionSource("csfFortiGates","csfFortiGatesWithStats",{tooltipKeys:{cpuUsage:new TooltipKey(translate("CPU Usage"),getAverageResourceUsage("cpu","1-min")),memUsage:new TooltipKey(translate("Memory Usage"),getAverageResourceUsage("mem","1-min"))}})}}),Topology.prototype.addCSFOmniselectFortiGatesSource=inject.mark(function($rootScope,$compile,lang,state){var translate=function(key){return lang(key).toString()};return function(){var csfTopology=this,getFortiGatesMap=function(){return this.fortigateMapping}.bind(this);Omniselect.prototype.SOURCES.csfFortiGates={name:translate("FortiGate"),valueFunction:function(entry){return"all"===entry.q_origin_key?translate("All FortiGates"):angular.isFunction(entry.getLabel)?entry.getLabel():entry.serial},formatFunction:function(entry,value){var iconClass=entry.getIconClass?entry.getIconClass():"ftnt-security-fabric-fortigate";return entry.serial===csfTopology.thisFortigate.serial&&(iconClass+=" current"),'<f-icon class="'+iconClass+'"></f-icon><span>'+value+"</span>"},sortFunction:function(valueA,valueB,entryA,entryB){if("all"===entryA.q_origin_key)return!0;if("all"===entryB.q_origin_key)return!1;var aPath=entryA.path||entryA.serial,bPath=entryB.path||entryB.serial,aPathLength=aPath.split(":").length,bPathLength=bPath.split(":").length;return aPathLength!==bPathLength?aPathLength>bPathLength:ftnt_shared.util.fastLocaleCompare(aPath,bPath)},onSourceDestroy:function(sourceLifeCycleData){Object.keys(sourceLifeCycleData).forEach(function(scopeKey){sourceLifeCycleData[scopeKey].$destroy()})},data:function(meta,sourceId){return csfTopology.buildIfNecessary().then(function(){var results=[{q_origin_key:"all",datasource:sourceId}];if(csfTopology.fortigates.forEach(function(fortigate){fortigate.q_origin_key=fortigate.serial,fortigate.datasource=sourceId,results.push(fortigate)}),csfTopology.upstreamSerial){var upstreamFgt={q_origin_key:csfTopology.upstreamSerial,datasource:sourceId,serial:csfTopology.upstreamSerial,ipAddress:state.csf_upstream_ip};results.push(upstreamFgt)}return results})}.bind(this),solitaryEntries:{all:!0},tooltipKeys:{hostname:new TooltipKey(translate("hostname"),function(entry){if(entry.state)return entry.state.hostname}),serial:new TooltipKey(translate("sn")),model:new TooltipKey(translate("model")),version:new TooltipKey(translate("version"),function(entry){if(entry.serial&&angular.isFunction(entry.getVersionLabel))return entry.getVersionLabel()}),opmode:new TooltipKey(translate("Operation Mode"),function(entry){var vdomInfo,mode;if(entry.state&&!entry.state.vdom_mode)return vdomInfo=entry.state.admin.vdom_info[entry.state.management_vdom],mode=vdomInfo.transparent_mode?state.OPERATION_MODE.TRANSPARENT:state.OPERATION_MODE.NAT,translate(mode)}),inspection_mode:new TooltipKey(translate("inspect_mode"),function(entry){var vdomInfo;if(entry.state&&!entry.state.vdom_mode)return vdomInfo=entry.state.admin.vdom_info[entry.state.management_vdom],translate("inspection_mode::"+vdomInfo.inspection_mode)}),topology:new TooltipKey("Topology",function(entry){if(!state.vdom_mode&&entry.serial!==csfTopology.upstreamSerial){var element=document.createElement("div"),lifeCycleData=this.getSourceLifeCycleData(entry.datasource),path=entry.path||entry.serial,scope=lifeCycleData[path];return scope||(scope=lifeCycleData[path]=$rootScope.$new(!0)),scope.path=path,element.innerHTML='<f-csf-tree path="path"></f-csf-tree>',$compile(element)(scope),scope.$digest(),element}},function(){return!state.vdom_mode}),managementIP:new TooltipKey(translate("Management IP"),function(entry){if("function"==typeof entry.getManagementIPLabel)return entry.getManagementIPLabel()}),ipAddress:new TooltipKey(translate("ipaddr")),conserveMode:new TooltipKey(translate("Conserve Mode"),function(entry){return entry.state&&entry.state.conserve_mode?'<f-icon class="fa-warning"></f-icon><span>'+translate("Yes")+"</span>":""})},searchKeys:{serial:!0,hostname:function(entry,searchString,searchRegex){if(entry.state)return searchRegex.test(entry.state.hostname)},managementIP:function(entry,searchString,searchRegex){var value="function"==typeof entry.getManagementIPLabel&&entry.getManagementIPLabel();if(value)return searchRegex.test(value)},model:!0,opmode:function(entry,searchString,searchRegex){var vdomInfo,mode;if(entry.state&&!entry.state.vdom_mode)return vdomInfo=entry.state.admin.vdom_info[entry.state.management_vdom],mode=vdomInfo.transparent_mode?state.OPERATION_MODE.TRANSPARENT:state.OPERATION_MODE.NAT,mode=translate(mode),searchRegex.test(mode)},parent:function(entry,searchString,searchRegex){var result,intfFormatted;if(entry.parentSerial){var parent=getFortiGatesMap()[entry.parentSerial];return parent?entry.upstreamInterface?(intfFormatted=Omniselect.formatEntry(entry.upstreamInterface,"firewallInterfaces"),result=lang("{0} via {1}",[parent.getLabel(),intfFormatted]).toString()):result=parent.getLabel():result=entry.parentSerial,searchRegex.test(result)}},version:function(entry,searchString,searchRegex){if(entry.serial&&angular.isFunction(entry.getVersionLabel))return searchRegex.test(entry.getVersionLabel())},ipAddress:!0}}}}),Topology.prototype._buildThisFortiGate=inject.mark(function(state){return function(){this.thisFortigate=this._createFortiGate({serial:state.serial}),this.thisFortigate._getStateInformation(),this.selectedFortigate=this.thisFortigate}}),Topology.prototype._buildFortiGates=inject.mark(function($http,$q){return function(){return $http.get(CSF_INFO_URI).then(function(response){var responseData=response.data,results=responseData.results,revision=responseData.revision,existingFortigateSeen={},statePromises=[],responseComplete=!0;if(this.upstreamSerial=results.upstream_sn,this.thisFortigate&&results.downstream_intf&&(this.thisFortigate.upstreamInterfaceName=results.downstream_intf),revision!==this._currentRevision&&results){fweb.log.info("Fabric topology tree revision has changed."),this.fortigates.forEach(function(fortigate){fortigate.isCurrent||(existingFortigateSeen[fortigate.serial]=!1)});var csfConfigPromise=$http.get(CMDB_CSF_URI).then(function(response){this.groupName=response.data.results["group-name"]}.bind(this));statePromises.push(csfConfigPromise),(results.fgts||[]).forEach(function(entry){var fortigate,serial=entry.serial;this.fortigateMapping[serial]?existingFortigateSeen[serial]=!0:this._fortigateResponsePopulated(entry)?(fweb.log.info('FortiGate added to fabric: "'+serial+'"'),fortigate=this._createFortiGate(entry),statePromises.push(fortigate._getStateInformation().then(function(){this.fortigates.push(fortigate),this.fortigateMapping[serial]=fortigate}.bind(this),function(){fweb.log.error("Failed to retrieve state information for "+serial)}))):(fweb.log.info('Still waiting on "'+serial+'"'),responseComplete=!1)}.bind(this)),responseComplete&&(this._currentRevision=revision)}return $q.all(statePromises).then(function(){SUPPORTED_OMNISELECT_CSF_PROXY_SOURCES.forEach(function(sourceID){this.addOmniselectProxySources(sourceID)}.bind(this)),Object.keys(existingFortigateSeen).forEach(function(serial){existingFortigateSeen[serial]||(this._removeFortiGate(serial),fweb.log.info('FortiGate removed from fabric: "'+serial+'"'))}.bind(this)),this._addChildParentReferences()}.bind(this))}.bind(this))}}),Topology.prototype._buildTopology=inject.mark(function($q,state){return function(){return this.csfEnabled=state.csf_enabled,this.isRootFortigate=!state.csf_enabled||state.csf_upstream_ip===EMPTY_IP,this.csfLoggingMode=state.csf_logging_mode,this.thisFortigate||(this._buildThisFortiGate(),this.fortigates.push(this.thisFortigate),this.fortigateMapping[this.thisFortigate.serial]=this.thisFortigate),this.csfEnabled&&state.adminHasReadPermission(state.ACCESS_GROUP.SYSTEM)?this._buildFortiGates():(this.upstreamSerial=null,this.fortigates=[this.thisFortigate],this.fortigateMapping={},this.fortigateMapping[this.thisFortigate.serial]=this.thisFortigate,$q.resolve())}}),Topology.prototype._buildInterfaces=inject.mark(function($q){return function(){var intfPromises=this.fortigates.map(function(fortigate){return fortigate._getInterfaceInformation()});return $q.all(intfPromises).then(function(){this.fortigates.forEach(function(fortigate){var parentFortigate=null;fortigate.parentSerial&&(parentFortigate=this.fortigateMapping[fortigate.parentSerial]),fortigate._populateCSFInterfaces(parentFortigate)}.bind(this))}.bind(this))}}),Topology.prototype._buildExtensionDevices=inject.mark(function($q){return function(){var promises=this.fortigates.map(function(fortigate){return fortigate._getConnectedExtensionDevices()});return $q.all(promises)}}),Topology.prototype._buildResourceStats=inject.mark(function($q){return function(){var promises=this.fortigates.map(function(fortigate){return fortigate._getResourceInformation()});return $q.all(promises)}}),Topology.prototype._fortigateResponsePopulated=function(entry){var validInterface=entry.downstream_intf&&"N/A"!==entry.downstream_intf;return validInterface},module.service("csfTopology",Topology)}),define("ng/services/interceptor",["angular","ng/ftnt","jquery","fweb"],function(angular,module,$,fweb){"use strict";function factory($injector,$q){var adminTimeout,connection,CCSRF={HEADER_NAME:"X-CSRFTOKEN"},DCSRF={HEADER_NAME:"X-CSRFTOKEN",FORM_TOKEN_NAME:"csrfmiddlewaretoken"};return $injector.has("adminTimeout")&&(adminTimeout=$injector.get("adminTimeout")),$injector.has("connection")&&(connection=$injector.get("connection")),{request:function(config){if(config.csfProxy){var topology=$injector.get("csfTopology");topology.selectedFortigateIsThisFortigate||(config.url="/csf/"+topology.selectedFortigate.path+config.url)}if(/^(\/\d+)?\/p\//.test(config.url)){var parts=config.url.split("?");if(parts.length>1&&(config.url=parts.shift(),config.params=parts.join("?").split("&").reduce(function(result,param){return param=param.split("="),result[param[0]]=decodeURIComponent(param[1])||"",result},config.params||{})),"/"!==config.url.slice(-1)&&(config.url=config.url+"/"),"POST"===config.method){var django_csrf=fweb.util.persist.getPythonCsrfToken();angular.isDefined(django_csrf)&&""!==django_csrf&&(config.headers[DCSRF.HEADER_NAME]=django_csrf,angular.isObject(config.data)&&(config.data=$.param(config.data)))}}else{config.headers["X-Requested-With"]="XMLHttpRequest";var c_csrf=fweb.util.persist.getCsrfToken();c_csrf&&(c_csrf=c_csrf.replace(/(^"|"$)/g,""),config.headers[CCSRF.HEADER_NAME]=c_csrf),"POST"!==config.method||/\/api\/v2\//.test(config.url)||config.data&&(null!=config.data.request&&(config.data.request=angular.toJson(config.data.request)),config.data=$.param(config.data))}return"POST"===config.method&&(config.headers["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8",adminTimeout&&adminTimeout.reset()),config},responseError:function(rejection){return rejection.status===-1&&connection?connection.setDisconnected():401===rejection.status&&(fweb.log.warn("$http interceptor received a 401. Redirecting to login page."),fweb.util.location.logout_redirect()),$q.reject(rejection)},response:function(response){return"createStyleSheet"in document&&/\.html$/.test(response.config.url)&&$injector.invoke(fix_ie_links,null,{response:response}),response}}}function fix_ie_links($compile,$rootScope,$route,response){var links=response.data.match(/(<link[^>]*>)/g);if(links){var head=document.getElementsByTagName("head")[0],route_path=$route.current.$$route.originalPath;$("head link[data-route]").each(function(i,link){link.getAttribute("data-route")!==route_path&&link.parentNode.removeChild(link)}),links=links.map(function(link){return link=angular.element(link)[0],link.className="compile_me",link}),angular.element(head).append(links),$("head link.compile_me").each(function(i,link){link.className="",link.setAttribute("data-route",route_path),$compile(link)($rootScope)})}}module.factory("ftntInterceptor",factory)}),define("ng/services/ip-location-service",["ng/ftnt","ng/services/injector","fweb"],function(module,inject,fweb){"use strict";function IPLocationService(injector){injector.injectMarked(this)}function IPLocation(ip){this.ip=ip,this.isPrivate=!fweb.util.ip.IpMask.isPublic(this.ip),this.isValid=!1}IPLocationService.prototype.URLS={GEOIP_QUERY:"/api/v2/monitor/geoip/geoip-query",COUNTRY_CENTERS:"/geo/country_centers.json"},IPLocationService.prototype._loadCountryCenters=inject.mark(function($http,$q,loader){return function(){return $http.get(loader.base_path(this.URLS.COUNTRY_CENTERS),{cache:!0}).then(function(_countryCenters){this._countryCenters=_countryCenters.data}.bind(this)).catch(function(){return fweb.log.error("Failed to load country centers."),$q.reject()})}}),IPLocationService.prototype._query=inject.mark(function($http){return function(queryParams){return $http.get(this.URLS.GEOIP_QUERY,{params:{ip_addresses:queryParams}}).then(function(response){return response.data.results})}}),IPLocationService.prototype._loadFallbacksOnDemand=inject.mark(function($q){return function(queryResults){var anyFallbacks=Object.keys(queryResults).some(function(ip){
return queryResults[ip].fallback});return anyFallbacks?this._loadCountryCenters().then(function(){return Object.keys(queryResults).forEach(function(ip){var location=queryResults[ip];if(location.fallback){var fallbackCoordinates=this._countryCenters[location.location.country.iso_code];location.location.location={latitude:fallbackCoordinates&&fallbackCoordinates.lat,longitude:fallbackCoordinates&&fallbackCoordinates.long}}}.bind(this)),queryResults}.bind(this)).catch(function(){return queryResults}):$q.resolve(queryResults)}}),IPLocationService.prototype.getIPLocation=inject.mark(function($q){return function(ip){if(""===ip)return fweb.log.error("IP is an empty string."),$q.resolve(new IPLocation(ip));var ipLocation=new IPLocation(ip);return ipLocation.isPrivate?$q.resolve(ipLocation):this._query(ipLocation.ip).then(function(locationQueryResult){return this._loadFallbacksOnDemand(locationQueryResult)}.bind(this)).then(function(locationQueryResult){return ipLocation.parseLocation(locationQueryResult),ipLocation}.bind(this)).catch(function(){return fweb.log.error("Failed to query IP location."),ipLocation})}}),IPLocationService.prototype.getIPLocations=inject.mark(function($q){return function(ips){if(!ips.length)return $q.resolve([]);var ipLocations=ips.map(function(ip){return new IPLocation(ip)}),publicIPs=ipLocations.filter(function(ipLocation){return!ipLocation.isPrivate}).map(function(ipLocation){return ipLocation.ip});return publicIPs.length?this._query(publicIPs).then(function(locationQueryResults){return this._loadFallbacksOnDemand(locationQueryResults)}.bind(this)).then(function(locationQueryResults){return ipLocations.forEach(function(ipLocation){if(locationQueryResults[ipLocation.ip]){var location={};location[ipLocation.ip]=locationQueryResults[ipLocation.ip],ipLocation.parseLocation(location)}}),ipLocations}.bind(this)).catch(function(){return fweb.log.error("Failed to query IP locations."),ipLocations}):$q.resolve(ipLocations)}}),IPLocation.prototype={get city(){return this._city},get country(){return this._country},get countryISOCode(){return this._countryISOCode},get countryFlag(){return this._countryFlag},get continent(){return this._continent},parseLocation:function(location){var _location=location[this.ip].location;this._parseCity(_location&&_location.city||null),this._parseCountry(_location&&_location.country||null),this._parseContinent(_location&&_location.continent||null),this.coordinates=_location&&_location.location||null,this.isValid=!!(this.toString()&&this.coordinates&&this.coordinates.latitude&&this.coordinates.longitude)},toString:function(){return[this.city,this.country,this.continent].filter(function(entry){return entry}).join(", ")},_parseCity:function(city){this._city=city&&city.names&&city.names.en||null},_parseCountry:function(country){this._country=country&&country.names&&country.names.en||null,this._countryISOCode=country&&country.iso_code||null,this._countryFlag=this._countryISOCode?"country_"+this._countryISOCode:null},_parseContinent:function(continent){this._continent=continent&&continent.names&&continent.names.en||null}},module.service("IPLocationService",IPLocationService)}),define("ng/services/persistent_storage",["angular","ng/ftnt","./cmdb"],function(angular,module){"use strict";module.factory("persistentStorage",function($cookies,$window){var have_localStorage="localStorage"in $window&&null!==$window.localStorage;return{get:function(key){var value;return value=have_localStorage?localStorage.getItem(key):$cookies.get(key),value?angular.fromJson(value):value},put:function(key,value){if(value=angular.toJson(value),have_localStorage)try{return void localStorage.setItem(key,value)}catch(ex){have_localStorage=!1}$cookies.put(key,value)},remove:function(key){have_localStorage?localStorage.removeItem(key):$cookies.remove(key)}}})}),define("ng/services/volatile_storage",["angular","ng/ftnt","./cmdb"],function(angular,module){"use strict";module.factory("volatileStorage",function($cookies,$window){var have_sessionStorage="sessionStorage"in $window&&null!==$window.sessionStorage,cookieKeyPrefix="__session_";return{get:function(key){var value;return value=have_sessionStorage?sessionStorage.getItem(key):$cookies.get(cookieKeyPrefix+key),value?angular.fromJson(value):value},put:function(key,value){if(value=angular.toJson(value),have_sessionStorage)try{return void sessionStorage.setItem(key,value)}catch(ex){have_sessionStorage=!1}$cookies.put(cookieKeyPrefix+key,value)},remove:function(key){have_sessionStorage?sessionStorage.removeItem(key):$cookies.remove(cookieKeyPrefix+key)},clear:function(){if(have_sessionStorage)sessionStorage.clear();else{var cookies=$cookies.getAll();Object.keys(cookies).forEach(function(key){key.startsWith(cookieKeyPrefix)&&$cookies.remove(key)})}}}})}),define("ng/services/password",["angular","notify","ng/ftnt","fweb"],function(angular,Notify,module,fweb){"use strict";function PasswordService($window,$rootScope,slide,lang){this.$rootScope=$rootScope,this.slide=slide,this.lang=lang,angular.element($window).on("message",function(event){var e=event.originalEvent||event,data=e.data,origin=fweb.util.structure.getOrigin();e.origin===origin&&data.messageType===this.OPEN_DIALOG_EVENT&&this.openPasswordDialog()}.bind(this))}function PasswordPolicyService(CMDB,$q){var ADMIN_POLICY=new CMDB("system","password-policy"),GUEST_ADMIN_POLICY=new CMDB("system","password-policy-guest-admin");this.getAllPolicies=function(){return this.policies={admin:ADMIN_POLICY.fetch(),"guest-admin":GUEST_ADMIN_POLICY.fetch()},$q.all([this.policies.admin.$promise,this.policies["guest-admin"].$promise])}}var PASSWORD_CHANGE_ID="passwordChange";PasswordService.prototype.OPEN_DIALOG_EVENT="openPasswordDialog",PasswordService.prototype.openPasswordDialog=function(admin){var scope=this.$rootScope.$new();scope.admin=admin,this.slide.open(PASSWORD_CHANGE_ID,{template:'<f-password-change admin="admin"></f-password-change>',data:{},parentScope:scope,options:{title:this.lang("Edit Password").toString(),okButtonLabel:this.lang("confirm").toString(),fullHeight:!0}})},module.service("passwordService",PasswordService),module.service("passwordPolicyService",PasswordPolicyService)}),define("ng/services/ensure_dcsrf",["angular","ng/ftnt","fweb.util/persist"],function(angular,module,persist){"use strict";function ensureDCSRF($q,$http){var promise,DCSRF_ENDPOINT="/p/csrf/ensure/";return function(){var djangoCSRF=persist.getPythonCsrfToken(),cookieExists=angular.isDefined(djangoCSRF)&&""!==djangoCSRF;return promise||cookieExists||(promise=$http.get(DCSRF_ENDPOINT)),cookieExists?$q.when(cookieExists):promise}}module.factory("ensureDCSRF",ensureDCSRF)}),define("ng/services/reboot",["angular","ng/ftnt"],function(angular,module){"use strict";function RebootService($q,$http,$timeout,usbDisk,adminTimeout,notification,connection){this.$http=$http,this.$q=$q,this.$timeout=$timeout,this.defer=null,this.monitorUrl=LOGIN_URL,this.usbDisk=usbDisk,this.adminTimeout=adminTimeout,this.notification=notification,this.connection=connection}var LOGIN_URL="/login",TIMEOUT_CHECK=1e3,INTERVAL_POLL=1e4,MINS_TO_MSEC=6e4,TIMEOUT_START_MINUTES=10,TIMEOUT_REBOOT_MINUTES=10;RebootService.prototype={monitor:function(triggerFunction,monitorUrl){var that=this;return this.defer&&this.fail("aborted"),null!=monitorUrl&&(this.monitorUrl=monitorUrl),this.defer=this.$q.defer(),this.startEvent(triggerFunction).then(function(){that.usbDisk.stop(),that.adminTimeout.stop(),that.notification.stop(),that.connection.disableVerification(),that.waitSystemDown()},function(){that.usbDisk.start(),that.fail("aborted")}),this.defer.promise},startEvent:function(triggerFunction){var promise=triggerFunction();if(!angular.isObject(promise)||!angular.isFunction(promise.then)){var defer=this.$q.defer();promise=defer.promise,this.$timeout(function(){defer.resolve()},0)}return promise},waitSystemDown:function(start){start=start||Date.now();var waitOrFail=function(){var time=Date.now();return time-start<TIMEOUT_START_MINUTES*MINS_TO_MSEC?void setTimeout(function(){this.waitSystemDown(start)}.bind(this),INTERVAL_POLL):void this.fail("timeout-down")}.bind(this);this.checkStatus(TIMEOUT_CHECK,waitOrFail,this.waitSystemUp.bind(this))},waitSystemUp:function(start){start=start||Date.now();var waitOrFail=function(){var time=Date.now();return time-start<TIMEOUT_REBOOT_MINUTES*MINS_TO_MSEC?void setTimeout(function(){this.waitSystemUp(start)}.bind(this),INTERVAL_POLL):void this.fail("timeout-up")}.bind(this);this.checkStatus(TIMEOUT_CHECK,this.done.bind(this),waitOrFail)},checkStatus:function(timeout,successCallback,errorCallback){this.$http.get(this.monitorUrl,{timeout:timeout}).success(successCallback).error(errorCallback)},fail:function(msg){this.defer.reject(msg),this.defer=null},done:function(){null!=this.defer&&(this.defer.resolve(),this.defer=null)}},module.service("rebootService",RebootService)}),define("ng/services/route",["angular","ng/ftnt","fweb"],function(angular,module,fweb){"use strict";var PERMISSION_CHECK_URI="/api/v2/monitor/web-ui/permission-check",ERROR_403_URI="/p/error/403",CACHE_ID="routePermissionCache",PERMISSION_CHECK_EXEMPT=[/^\/$/,/^\/prompt/,/^\/page/],isInPathList=function(path,pathList){var i,result=!1;for(i=0;i<pathList.length;i++)if(pathList[i].test(path)){result=!0;break}return result};module.provider("fosRoute",function($routeProvider,loaderProvider){var permissionCache;angular.extend(this,$routeProvider,{when:function(path,route){var resolve=route.resolve=route.resolve||loaderProvider.resolve([]);return path&&!isInPathList(path,PERMISSION_CHECK_EXEMPT)&&(resolve.permission=function($location,$q,$http,$rootScope,$window,state,structure){var path="/ng"+$location.path(),search=$location.search(),deferred=$q.defer();return $http.get(PERMISSION_CHECK_URI,{params:{uri:path},cache:permissionCache}).then(function(response){var readOnly,results=response.data.results;results.permitted?(readOnly=results.read_only||state.readOnlyAdmin(),$rootScope.ADMIN_RO=readOnly,state.readOnlyForPage=readOnly,deferred.resolve(readOnly?"ro":"rw")):(fweb.log.error('Insufficient permissions for "'+path+'"'),null!=search.viewOnly?$window.location.href=ERROR_403_URI:($location.url(structure.ngURI(ERROR_403_URI)),deferred.reject()))}),deferred.promise}),$routeProvider.when(path,route),this},$get:function($cacheFactory,$rootScope,state){var service={};return service.enablePermissionCache=function(){permissionCache=$cacheFactory(CACHE_ID),$rootScope.$on(state.UPDATE_EVENT,function(){permissionCache.removeAll()})},service}})})}),define("ng/services/slide-bridge",["angular","ng/ftnt","ng/services/injector","fweb.util/structure"],function(angular,ftntModule,inject,structure){"use strict";function SlideBridge(injector,$window){injector.injectMarked(this),this._openSlides={},$window.addEventListener("message",this._listen.bind(this))}var MESSAGE_TYPE="slideBridge",ACTIONS={OPEN:"open",RESOLVE:"resolve",REJECT:"reject"};SlideBridge.prototype._listen=inject.mark(function(slide,$rootScope,ftntCopy,loader){return function(event){function open(){var scope=data.args[1].parentScope,keys=scope&&Object.keys(scope);scope&&(scope=Object.assign($rootScope.$new(),data.args[1].parentScope),data.args[1].parentScope=scope),slide.open.apply(slide,data.args).then(function(){var result={};keys.forEach(function(key){result[key]=scope[key]});var reply={messageType:MESSAGE_TYPE,action:ACTIONS.RESOLVE,result:result,id:data.id};event.source.postMessage(reply,origin),scope&&scope.$destroy()},function(error){var reply={messageType:MESSAGE_TYPE,action:ACTIONS.REJECT,error:error,id:data.id};event.source.postMessage(reply,origin),scope&&scope.$destroy()})}var origin=structure.getOrigin(),data=event.data;if(event.origin===origin&&data.messageType===MESSAGE_TYPE)switch(data.action){case ACTIONS.OPEN:data.initModules.length?loader.initModules(data.initModules).then(open):$rootScope.$apply(open);break;case ACTIONS.RESOLVE:$rootScope.$apply(function(){this._openSlides[data.id].resolve(data.result),delete this._openSlides[data.id]}.bind(this));break;case ACTIONS.REJECT:$rootScope.$apply(function(){this._openSlides[data.id].reject(data.error),delete this._openSlides[data.id]}.bind(this))}}}),SlideBridge.prototype.open=inject.mark(function($window,$q){return function(initModules,id){if($window==$window.top)throw new Error("Not inside an iframe. Please use the slide service directly.");return structure.topPostMessage({messageType:MESSAGE_TYPE,action:ACTIONS.OPEN,id:id,args:Array.from(arguments).slice(1),initModules:initModules}),this._openSlides[id]=$q.defer(),this._openSlides[id].promise}}),SlideBridge.prototype.get=inject.mark(function(slide){return function(id){return slide.get(id)}}),ftntModule.service("slideBridge",SlideBridge)}),define("ng/services/state",["angular","ng/ftnt","early_state!","text!/api/v2/monitor/web-ui/object-urls","fweb"],function(angular,module,stateResponse,object_urls_text,fweb){"use strict";function State($q,$http,$rootScope,$window,$cookies,$document,persistentStorage,$location){var deferred=$q.defer();angular.extend(this,stateResponse.results),this.responseData=stateResponse.results,this.serial=stateResponse.serial,this.version=stateResponse.version,this.build=stateResponse.build,deferred.resolve(this),this.$q=$q,this.$http=$http,this.$rootScope=$rootScope,this.$cookies=$cookies,this.persistentStorage=persistentStorage,this.$document=$document,this.$window=$window,this.$location=$location,this._postUpdate(stateResponse.snapshot_utc_response_received_time),this._objectUrls=JSON.parse(object_urls_text).results,this._objectUrls.by_path={},Object.keys(this._objectUrls.by_type).forEach(function(type){var objUrl=this._objectUrls.by_type[type];objUrl.type=type,this._objectUrls.by_path[objUrl.path]=objUrl}.bind(this)),this.$promise=deferred.promise,this.loading=!1,$window.state=this}var URI="/api/v2/monitor/web-ui/state";State.prototype._getEditUrl=function(config,mkey,vdom){var url,MKEY_PATTERN=/<mkey>/;return config&&(!mkey&&config.new?url=config.new:config.edit&&(url=config.edit,mkey?config.mkey_url_param?url+="?mkey="+encodeURIComponent(mkey):url=url.replace(MKEY_PATTERN,encodeURIComponent(mkey)):url=url.replace(MKEY_PATTERN,"").replace(/\/{2,}/g,"/"))),vdom?fweb.util.uri.setQueryValue(url,"vdom",vdom):url},State.prototype.getEditUrl=function(path,name,mkey,vdom){var config;if(name&&(path=path+"."+name),config=this._objectUrls.by_path[path])return this._getEditUrl(config,mkey,vdom)},State.prototype.getExactEditUrl=function(path,name,mkey,vdom){return this._getExactEditUrl(path,name,mkey).then(function(url){return vdom?fweb.util.uri.setQueryValue(url,"vdom",vdom):url})},State.prototype._getExactEditUrl=function(path,name,mkey){var that=this,uriEncodedMkey=encodeURIComponent(mkey);if(path&&!name){var pathObject=fweb.util.formatters.path_name_format(path);path=pathObject.path,name=pathObject.name}var commonPolicyUrlFunction=function(policy){return that.$http.get("/api/v2/monitor/system/available-interfaces").then(function(response){var interfaces=response.data.results,srcintf=policy.srcintf[0].name,dstintf=policy.dstintf[0].name,dstintfIsVWP=!1,srcintfIsVWP=!1;return interfaces.forEach(function(intf){intf.name===srcintf&&(srcintfIsVWP=intf.is_virtual_wire_pair_member),intf.name===dstintf&&(dstintfIsVWP=intf.is_virtual_wire_pair_member)}),srcintfIsVWP&&dstintfIsVWP?"/ng/firewall/policy/"+name+"/virtual-wire/edit/"+uriEncodedMkey:that.getEditUrl(path,name,mkey)})},overrides={"firewall.vip":function(vip){return that.$q(function(resolve){resolve("server-load-balance"===vip.type?"/ng/firewall/load-balance/virtual-server/edit/"+uriEncodedMkey:that.getEditUrl(path,name,mkey))})},"firewall.policy":commonPolicyUrlFunction,"firewall.policy6":commonPolicyUrlFunction};return overrides[path+"."+name]&&null!=mkey?that.$http.get("/api/v2/cmdb/"+path+"/"+name+"/"+uriEncodedMkey).then(function(response){return overrides[path+"."+name](response.data.results[0]).then(function(url){return url})}):that.$q.resolve(that.getEditUrl(path,name,mkey))},State.prototype.getEditUrlByType=function(qtype,mkey,vdom){var config=this._objectUrls.by_type[String(qtype)];if(config)return this._getEditUrl(config,mkey,vdom)},State.prototype.getListUrl=function(path,name){var config=this._objectUrls.by_path[path+"."+name];if(config)return config.list},State.prototype.getListUrlByType=function(qType){var config=this._objectUrls.by_type[qType];if(config)return config.list},State.prototype.getPathNameByType=function(qtype){var config=this._objectUrls.by_type[String(qtype)];if(config)return config.path},State.prototype.getTypeByPath=function(path){return this._objectUrls.by_path[path].type},State.prototype.getObjectUrls=function(path,name){return this._objectUrls.by_path[path+"."+name]},State.prototype._updateRootScope=function(){this.$rootScope.model_name=this.model_name,this.$rootScope.hostname=this.hostname,this.$rootScope.host_addr=this.$location.absUrl()},State.prototype.PLATFORM_ERROR={CONSERVE_MODE:"error_conserve_mode"},State.prototype._updateplatformError=function(){var errorLangKey=null;this.conserve_mode&&(errorLangKey=this.PLATFORM_ERROR.CONSERVE_MODE),this.platform_error=errorLangKey},State.prototype.updateTheme=function(theme){var oldTheme,uri,newTheme=theme||this.theme,link=this.$document[0].getElementById("theme");link&&(oldTheme=link.getAttribute("data-theme"),newTheme!==oldTheme&&(uri=fweb.util.uri.cachePath("/css/main-"+newTheme+".css"),link.setAttribute("href",uri),link.setAttribute("data-theme",newTheme),this.$document[0].body.setAttribute("data-theme",newTheme)))},State.prototype._postUpdate=function(responseReceivedTime){responseReceivedTime=responseReceivedTime||(new Date).getTime(),this.browser_utc_offset=responseReceivedTime-this.snapshot_utc_time,this.browser_time_zone_offset=(new Date).getTimezoneOffset(),this._updateRootScope(),this._updateplatformError(),this.updateTheme()},State.prototype.UPDATE_EVENT="refreshState",State.prototype.LOADED_EVENT="stateLoaded",State.prototype.refresh=function(){return fweb.log("Updating application state"),this.loading=!0,this.$promise=this.$http.get(URI).then(function(response){return angular.extend(this,response.data.results),this.responseData=response.data.results,this._postUpdate(),this.loading=!1,this.$rootScope.$broadcast(this.LOADED_EVENT),this}.bind(this)),this.$rootScope.$broadcast(this.UPDATE_EVENT),this.$promise},State.prototype.checkRefresh=function(){this.persistentStorage.get(this.UPDATE_EVENT)===!0&&(this.refresh(),this.persistentStorage.remove(this.UPDATE_EVENT))},State.prototype.readOnlyAdmin=function(){var value=!1;return!this.admin.guest_admin&&this.centrally_managed&&(value=!this.$cookies.get(this.cmgmt_override_cookie_name)),value},State.prototype.readOnlyForPage=!1,State.prototype.VDOM_SCOPE={GLOBAL:"global",VDOM:"vdom"},State.prototype.getCurrentVDOMScope=function(){return this.vdom_mode&&this.current_vdom?this.VDOM_SCOPE.VDOM:this.VDOM_SCOPE.GLOBAL},State.prototype.getOperatingVDOM=function(){return this.current_vdom?this.current_vdom:this.admin.vdom_info[this.management_vdom]?this.management_vdom:Object.keys(this.admin.vdom_info)[0]},State.prototype.getVDOMs=function(){return this.admin.vdoms.filter(function(vdom){return""!==vdom})},State.prototype.OPERATION_MODE={NAT:"NAT",TRANSPARENT:"Transparent"},State.prototype.getOperationMode=function(){var result=this.OPERATION_MODE.NAT,vdom=this.getOperatingVDOM(),vdomInfo=this.admin.vdom_info[vdom];return vdomInfo.transparent_mode&&(result=this.OPERATION_MODE.TRANSPARENT),result},State.prototype.INSPECTION_MODE={FLOW:"flow",PROXY:"proxy"},State.prototype.NGFW_MODE={PROFILE_BASED:"profile-based",POLICY_BASED:"policy-based"},State.prototype.getInspectionMode=function(){var vdom=this.getOperatingVDOM();return this.admin.vdom_info[vdom].inspection_mode},State.prototype.isNgfwPolicyMode=function(){var vdom=this.getOperatingVDOM();return this.admin.vdom_info[vdom].ngfw_mode===this.NGFW_MODE.POLICY_BASED},State.prototype.getVdomSslSshProfile=function(){var vdom=this.getOperatingVDOM(),vdomInfo=this.admin.vdom_info[vdom];return vdomInfo.default_ssl_ssh_profile},State.prototype.hasVdomWithNgfwPolicyMode=function(){return Object.keys(this.admin.vdom_info).some(function(key){return"ngfw"===this.admin.vdom_info[key].policy_mode}.bind(this))},State.prototype.centralNatEnabled=function(){var vdom=this.getOperatingVDOM();return this.admin.vdom_info[vdom].central_nat_enabled},State.prototype.featureEnabled=function(name){var vdom=this.getOperatingVDOM(),vdomFeatures=this.admin.vdom_info[vdom].features;return vdomFeatures[name]||this.features[name]||!1},State.prototype.featureEnabledInAnyVDOM=function(name){var enabledInVDOM=Object.keys(this.admin.vdom_info).some(function(key){return this.admin.vdom_info[key].features[name]}.bind(this));return enabledInVDOM||this.features[name]||!1},State.prototype.ACCESS_GROUP={ADMIN:"admingrp",USER_DEVICE:"authgrp",ENDPOINT_CONTROL:"endpoint-control-grp",FIREWALL:"fwgrp",FIREWALL_ADDRESS:"fwgrp#address",FIREWALL_OTHERS:"fwgrp#others",FIREWALL_PACKET_CAPTURE:"fwgrp#packet-capture",FIREWALL_POLICY:"fwgrp#policy",FIREWALL_SCHEDULE:"fwgrp#schedule",FIREWALL_SERVICE:"fwgrp#service",LOG:"loggrp",LOG_CONFIG:"loggrp#config",LOG_DATA_ACCESS:"loggrp#data-access",LOG_REPORT_ACCESS:"loggrp#report-access",LOG_THREAT_WEIGHT:"loggrp#threat-weight",MAINTENANCE:"mntgrp",NETWORK:"netgrp",ROUTE:"routegrp",SYSTEM:"sysgrp",UPDATE:"updategrp",UTM:"utmgrp",UTM_AV:"utmgrp#antivirus",UTM_APPCTRL:"utmgrp#application-control",UTM_DLP:"utmgrp#data-loss-prevention",UTM_ICAP:"utmgrp#icap",UTM_IPS:"utmgrp#ips",UTM_SPAMFILTER:"utmgrp#spamfilter",UTM_VOIP:"utmgrp#voip",UTM_WF:"utmgrp#WEBFILTER",VPN:"vpngrp",WANOPT:"wanoptgrp",WIFI:"wifi"},State.prototype._getPermission=function(accessGroup){var permission,split,group,granular,isGranular=accessGroup.indexOf("#")>=0;return isGranular?(split=accessGroup.split("#"),group=split[0],granular=split[1],permission="custom"===this.admin.profile[group]?this.admin.profile[group+"-permission"][granular]:this.admin.profile[group]):permission=this.admin.profile[accessGroup],permission},State.prototype._getTablePermissionValue=function(path,name,key){var config,permission=!1;return name&&(path=path+"."+name),config=this._objectUrls.by_path[path],config&&null!=config[key]&&(permission=config[key]),permission},State.prototype.adminHasReadPermission=function(accessGroup){var permission=this._getPermission(accessGroup);return permission?0===permission.indexOf("read"):null},State.prototype.adminHasReadPermissionForTable=function(path,name){return this._getTablePermissionValue(path,name,"read_access")},State.prototype.adminHasWritePermission=function(accessGroup,ignoreReadOnly){var permission="read-write"===this._getPermission(accessGroup);return permission&&(ignoreReadOnly||!this.readOnlyAdmin())},State.prototype.adminHasWritePermissionForTable=function(path,name,ignoreReadOnly){return this._getTablePermissionValue(path,name,"write_access")&&(ignoreReadOnly||!this.readOnlyAdmin())},State.prototype.getFortiGateTimeUTC=function(){return(new Date).getTime()-this.browser_utc_offset},State.prototype.fortiGateUTCToBrowserUTC=function(timestamp){return 1e3*timestamp+this.browser_utc_offset},State.prototype.getBrowerTZOffsetFromFortiGate=function(){return this.time_zone_offset-this.browser_time_zone_offset},State.prototype.getFortiGateTimeZoneOffsetString=function(){var offset=this.time_zone_offset/60*-1,sign=offset>0?"+":"-",absOffset=Math.abs(offset),hours=("0"+Math.trunc(absOffset)).slice(-2),minutes=("0"+Math.round(absOffset%1*60)).slice(-2);return sign+hours+minutes},State.prototype.FORTIVIEW_TIME_PERIODS={REALTIME:"realtime",FIVE_MIN:"5min",ONE_HOUR:"hour",ONE_DAY:"day",ONE_WEEK:"week"},State.prototype.isHistoricalFortiViewSupported=function(){return this.disk_based_fortiview_supported||"faz"===this.getLogDisplayLocation()},State.prototype.suppportsFortiViewTimePeriod=function(period){return this.getFortiViewTimeframeOptions().indexOf(period)>=0},State.prototype.getFortiViewTimeframeOptions=function(){var timeframeOptions=[this.FORTIVIEW_TIME_PERIODS.REALTIME],logDeviceState=this.getLogDeviceState(),fazEnabled=logDeviceState&&logDeviceState.fortianalyzer.is_available;return this.isHistoricalFortiViewSupported()&&(timeframeOptions=timeframeOptions.concat([this.FORTIVIEW_TIME_PERIODS.FIVE_MIN,this.FORTIVIEW_TIME_PERIODS.ONE_HOUR])),(fazEnabled||"low"!==this.model_level)&&timeframeOptions.push(this.FORTIVIEW_TIME_PERIODS.ONE_DAY),(fazEnabled||this.fortiview_weekly_data)&&timeframeOptions.push(this.FORTIVIEW_TIME_PERIODS.ONE_WEEK),timeframeOptions},State.prototype.getLogDisplayLocation=function(){var result="unknown",vdom=this.getOperatingVDOM(),vdomInfo=this.admin.vdom_info[vdom];return vdomInfo&&(result=vdomInfo.log_display_location),result},State.prototype.getLogDeviceState=function(){var vdom=this.getOperatingVDOM(),vdomInfo=this.admin.vdom_info[vdom];return vdomInfo&&vdomInfo.log_device_state},module.service("state",State)}),define("ng/structure/services/structure",["ng/ftnt","fweb.util/structure","ng/services/state"],function(module,fwebStructure){"use strict";module.provider("structure",function(){this.EMBEDDED_URI_ROUTE=fwebStructure.EMBEDDED_URI_ROUTE,this.ENTER_VDOM_EVENT="enterVDOM",this.ngURI=function(uri){return fwebStructure.ngURI(uri)},this.isEmbeddedURI=function(uri){return 0===uri.indexOf(fwebStructure.EMBEDDED_URI_ROUTE)},this.responsiveMenu=!1,this.toggleResponsiveMenu=function(){this.responsiveMenu=!this.responsiveMenu}.bind(this),this.isFullscreen=!1,this.$get=function($location,$injector,$window,$cookies,state){return this.notifyMessagesQueuedForIframe=!1,this.hideBuildLabel=!1,this.getAbsolutePath=function(){var path=$location.path();return path=0===path.indexOf(fwebStructure.EMBEDDED_URI_ROUTE)?path.replace(fwebStructure.EMBEDDED_URI_ROUTE,""):"/ng"+path},this.setVDOMCookie=function(vdom){$cookies.put(state.vdom_cookie_name,vdom,{path:"/"})},this.getVDOMCookieValue=function(){return $cookies.get(state.vdom_cookie_name)},this.ngRouteURI=function(path,search){function splitDecode(kv){return kv=/^([^=]+)=?(.*)?/.exec(kv),{key:decodeURIComponent(kv[1]),value:kv[2]&&decodeURIComponent(kv[2])}}function toObject(obj,kv){return obj[kv.key]=kv.value,obj}if(void 0===search){var searchMatch=/^([^\?]+)\?(.*)/.exec(path);searchMatch&&searchMatch[2]&&(path=searchMatch[1],search=searchMatch[2].split("&").map(splitDecode).reduce(toObject,{}))}return!state.vdom_mode||search&&"vdom"in search||(search=search||{},search.vdom=state.current_vdom),search=search&&Object.keys(search).reduce(function(params,k){return params.push(encodeURIComponent(k)+(void 0!==search[k]?"="+encodeURIComponent(search[k]):"")),params},[]).join("&"),(path+(search?"?"+search:"")).replace(/^(?:\/ng)?\/?\/?/,"/ng/")},this.dialogSaveSuccessRedirect=function(redir){return"/success"===redir?$window.location.href=redir:$location.url(fwebStructure.ngURI(redir))},this}})}),define("ng/directives/qlist",["angular","ng/ftnt","jquery","qed_list"],function(angular,ftntModule,$){"use strict";var TEMPLATE='<div class="qlist-container"><div class="base-mask qlist-loading-mask" ng-show="qlistCtrl.loading"><f-icon class="qlist-loading-icon fa-loading icon-xxxl"></f-icon></div></div>',QLIST_ELEMENT='<div class="ng-qlist" ng-class="{\'invisible\': loading}"></div>',qlist=function($q,$compile,$injector){return{restrict:"E",replace:!0,template:TEMPLATE,controllerAs:"qlistCtrl",bindToController:!0,scope:{source:"=",options:"=",filters:"=",deepWatchSource:"=?",deepWatchOptions:"=?",qlistElement:"=",click:"&",doubleClick:"&",selectRows:"&",selectedEntries:"=?",lastSelectedEntry:"=?",refreshOn:"&",alwaysPurge:"<?",qlistCtrl:"=?"},controller:function($scope,$element,$attrs){var $qlist,deepWatchSource=this.deepWatchSource||!1,deepWatchOptions=void 0===this.deepWatchOptions||this.deepWatchOptions;this.qlistCtrl=this;var getConfig=function(options,source){var config=$.extend(!0,{},options);return config.options?config.options.inline=config.options.inline||!!$attrs.inlineStyle:config.options={inline:!!$attrs.inlineStyle},config.paging&&source.totalPagedLines&&(config.paging.total_lines=source.totalPagedLines),config.$scope=config.ngScope=$scope,config.ngInjector=$injector,config.source=source,config},getQlistElement=function(){var ns=".f-qlist-"+$scope.$id;return $qlist||($qlist=$compile(QLIST_ELEMENT)($scope).prependTo($element),$attrs.qlistElement&&(this.qlistElement={element:$qlist}),$qlist.on("click."+ns,function(event){this.click({$event:event})}.bind(this)).on(),$qlist.on("qlist_dblclick_row."+ns,function(event,data){this.doubleClick({$event:event,$entries:data.entries})}.bind(this)),$qlist.on("qlist_select_rows"+ns,function(event,data){$scope.$evalAsync(function(){this.selectedEntries=data.entries||null,this.selectRows({$event:event,data:data})}.bind(this))}.bind(this))),$qlist}.bind(this),purgeState=function(){$qlist&&($qlist.remove(),$qlist=null)},renderQlist=$.debounce(100,function(){this.source&&this.options&&$q.when(this.source.$promise||this.source).then(function(source){if(Array.isArray(source)){for(;$scope.$$childTail;)$scope.$$childTail.$destroy();$qlist=getQlistElement().toggleClass("inline-qlist",!!$attrs.inlineStyle),$qlist.qlist(getConfig(this.options,source)),$qlist.qlist("get_selected_entries").then(function(entries){this.selectedEntries=entries,this.lastSelectedEntry=entries&&entries[entries.length-1]||null}.bind(this)),this.loading=!1}}.bind(this))}.bind(this)),reload=function(purge){this.loading=!0,purge&&purgeState(),renderQlist()}.bind(this);this.$onInit=function(){this.loading=!0,$scope.$watch("qlistCtrl.source",function(){reload()},deepWatchSource),$scope.$watch("qlistCtrl.options",function(options,old){if(this.source&&options&&"source"in options)throw new Error('Invalid property "source" in qlist options. Use source attribute on the directive exclusively');if(this.filters&&options&&"column_filters"in options&&"value"in options.column_filters)throw new Error('Invalid property "column_filters.value"  in qlist options. Use filters attribute on the directive exclusively');var purge=this.alwaysPurge||(options||{}).prefix!==(old||{}).prefix;reload(purge)}.bind(this),deepWatchOptions),$scope.$watch("qlistCtrl.filters",function(value){Array.isArray(value)&&$qlist&&$qlist.qlist("filter",value)},!0),$scope.$watch("qlistCtrl.refreshOn()",this.refresh.bind(this),!0),$scope.$on("qlistReload",function(){reload()}),$scope.$on("clearQlistSelection",function(){$qlist&&$qlist.qlist("clear_selection")}),$scope.$on("$destroy",function(){$qlist&&$qlist.qlist("clean_up")})}.bind(this),this.refresh=function(){$qlist&&$qlist.qlist("refresh")},this.render=function(){renderQlist()}}}};ftntModule.directive("fQlist",qlist)}),define("ng/directives/f-list",["module","ng/ftnt","ng/services/injector","angular","ng/directives/qlist"],function(module,ftntModule,inject){"use strict";function List($transclude,injector){injector.injectMarked(this,{$transclude:$transclude})}function ListMenuTransclude($element,injector){injector.injectMarked(this,{$element:$element})}var TEMPLATE_URL="/ng/directives/f-list.html",fList={transclude:!0,templateUrl:function(loader){return loader.base_path(TEMPLATE_URL,module)},bindings:{source:"<",options:"=",filters:"=?",qlist:"=?",loading:"<?"},controller:List};List.prototype={transcludeFilled:!1,addMenu:inject.mark(function($transclude){return function(menu){if(menu instanceof ListMenuTransclude)return function(cloned){return this.transcludeFilled=cloned.length,$transclude.apply(this,arguments)}.bind(this)}}),loadingMessage:inject.mark(function(lang){return function(){return"string"==typeof this.loading||this.loading instanceof lang.Translated?this.loading:" "}})};var fListMenuTransclude={bindings:{menu:"<",list:"<"},controller:ListMenuTransclude};ListMenuTransclude.prototype={$onInit:inject.mark(function($element){return function(){var $transclude=this.list.addMenu(this);$transclude(function(cloned,scope){
scope.menu=this.menu,$element.append(cloned)}.bind(this))}})},ftntModule.component("fList",fList),ftntModule.component("fListMenuTransclude",fListMenuTransclude)}),define("ng/directives/object_attributes",["angular","ng/ftnt","jquery","fweb.util/dom"],function(angular,module,$,dom){"use strict";module.controller("objectAttributes",function($scope,slide,$http,$q){$scope.data=slide.get("object_attributes_slide").data;var highlightKeys=[],loadData=function(){var params={schema:{action:"schema"},data:{skip:"1"}};$scope.data.entry.vdom&&(params.schema.vdom=$scope.data.entry.vdom,params.data.vdom=$scope.data.entry.vdom);var objectAttributes={},promises=[$http.get("/api/v2/cmdb/"+$scope.data.entry.path+"/"+$scope.data.entry.name,{params:params.schema}),$http.get("/api/v2/cmdb/"+$scope.data.entry.path+"/"+$scope.data.entry.name+"/"+encodeURIComponent($scope.data.entry.mkey),{params:params.data})],ignoreKeys=[/^q_[A-Za-z\-\_]+$/,/^datasource$/,/^css\-class$/],removeIgnoredKeys=function(subtable){return Object.keys(subtable).forEach(function(key){ignoreKeys.forEach(function(ignoredKey){key.match(ignoredKey)&&delete subtable[key]})}),subtable};$q.all(promises).then(function(response){var children=response[0].data.results.children,compare=function(key){$scope.data.entry.attributes.indexOf(key)!==-1&&highlightKeys.push(key)},processComplexValue=function(value,key){return compare(key),removeIgnoredKeys(value)};Object.keys(children).forEach(function(key){objectAttributes[key]=children[key]});var object;object=Array.isArray(response[1].data.results)?response[1].data.results[0]:response[1].data.results;var keys=Object.keys(object);keys.forEach(function(key){if(objectAttributes[key]){var attribute=objectAttributes[key],value=object[key];switch(attribute.category){case"complex":value=processComplexValue(value,key);break;case"table":for(var i=0;i<value.length;i++)value[i]=processComplexValue(value[i],key);break;case"unitary":angular.isObject(value)&&(value=processComplexValue(value,key))}attribute.value=value}});var attributes=[];Object.keys(objectAttributes).forEach(function(key){object[key]&&attributes.push(objectAttributes[key])});var makeSubtable=function(keys,values){var $span=$("<span></span>"),makeRow=function(key,value){var printedValue=value;return angular.isArray(value)?printedValue="<em>"+$.getInfo("Table with {COUNT} entries",[value.length])+"</em>":angular.isObject(value)&&(printedValue="<em>"+$.getInfo("Object with {COUNT} properties",[Object.keys(value).length])+"</em>"),$("<tr><td>"+key+"</td><td>"+printedValue+"</td></tr>")},$button=$('<button type="button" class="compact-visual-toggle"></button>'),$label=$("<label><span>"+$.getInfo("Show")+"</span></label>");$label.prepend($button);var $table=$('<table class="table key-value hidden"><tbody></tbody></table>');return $label.click(function(){return $table.toggleClass("hidden"),$button.toggleClass("active"),$(window).trigger("resize"),!1}),keys&&keys.length>0?keys.forEach(function(key){$table.append(makeRow(key,values[key]))}):values.forEach(function(value){angular.isObject(value)?Object.keys(value).forEach(function(key){$table.append(makeRow(key,value[key]))}):$table.append($('<tr><td colspan="2">'+value+"</td></tr>"))}),$span.append($label),$span.append($table),$span};$scope.qlistSource=attributes,$scope.qlistOptions={prefix:"objectAttributes",columns:[{selector:"name",lang_key:"Name"},{selector:"value",lang_key:"value"}],row_gen:function(index,entry){highlightKeys.indexOf(entry.name)!==-1&&$(this).toggleClass("selected")},options:{disable_selection:!0,sorting:!0},default_sort:[{selector:"name",direction:"asc"}],sort:{save_in_cookie:!1},format_fn:{name:function(td,col,entry){angular.isArray(entry.value)&&entry.value.length>0?td.addClass("cell-top"):angular.isObject(entry.value)&&Object.keys(entry.value).length>1&&td.addClass("cell-top")},value:function(td,col,entry){if(angular.isArray(entry.value)&&entry.value.length>0)td.append(makeSubtable([],entry.value));else{if(!angular.isObject(entry.value))return"password"===entry.type?$.getInfo("Password value not shown."):dom.escapeHTML(entry.value);var keys=Object.keys(entry.value);if(keys.length>0){if(1===keys.length)return entry.value[keys[0]];td.append(makeSubtable(keys,entry.value))}}}}}})};$scope.$watch("data.entry",function(newVal,oldVal){newVal!==oldVal&&loadData()},!0),$scope.noMenu=!0,loadData()}),module.directive("objectAttributes",function(){return{restrict:"E",controller:"objectAttributes",controllerAs:"ctrl",template:'<f-list source="qlistSource" options="qlistOptions"></f-list>'}})}),define("ng/services/object_attributes",["angular","ng/ftnt","ng/directives/object_attributes"],function(angular,module){"use strict";function ObjectAttributes($http,lang,slide){this.$http=$http,this.lang=lang,this.slide=slide}ObjectAttributes.prototype.open=function(entry){var config,generateTitle=function(entry){var title;return title=entry.mkey?this.lang("Properties of {0}: {1}",[this.lang(entry.path+"."+entry.name),entry.mkey]).toString():this.lang("Properties of {0}",[this.lang(entry.path+"."+entry.name)]).toString()}.bind(this),title=generateTitle(entry);return this.slide.open("object_attributes_slide",{template:"<object-attributes></object-attributes>",data:{entry:entry},options:{title:title,okButton:!1,fullHeight:!0,width:600}}),function(entry){config=this.slide.get("object_attributes_slide"),config.slide.update({title:generateTitle(entry)}),config.data.entry=entry}.bind(this)},module.service({objectAttributes:ObjectAttributes})}),define("ng/directives/object_usage",["angular","ng/ftnt","jquery","fweb","notify","ng/structure/services/structure","ng/directives/f-list","ng/directives/qlist","ng/services/object_attributes"],function(angular,module,$,fweb,Notify){"use strict";var RELOAD_OBJECT_USAGE_SLIDE="reloadObjectUsageSlide";module.controller("ObjectUsage",function($scope,$rootScope,slide,$http,$q,$location,structure,state,$httpParamSerializer){$scope.qtypes=$scope.qtypes.split(",");var slideObject=slide.get("object_usage_slide:"+$scope.path+"."+$scope.name+":"+$scope.mkey);$scope.view={options:[{value:"currently_using",label:"Current Usage"},{value:"can_use",label:"Possible Uses"}],selected:"currently_using"},$scope.menuItemsTemplate="/ng/menu/system/object_usage.html",$scope.loadData=function(){$scope.referenceGroup={},$scope.data={currently_using:[],can_use:[]};var sortingKeys={currently_using:{},can_use:{}},qtypes="string"==typeof $scope.qtypes?$scope.qtypes.split(","):$scope.qtypes;$http.get("/api/v2/monitor/system/object/usage",{params:{mkey:$scope.mkey,qtypes:JSON.stringify(qtypes)}}).then(function(response){["currently_using","can_use"].forEach(function(type){response.data.results[type].forEach(function(entry){if(entry.type=$.getInfo(entry.path+"."+entry.name),"currently_using"===type){var key=entry.path+"."+entry.name+":"+entry.mkey;entry.groupKey=key,$scope.referenceGroup[key]?($scope.referenceGroup[key].count++,$scope.referenceGroup[key].attributes.push(entry.attribute)):$scope.referenceGroup[key]={count:1,attributes:[entry.attribute]},entry.canDelete=0===entry.reference_count&&entry.static===!1&&"complex"!==entry.table_type,entry.q_type=state.getTypeByPath(entry.path+"."+entry.name),sortingKeys.currently_using[entry.groupKey]||(sortingKeys.currently_using[entry.groupKey]=!0,$scope.data.currently_using.push(entry))}else"can_use"===type&&(sortingKeys.can_use[entry.name]||(sortingKeys.can_use[entry.name]=!0,$scope.data.can_use.push(entry)))})}),$scope.loadTable(!0)})},$scope.loadData(),$scope.$on(RELOAD_OBJECT_USAGE_SLIDE,$scope.loadData.bind($scope)),$scope.loadTable=function(currentlyUsing){var qlistOptions={prefix:"objectUsage_"+(currentlyUsing?"currently-using":"possible-uses"),options:{collapsible_sections:{"*":!1}},sort:{save_in_cookie:!1},filter:function(entry){return"currently_using"!==$scope.view.selected||!!entry.table_type},format_fn:{mkey:function(td,col,entry){var val=entry.mkey||$.getInfo("Settings"),groupCount=$scope.referenceGroup[entry.groupKey].count;return groupCount>1&&(val=$.getInfo("{NAME} ({COUNT} References)",[val,groupCount])),val},reference_count:function(td,col,entry){var refLink=$("<a>"+entry.reference_count+"</a>");return refLink.click(function(){fweb.util.structure.topPostMessage({messageType:"showObjectUsage",qTypes:[entry.q_type],mkey:entry.mkey,vdom:entry.vdom})}),refLink}}};currentlyUsing?($scope.qlistSource=$scope.data.currently_using,qlistOptions.sections=["type"],qlistOptions.columns=[{selector:"mkey",lang_key:"Object Name"},{selector:"reference_count",lang_key:"ref"}]):($scope.qlistSource=$scope.data.can_use,qlistOptions.columns=[{selector:"type",lang_key:"Object Type"}],qlistOptions.options.sorting=!0,qlistOptions.default_sort=[{selector:"type",direction:"asc"}]),$scope.qlistOptions=qlistOptions,$scope.$broadcast("qlistReload")},$scope.$watch("view.selected",function(newVal,oldVal){newVal!==oldVal&&$scope.loadTable("currently_using"===newVal)});var navigateToObjectOrList=function(url,referenceEntry){var VDOM_RANGE_BOTH_GLOBAL={"system.admin":!0},determineVDOM=function(){var vdom,url,pathName=referenceEntry.path+"."+referenceEntry.name,fallbackVDOM=$scope.vdom||state.current_vdom||state.management_vdom,tableRange=referenceEntry.range;return"both"===tableRange?VDOM_RANGE_BOTH_GLOBAL[pathName]?vdom="":referenceEntry.mkey?(url="/api/v2/cmdb/"+referenceEntry.path+"/"+referenceEntry.name+"/"+referenceEntry.mkey,vdom=$http.get(url).then(function(response){var entryVDOM=response.data.results[0].vdom;return entryVDOM?entryVDOM.q_origin_key||entryVDOM:""})):vdom=fallbackVDOM:vdom="global"===tableRange?"":referenceEntry.vdom||fallbackVDOM,vdom===fweb.BUILD.SYMBOLS.DMGMT_VF_NAME&&(vdom=state.management_vdom),$q.resolve(vdom)};$q.all([determineVDOM(),slideObject.slide.done()]).then(function(result){var vdom=result[0];url=structure.ngURI(url),state.vdom_mode&&(url+=(url.indexOf("?")>=0?"&":"?")+$httpParamSerializer({vdom:vdom})),$location.url(url)})};$scope.navigateTo=function(entry,url){entry&&url&&navigateToObjectOrList(url,entry)};var canObjectBeDeleted=function(entry){var overrides={"system.admin":function(){return entry.mkey!==state.admin.name}},override=overrides[entry.path+"."+entry.name];return!override||override()};$scope.canDelete=function(entries){var canDelete=!1;return entries.forEach(function(entry){entry.canDelete&&(canDelete=canObjectBeDeleted(entry))}),canDelete},$scope.objectHaveStateDependencies=function(pathName){var dependencies=new Set(["system.virtual-wire-pair"]);return dependencies.has(pathName)},$scope.deleteObjects=function(entries){if(!(entries.length<=0)&&$scope.canDelete(entries)){var deleteMessage,entriesToDelete=[];entries.forEach(function(entry){entry.canDelete&&entriesToDelete.push(entry)}),deleteMessage=entriesToDelete.length===entries.length?$.getInfo("selected_delete_confirm",["elements"]):$.getInfo("selected_delete_confirm_subset",["elements",entriesToDelete.length,entries.length]),fweb.util.slide.confirm(deleteMessage).then(function(){var promises=[],objectHasDependencies=!1;entriesToDelete.forEach(function(entry){var url="/api/v2/cmdb/"+entry.path+"/"+entry.name+"/"+encodeURIComponent(entry.mkey);promises.push($http.delete(url)),$scope.objectHaveStateDependencies(entry.path+"."+entry.name)&&(objectHasDependencies=!0)}),$q.all(promises).then(function(){Notify.post($.getInfo("Object(s) deleted successfully."),"success")}).catch(function(){Notify.post($.getInfo("Unable to delete all or some objects."),"error")}).finally(function(){$rootScope.$broadcast(RELOAD_OBJECT_USAGE_SLIDE),slideObject.data.shouldReloadRoute=!0,slideObject.data.shouldRefreshState=objectHasDependencies})})}}}),module.controller("objectUsageMenu",function($scope,slide,$q,state,objectAttributes){$scope.buttonURLs={};var determineButtonURLs=function(entry,complex){return $q(function(resolve){var key=entry.path+"."+entry.name+"."+entry.mkey;if($scope.buttonURLs[key])return void resolve($scope.buttonURLs[key]);var URLs={},objectUrls=state.getObjectUrls(entry.path,entry.name);URLs.listURL=objectUrls.list,entry.mkey||complex?resolve(state.getExactEditUrl(entry.path,entry.name,entry.mkey).then(function(dialogURL){return URLs.dialogURL=dialogURL,$scope.buttonURLs[key]=URLs,URLs})):($scope.buttonURLs[key]=URLs,resolve(URLs))})};$scope.viewProperties=function(entry){entry&&($scope.updateAttributes=objectAttributes.open({path:entry.path,name:entry.name,mkey:entry.mkey,vdom:entry.vdom,attributes:$scope.referenceGroup[entry.groupKey].attributes}))},$scope.$watch("menu.lastSelectedEntry",function(newVal,oldVal){if(newVal!==oldVal){newVal&&($scope.dialogURL=void 0,$scope.listURL=void 0,$scope.buttonLoading=!0,determineButtonURLs(newVal,"complex"===newVal.table_type).then(function(URLs){$scope.buttonLoading=!1,void 0!==URLs.listURL&&URLs.listURL.length>0&&($scope.listURL=URLs.listURL),void 0!==URLs.dialogURL&&URLs.dialogURL.length>0&&($scope.dialogURL=URLs.dialogURL)},function(){$scope.buttonLoading=!1}));var config;try{config=slide.get("object_attributes_slide"),newVal.attributes=$scope.referenceGroup[newVal.groupKey].attributes,$scope.updateAttributes(newVal)}catch(err){}}})}),module.directive("objectUsage",function(){return{restrict:"E",controller:"ObjectUsage",controllerAs:"ctrl",template:'<f-list source="qlistSource" options="qlistOptions"><div ng-include="menuItemsTemplate | cache_path"></div></f-list>',scope:{qtypes:"@",mkey:"@",path:"@",name:"@",vdom:"@"}}})}),define("ng/services/object_usage",["angular","ng/ftnt","fweb.util/formatters","ng/directives/object_usage"],function(angular,module,formatters){"use strict";function ObjectUsage($http,lang,slide,state){this.$http=$http,this.lang=lang,this.slide=slide,this.state=state}ObjectUsage.prototype.open=function(qTypes,mkey,vdom,nameOverride){Array.isArray(qTypes)||(qTypes=[qTypes]);var objName=nameOverride||mkey,pathName=formatters.path_name_format(this.state.getPathNameByType(qTypes[0])),slideID="object_usage_slide:"+pathName.path+"."+pathName.name+":"+mkey,template='<object-usage qtypes="'+qTypes.join(",")+'" mkey="'+mkey+'" path="'+pathName.path+'" name="'+pathName.name+'"';return vdom&&(template+=' vdom="'+vdom+'"'),template+="></object-usage>",this.slide.open(slideID,{template:template,data:{mkey:mkey,qtypes:qTypes,path:pathName.path,name:pathName.name,vdom:vdom},options:{title:this.lang("Usage of {0}: {1}",[this.lang(pathName.path+"."+pathName.name),objName]).toString(),okButtonLabel:this.lang("Close").toString(),fullHeight:!0}})},module.service({objectUsage:ObjectUsage})}),define("ng/services/vdom_state",["angular","ng/ftnt","ng/services/injector","fweb"],function(angular,module,inject,fweb){"use strict";function VDOMState(injector){injector.injectMarked(this)}var ERROR_403_URI="/p/error/403";VDOMState.prototype.setCurrent=inject.mark(function(state,structure,$location,navbarDependencies){return function(vdom){var result=!0;return vdom!==state.current_vdom&&(navbarDependencies._dependenciesCache.removeAll(),navbarDependencies.update(),state.admin.vdoms.indexOf(vdom)>=0?(structure.setVDOMCookie(vdom),state.current_vdom=vdom):($location.url(structure.ngURI(ERROR_403_URI)),fweb.log.error('Invalid VDOM specified for the current admin: "'+vdom+'"'),state.current_vdom=state.initial_vdom,result=!1)),result}}),module.service("vdomState",VDOMState)}),define("ng/services/license/license",["angular","ng/services/injector","ng/ftnt","fweb"],function(angular,inject,ngFtnt,fweb){"use strict";function License(injector){injector.injectMarked(this),this._init()}function LicenseRegions(injector){injector.injectMarked(this),this.countries=[],this.canada=[],this.usa=[],this.canadaCode=null,this.usaCode=null,this.loading=!0,this.resellersCache={},this.resellers=[],this.resellersLoading=!1,this._get()}var STATUS_BASE_KEY="LICENSE_STATUS_",STATUSES=fweb.BUILD.SYMBOLS,COUNTRY_CODES_URI="/ng/services/license/fortiguard_country_codes.json",REGION_CODES_URI="/ng/services/license/ca_us_region_codes.json",RESELLERS_URL="/api/v2/monitor/license/forticare-resellers?country_code=",ORG_URL="/api/v2/monitor/license/forticare-org-list",FORTICARE_INDUSTRY_KEY="FortiCare::industry.";License.prototype._init=function(){this._loaded=!1,this._licenses={},this._updateExecuted=!1},License.prototype.getSeverityLevel=function(status){var level;switch(status){case STATUSES[STATUS_BASE_KEY+"EXPIRED"]:case STATUSES[STATUS_BASE_KEY+"VM_EXPIRED"]:case STATUSES[STATUS_BASE_KEY+"VM_INVALID"]:case STATUSES[STATUS_BASE_KEY+"VM_INVALID_COPY"]:case STATUSES[STATUS_BASE_KEY+"VM_ERROR"]:case STATUSES[STATUS_BASE_KEY+"NOT_REGISTERED"]:case STATUSES[STATUS_BASE_KEY+"CLOUD_ERROR"]:level="severity-critical";break;case STATUSES[STATUS_BASE_KEY+"NO_LICENSE"]:case STATUSES[STATUS_BASE_KEY+"EXPIRES_SOON"]:case STATUSES[STATUS_BASE_KEY+"LICENSED_EXHAUSTED"]:case STATUSES[STATUS_BASE_KEY+"FREE_LICENSE_EXHAUSTED"]:case STATUSES[STATUS_BASE_KEY+"CLOUD_LOGGED_OUT"]:case STATUSES[STATUS_BASE_KEY+"VM_EVAL"]:level="severity-high";break;default:level=""}return level},License.prototype.getStatusIcon=function(status){var icon;switch(status){case STATUSES[STATUS_BASE_KEY+"REGISTERED"]:case STATUSES[STATUS_BASE_KEY+"LICENSED"]:case STATUSES[STATUS_BASE_KEY+"VM_VALID"]:case STATUSES[STATUS_BASE_KEY+"FREE_LICENSE"]:case STATUSES[STATUS_BASE_KEY+"CLOUD_LOGGED_IN"]:icon="fa-enabled";break;case STATUSES[STATUS_BASE_KEY+"NOT_REGISTERED"]:case STATUSES[STATUS_BASE_KEY+"EXPIRED"]:case STATUSES[STATUS_BASE_KEY+"VM_EXPIRED"]:case STATUSES[STATUS_BASE_KEY+"VM_INVALID"]:case STATUSES[STATUS_BASE_KEY+"VM_INVALID_COPY"]:case STATUSES[STATUS_BASE_KEY+"VM_ERROR"]:case STATUSES[STATUS_BASE_KEY+"CLOUD_ERROR"]:icon="fa-severity-critical";break;case STATUSES[STATUS_BASE_KEY+"NO_LICENSE"]:case STATUSES[STATUS_BASE_KEY+"LICENSED_EXHAUSTED"]:case STATUSES[STATUS_BASE_KEY+"FREE_LICENSE_EXHAUSTED"]:case STATUSES[STATUS_BASE_KEY+"CLOUD_LOGGED_OUT"]:case STATUSES[STATUS_BASE_KEY+"EXPIRES_SOON"]:case STATUSES[STATUS_BASE_KEY+"VM_EVAL"]:icon="fa-severity-high";break;case STATUSES[STATUS_BASE_KEY+"PENDING"]:case STATUSES[STATUS_BASE_KEY+"VM_STARTUP"]:case STATUSES[STATUS_BASE_KEY+"VM_WAIT_AUTH"]:case STATUSES[STATUS_BASE_KEY+"CLOUD_CONFIRM_EMAIL"]:case STATUSES[STATUS_BASE_KEY+"CLOUD_LOGIN_IN_PROGRESS"]:icon="fa-loading";break;case STATUSES[STATUS_BASE_KEY+"NO_SUPPORT"]:icon="fa-exempt";break;default:icon="fa-unknown"}return icon},License.prototype.getFortiCareSupportLangKey=function(key){var MAP={enhanced:"ENHC",comprehensive:"COMP"};return MAP[key]||key},License.prototype.getExpiresLabelForStatus=inject.mark(function(lang){return function(status){return lang(this.getExpiresLangKeyForStatus(status))}}),License.prototype.getExpiresLangKeyForStatus=function(status){var result;return result=status===STATUSES[STATUS_BASE_KEY+"EXPIRED"]?"expired_on":"expires_on"},License.prototype.formatExpiryDate=inject.mark(function($filter){var dateFilter=$filter("date");return function(expiry,timezone){return dateFilter(1e3*expiry,"yyyy/MM/dd",timezone)}}),License.prototype.formatExpiresLabelForStatus=inject.mark(function($filter,lang){return function(status,expiry,timezone){var key;return key=status===STATUSES[STATUS_BASE_KEY+"EXPIRED"]?"expired on {0}":"expires on {0}",lang(key,[this.formatExpiryDate(expiry,timezone)])}}),LicenseRegions.prototype._get=inject.mark(function($http,loader,$q){return function(){var countryCodesUri=loader.base_path(COUNTRY_CODES_URI),regionCodesUri=loader.base_path(REGION_CODES_URI);$q.all([$http.get(countryCodesUri),$http.get(regionCodesUri)]).then(function(response){this.countries=response[0].data,this.canada=response[1].data.canada,this.usa=response[1].data.usa,this.countries.forEach(function(country){"Canada"===country.name?this.canadaCode=country.code:"United States"===country.name&&(this.usaCode=country.code)}.bind(this)),this.loading=!1}.bind(this))}}),LicenseRegions.prototype.getIndustryOrgInfo=inject.mark(function($http){return function(){return $http.get(ORG_URL).then(function(response){var data=response.data.results;this.industries=data.industry,this.orgSizes=data.org_size,this.industries.forEach(function(industry){industry.translated=this.translateIndustry(industry)}.bind(this))}.bind(this),function(){fweb.log.error("Failed to retrieve industry/organization size information.")})}}),LicenseRegions.prototype.translateIndustry=inject.mark(function(lang){return function(industry){industry=industry instanceof Object?industry.name:industry;var translated=lang(FORTICARE_INDUSTRY_KEY+industry);return translated.trusted?translated.toString():industry}}),LicenseRegions.prototype.updateResellers=inject.mark(function($http){return function(country){this.resellersCache[country]?this.resellers=this.resellersCache[country]:(this.resellersLoading=!0,$http.get(RESELLERS_URL+country).then(function(response){var resellers=response.data.results.resellers;this.resellers=resellers,this.resellersCache[country]=resellers,this.resellersLoading=!1}.bind(this)))}}),ngFtnt.service({license:License,licenseRegions:LicenseRegions})}),define("ng/services/registration",["angular","ng/services/injector","ng/ftnt","fweb","ng/services/ensure_dcsrf"],function(angular,inject,ngFtnt,fweb){"use strict";function Registration(injector){injector.injectMarked(this)}Registration.prototype.open=inject.mark(function(slide){return function(model,step,warning){var params=this.setupForIndividualStep(model,step,warning);return slide.open("F_REGISTRATION_MODAL",params)}}),Registration.prototype.setupForIndividualStep=inject.mark(function(state,lang,ensureDCSRF){return function(model,step,warning){ensureDCSRF();var modalData={model:{step:step||"forticare",override_next_step:model.override_next_step||null,action:model.action||"login",serial:state.serial,auto_forticloud:!0,send_logs:!fweb.BUILD.PLATFORM.GUI_FORTICLOUD_ACTIVATE_LOG_OPTION_DISABLED},initialWarning:warning},params={template:"<f-registration></f-registration>",data:modalData,options:{fullHeight:!0}};return"forticloud_logout"===step&&(params.options.okButtonLabel=lang("Yes"),params.options.cancelButtonLabel=void 0),params}}),ngFtnt.service({registration:Registration})}),define("ng/directives/head",["angular","ng/ftnt","ftnt_shared","ng/services/loader"],function(angular,module,ftnt_shared){"use strict";function HeadStylesheets($rootScope){this._$rootScope=$rootScope,this.stylesheets=new ftnt_shared.SetSequence,this.changeSubscriptions=new Set}function HeadStylesheet(href){this.href=href}function Subscription(callback){this.notify=callback}module.provider("cssRouteSegment",function($injector){try{var $routeSegmentProvider=$injector.get("$routeSegmentProvider");this.$get=function(){return{$routeSegmentProvider:$routeSegmentProvider}}}catch(ex){this.$get=function(){return{}}}}),HeadStylesheets.prototype={stylesheets:null,add:function(stylesheetHref,expires){function cleanup(){this.stylesheets.delete(hss),this._changed()}if(Array.isArray(stylesheetHref))return void stylesheetHref.forEach(function(href){this.add(href)}.bind(this));if(!expires)throw new Error("Stylesheets must have an expires promise so they can be cleaned up.");var hss=new HeadStylesheet(stylesheetHref);this.stylesheets.add(hss),expires instanceof this._$rootScope.constructor?expires.$on("$destroy",cleanup.bind(this)):expires.finally(cleanup.bind(this)),this._changed()},getHrefs:function(){function pluckHref(hss){return hss.href}return Array.from(this.stylesheets.map(pluckHref))},_changed:function(){this._changing||(this._changing=!0,this._$rootScope.$evalAsync(function(){this._changing=!1,this.changeSubscriptions.forEach(function(s){s.notify()})}.bind(this)))},onChanged:function(callback){var s=new Subscription(callback);return this.changeSubscriptions.add(s),function(){this.changeSubscriptions.delete(s)}.bind(this)}},module.service("headStylesheets",HeadStylesheets),module.directive("head",function($rootScope,$compile,loader,cssRouteSegment,$timeout,headStylesheets){var ROUTE_CHANGE_TIMEOUT=500,lastRoute=null,getUrls=function(route){lastRoute=route;var segments,routeSegments,segmentCSS,urls=[],result=[],$$route=route&&route.$$route;$$route&&$$route.css?urls=route.$$route.css:$$route&&$$route.segment&&(routeSegments=route.$$route.segment.split("."),segments=cssRouteSegment.$routeSegmentProvider.segments,segmentCSS=routeSegments.reduce(function(css,s){var segment=segments[s],scss=segment&&segment.params.css;return segments=segment&&segment.children||{},css.concat(scss||[])},[]),segmentCSS.length>0&&(urls=segmentCSS));var cache_path=loader.base_path("");return result=urls.concat(headStylesheets.getHrefs()).map(function(url){return url.startsWith("/")?url.startsWith(cache_path)?url:loader.base_path(url):loader.cache_path(url,null,route)}),Array.from(new Set(result))};return{restrict:"E",scope:!0,link:function(scope,element){function notIn(otherUrls){return function(url){return otherUrls.indexOf(url)===-1}}var lastUrls,timeout,unsubscribe,html='<link rel="stylesheet" type="text/css" ng-repeat="url in urls" ng-href="{{ url }}" />';element.append($compile(html)(scope)),unsubscribe=[$rootScope.$on("$routeChangeStart",function(event,next){var nextUrls=getUrls(next);lastUrls=lastUrls||scope.urls||[],scope.urls=lastUrls.filter(notIn(nextUrls)).concat(nextUrls),timeout=timeout||$timeout(function(){scope.urls=lastUrls,lastUrls=null,timeout=null},ROUTE_CHANGE_TIMEOUT)}),$rootScope.$on("$routeChangeSuccess",function(event,next){scope.urls=getUrls(next),$timeout.cancel(timeout),lastUrls=null,timeout=null}),headStylesheets.onChanged(function(){lastRoute&&(scope.urls=getUrls(lastRoute))})],scope.$on("$destroy",function(){unsubscribe.forEach(function(u){u()})})}}})}),define("ng/directives/ftnt",["angular","ng/ftnt","jquery","fweb","jquery.qtip","ng/services/cmdb","jquery.textarea"],function(angular,module,$,fweb){"use strict";var isArray=angular.isArray,ng_parse_params=function(validation_type,attr,scope){var supported={f_min_length:"fMinLength",f_max_length:"fMaxLength",f_length:"fLength"},directive=supported[validation_type]||validation_type;if(angular.isUndefined(directive))return[];var directive_val=scope.$eval(attr[directive]);if(angular.isUndefined(directive_val))return[];var num=parseInt(directive_val,10);return Number.isFinite(num)?[num]:[]},is_subnet0=function(ip){return 0===ip.indexOf("0")},validate_ipv4=function(value,required){var valid=fweb.util.patterns.commonRegExp.IP_HOST.test(value);return valid&&!(required&&is_subnet0(value))},validate_ipv6=function(value,required){var valid=fweb.util.patterns.commonRegExp.IP6_HOST.test(value),ip=goog.net.IpAddress.fromString(value),unspecified=ip&&6===ip.getVersion()&&0===ip.toInteger().toNumber();return valid&&!(required&&unspecified)},validationMessageMap=new Map;module.directive("fValidationMessage",function(lang,$timeout,fFieldConfig){function ValidationMessage(){this.errorTextValues={}}var DEBOUNCE_INTERVAL=250;return ValidationMessage.prototype={_blurForced:!1,forceMessageVisible:function(){this._blurForced=!0,this._refreshMsg({name:"validation-msg_show"})},setErrorTextValues:function(errorName,errorTextArray){this.errorTextValues[errorName]=errorTextArray},_refreshMsg:null},{restrict:"A",require:["?ngModel","?fValidationLink","fValidationMessage"],controller:ValidationMessage,compile:function(){function get_msg_elem(elem){var msg,field=elem.closest(".field, .inline-field, .validation-container");if(!field.length)throw new Error("Validated input not inside a proper field");return elem[0].id&&(msg=field.find('.validation-msg[for="'+elem[0].id+'"]')),msg&&msg.length||(msg=field.find(".validation-msg")),msg.length||(msg=angular.element("<label>").addClass("validation-msg error").css("display","none"),field.append(msg)),msg}return function(scope,elem,attr,ctrls){function debounceRefresh(value){function showLast(a,b){var u=fFieldConfig.messages.forceValidation;return(a===u?1:0)+(b===u?-1:0)}value&&!refreshing[value.name]&&(refreshing[value.name]=value,timeout=timeout||$timeout(function(){Object.keys(refreshing).sort(showLast).forEach(function(k){refreshMsg(refreshing[k])}),timeout=null,refreshing={}},DEBOUNCE_INTERVAL))}function refreshMsg(value){var force=!elem.is("input,select,textarea")||ctrl._blurForced;value&&value.name===fFieldConfig.messages.forceValidation&&ngModel.$setDirty();var show,msgs,links=fValidationLink&&fValidationLink.others()||[],linkShow=links.some(function(link){return link&&link.$dirty&&link.$invalid});show=ngModel.$dirty&&ngModel.$invalid&&(blurred||force),show&&ngModel.$error?(msgs=[],angular.forEach(ngModel.$error,function(val,key){if(val){var priority="required"===key,lang_err=scope.$eval(attr.fValidationMessage);if(angular.isObject(lang_err)&&(lang_err=lang_err[key]),void 0===lang_err&&(lang_err=fFieldConfig.errorTranslationMap[key]),lang_err){var fmt_params=ctrl.errorTextValues[key]||ng_parse_params(key,attr,scope);lang_err=lang(lang_err,fmt_params),msgs[priority?"unshift":"push"](lang_err)}}}),msg.text(msgs.length>0?msgs[0]:""),msg.css("display",msgs.length>0?"":"none")):linkShow||msg.css("display","none")}var ngModel=ctrls.shift(),fValidationLink=ctrls.shift(),ctrl=ctrls.shift(),blurred=!1,msg=get_msg_elem(elem);ctrl._refreshMsg=refreshMsg;var timeout,refreshing={};ngModel&&(elem.on("blur",function(){blurred=!0,refreshMsg()}),scope.$watch(function(){return scope.$eval(attr.fValidationMessage)},refreshMsg,!0),scope.$watch(function(){return ngModel.$error},refreshMsg,!0),scope.$on(fFieldConfig.messages.forceValidation,debounceRefresh),scope.$on("validation-msg_update",debounceRefresh),validationMessageMap.set(ngModel,ctrl),scope.$on("$destroy",function(){validationMessageMap.delete(ngModel)}))}}}}).directive("fValidationLink",function(){var recursing=!1;return{require:["ngModel","^form","fValidationLink"],priority:-1e3,controller:function(){},link:function(scope,elem,attr,ctrls){function parse(value){var others=ctrl.others();return recursing||(recursing=!0,scope.$evalAsync(function(){others.forEach(function(other){other.$validate();var unwatch=scope.$watch(function(){return other.$pending},function(value){if(!value&&(unwatch(),!other.$isEmpty(other.$viewValue)&&!other.$valid)){var msg=validationMessageMap.get(other);msg&&msg.forceMessageVisible()}})}),recursing=!1})),value}var ngModel=ctrls.shift(),ngForm=ctrls.shift(),ctrl=ctrls.shift();ctrl._ngModel=ngModel,ngModel.$parsers.push(parse),ctrl.others=function(){var others=attr.fValidationLink.split(",").map(function(otherName){return otherName.trim()});return others.map(function(name){return ngForm[name]}).filter(function(other){return other})}}}}).directive("fValidationWatch",function(){return{require:"ngModel",link:function(scope,elem,attr,ngModel){var remove_if=angular.noop,remove_watch=angular.noop;attr.$observe("fValidationWatch",function(value){function watch(enabled){remove_watch(),enabled&&(remove_watch=scope.$watch(watch_expr,do_watch))}function do_watch(v,oldV){if(v!==oldV){var vv=ngModel.$viewValue;ngModel.$setViewValue(null),ngModel.$setViewValue(vv)}}remove_if();var expressions=value.split(/\s+if\s+/),watch_expr=expressions.shift(),if_expr=expressions.shift();if_expr?remove_if=scope.$watch(if_expr,watch):(watch(!0),remove_if=angular.noop)})}}}),module.directive("fIsUnique",function($q,CMDB,$parse){return{restrict:"A",require:["ngModel","?fValidationMessage"],link:function(scope,elem,attr,ctrls){function updateConfig(newValue){function getCMDBProperties(paths){var cmdbs=[];return isArray(paths)||(paths=[paths]),angular.forEach(paths,function(config){if("string"==typeof config)expressions.push(config);else{if(!config||!config.path||!config.name)return;if(config.format&&config.format.indexOf("|")>=0&&!attr.uniqueComparator)throw new Error('If multiple properties are specified, a custom comparison expression ("unique-comparator") must also be specified');var defaults={format:"name",model:!1};config=angular.extend(defaults,config),cmdbs.push(new CMDB(config))}}),cmdbs}function createValueSet(objects){function getObjectProperty(obj){function addPropToItem(item,propName){return item[propName]=obj[propName],
item}var item;return item=obj.$cmdb.format.indexOf("|")>=0?obj.$cmdb.format.split("|").reduce(addPropToItem,{}):obj[obj.$cmdb.format],normalize(item)}var result=new Set(objects.map(getObjectProperty));return result.delete(void 0),result}if(!newValue)return void(cmdbPropsPromise=null);var normalizer,normalize,cmdbs;attr.itemNormalizer?(normalizer=$parse(attr.itemNormalizer),normalize=function(item){return normalizer(scope,{$item:item})}):normalize=function(value){return value},expressions=[],cmdbs=getCMDBProperties(newValue),cmdbPropsPromise=cmdbs.length?new CMDB.Union(cmdbs).fetch().$promise.then(createValueSet):$q.resolve(null)}function isUnique(value){function checkUnique(existingItems){function checkExpr(expr){return scope.$eval(expr,{$value:value})}var items,item,collision,valid;if(checkCollision&&existingItems){for(items=existingItems.values(),collision=!1;collision===!1&&!(item=items.next()).done;)collision=checkCollision(scope,{$value:normValue,$item:item.value});valid=!collision}else valid=!!existingItems&&!existingItems.has(value);return valid=valid||expressions.some(checkExpr),collision&&validationMsg&&validationMsg.setErrorTextValues("f_is_unique",[collision]),valid||$q.reject()}var checkCollision,normValue;return attr.uniqueComparator&&(checkCollision=$parse(attr.uniqueComparator)),normValue=attr.valueNormalizer?scope.$eval(attr.valueNormalizer,{$value:value}):value,cmdbPropsPromise?cmdbPropsPromise.then(checkUnique):$q.when(!0)}var expressions,cmdbPropsPromise,ngModel=ctrls.shift(),validationMsg=ctrls.shift();scope.$watch(attr.fIsUnique,updateConfig,!0),ngModel.$asyncValidators.f_is_unique=isUnique}}}).directive("fPasswordPolicy",function($resource,$http,$timeout,$q){return{restrict:"A",require:["ngModel","?fValidationMessage","?^^fField"],link:function(scope,elem,attr,controllers){function forceMessage(){fValidationMessage&&fValidationMessage.forceMessageVisible(),fField&&fField.showValidationMessages()}function passwordPolicyValidator(password){function check(){var data={mkey:mkey,apply_to:apply_to,password:password,old_password:old_password};return $http({method:"POST",url:url,data:data}).then(function(res){var results=res.data.results,resolution=!0;return results.valid||(results.reused?(ngModel.$setValidity("f_password_reused",!1),resolution=$q.resolve()):resolution=$q.reject(),forceMessage()),resolution})}var apply_to,mkey=scope.$eval(attr.adminName),policy=scope.$eval(attr.fPasswordPolicy),old_password=scope.$eval(attr.oldPassword)||"";if(ngModel.$setValidity("f_password_reused",!0),attr.fPasswordPolicy&&!policy)return $q.when(!0);apply_to=angular.isUndefined(policy)||accepted.indexOf(policy)===-1?"admin":policy;var skip_check=Object.keys(ngModel.$error).some(function(name){return"f_password_policy"!==name&&ngModel.$error[name]}),wait=0;return last_timeout&&(wait=DEBOUNCE,$timeout.cancel(last_timeout),last_timeout=$q.reject()),skip_check||(last_timeout=$timeout(check,wait)),last_timeout}var accepted=["ipsec","admin","guest-admin"],url="/api/v2/monitor/system/password-policy-conform/",DEBOUNCE=1e3,last_timeout=$q.reject(),ngModel=controllers.shift(),fValidationMessage=controllers.shift(),fField=controllers.shift();ngModel.$asyncValidators.f_password_policy=passwordPolicyValidator,scope.$watchGroup([attr.fPasswordPolicy,attr.oldPassword],function(){ngModel&&ngModel.$dirty&&ngModel.$validate()},!0)}}}).directive("fPasswordPolicyRequirements",function(lang,passwordPolicyService){return{restrict:"A",scope:{policy:"="},templateUrl:"/ng/admin/password/policy_list.html",link:function(scope,elem,attr){var accepted=["admin","guest-admin"],checkIntegerVal=function(val){return val>0},POLICY_MAP={"min-lower-case-letter":{type:Number,isValid:checkIntegerVal,langKey:"lower"},"min-non-alphanumeric":{type:Number,isValid:checkIntegerVal,langKey:"Special Characters"},"min-number":{type:Number,isValid:checkIntegerVal,langKey:"Numbers (0-9)"},"min-upper-case-letter":{type:Number,isValid:checkIntegerVal,langKey:"upper"},"minimum-length":{type:Number,isValid:checkIntegerVal,langKey:"min_len"},"change-4-characters":{type:Boolean,isValid:function(val){return"enable"===val},langKey:"Change 4 Characters"},"reuse-password":{type:Boolean,isValid:function(val){return"disable"===val},langKey:"Cannot reuse old passwords"}},getRequirements=function(obj){var helpText,attrValue,requirements=[],policy=obj.$$original;return policy&&"enable"===policy.status&&angular.forEach(POLICY_MAP,function(attributes,attrKey){attrValue=policy[attrKey],attrValue&&attributes.isValid(attrValue)&&(helpText={text:lang(attributes.langKey).toString(),requirement:attributes.type===Boolean?"":attrValue},requirements.push(helpText))}),requirements},getPolicy=function(policy){passwordPolicyService.getAllPolicies().then(function(){var key=accepted.indexOf(policy)===-1?"admin":policy,obj=passwordPolicyService.policies[key];obj.$promise.then(function(){obj["apply-to"]=obj["apply-to"].split(" "),scope.policy=obj,scope.policyRequirements=getRequirements(obj)})})};attr.$observe("fPasswordPolicyRequirements",function(val){getPolicy(val)})}}}).directive("fMinLength",function(){return{restrict:"A",require:["ngModel","?^^fField"],link:function(scope,elem,attr,requires){function minValidator(value){var min=parseInt(scope.$eval(attr.fMinLength),10),valid=!(angular.isNumber(min)&&!ngModel.$isEmpty(value)&&value.length<min),changed=valid!==ngModel.$valid;return ngModel.$setValidity("f_min_length",valid),!changed&&valid||(scope.$broadcast("validation-msg_update"),field&&field.setValidationData("f_min_length",min)),value}var ngModel=requires[0],field=requires[1];if(ngModel){ngModel.$parsers.push(minValidator),ngModel.$formatters.push(minValidator);var remove=angular.noop;attr.$observe("fMinLength",function(value){remove(),remove=scope.$watch(value,function(newValue,oldValue){newValue!==oldValue&&minValidator(ngModel.$viewValue)})})}}}}).directive("fMaxLength",function(){return{restrict:"A",require:["ngModel","?^^fField"],link:function(scope,elem,attr,requires){function maxValidator(value){var max=parseInt(scope.$eval(attr.fMaxLength),10),valid=!(angular.isNumber(max)&&!ngModel.$isEmpty(value)&&value.length>max),changed=valid!==ngModel.$valid;return ngModel.$setValidity("f_max_length",valid),!changed&&valid||(scope.$broadcast("validation-msg_update"),field&&field.setValidationData("f_max_length",max)),value}var ngModel=requires[0],field=requires[1];if(ngModel){ngModel.$parsers.push(maxValidator),ngModel.$formatters.push(maxValidator);var remove=angular.noop;attr.$observe("fMaxLength",function(value){remove(),remove=scope.$watch(value,function(newValue,oldValue){newValue!==oldValue&&maxValidator(ngModel.$viewValue)})})}}}}).directive("fLength",function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attr,ngModel){ngModel.$validators.length=function(value){var length=parseInt(scope.$eval(attr.fLength),10),valid=!(angular.isNumber(length)&&!ngModel.$isEmpty(value)&&value.length!==length);return ngModel.$setValidity("f_length",valid),valid}}}}).directive("fOneRequiredGroup",function(){return{restrict:"A",controller:function(){this.models=Object.create(null),this.addModel=function(id,model){this.models[id]=model},this.removeModel=function(id){delete this.models[id]},this.isOneDirty=function(){return Object.keys(this.models).some(function(m){return this.models[m].$dirty}.bind(this))},this.isValid=function(){return Object.keys(this.models).some(function(m){return!!this.models[m].$viewValue}.bind(this))}}}}).directive("fOneRequired",function(){return{restrict:"A",require:["ngModel","^fOneRequiredGroup"],scope:{},link:function(scope,elem,attr,ctrls){function validate(value){return ngModel.$setValidity("f_one_required",groupController.isValid()),groupController.isOneDirty()?(ngModel.$setDirty(),ngModel.$options&&ngModel.$options.allowInvalid?value:groupController.isValid()?value:void 0):value}var groupController=ctrls[1],ngModel=ctrls[0];groupController.addModel(scope.$id,ngModel),scope.$on("$destroy",function(){groupController.removeModel(scope.$id)}),scope.$watch(groupController.isValid.bind(groupController),function(){validate(ngModel.$viewValue)})}}}).directive("fIsEmpty",function($parse){return{restrict:"A",require:"ngModel",link:function(scope,elem,attr,ngModel){var oldEmpty=ngModel.$isEmpty;ngModel.$isEmpty=function(value){return value=0===arguments.length?ngModel.$viewValue:value,oldEmpty(value)||$parse(attr.fIsEmpty)(scope,{$value:value})}}}}).directive("fIpmask",function(){return{restrict:"A",require:"ngModel",scope:"=ngModel",link:function(scope,elem,attr,ngModel){return scope.$watch(function(){var cond=attr.fIpmask||"true";if(scope.$eval(cond))return ngModel.$modelValue},function(value){if(ngModel.$isEmpty(value))ngModel.$setValidity("f_ipmask",!0);else{var valid=fweb.util.patterns.commonRegExp.IP_MASK.test(value);ngModel.$setValidity("f_ipmask",valid)}})}}}).directive("fMacAddress",function(){return{restrict:"A",require:"ngModel",scope:"=ngModel",link:function(scope,elem,attr,ngModel){ngModel.$validators.f_mac_address=function(value){var cond=attr.fMacAddress||"true";return scope.$eval(cond)?fweb.util.patterns.commonRegExp.MAC_ADDRESS.test(value):value}}}}).directive("fIpv4Address",function(){return{restrict:"A",require:"ngModel",scope:"=ngModel",link:function(scope,elem,attr,ngModel){ngModel.$validators.f_ipv4_address=function(value){var cond=attr.fIpv4Address||"true";return scope.$eval(cond)?validate_ipv4(value,attr.required):value},ngModel.$parsers.push(function(value){return!attr.required&&ngModel.$isEmpty(value)?"0.0.0.0":value})}}}).directive("fIpv6Address",function(){return{restrict:"A",require:"ngModel",scope:"=ngModel",link:function(scope,elem,attr,ngModel){ngModel.$validators.f_ipv6_address=function(value){var cond=attr.fIpv6Address||"true";return scope.$eval(cond)?validate_ipv6(value,attr.required):value},ngModel.$parsers.push(function(value){return!attr.required&&ngModel.$isEmpty(value)?"::":value})}}}).directive("fIpv46Address",function(){return{restrict:"A",require:"ngModel",scope:"=ngModel",link:function(scope,elem,attr,ngModel){ngModel.$validators.f_ipv46_address=function(value){var cond=attr.fIpv46Address||"true";return scope.$eval(cond)?validate_ipv4(value,attr.required)||validate_ipv6(value,attr.required):value},ngModel.$parsers.push(function(value){return!attr.required&&ngModel.$isEmpty(value)?"0.0.0.0":value})}}}).directive("fCombinedField",function($parse,FOSError){return{restrict:"A",require:"ngModel",scope:"=ngModel",link:function(scope,elem,attr,ngModel){function get_params(value){var result=value||scope.$eval(attr.fCombinedField);return result&&{fields:result[0],parsed:result[0].map(function(field){return $parse(field)}),type:result[1]||"",separator:result[2]||"-"}}function part_test(type){return function(part,idx,array){if(type instanceof RegExp)return type.test(part);if(angular.isFunction(type))return type(part);if("address_range"===type){var validIpAddress=function(address){return fweb.util.patterns.commonRegExp.IP_HOST.test(address)},ipAddressAsInteger=function(address){return validIpAddress(address)?goog.net.IpAddress.fromString(address).toInteger().toNumber():0};return validIpAddress(part)&&!is_subnet0(part)&&ipAddressAsInteger(array[0])<=ipAddressAsInteger(array[1])}if(type)throw new FOSError("Unable to test f-combined-field type "+type);return!0}}function parse(text){var params=get_params();if(!params)return text;var parts=(text||"").split(params.separator),valid=!params.type;if(parts.length===params.fields.length){var pt=part_test(params.type);valid=parts.every(pt),valid&&parts.forEach(function(part,i){params.parsed[i].assign(scope,part)})}return ngModel.$setValidity("f_combined_field",valid),valid?text:void 0}function format(text){var params=get_params();if(!params)return text;var fields=params.parsed.map(function(parsed){return parsed(scope)});params.type&&(fields=fields.map(function(field){return field||"0.0.0.0"}));var valid=!params.type;if(2===fields.length&&params.fields.length){var ft=part_test(params.type);valid=fields.every(ft)}return ngModel.$setValidity("f_combined_field",valid),fields.join(params.separator)}var remove=angular.noop;scope.$watch(attr.fCombinedField,function(newVal,oldVal){if(newVal===oldVal&&(ngModel.$parsers.push(parse),ngModel.$formatters.push(format)),!newVal)return void ngModel.$setValidity("f_combined_field",!0);oldVal||format(ngModel.$modelValue),remove();var params=get_params(newVal);params&&(remove=scope.$watch("["+params.fields.join(",")+"]",function(values){var value=values.join(params.separator),ngModel=$parse(attr.ngModel);angular.toJson(value)!==angular.toJson(ngModel(scope))&&ngModel.assign(scope,value)},!0))},!0)}}}).directive("fCombined",function($parse,FOSError){var DEFAULT_SEPARATOR="-";return{restrict:"A",require:"ngModel",scope:"=ngModel",link:function(scope,elem,attr,ngModel){function parse(text){return text?text.split(attr.separator||DEFAULT_SEPARATOR):[]}function format(values){if(Array.isArray(values))return values.join(attr.separator||DEFAULT_SEPARATOR)}function validateOn(value,expr){var result=$parse(expr)(scope,{$value:value});return result instanceof RegExp?result.test(value):!!expr}var quora={all:function(parts,expr){return parts.every(function(p){return validateOn(p,expr)})},allOrNone:function(parts,expr){var matches=parts.reduce(function(count,p){return count+(validateOn(p,expr)?1:0)},0);return 0===matches||matches===parts.length},order:function(parts,exprSource){var expr=$parse(exprSource)(scope);if(!angular.isFunction(expr))throw new FOSError("Expression is not a function.");return parts.every(function(p,ndx,arr){return 0===ndx||expr(arr[ndx-1],p)})}};ngModel.$parsers.push(parse),ngModel.$formatters.push(format),ngModel.$validators.cardinality=function(parts){if(!Array.isArray(parts))return!1;var expr=$parse(attr.fCombined||"2")(scope),c=parts.length;return!c||c===expr};var quoraNames=Object.getOwnPropertyNames(quora);quoraNames.forEach(function(q){var attrName="valid"+q[0].toUpperCase()+q.slice(1),exprSource=attr[attrName];exprSource&&(ngModel.$validators[q]=function(parts){return!!Array.isArray(parts)&&quora[q](parts,exprSource)})})}}}).directive("fWith",function(){return{scope:!0,link:function(scope,elem,attr){var exprs=attr.fWith.split(/\s*;\s*/).map(function(expr){return expr.split(/\s+as\s+/)});if(exprs.some(function(expr){return 2!==expr.length}))throw new Error('f-with directive requires an expression like "_expression_ as _alias_[;_expression_ as _alias_;...]"');exprs.forEach(function(expr){scope.$watch(expr[0],function(value){scope[expr[1]]=value},!0)})}}}).directive("fCompile",function($compile){return function(scope,element,attrs){scope.$watch(function(){return scope.$eval(attrs.fCompile)},function(html){html&&(element.html(html),$compile(element.contents())(scope))})}}).directive("fTextarea",function(){return{require:"ngModel",scope:!1,link:function(scope,elem,attr,ngModel){function parseMaxLength(){return scope.$eval(attr.fMaxLength)}function makeTextArea(maxLength){void 0!==maxLength&&(textOptions={maxLength:maxLength},elem.textarea(textOptions))}function resetTextArea(){function reinitTextArea(){elem.height(0),elem.textarea()}scope.$$postDigest(reinitTextArea)}var textOptions;elem.addClass("f-textarea"),scope.$watch(parseMaxLength,makeTextArea),scope.$on("textarea_reset",resetTextArea);var render=ngModel.$render;ngModel.$render=function(){var result=render.apply(this,arguments);return elem.textarea(textOptions),result}}}}).directive("fScrolling",function($window,$document,$rootScope,$timeout){function scrolling(){var doc=$document[0];return $window.innerHeight?doc.body.offsetHeight>$window.innerHeight:doc.documentElement.scrollHeight>doc.documentElement.offsetHeight||doc.body.scrollHeight>doc.body.offsetHeight}return{scope:!1,link:function(scope,elem){function update(){return $timeout.cancel(timeout),timeout=$timeout(function(){elem.toggleClass("f-scrolling",scrolling())},DEBOUNCE_INTERVAL,!1),!0}var timeout,DEBOUNCE_INTERVAL=100;angular.element($window).bind("resize",update),$rootScope.$watch(update)}}}).directive("fPattern",function(){return{scope:!1,require:"ngModel",link:function(scope,elem,attr,ngModel){function fPatternValidator(value){var pattern=scope.$eval(attr.fPattern);return!pattern||ngModel.$isEmpty(value)||pattern.test(value)?ngModel.$setValidity("f_pattern",!0):(ngModel.$setValidity("f_pattern",!1),value=void 0),value}scope.$watch(attr.fPattern,function(){fPatternValidator(ngModel.$viewValue)}),ngModel.$formatters.push(fPatternValidator),ngModel.$parsers.push(fPatternValidator)}}}).directive("fValueConfirm",function(){return{require:["ngModel","?fValidationMessage","?^^fField"],link:function(scope,elem,attr,controllers){function forceMessage(){fValidationMessage&&fValidationMessage.forceMessageVisible(),fField&&fField.showValidationMessages()}function update(newVal,oldVal){ngModel&&(ngModel.$dirty||newVal!==oldVal)&&(otherValue=newVal,ngModel.$validate())}var otherValue,unwatch=angular.noop;attr.$observe("fValueConfirm",function(expr){unwatch(),unwatch=scope.$watch(expr,update)}.bind(this));var ngModel=controllers.shift(),fValidationMessage=controllers.shift(),fField=controllers.shift();ngModel.$validators.f_value_confirm=function(value){var isValid=void 0===otherValue||value===otherValue;return!isValid&&value&&forceMessage(),isValid}}}}).directive("fUiRefresh",function($timeout,uiJqConfig){return{scope:!1,compile:function(tElem,tAttrs){var options=uiJqConfig&&uiJqConfig[tAttrs.uiJq];return function(scope,elem,attr){scope.$watch(attr.fUiRefresh,function(){$timeout(function(){elem.is(":ui-"+attr.uiJq)&&elem[attr.uiJq]("destroy");var linkOptions=scope.$eval(attr.uiOptions);linkOptions=angular.extend({},options,linkOptions),elem[attr.uiJq](linkOptions)})})}}}}).directive("fQtip",function($window){var allTips=[];return{template:'<div class="f-qtip" ng-transclude></div>',transclude:!0,scope:{show:"&fQtip",immediate:"&",options:"&",position:"&",reposition:"&",promise:"&",repositionTarget:"&"},require:"?^fQtipTarget",link:function($scope,$element,$attrs,fQtipTarget,$transclude){function init_tip(show){return show&&(show=angular.extend(options.show||{},{ready:!0})),$element.qtip(angular.extend({content:{text:""}},options,show||{})),$element.qtip("api")}$scope.visible=!1;var options=angular.copy($scope.options()||{}),position=$scope.position();position?options.position=position:options.position||(options.position={my:"bottom left",at:"top right",target:"mouse",viewport:$($window),adjust:{x:10}});var classes=options.style&&options.style.classes?[options.style.classes]:[];options.style=angular.extend(options.style||{},{classes:["f-qtip"].concat(classes).join(" ")}),fQtipTarget&&(options.position=angular.extend({target:fQtipTarget.elem},options.position),options.show=angular.extend({target:fQtipTarget.elem},options.show),options.hide=angular.extend({target:fQtipTarget.elem},options.hide)),options.hide&&"string"==typeof options.hide.target&&(options.hide.target=$(options.hide.target)),options.position&&"window"===options.position.viewport&&(options.position.viewport=$($window)),options.position&&angular.isFunction(options.position.container)&&(options.position.container=options.position.container());var tip=init_tip();allTips.push(tip),$attrs.title&&tip.set("content.text",$attrs.title),$element.children().addClass("hidden"),$transclude(function(clone){function repositionAll(){allTips.forEach(function(tip){tip.reposition()})}function doShowHide(elem,phase){if(!phase||"close"===phase){var show=$scope.show(),showEvent=options.show&&options.show.event||$.fn.qtip.defaults.show.event;tip.set("show.event",show?showEvent:""),show&&!$scope.immediate()||tip.toggle(show)}phase&&repositionAll()}function getText(){var promise=$scope.promise();if(promise){var deferred=$.Deferred();return promise.then(function(){$scope.$evalAsync(function(){deferred.resolve(clone),tip.reposition(null,!1)})}),deferred.promise()}return clone}if(clone.is("*")){fQtipTarget&&fQtipTarget.elem[0]!==$element[0]&&$element.addClass("hidden"),tip.set("content.text",$scope.promise()?getText:clone),options.content={text:getText};var $animating;$scope.$watch("show()",function(show){void 0!==show&&$scope.$evalAsync(function(){function showHideAfterAnimation($animatingParents){return!(!$animatingParents||!$animatingParents.length)}var updated=!1;!showHideAfterAnimation($animating,"off")&&show||(doShowHide(),updated=!0),$animating=$element.parents("[data-ng-animate]"),showHideAfterAnimation($animating,"on")||updated||doShowHide()})});var reposition=$scope.$evalAsync.bind($scope,function(){var repositionTarget=$scope.repositionTarget();if(repositionTarget){var position=tip.get("position");position.target=repositionTarget,tip.set("position",position)}tip.reposition()});$scope.$watch("reposition()",reposition),$scope.$watch("promise()",function(p,oldp){(p!==oldp||oldp)&&tip.set("content.text",p?getText:clone)})}}),$scope.$on("$destroy",function(){var index=allTips.indexOf(tip);allTips.splice(index,1),tip.destroy()}),$scope.$on("qtip_hide",function(){tip.hide()})}}}).directive("fQtipTarget",function(){return{controller:function($scope,$element){this.elem=$element,$scope.$on("$destroy",function(){this.elem=null}.bind(this))}}}).directive("fInclude",function($http,$templateCache,$compile){return{restrict:"E",link:function(scope,element,attrs){var templateUrl=scope.$eval(attrs.template);$http.get(templateUrl,{cache:$templateCache}).success(function(content){element.replaceWith($compile(content)(scope))})}}}).directive("fIncludeCloak",function(){return{link:function(scope,element){function cloak(){element.toggleClass("f-include-cloak",Object.keys(loadings).length>0)}var loadings={};scope.$on("$includeContentRequested",function(event){var scopeId=event.targetScope.$id;loadings[scopeId]=event.targetScope.$on("$destroy",function(){delete loadings[scopeId],cloak()}),cloak()}),scope.$on("$includeContentLoaded",function(event){var scopeId=event.targetScope.$parent.$id;loadings[scopeId]&&(loadings[scopeId](),delete loadings[scopeId],cloak())})}}}).directive("fValueIfEmpty",function(){return{scope:{fValueIfEmpty:"@"},restrict:"A",require:"ngModel",link:function(scope,elm,attrs,ctrl){ctrl.$parsers.push(function(viewValue){return""===viewValue?scope.fValueIfEmpty:viewValue})}}})}),define("ng/directives/f-equal-width",["ng/ftnt"],function(ngModule){"use strict";function EqualWidth(){this._items={},this.minWidth=0}function EqualWidthItem($scope,$element){var element=$element[0];$scope.$watch(function(){var width,currentMinWidth=element.style.minWidth;return element.style.minWidth=0,width=element.offsetWidth,element.style.minWidth=currentMinWidth,width},function(width){this.equalWidthController.updateItem($scope.$id,width)}.bind(this)),$scope.$watch(function(){return this.equalWidthController.minWidth}.bind(this),function(calculatedMinWidth){$element[0].style.minWidth=calculatedMinWidth+"px"}),$scope.$on("$destroy",function(){this.equalWidthController.removeItem($scope.$id)}.bind(this))}EqualWidth.prototype._calculate=function(){var minWidth=0;Object.keys(this._items).forEach(function(key){var width=this._items[key];width>minWidth&&(minWidth=width)}.bind(this)),this.minWidth=minWidth},EqualWidth.prototype.updateItem=function(itemID,width){this._items[itemID]=width,this._calculate()},EqualWidth.prototype.removeItem=function(itemID){var itemWidth=this._items[itemID];delete this._items[itemID],itemWidth===this.minWidth&&this._calculate()},ngModule.directive("fEqualWidth",function(){return{restrict:"A",controller:EqualWidth}}),ngModule.directive("fEqualWidthItem",function(){return{restrict:"A",controller:EqualWidthItem,bindToController:!0,require:{equalWidthController:"^fEqualWidth"}}})}),define("ng/directives/f-file-select",["angular"],function(angular){"use strict";function fFileSelect($window,loader){return{restrict:"A",require:"ngModel",scope:!0,templateUrl:loader.base_path("/ng/directives/f-file-select.html"),link:function(scope,element,attrs,ngModel){var file,fileInputEl=element.find('input[type="file"]'),reader=new FileReader,fileModel=null,bufTobase64=function(buf){var i,uint8Buf=new Uint8Array(buf),chars=[];for(i=0;i<uint8Buf.length;i++)chars.push(String.fromCharCode(uint8Buf[i]));return $window.btoa(chars.join(""))},setFileLoading=function(loadingBool){scope.$apply(function(){scope.loading=loadingBool,scope.$emit("fileLoading",scope.loading)})},updateFileModel=function(){var fileModelCopy=angular.extend({},fileModel);ngModel.$setViewValue(fileModelCopy)};scope.$watch(function(){return ngModel.$modelValue},function(value){value&&value.filename&&value.file_content&&(scope.filename=value.filename)}),reader.onloadstart=function(){fileModel=null,updateFileModel(),scope.filename=file.name,setFileLoading(!0)},reader.onerror=function(){delete scope.filename},reader.onloadend=function(){setFileLoading(!1)},reader.onload=function(e){var filebuf=e.target.result,fileBase64=bufTobase64(filebuf);fileModel={filename:file.name,file_content:fileBase64},updateFileModel()},fileInputEl.on("change",function(selected){file=selected.target.files[0],reader.readAsArrayBuffer(file)}),element.on("dragover","label",function(e){e.preventDefault()}),element.on("drop","label",function(e){e.preventDefault(),file=e.originalEvent.dataTransfer.files[0],reader.readAsArrayBuffer(file)})}}}return function(providers){providers.$compile.directive("fFileSelect",fFileSelect)}}),define("ng/directives/f-object-formatted",["ng/ftnt","fweb"],function(module,fweb){"use strict";module.component("fObjectFormatted",{bindings:{mkey:"@",datasource:"@",csfPath:"@"},controller:function($scope,$element){var tooltip,element=$element[0];element.style.display="inline-block",fweb.util.dom.formatObject({element:element,mkey:this.mkey,datasource:this.datasource,csfPath:this.csfPath}),tooltip=fweb.util.dom.setupObjectTooltip({element:element,mkey:this.mkey,datasource:this.datasource,csfPath:this.csfPath,manualCleanup:!0}),$scope.$on("$destroy",function(){tooltip&&tooltip.destroy()})}})}),define("ng/directives/f-object-tooltip",["ng/ftnt","fweb"],function(module,fweb){"use strict";module.directive("fObjectTooltip",function(){return{restrict:"A",scope:{mkey:"@",datasource:"@",csfPath:"@"},bindToController:!0,controllerAs:"$ctrl",controller:function($scope,$element){var tooltip,element=$element[0];element.style.display="inline-block",tooltip=fweb.util.dom.setupObjectTooltip({element:element,mkey:this.mkey,datasource:this.datasource,csfPath:this.csfPath,manualCleanup:!0}),$scope.$on("$destroy",function(){tooltip&&tooltip.destroy()})}}})}),define("ng/directives/f-system-power",["module","ng/ftnt","ng/services/injector"],function(module,ngModule,inject){"use strict";function SystemPower(injector){injector.injectMarked(this),this.hideTitle=!0,this.forwardUrl="/prompt/"+this.powerType}SystemPower.prototype={submit:inject.mark(function($http,$location){return function(){$http.post("/api/v2/monitor/system/os/"+this.powerType,{event_log_message:this.logMsg||""}),$location.path(this.forwardUrl).search({viewOnly:1})}})},ngModule.component("fSystemPower",{controller:SystemPower,templateUrl:function(loader){return loader.base_path("f-system-power.html",module)},bindings:{powerType:"<type"}})}),define("ng/directives/f-time-format",["ng/ftnt","fweb.util/datetime"],function(ngModule,datetime){"use strict";function timeFormat(scope,$element,attr,ngModel){var format=attr["f-time-format"];ngModel&&ngModel.$formatters.unshift(function(){var time=ngModel.$modelValue;return time&&datetime.formatTime(time,format||(time.getSeconds()?"HH:mm:ss":"HH:mm"))})}ngModule.directive("fTimeFormat",function(){return{restrict:"A",require:"?ngModel",link:timeFormat}})}),define("ng/directives/f-wan-ip-blacklist-info",["module","ng/ftnt"],function(module,ngModule){"use strict";function WANIPBlacklist(state){this.state=state}ngModule.component("fWanIpBlacklistInfo",{templateUrl:function(loader){return loader.base_path("f-wan-ip-blacklist-info.html",module)},controller:WANIPBlacklist,bindings:{wanIp:"<",blacklistEntries:"<"}})}),define("ng/directives/f-csf-tree",["module","ng/ftnt","ng/services/injector","fweb.util/tree"],function(module,ngModule,inject,utilTree){"use strict";function CsfTree(injector){injector.injectMarked(this),this.init()}CsfTree.prototype={init:inject.mark(function(state,csfTopology){return function(){var isTruncated=!!this.path;csfTopology.buildIfNecessary().then(function(){var upstreamSerial=csfTopology.upstreamSerial;if(this.treeNodes=[],upstreamSerial&&this.treeNodes.push({serial:upstreamSerial,ipAddress:state.csf_upstream_ip}),isTruncated){var truncatedNodes=utilTree.genTruncatedTopologyTreeNodes(csfTopology.fortigateMapping,this.path,this.deviceEntry,csfTopology.csfEnabled&&csfTopology.isRootFortigate);truncatedNodes&&truncatedNodes.length&&(upstreamSerial&&(truncatedNodes[0].parentSerial=upstreamSerial),this.treeNodes=this.treeNodes.concat(truncatedNodes))}else{var fullNodes=csfTopology.fortigates.map(function(fgt){return{serial:fgt.serial,parentSerial:fgt.isCurrent?upstreamSerial:fgt.parentSerial,isRoot:csfTopology.csfEnabled&&fgt.isRoot(),isCurrent:fgt.isCurrent}});this.treeNodes=this.treeNodes.concat(fullNodes)}}.bind(this))}})},ngModule.component("fCsfTree",{controller:CsfTree,templateUrl:function(loader){return loader.base_path("f-csf-tree.html",module)},bindings:{path:"<",deviceEntry:"<"}})}),define("ng/directives/menu/menu_items",["angular","ng/ftnt","ng/services/loader","jquery","fweb","notify","fweb.cmdbClone","jquery.util_core","ng/services/cmdb"],function(angular,module,loader,$,fweb,Notify,cmdbClone){"use strict";var templatePath=loader.base_path("/ng/directives/menu/partials/"),getEntryMkey=function(entry){return entry.q_origin_key||entry.mkey||entry.name||entry.id};module.directive("fMenuItemCreate",["$location",function($location){return{restrict:"A",templateUrl:templatePath+"create_new.html",scope:{createFn:"=",isAdd:"=",enabled:"&"},require:["?^fPopUpMenu","?^fMenuBar"],link:function(scope,element,attrs,controllers){element.addClass("menu-item"),scope.menu=controllers[0]||controllers[1],scope.$watch("enabled()",function(value){void 0!==value&&(scope._enabled=value)}),scope.$watch("createFn",function(createFn){scope.createNew=createFn||function(){var search,path=$location.path();path?(search=$location.search(),$location.path(fweb.util.location.join_with_mkey([path,"edit"]),search)):(path=window.location.pathname,search=window.location.search,window.location.href=fweb.util.location.join_with_mkey([path,"edit"],null,!0)+search)}})}}}]),module.directive("fMenuItemEdit",["$location",function($location){return{restrict:"A",scope:{action:"&",editFn:"=",enabled:"&",viewOnly:"&"},templateUrl:templatePath+"edit.html",require:["?^fPopUpMenu","?^fMenuBar"],link:function(scope,element,attrs,controllers){element.addClass("menu-item");var menu=controllers[0]||controllers[1];scope.edit=function(){if(attrs.action)return void scope.action({$menu:menu,$menuItem:this});if(scope.editFn)return void scope.editFn.call(this,menu);var search,path=$location.path(),mkey=getEntryMkey(menu.lastSelectedEntry)+"";path?(search=$location.search(),$location.path(fweb.util.location.join_with_mkey([path,"edit"],mkey),search)):(path=window.location.pathname,search=window.location.search,window.location.href=fweb.util.location.join_with_mkey([path,"edit"],mkey,!0))},scope.$watch(function(){return menu.entries},function(entries){var enabled=scope.enabled({$entries:entries});null!=enabled?scope._enabled=enabled:scope._enabled=entries&&1===entries.length||null!=attrs.editableSections&&menu.$sectionRow,scope._viewOnly=scope.viewOnly({$entries:entries})}),menu.menuBar&&(menu.qlistDoubleClickHandler=function(){scope._enabled&&scope.edit.apply(scope,arguments)})}}}]),module.directive("fMenuItemEditCli",function(){return{restrict:"A",scope:{action:"&",editCliFn:"=",enabled:"&"},templateUrl:templatePath+"editcli.html",require:["?^fPopUpMenu","?^fMenuBar"],link:function(scope,element,attrs,controllers){
element.addClass("menu-item mini-hide");var menu=controllers[0]||controllers[1];scope.menu=menu,scope.editCli=function(){if(attrs.action)return void scope.action({$menu:menu,$menuItem:this});if(scope.editCliFn)return void scope.editCliFn.call(this,menu);var entry=menu.lastSelectedEntry;fweb.util.structure.openCli(entry)},scope.$watch(function(){return menu.entries},function(entries){var enabled=scope.enabled({$entries:entries});if(null!=enabled)scope._enabled=enabled;else{var entry=menu.lastSelectedEntry;scope._enabled=entries&&1===entries.length&&void 0!==entry.q_type}})}}}),module.directive("fMenuItemDelete",function($q,$route,lang,CMDB,state){return{restrict:"A",scope:{action:"&",deleteFn:"=",deleteEntriesFn:"=",canDelete:"&",canDeleteFn:"=",enabled:"&",beforeDelete:"&",afterDelete:"&",transitionAfterDelete:"&",labelKey:"@",entriesLabelKey:"@"},require:["?^fPopUpMenu","?^fMenuBar"],templateUrl:templatePath+"delete.html",link:function(scope,element,attrs,controllers){element.addClass("menu-item");var menu=controllers[0]||controllers[1],canDelete=function(entry){var value=!1;return attrs.canDelete?value=scope.canDelete({$menu:menu,$entry:entry,$menuItem:this}):scope.canDeleteFn?value=scope.canDeleteFn.call(this,entry):entry&&(value=null==entry.can_delete?!entry.q_static&&!entry.implicit&&!entry.q_ref:entry.can_delete),value};scope.delete=function(){if(scope.deleteFn)return void scope.deleteFn.call(this,menu);var deleteMessage,canDeleteCount=0,toDeleteEntries=[],total=menu.entries.length,entriesLabel=lang(scope.entriesLabelKey||"elements");menu.entries.forEach(function(entry){canDelete(entry)&&(canDeleteCount++,toDeleteEntries.push(entry))}),deleteMessage=canDeleteCount===total?lang("selected_delete_confirm",[entriesLabel]):lang("selected_delete_confirm_subset",[entriesLabel,canDeleteCount,total]),fweb.util.slide.confirm(deleteMessage.toString()).then(function(){$q.when(scope.beforeDelete()).then(function(){function flatten(result,arr){return result.concat(arr)}if(attrs.action)return void scope.action({$menu:menu,$menuItem:this});if(scope.deleteEntriesFn)return void scope.deleteEntriesFn.call(this,toDeleteEntries,menu);var promises,typeMap={};toDeleteEntries.forEach(function(entry){var mkey=getEntryMkey(entry),type=entry.q_type;if(void 0===type||null===type)throw new Error("Entry doesn't have a q type");typeMap[type]?typeMap[type].push(mkey):typeMap[type]=[mkey]}),promises=Object.keys(typeMap).map(function(type){var pathName=state.getPathNameByType(type),path=fweb.util.formatters.path_name_format(pathName),cmdb=new CMDB(path.path,path.name);return typeMap[type].map(function(mkey){return cmdb.del(mkey).$promise})}).reduce(flatten,[]),$q.all(promises).then(function(results){var i,result;for(i=0;i<results.length;i++)if(result=results[i],result.error)return void Notify.post(lang(result.error).toString(),"error");$q.when(scope.afterDelete()).then(function(){scope.transitionAfterDelete(),window===top?$route.reload():window.location.reload()})})}.bind(this),CMDB.notifyFailure)}.bind(this))},scope.$watch(function(){return menu.entries},function(entries){var enabled=scope.enabled({$entries:entries});if(null!=enabled)scope._enabled=enabled;else{var numRows=entries?entries.length:0;scope._enabled=numRows&&entries.some(canDelete)}})}}}),module.directive("fMenuItemClone",function($route){return{restrict:"A",scope:{action:"&",cloneFn:"=",enabled:"&"},require:["?^fPopUpMenu","?^fMenuBar"],templateUrl:templatePath+"clone.html",link:function(scope,element,attrs,controllers){element.addClass("menu-item");var menu=controllers[0]||controllers[1];scope.$watch(function(){return menu.entries},function(entries){var enabled=scope.enabled({$entries:entries});null!=enabled?scope._enabled=enabled:scope._enabled=entries&&1===entries.length}),scope.clone=function(){if(attrs.action)return void scope.action({$menu:menu,$menuItem:this});if(scope.cloneFn)return void scope.cloneFn.call(this,menu);var entry=menu.lastSelectedEntry;cmdbClone({mkey:getEntryMkey(entry),mkey_type:entry.q_mkey_type,qType:entry.q_type}).then(function(){window===top?$route.reload():window.location.reload()})}}}}),module.directive("fMenuItemExpandAll",function(){return{restrict:"A",templateUrl:templatePath+"expand_all.html",scope:{collapse:"=",action:"&",expandCollapseFn:"="},require:["?^fPopUpMenu","?^fMenuBar"],link:function(scope,element,attrs,controllers){element.addClass("menu-item"),scope.menu=controllers[0]||controllers[1],scope.expandCollapse=function(){if(attrs.action)return void scope.action({$menu:scope.menu,$menuItem:this});if(scope.expandCollapseFn)return void scope.expandCollapseFn.call(this,scope.menu);var rowSelector;if(scope.menu.$categoryRow)rowSelector=".qlist_category";else{if(!scope.menu.$sectionRow)return;rowSelector=".qlist_section"}var selector=rowSelector+" label button.compact-visual-toggle";selector+=scope.collapse?".active":":not(.active)";var buttons=scope.menu.$qlist.find(selector);buttons.click()}}}}),module.directive("fMenuItemDefaults",function(){return{restrict:"A",templateUrl:templatePath+"defaults.html",link:function(scope,element){element.addClass("menu-item-group")}}}),module.directive("fMenuItemQlistSearch",function($q){return{restrict:"A",templateUrl:templatePath+"search.html",scope:{beforeSearch:"="},require:["?^fPopUpMenu","?^fMenuBar"],link:function(scope,element,attrs,controllers){var beforeSearchPromise,lastSearch,menu=controllers[0]||controllers[1];element.addClass("menu-item").addClass("menu-item-search"),scope.miniHideInput=!0,scope.searchValue=lastSearch="",scope.search=function(){var promise;if(!menu.$qlist)throw new Error("Menu doesn't contain a jQuery qlist object");scope.miniHideInput=!1,scope.searchValue!==lastSearch&&(promise=beforeSearchPromise?beforeSearchPromise.then(function(){return $q.when(menu.$qlist.qlist("search",scope.searchValue))}):$q.when(menu.$qlist.qlist("search",scope.searchValue)),scope.searching=!0,lastSearch=scope.searchValue,promise.finally(function(){scope.searching=!1}))},scope.clearSearch=function(){scope.searchValue="",scope.search()},scope.searchFocussed=function(){scope.beforeSearch&&"function"==typeof scope.beforeSearch&&(beforeSearchPromise=$q.when(scope.beforeSearch()))},angular.element(element).find("input.search-input").on("keydown",function(event){27===event.keyCode&&(event.preventDefault(),scope.$apply(function(){scope.clearSearch()})),13===event.keyCode&&(event.preventDefault(),scope.search())}).on("blur",function(){scope.$apply(function(){scope.search()})})}}})}),define("ng/directives/registration/f-registration",["ng/ftnt","ng/services/injector","angular","fweb"],function(ngFtnt,inject,angular,fweb){"use strict";function Registration($scope,injector){injector.injectMarked(this,{$scope:$scope}),this._setup()}function RegistrationForticare($scope,injector){injector.injectMarked(this,{$scope:$scope}),this.loading=!0,this._setup()}function RegistrationForticloud($scope,injector){injector.injectMarked(this,{$scope:$scope}),this._setup()}var STEP_TITLES={forticare:"Register this FortiGate",forticare_license:"Add FortiCare Contract",forticloud:"Activate FortiCloud",forticloud_extend:"Extend FortiCloud Account",forticloud_upgrade:"Upgrade FortiCloud Storage",forticloud_logout:"FortiCloud Logout",vdom_license:"Add VDOM License",success:"Success"},FORTICARE_URL="https://support.fortinet.com",FORTICARE_PASSWORD_RESET_URL=FORTICARE_URL+"/login/UserPassword.aspx",SLIDE_ID="F_REGISTRATION_MODAL",FORTICLOUD_POST_URL="/p/registration/forticloud/",FORTICARE_POST_URL="/p/registration/forticare/",FORTICARE_LICENSE_POST_URL=FORTICARE_POST_URL+"add_license/",VDOM_POST_URL="/p/registration/vdom/add_license/";Registration.prototype._setup=inject.mark(function(slide,registration){return function(){try{var current=slide.get(SLIDE_ID);current.slide.update({title:STEP_TITLES[current.data.model.step]}),angular.extend(this,current.data)}catch(e){var params=registration.setupForIndividualStep({},this.singleStep);angular.extend(this,params.data)}this.okButton={show:!0,label:"ok"},this.cancelButton={show:!0,label:"cancel"}}}),Registration.prototype.close=inject.mark(function(slide){return function(){this.registrationPrompt?this.registrationPrompt.continue():slide.get(SLIDE_ID).slide.done()}}),Registration.prototype.submit=inject.mark(function($q,$scope,slide){return function(){if(this.form.$valid){var current={};return this.registrationPrompt||(current=slide.get(SLIDE_ID)),this.submitButtonBusy=!0,this._submit().then(function(){this.registrationPrompt?this.registrationPrompt.continue():current.slide.done()}.bind(this)).finally(function(){this.submitButtonBusy=!1}.bind(this))}return $scope.$broadcast("validation-msg_show"),$q.reject()}}),Registration.prototype._submit=inject.mark(function($q){return function(){var deferred=$q.defer();return this.successMessages=null,"success"===this.model.step?this._onSuccess(null,deferred):"forticare_license_success"===this.model.step?this._onSuccess("forticare_license",deferred):"forticare"===this.model.step?this._submitForticare(deferred):"forticare_license"===this.model.step?this._submitPostData(FORTICARE_LICENSE_POST_URL,deferred):"forticloud"===this.model.step?this._submitPostData(FORTICLOUD_POST_URL,deferred):0===this.model.step.indexOf("forticloud_")?(this.model.action=this.model.step.split("_").splice(1).join("_"),this._submitPostData(FORTICLOUD_POST_URL,deferred)):"vdom_license"===this.model.step&&this._submitPostData(VDOM_POST_URL,deferred),deferred.promise}}),Registration.prototype._onSuccess=inject.mark(function(lang,slide){return function(nextStep,deferred){if(this.registrationPrompt)return void deferred.resolve();var current=slide.get(SLIDE_ID);this.initialWarning=null,nextStep?(this.model.step=this.model.override_next_step||nextStep,this.model.override_next_step=null,current.slide.update({title:STEP_TITLES[this.model.step]}),"success"===this.model.step?(this.okButton.show=!1,this.cancelButton.show=!0,this.cancelButton.label="Close"):"forticare_license_success"===this.model.step?(this.okButton.show=!0,this.okButton.label="add_another",this.cancelButton.show=!0,this.cancelButton.label="finished"):(this.okButton.show=!0,this.okButton.label="ok",this.cancelButton.show=!0,this.cancelButton.label="cancel"),deferred.reject()):deferred.resolve()}}),Registration.prototype._submitPostData=inject.mark(function($http,lang){return function(url,deferred){$http.post(url,{data:JSON.stringify(this.model)}).then(function(response){var data=response.data;this.successMessages=data.messages,this.errorMessage=data.error,data.success?this._onSuccess(data.next_step||"success",deferred):deferred.reject(),fweb.util.structure.updateLicense()}.bind(this),function(data){this.errorMessage=lang("error")+": HTTP "+data.status,deferred.reject()}.bind(this))}}),Registration.prototype._submitForticare=inject.mark(function(licenseRegions){return function(deferred){var reseller=this.model.reseller,industry_id=this.model.industry_id;(licenseRegions.resellers||[]).some(function(r){return r.value===reseller&&(this.model.reseller_name=r.text,!0)}.bind(this)),"create"===this.model.action&&(licenseRegions.industries||[]).some(function(industry){return industry.id===industry_id&&(this.model.industry=industry.name,!0)}.bind(this)),this._submitPostData(FORTICARE_POST_URL,deferred)}});var fRegistration={controller:Registration,templateUrl:function(loader){return loader.base_path("/ng/directives/registration/partials/f-registration.html")},require:{registrationPrompt:"?^fForticareLicensePrompt"},bindings:{singleStep:"<",relative:"<"}};RegistrationForticare.prototype._setup=inject.mark(function($q,notificationRequests,licenseRegions){return function(){$q.all([notificationRequests.license(),licenseRegions.getIndustryOrgInfo().then(angular.noop,angular.noop)]).then(function(results){this.licenses=results[0],this.loading=!1}.bind(this)),this.licenseRegions=licenseRegions,this.PASSWORD_RESET_URL=FORTICARE_PASSWORD_RESET_URL,this.CLOUD_LOGGED_OUT=fweb.BUILD.SYMBOLS.LICENSE_STATUS_CLOUD_LOGGED_OUT}});var fRegistrationForticare={controller:RegistrationForticare,templateUrl:function(loader){return loader.base_path("/ng/directives/registration/partials/f-registration-forticare.html")},bindings:{model:"<"}};RegistrationForticloud.prototype._setup=inject.mark(function(){return function(){this.SHOW_ACTIVATE_LOG_OPTION=fweb.BUILD.PLATFORM.GUI_SHOW_FORTICLOUD_ACTIVATE_LOG_OPTION}});var fRegistrationForticloud={controller:RegistrationForticloud,templateUrl:function(loader){return loader.base_path("/ng/directives/registration/partials/f-registration-forticloud.html")},bindings:{model:"<"}};ngFtnt.component("fRegistration",fRegistration),ngFtnt.component("fRegistrationForticare",fRegistrationForticare),ngFtnt.component("fRegistrationForticloud",fRegistrationForticloud)}),define("ng/filters/ftnt",["angular","ng/ftnt","fweb.util/formatters","fweb.util/ip","fweb.util/datetime","byod_common"],function(angular,module,formatters,ip,fDatetime,byod_common){"use strict";function password(){return function(value){return(value||"").replace(/./g,"•")}}function bytes(){return formatters.metric_bytes}function binaryBytes(){return formatters.binary_bytes}function bitsPerSecond(){return formatters.metric_bits_per_second}function toCase($filter){function titleCase(value){return String(value).toLowerCase().replace(/(?:^|\s)(\w)/g,doCase.upper)}function sentenceCase(value){return String(value).toLowerCase().replace(/(?:^|\.\s+)(\w)/g,doCase.upper)}var doCase={upper:$filter("uppercase"),lower:$filter("lowercase"),title:titleCase,sentence:sentenceCase};return function(value,fmt){if(fmt in doCase)return doCase[fmt](value);throw new Error("Unable to format using "+fmt+"-case")}}function deviceSprite(){return function(type){return byod_common.gen_fw_device_class(type)}}function elapsedTime(){return fDatetime.elapsedTime}function relativeDate(){return function(time){var datetime=Number.isInteger(time)?fDatetime.gmtSecondsToDate(time):time;return fDatetime.formatDateDiff(datetime)}}function keys(){return function(obj){return Object.keys(obj||{})}}function ngURI(structure){return function(uri){var value=null;return uri&&(value=structure.ngURI(uri).substring(1)),value}}function ngRouteURI(structure){return function(uri){var value=null;return uri&&(value=structure.ngRouteURI(uri)),value}}function subnet(){return function(value){var ipmask=ip.IpMask.parse(value);return ipmask.fullNetwork()}}function toTrustedHtml($sce){return function(html){return $sce.trustAsHtml(html)}}function locStr(){return function(locObj){var locArr=[];return locObj?(locObj.city&&locArr.push(locObj.city.names.en),locObj.country&&locArr.push(locObj.country.names.en),locObj.continent&&locArr.push(locObj.continent.names.en),locArr.join(", ")):""}}function numberWithSign($filter){var numberFilter=$filter("number");return function(value,decimalPlaces){var prefix="";return"number"==typeof value&&(value>=0&&(prefix="+"),decimalPlaces&&(value=Number(value.toFixed(decimalPlaces)))),prefix+numberFilter(value)}}function buildNumber(){return function(input){var result,number,minLength=4,prefix=Array(minLength).join("0");return input&&(number=Number(input),isNaN(number)||(minLength=Math.max(minLength,String(input).length),result=(prefix+number).slice(-minLength))),result}}module.filter({password:password,bytes:bytes,binaryBytes:binaryBytes,bitsPerSecond:bitsPerSecond,case:toCase,devicesprite:deviceSprite,elapsedTime:elapsedTime,relativeDate:relativeDate,keys:keys,ngURI:ngURI,ngRouteURI:ngRouteURI,subnet:subnet,toTrustedHtml:toTrustedHtml,location:locStr,numberWithSign:numberWithSign,buildNumber:buildNumber})}),define("ng/notification/notification_item",["ng/services/injector"],function(inject){"use strict";function NotificationItem(injector){if(injector.injectMarked(this),this._result=this.RESULT.PENDING,this._completed=!1,this.MULTIPLE?this._messages=[]:this._message=null,!this.ID)throw new Error('"ID" not defined for notification item "'+this.constructor.name+'"')}return NotificationItem.prototype.ID=null,NotificationItem.prototype.MULTIPLE=!1,NotificationItem.prototype.RESULT={PENDING:"pending",EXECUTION_ERROR:"executionError",FAILED:"failed",PASSED:"passed"},NotificationItem.prototype.SEVERITY_LEVELS={LOW:"low",MEDIUM:"medium",HIGH:"high",CRITICAL:"critical"},NotificationItem.prototype.SEVERITY_LEVELS_INDEXES={},Object.keys(NotificationItem.prototype.SEVERITY_LEVELS).forEach(function(key,index){var value=NotificationItem.prototype.SEVERITY_LEVELS[key];NotificationItem.prototype.SEVERITY_LEVELS_INDEXES[value]=index}),NotificationItem.prototype.SEVERITY_LEVEL=NotificationItem.prototype.SEVERITY_LEVELS.MEDIUM,NotificationItem.prototype.setResult=function(result){this._result=result},NotificationItem.prototype.getResult=function(){return this._result},NotificationItem.prototype.setMessage=function(message){if(this.MULTIPLE)throw new Error('Use "addMessage" for multiple notification items.');this._message=message},NotificationItem.prototype.getMessage=function(index){return this.MULTIPLE?this._messages[index]:this._message},NotificationItem.prototype.addMessage=function(message){if(!this.MULTIPLE)throw new Error('Use "setMessage" for singular notification items.');this._completed&&(this._messages=[],this._completed=!1),this._messages.push(message)},NotificationItem.prototype.run=inject.mark(function($q){return function(){return $q.reject('"run" not implemented.')}}),NotificationItem.prototype.onClick=function(){throw new Error('"onClick" not implemented.')},NotificationItem.prototype.canClick=function(){return!0},NotificationItem.prototype.markCompleted=function(){this._completed=!0},NotificationItem}),define("ng/notification/disk_logging",["ng/notification/notification_item","ng/services/injector"],function(NotificationItem,inject){"use strict";function DiskLogging($injector){$injector.invoke(NotificationItem,this)}return DiskLogging.prototype=Object.create(NotificationItem.prototype),DiskLogging.prototype.constructor=DiskLogging,DiskLogging.prototype.ID="diskLogging",DiskLogging.prototype.SEVERITY_LEVEL=DiskLogging.prototype.SEVERITY_LEVELS.MEDIUM,DiskLogging.prototype.run=inject.mark(function(notificationRequests,lang){return function(){return notificationRequests.baseNotifications().then(function(results){var loggingDisabled=results.disk_logging_disabled;loggingDisabled&&this.setMessage(lang("disable_detail").toString()),this.setResult(loggingDisabled?this.RESULT.FAILED:this.RESULT.PASSED)}.bind(this))}}),DiskLogging.prototype.onClick=inject.mark(function(registration){return function(){registration.open({},"forticloud")}}),DiskLogging.prototype.canClick=inject.mark(function(state){return function(){return state.adminHasWritePermission(state.ACCESS_GROUP.SYSTEM)}}),DiskLogging}),define("ng/notification/fs_check",["fweb","notify","ng/notification/notification_item","ng/services/injector"],function(fweb,notify,NotificationItem,inject){"use strict";function FileSystemCheck($injector){$injector.invoke(NotificationItem,this)}var DISK_USAGE_LANG_MAP={wanopt:"WAN Optimization",log:"log"};return FileSystemCheck.prototype=Object.create(NotificationItem.prototype),FileSystemCheck.prototype.constructor=FileSystemCheck,FileSystemCheck.prototype.ID="fileSystemCheck",FileSystemCheck.prototype.SEVERITY_LEVEL=FileSystemCheck.prototype.SEVERITY_LEVELS.HIGH,FileSystemCheck.prototype.run=inject.mark(function($q,state,lang){return function(){var diskUsage,passed=!state.need_fs_check||!state.admin.global_admin||!state.adminHasWritePermission(state.ACCESS_GROUP.SYSTEM);return passed||(diskUsage=lang(DISK_USAGE_LANG_MAP[state.current_disk_usage]).toString(),this.setMessage(lang("Power disruption. Check file system consistency.").toString())),this.setResult(passed?this.RESULT.PASSED:this.RESULT.FAILED),$q.resolve()}}),FileSystemCheck.prototype.onClick=inject.mark(function($location){return function(){$location.path("/prompt/file_system_check").search({viewOnly:1})}}),FileSystemCheck.prototype.canClick=inject.mark(function(state){return function(){return state.adminHasWritePermission(state.ACCESS_GROUP.SYSTEM)}}),FileSystemCheck}),define("ng/notification/ip_conflict",["fweb","notify","ng/notification/notification_item","ng/services/injector"],function(fweb,notify,NotificationItem,inject){"use strict";function IPConflict($injector){$injector.invoke(NotificationItem,this)}var INTERFACE_LIST_URI="/p/system/interface/";return IPConflict.prototype=Object.create(NotificationItem.prototype),IPConflict.prototype.constructor=IPConflict,IPConflict.prototype.ID="ipConflict",IPConflict.prototype.MULTIPLE=!0,IPConflict.prototype.SEVERITY_LEVEL=IPConflict.prototype.SEVERITY_LEVELS.CRITICAL,IPConflict.prototype.run=inject.mark(function(notificationRequests,lang){return function(){return notificationRequests.baseNotifications().then(function(results){var conflicts=results.wan_lan_ip_conflict,passed=!0;conflicts.length&&(conflicts.forEach(function(conflict){var dhcpInterface=conflict.dhcp.intf,otherInterface=conflict.other.intf,message=lang("wan_lan_ip_conflict",[otherInterface,dhcpInterface]).toString();this.addMessage(message)}.bind(this)),passed=!1),this.conflicts=conflicts,this.setResult(passed?this.RESULT.PASSED:this.RESULT.FAILED)}.bind(this))}}),IPConflict.prototype.onClick=inject.mark(function($location,state,structure,lang){return function(index){var path,search,vdom="",conflict=this.conflicts[index],firstIntf=conflict.dhcp.intf,secondIntf=conflict.other.intf;state.vdom_mode&&!state.admin.global_vdom&&(vdom=conflict.vdom),fweb.util.location.notify_after_change(lang("wan_lan_ip_conflict_review").toString(),notify.LEVEL.WARNING),path=structure.ngURI(INTERFACE_LIST_URI),search={qlist_find:JSON.stringify([{name:firstIntf},{name:secondIntf}])},$location.path(path).search(search)}}),IPConflict}),define("ng/notification/newer_firmware",["fweb","notify","ng/notification/notification_item","ng/services/injector"],function(fweb,notify,NotificationItem,inject){"use strict";function NewerFirmware($injector){$injector.invoke(NotificationItem,this)}return NewerFirmware.prototype=Object.create(NotificationItem.prototype),NewerFirmware.prototype.constructor=NewerFirmware,NewerFirmware.prototype.ID="newerFirmware",NewerFirmware.prototype.SEVERITY_LEVEL=NewerFirmware.prototype.SEVERITY_LEVELS.LOW,NewerFirmware.prototype.run=inject.mark(function($q,state,lang){return function(){var label,newerAvailable=state.newer_firmware_available,newerVersion=state.newer_firmware_version;return newerAvailable&&(label=[newerVersion.major,newerVersion.minor,newerVersion.patch].join("."),this.setMessage(lang("{0} available for firmware upgrade.",[label]).toString())),this.setResult(newerAvailable?this.RESULT.FAILED:this.RESULT.PASSED),$q.resolve()}}),NewerFirmware.prototype.onClick=inject.mark(function($location){return function(){$location.path("/system/firmware")}}),NewerFirmware.prototype.canClick=inject.mark(function(state){return function(){return state.adminHasWritePermission(state.ACCESS_GROUP.MAINTENANCE)}}),NewerFirmware}),define("ng/notification/fortianalyzer_connection",["ng/notification/notification_item","ng/services/injector"],function(NotificationItem,inject){"use strict";function FortiAnalyzerConnection($injector){$injector.invoke(NotificationItem,this)}return FortiAnalyzerConnection.prototype=Object.create(NotificationItem.prototype),FortiAnalyzerConnection.prototype.constructor=FortiAnalyzerConnection,FortiAnalyzerConnection.prototype.ID="fortiAnalyzerConnection",FortiAnalyzerConnection.prototype.SEVERITY_LEVEL=FortiAnalyzerConnection.prototype.SEVERITY_LEVELS.CRITICAL,FortiAnalyzerConnection.prototype.run=inject.mark(function(notificationRequests,lang){return function(){return notificationRequests.fortianalyzerStatus().then(function(results){var failed=results.is_enabled&&"allow"!==results.connection;failed&&this.setMessage(lang("fortianalyzer_no_connection").toString()),this.setResult(failed?this.RESULT.FAILED:this.RESULT.PASSED)}.bind(this))}}),FortiAnalyzerConnection.prototype.onClick=inject.mark(function($location,state){return function(){var search={};state.vdom_mode&&(search.vdom=""),$location.path("/system/external_security").search(search)}}),FortiAnalyzerConnection}),define("ng/notification/forticare",["fweb","ng/notification/notification_item","ng/services/injector"],function(fweb,NotificationItem,inject){"use strict";function FortiCare($injector){$injector.invoke(NotificationItem,this)}var STATUSES=fweb.BUILD.SYMBOLS;return FortiCare.prototype=Object.create(NotificationItem.prototype),FortiCare.prototype.constructor=FortiCare,FortiCare.prototype.ID="fortiCare",FortiCare.prototype.SEVERITY_LEVEL=FortiCare.prototype.SEVERITY_LEVELS.HIGH,FortiCare.prototype.run=inject.mark(function(notificationRequests,lang){return function(){return notificationRequests.license().then(function(licenses){var langKey,passed=!0,registered=!0;licenses&&(licenses.forticare.status===STATUSES.LICENSE_STATUS_NOT_REGISTERED?(passed=!1,registered=!1,langKey="FortiCare is not registered.",this.SEVERITY_LEVEL=this.SEVERITY_LEVELS.CRITICAL):licenses.forticare.support&&Object.keys(licenses.forticare.support).every(function(key){var supportStatus=licenses.forticare.support[key].status;return supportStatus===STATUSES.LICENSE_STATUS_EXPIRED?(passed=!1,langKey="Some FortiCare support coverage services have expired.",this.SEVERITY_LEVEL=this.SEVERITY_LEVELS.CRITICAL,!1):(supportStatus===STATUSES.LICENSE_STATUS_EXPIRES_SOON&&(passed=!1,langKey="Some FortiCare support coverage services expire soon."),!0)}.bind(this))),passed||this.setMessage(lang(langKey).toString()),this.registered=registered,this.setResult(passed?this.RESULT.PASSED:this.RESULT.FAILED)}.bind(this))}}),FortiCare.prototype.onClick=inject.mark(function($location,registration,state){return function(){var search={};this.registered?(state.vdom_mode&&(search.vdom=""),$location.path("/system/fortiguard").search(search)):registration.open({},"forticare")}}),FortiCare.prototype.canClick=inject.mark(function(state){return function(){return state.adminHasWritePermission(state.ACCESS_GROUP.SYSTEM)}}),FortiCare}),define("ng/notification/fortiguard_subscriptions",["fweb","ng/notification/notification_item","ng/services/injector"],function(fweb,NotificationItem,inject){"use strict";function FortiGuardSubscriptions($injector){$injector.invoke(NotificationItem,this)}var STATUSES=fweb.BUILD.SYMBOLS,LICENSES={antivirus:["gui-antivirus"],ips:["gui-ips"],web_filtering:["gui-webfilter"],antispam:["gui-spamfilter"],mobile_malware:[],forticlient:["gui-endpoint-control"],industrial_db:[]};return FortiGuardSubscriptions.prototype=Object.create(NotificationItem.prototype),FortiGuardSubscriptions.prototype.constructor=FortiGuardSubscriptions,FortiGuardSubscriptions.prototype.ID="fortiGuardSubscriptions",FortiGuardSubscriptions.prototype.SEVERITY_LEVEL=FortiGuardSubscriptions.prototype.SEVERITY_LEVELS.HIGH,FortiGuardSubscriptions.prototype.run=inject.mark(function($filter,notificationRequests,state,lang){var dateFilter=$filter("date");return function(){return notificationRequests.license().then(function(licenses){var closestExpiresTime,message,passed=!0,oneExpiresSoon=!1,oneIsExpired=!1,enabledInAnyVDOM=function(feature){return state.featureEnabledInAnyVDOM(feature)};Object.keys(LICENSES).forEach(function(key){var guiFeatures=LICENSES[key],license=licenses[key];guiFeatures.some(enabledInAnyVDOM)&&(license.status===STATUSES.LICENSE_STATUS_EXPIRES_SOON?(oneExpiresSoon=!0,(!closestExpiresTime||license.expires<closestExpiresTime)&&(closestExpiresTime=license.expires)):license.status===STATUSES.LICENSE_STATUS_EXPIRED&&(oneIsExpired=!0))}.bind(this)),oneIsExpired?(passed=!1,message=lang("Some FortiGuard license subscriptions have expired.").toString(),this.SEVERITY_LEVEL=this.SEVERITY_LEVELS.CRITICAL):oneExpiresSoon&&(passed=!1,message=lang("Some FortiGuard license subscriptions expire soon ({0}).",[dateFilter(1e3*closestExpiresTime,"yyyy/MM/dd")]).toString()),passed||this.setMessage(message),this.setResult(passed?this.RESULT.PASSED:this.RESULT.FAILED)}.bind(this))}}),FortiGuardSubscriptions.prototype.onClick=inject.mark(function($location,state){return function(){var search={};state.vdom_mode&&(search.vdom=""),$location.path("/system/fortiguard").search(search)}}),FortiGuardSubscriptions}),define("ng/notification/forticlient_exhausted",["fweb","ng/notification/notification_item","ng/services/injector"],function(fweb,NotificationItem,inject){"use strict";function FortiClientExhausted($injector){$injector.invoke(NotificationItem,this)}var SYMBOLS=fweb.BUILD.SYMBOLS;return FortiClientExhausted.prototype=Object.create(NotificationItem.prototype),FortiClientExhausted.prototype.constructor=FortiClientExhausted,FortiClientExhausted.prototype.ID="forticlientExhausted",FortiClientExhausted.prototype.SEVERITY_LEVEL=FortiClientExhausted.prototype.SEVERITY_LEVELS.HIGH,FortiClientExhausted.prototype.run=inject.mark(function(notificationRequests,state,lang){return function(){return notificationRequests.license().then(function(licenses){var message,EXHAUSTED_STATUSES=[SYMBOLS.LICENSE_STATUS_FREE_LICENSE_EXHAUSTED,SYMBOLS.LICENSE_STATUS_LICENSED_EXHAUSTED],passed=!0,forticlient=licenses.forticlient;forticlient&&EXHAUSTED_STATUSES.indexOf(forticlient.status)>=0&&state.featureEnabledInAnyVDOM("gui-endpoint-control")&&(passed=!1,message=lang("FortiClient endpoint allowance has been exhausted.").toString()),passed||this.setMessage(message),this.setResult(passed?this.RESULT.PASSED:this.RESULT.FAILED)}.bind(this))}}),FortiClientExhausted.prototype.onClick=inject.mark(function($location,state){return function(){var search={};state.vdom_mode&&(search.vdom=""),$location.path("/system/fortiguard").search(search)}}),FortiClientExhausted}),define("ng/notification/forticloud",["fweb","ng/notification/notification_item","ng/services/injector"],function(fweb,NotificationItem,inject){"use strict";function FortiCloud($injector){$injector.invoke(NotificationItem,this)}return FortiCloud.prototype=Object.create(NotificationItem.prototype),FortiCloud.prototype.constructor=FortiCloud,FortiCloud.prototype.ID="fortiCloud",FortiCloud.prototype.SEVERITY_LEVEL=FortiCloud.prototype.SEVERITY_LEVELS.HIGH,FortiCloud.prototype.run=inject.mark(function($filter,notificationRequests,lang){var dateFilter=$filter("date");return function(){return notificationRequests.license().then(function(licenses){var date,passed=!0,forticloud=licenses.forticloud,loggedIn=forticloud.status===fweb.BUILD.SYMBOLS.LICENSE_STATUS_CLOUD_LOGGED_IN;loggedIn&&forticloud.license_status===fweb.BUILD.SYMBOLS.LICENSE_STATUS_EXPIRES_SOON&&(passed=!1,date=dateFilter(1e3*forticloud.expires,"yyyy/MM/dd"),this.setMessage(lang("Paid FortiCloud account expires soon ({0}).",[date]).toString())),this.setResult(passed?this.RESULT.PASSED:this.RESULT.FAILED)}.bind(this))}}),FortiCloud.prototype.onClick=inject.mark(function(registration){return function(){registration.open({},"forticloud_extend")}}),FortiCloud.prototype.canClick=inject.mark(function(state){return function(){return state.adminHasWritePermission(state.ACCESS_GROUP.SYSTEM)}}),FortiCloud}),define("ng/notification/forticloud_sandbox",["fweb","ng/notification/notification_item","ng/services/injector"],function(fweb,NotificationItem,inject){"use strict";function FortiCloudSandbox($injector){$injector.invoke(NotificationItem,this)}return FortiCloudSandbox.prototype=Object.create(NotificationItem.prototype),FortiCloudSandbox.prototype.constructor=FortiCloudSandbox,FortiCloudSandbox.prototype.ID="fortiCloudSandbox",FortiCloudSandbox.prototype.SEVERITY_LEVEL=FortiCloudSandbox.prototype.SEVERITY_LEVELS.HIGH,FortiCloudSandbox.prototype.run=inject.mark(function($filter,notificationRequests,lang){var dateFilter=$filter("date");return function(){return notificationRequests.license().then(function(licenses){var date,passed=!0,forticloud=licenses.forticloud,loggedIn=forticloud.status===fweb.BUILD.SYMBOLS.LICENSE_STATUS_CLOUD_LOGGED_IN;loggedIn&&forticloud.sandbox.status===fweb.BUILD.SYMBOLS.LICENSE_STATUS_EXPIRES_SOON&&(passed=!1,
date=dateFilter(1e3*forticloud.sandbox.expires,"yyyy/MM/dd"),this.setMessage(lang("Paid FortiSandbox Cloud account expires soon ({0}).",[date]).toString())),this.setResult(passed?this.RESULT.PASSED:this.RESULT.FAILED)}.bind(this))}}),FortiCloudSandbox.prototype.onClick=inject.mark(function(registration){return function(){registration.open({},"forticloud_extend")}}),FortiCloudSandbox.prototype.canClick=inject.mark(function(state){return function(){return state.adminHasWritePermission(state.ACCESS_GROUP.SYSTEM)}}),FortiCloudSandbox}),define("ng/notification/fortisandbox_connection",["ng/notification/notification_item","ng/services/injector"],function(NotificationItem,inject){"use strict";function FortiSandboxConnection($injector){$injector.invoke(NotificationItem,this)}return FortiSandboxConnection.prototype=Object.create(NotificationItem.prototype),FortiSandboxConnection.prototype.constructor=FortiSandboxConnection,FortiSandboxConnection.prototype.ID="fortiSandboxConnection",FortiSandboxConnection.prototype.SEVERITY_LEVEL=FortiSandboxConnection.prototype.SEVERITY_LEVELS.CRITICAL,FortiSandboxConnection.prototype.run=inject.mark(function(notificationRequests,lang){return function(){return notificationRequests.sandboxStatus().then(function(results){var failed=results.configured&&"appliance"===results.type&&!results.connected;failed&&this.setMessage(lang("fortisandbox_appliance_no_connection").toString()),this.setResult(failed?this.RESULT.FAILED:this.RESULT.PASSED)}.bind(this))}}),FortiSandboxConnection.prototype.onClick=inject.mark(function($location,state){return function(){var search={};state.vdom_mode&&(search.vdom=""),$location.path("/system/external_security").search(search)}}),FortiSandboxConnection}),define("ng/notification/vm_license",["fweb","ng/notification/notification_item","ng/services/injector"],function(fweb,NotificationItem,inject){"use strict";function VmLicense($injector){$injector.invoke(NotificationItem,this)}return VmLicense.prototype=Object.create(NotificationItem.prototype),VmLicense.prototype.constructor=VmLicense,VmLicense.prototype.ID="VmLicense",VmLicense.prototype.SEVERITY_LEVEL=VmLicense.prototype.SEVERITY_LEVELS.HIGH,VmLicense.prototype.run=inject.mark(function($filter,notificationRequests,lang){var dateFilter=$filter("date");return function(){return notificationRequests.license().then(function(licenses){var date,passed=!0,vm=licenses.vm;vm.status===fweb.BUILD.SYMBOLS.LICENSE_STATUS_VM_EVAL&&(passed=!1,date=dateFilter(1e3*vm.expires,"yyyy/MM/dd"),this.setMessage(lang("VM evaluation license expires soon ({0}).",[date]).toString())),this.setResult(passed?this.RESULT.PASSED:this.RESULT.FAILED)}.bind(this))}}),VmLicense.prototype.onClick=inject.mark(function($location){return function(){$location.path("/system/vm/license")}}),VmLicense.prototype.canClick=inject.mark(function(state){return function(){return state.adminHasWritePermission(state.ACCESS_GROUP.SYSTEM)}}),VmLicense}),define("ng/notification/wan_ip_blacklist",["fweb","notify","ng/notification/notification_item","ng/services/injector"],function(fweb,notify,NotificationItem,inject){"use strict";function WANIPBlacklist($injector){$injector.invoke(NotificationItem,this)}return WANIPBlacklist.prototype=Object.create(NotificationItem.prototype),WANIPBlacklist.prototype.constructor=WANIPBlacklist,WANIPBlacklist.prototype.ID="wanIPBlacklist",WANIPBlacklist.prototype.SEVERITY_LEVEL=WANIPBlacklist.prototype.SEVERITY_LEVELS.CRITICAL,WANIPBlacklist.prototype.run=inject.mark(function($q,notificationRequests,lang){return function(){return notificationRequests.license().then(function(licenses){var fortiguard=licenses.fortiguard,wanIP=fortiguard&&fortiguard.fortigate_wan_ip;return wanIP?notificationRequests.wanIPBlacklist(wanIP).then(function(results){var message,passed=!0;results.blacklisted&&(passed=!1,message=lang('WAN IP "{0}" is blacklisted.',[wanIP]).toString(),this.setMessage(message),this.wanIP=wanIP,this.blacklistEntries=results.info),this.setResult(passed?this.RESULT.PASSED:this.RESULT.FAILED)}.bind(this),function(){return $q.reject("Failed to retrieve WAN IP blacklist from FortiGuard.")}):void this.setResult(this.RESULT.PASSED)}.bind(this))}}),WANIPBlacklist.prototype.onClick=inject.mark(function($rootScope,slide,lang){return function(){var scope=$rootScope.$new();scope.wanIP=this.wanIP,scope.blacklistEntries=this.blacklistEntries,slide.open("wanIPBlacklist",{template:'<f-wan-ip-blacklist-info wan-ip="wanIP" blacklist-entries="blacklistEntries"></f-wan-ip-blacklist-info>',parentScope:scope,options:{title:lang("WAN IP Blacklisted").toString(),fullHeight:!0}}).finally(function(){scope.$destroy()})}}),WANIPBlacklist}),define("ng/notification/notification_requests",["ng/ftnt","ng/services/injector","fweb"],function(module,inject,fweb){"use strict";function NotificationRequests(injector){injector.injectMarked(this),this._permanentlyCached=new Set,this._cache={}}var BASE_URI="/api/v2/monitor/",BASE_NOTIFICATION_URI=BASE_URI+"web-ui/notification",FORTIGUARD_UPDATE_URI="/api/v2/monitor/system/fortiguard/update",LICENSE_URI=BASE_URI+"license/status",FORTITOKEN_URI=BASE_URI+"user/fortitoken",SANDBOX_URI=BASE_URI+"system/sandbox/status",SENSOR_URI=BASE_URI+"system/sensor-info",BLACKLIST_URI=BASE_URI+"system/fortiguard-blacklist",LOG_DEVICE_URI=BASE_URI+"log/device/state",FAZ_URI=BASE_URI+"log/fortianalyzer",FMG_URI=BASE_URI+"system/fortimanager/status";NotificationRequests.prototype._getUpdatingEvent=function(cacheKey){return"notificationRequestUpdated::"+cacheKey},NotificationRequests.prototype._resetCache=function(){Object.keys(this._cache).forEach(function(key){this._permanentlyCached.has(key)||delete this._cache[key]}.bind(this))},NotificationRequests.prototype._createCachedRequest=inject.mark(function($rootScope){return function(id,fn,forceReload){var cached=this._cache[id];return cached&&!forceReload||(cached=this._cache[id]=fn(),$rootScope.$broadcast(this._getUpdatingEvent(id))),cached}}),NotificationRequests.prototype._setPermanentlyCached=function(id){this._permanentlyCached.add(id)},NotificationRequests.prototype.watch=function(scope,requestType,callback,immediate){var run=function(){if("function"!=typeof this[requestType])throw new Error('Invalid request type "'+requestType+'"');this[requestType]().then(function(result){callback(result)})}.bind(this);return immediate&&run(),scope.$on(this._getUpdatingEvent(requestType),run)},NotificationRequests.prototype.watchMultiple=inject.mark(function($q){return function(scope,requestTypes,callback,immediate){var areAllCached=function(){return requestTypes.every(function(requestType){return this._cache[requestType]}.bind(this))}.bind(this),run=function(){var promises=requestTypes.reduce(function(prev,requestType){if("function"!=typeof this[requestType])throw new Error('Invalid request type "'+requestType+'"');return prev[requestType]=this[requestType](),prev}.bind(this),{});return $q.all(promises).then(function(results){callback(results)})}.bind(this),initializeListeners=function(){requestTypes.forEach(function(requestType){scope.$on(this._getUpdatingEvent(requestType),function(){areAllCached()&&run()})}.bind(this))}.bind(this);immediate?run().then(initializeListeners):initializeListeners()}}),NotificationRequests.prototype.baseNotifications=inject.mark(function($http){return function(){var get=function(){return $http.get(BASE_NOTIFICATION_URI).then(function(response){return response.data.results})}.bind(this);return this._createCachedRequest("baseNotifications",get)}}),NotificationRequests.prototype._triggerFortiGuardUpdate=inject.mark(function($http){return function(){this._fortiguardUpdateRequested||$http.post(FORTIGUARD_UPDATE_URI).catch(function(){fweb.log.error("Failed to query FortiGuard for license update.")}),this._fortiguardUpdateRequested=!0}}),NotificationRequests.prototype._aggregateFortiTokens=function(response){var result={used:0,max:0,vdoms:[]};return response.forEach(function(vdomResponse){var used=0,max=0,tokens=vdomResponse.results;Object.keys(tokens).forEach(function(key){var token=tokens[key];"mobile"===token.type&&(token.status&&"activated"===token.status.name&&(result.used++,used++),result.max++,max++)}),result.vdoms.push({name:vdomResponse.vdom,used:used,max:max})}),result},NotificationRequests.prototype.license=inject.mark(function($http,$q){return function(forceReload){var get=function(){var SYMBOLS=fweb.BUILD.SYMBOLS,TRIGGER_UPDATE_STATUSES=new Set([SYMBOLS.LICENSE_STATUS_PENDING,SYMBOLS.LICENSE_STATUS_VM_STARTUP,SYMBOLS.LICENSE_STATUS_UNAVAILABLE]),CORE_LICENSES=["antivirus","appctrl","ips"],promises=[$http.get(LICENSE_URI),$http.get(FORTITOKEN_URI,{params:{global:1}})];return $q.all(promises).then(function(response){var licenses=response[0].data.results,fortitokensResponse=response[1].data;return CORE_LICENSES.some(function(key){var license=licenses[key];return!(!license||!TRIGGER_UPDATE_STATUSES.has(license.status))&&(this._triggerFortiGuardUpdate(),!0)}.bind(this)),licenses.fortitoken=this._aggregateFortiTokens(fortitokensResponse),licenses}.bind(this))}.bind(this);return this._createCachedRequest("license",get,forceReload)}}),NotificationRequests.prototype.sandboxStatus=inject.mark(function($http){return function(forceReload){var get=function(){return $http.get(SANDBOX_URI).then(function(response){return response.data.results})};return this._createCachedRequest("sandboxStatus",get,forceReload)}}),NotificationRequests.prototype.logDeviceStatus=inject.mark(function($http){return function(){var get=function(){return $http.get(LOG_DEVICE_URI).then(function(response){return response.data.results})};return this._createCachedRequest("logDeviceStatus",get)}}),NotificationRequests.prototype.fortianalyzerStatus=inject.mark(function($http){return function(){var get=function(){return this.logDeviceStatus().then(function(logStatus){var result={is_enabled:logStatus.fortianalyzer.is_enabled,ip:logStatus.fortianalyzer.ip};return result.is_enabled?$http.get(FAZ_URI).then(function(response){return Object.assign(result,response.data.results)}):result})}.bind(this);return this._createCachedRequest("fortianalyzerStatus",get)}}),NotificationRequests.prototype.sensorInfo=inject.mark(function($http){return function(){var get=function(){return $http.get(SENSOR_URI).then(function(response){return response.data.results})};return this._createCachedRequest("sensorInfo",get)}}),NotificationRequests.prototype.wanIPBlacklist=inject.mark(function($http){return function(wanIP){var CACHE_KEY="wanIPBlacklist::"+wanIP,get=function(){return $http.get(BLACKLIST_URI,{params:{ip:wanIP}}).then(function(response){var results=response.data.results;return results.blacklisted||this._setPermanentlyCached(CACHE_KEY),results}.bind(this))}.bind(this);return this._createCachedRequest(CACHE_KEY,get)}}),NotificationRequests.prototype.fortimanagerStatus=inject.mark(function($http){return function(){var get=function(){return $http.get(FMG_URI).then(function(response){return response.data.results})};return this._createCachedRequest("fortimanagerStatus",get)}}),NotificationRequests.prototype.csfTopologyWithExtensionDevices=inject.mark(function(csfTopology){return function(){var get=function(){return csfTopology.build(csfTopology.BUILD_TYPES.WITH_EXTENSION_DEVICES).then(function(){return csfTopology})};return this._createCachedRequest("csfTopologyWithExtensionDevices",get)}}),module.service("notificationRequests",NotificationRequests)}),define("ng/notification/notification",["ng/ftnt","fweb","ng/services/injector","ng/notification/ip_conflict","ng/notification/disk_logging","ng/notification/fs_check","ng/notification/newer_firmware","ng/notification/fortianalyzer_connection","ng/notification/forticare","ng/notification/fortiguard_subscriptions","ng/notification/forticloud","ng/notification/forticloud_sandbox","ng/notification/fortisandbox_connection","ng/notification/vm_license","ng/notification/wan_ip_blacklist","ng/notification/forticlient_exhausted","ng/notification/notification_item","ng/notification/notification_requests","ng/directives/f-wan-ip-blacklist-info"],function(module,fweb,inject,IPConflict,DiskLogging,FileSystemCheck,NewerFirmware,FortiAnalyzerConnection,FortiCare,FortiGuardSubscriptions,FortiCloud,FortiCloudSandbox,FortiSandboxConnection,VmLicense,FortiClientExhausted,WANIPBlacklist){"use strict";function Notification(injector){injector.injectMarked(this),this.failCount=0,this.highestSeverityLevel=null,this.failedNotificationItems=[],this._firstRun=!0,this._notificationItems=[],this._updateTimeout=null,this._createNotificationItems()}var UPDATE_INTERVAL=3e4;return Notification.prototype.start=inject.mark(function($timeout){return function(){var update=function(){this._run().finally(function(){this._updateTimeout=$timeout(update,UPDATE_INTERVAL)}.bind(this))}.bind(this);update()}}),Notification.prototype.restart=function(){this.stop(),this.start()},Notification.prototype.restartIfActive=function(notificationID){var active,set=new Set;Array.isArray(notificationID)?notificationID.forEach(function(id){set.add(id)}):set.add(notificationID),active=this.failedNotificationItems.some(function(item){return set.has(item.ID)}),active&&(fweb.log('Notification item "'+notificationID+'" is active. Restarting notifications'),this.restart())},Notification.prototype.restartIfAnyActive=function(){this.failedNotificationItems.length&&(fweb.log("Restarting notifications"),this.restart())},Notification.prototype.stop=inject.mark(function($timeout){return function(){$timeout.cancel(this._updateTimeout)}}),Notification.prototype._notificationItemError=function(item,message){var name=item.constructor.name;fweb.log.error('"'+name+'" failed during execution: '+message),item.setResult(item.RESULT.EXECUTION_ERROR)},Notification.prototype._run=inject.mark(function($q,notificationRequests){return function(){var failed=[],promises=[],highestSeverityLevel=null,highestSeverityLevelIndex=-1;return this._firstRun||notificationRequests._resetCache(),this._firstRun=!1,this._notificationItems.forEach(function(item){var promise,VALID_RESULTS=[item.RESULT.PASSED,item.RESULT.FAILED];try{promise=item.run().then(function(){var result=item.getResult();if(VALID_RESULTS.indexOf(result)>=0){var severity,severityIndex;result===item.RESULT.FAILED&&(severity=item.SEVERITY_LEVEL,severityIndex=item.SEVERITY_LEVELS_INDEXES[severity],severityIndex>highestSeverityLevelIndex&&(highestSeverityLevel=severity,highestSeverityLevelIndex=severityIndex),failed.push(item)),item.markCompleted()}else this._notificationItemError(item,"invalid result set.")}.bind(this),function(error){this._notificationItemError(item,error)}.bind(this)),promises.push(promise)}catch(error){this._notificationItemError(item,error)}}.bind(this)),$q.all(promises).then(function(){this.failedNotificationItems=failed,this.failCount=failed.length,this.highestSeverityLevel=highestSeverityLevel}.bind(this))}}),Notification.prototype._createNotificationItems=inject.mark(function($injector,state){return function(){var notificationItems=[];state.adminHasReadPermission(state.ACCESS_GROUP.NETWORK)&&notificationItems.push(IPConflict),state.admin.global_admin&&(state.adminHasReadPermission(state.ACCESS_GROUP.MAINTENANCE)&&notificationItems.push(NewerFirmware),state.adminHasReadPermission(state.ACCESS_GROUP.SYSTEM)&&(notificationItems=notificationItems.concat([FortiGuardSubscriptions,FortiSandboxConnection,FortiClientExhausted,WANIPBlacklist,DiskLogging,FileSystemCheck,FortiCare,FortiCloud,FortiCloudSandbox]),state.is_vm&&notificationItems.push(VmLicense),state.adminHasReadPermission(state.ACCESS_GROUP.LOG_CONFIG)&&state.adminHasReadPermission(state.ACCESS_GROUP.LOG_DATA_ACCESS)&&notificationItems.push(FortiAnalyzerConnection))),notificationItems.forEach(function(itemClass){this._notificationItems.push($injector.instantiate(itemClass))}.bind(this))}}),module.service("notification",Notification),Notification}),define("ng/structure/controllers",["angular","ng/ftnt","fweb","jquery","notify","ftnt_shared","legacy.util","ng/services/object_usage"],function(angular,module,fweb,$,Notify){"use strict";var CENTRALLY_MANAGED_PROMPT_URI="/prompt/centrally_managed/",BACKUP_CONFIGURATION_URI="/ng/system/config/backup",RESTORE_CONFIGURATION_URI="/ng/system/config/restore",CONFIGURATION_REVISIONS_URI="/ng/system/config/revisions",FIRMWARE_URI="/ng/system/firmware",LOGOUT_URI="/logout",BETA_ANNOUNCEMENTS_URI="https://forum.fortinet.com/tm.aspx?m=141214",BETA_FEEDBACK_URI="https://forum.fortinet.com/tt.aspx?forumid=162",BETA_DOCUMENTATION_URI="https://support.fortinet.com/BetaProgram/BetaProgramHome.aspx",COVERAGE_DOWNLOAD_URI="/api/v2/monitor/coverage/download",COVERAGE_RESET_URI="/api/v2/monitor/coverage/reset",VIEW_ONLY_ALWAYS="always";module.controller("App",function($scope,$rootScope,$location,$window,$http,state,structure,loader,lang,dialog,adminTimeout,navbar,shortcuts,objectUsage,vdomState,usbDisk,connection,notification,notificationRequests,$route){var deregister,viewOnlyAlways,showStructure=function(){var value,viewOnly;return viewOnlyAlways?value=!1:(viewOnly=$location.search().viewOnly,viewOnlyAlways=viewOnly===VIEW_ONLY_ALWAYS,value=null==viewOnly&&!$scope.isFullscreen),value},showNavigation=function(){return Object.keys(state.admin.profile).length>0},initializeStructure=function(){structure.responsiveMenu=!1,$scope.$on("$locationChangeSuccess",function(){$scope.showStructure=showStructure(),$scope.showNavigation=showNavigation(),state.checkRefresh()}),$scope.$watch(function(){return structure.isFullscreen},function(){$scope.isFullscreen=structure.isFullscreen,$scope.showStructure=showStructure(),angular.element($window).resize(),$rootScope.$broadcast("fullScreen:resize")}),state.timeout_minutes&&adminTimeout.start(fweb.util.location.logout_redirect,60*state.timeout_minutes),$scope.$on(state.UPDATE_EVENT,function(){state.$promise.then(adminTimeout.reset.bind(adminTimeout))}),!state.admin.guest_admin&&state.adminHasReadPermission(state.ACCESS_GROUP.SYSTEM)&&usbDisk.start(),notification.start()},search=$location.search();state.vdom_mode&&"string"==typeof search.vdom?vdomState.setCurrent(search.vdom):window!==top?state.current_vdom=structure.getVDOMCookieValue():(state.current_vdom=state.initial_vdom,structure.setVDOMCookie(state.current_vdom)),$location.search("vdom",state.vdom_mode?state.current_vdom:null),$scope.$on("$locationChangeStart",function(event){if(state.vdom_mode){var vdom=$location.search().vdom;null==vdom?(event.preventDefault(),$location.search("vdom",state.current_vdom),structure.setVDOMCookie(state.current_vdom)):vdom!==state.current_vdom&&vdomState.setCurrent(vdom)}}),$window.addEventListener("message",function(event){var origin=fweb.util.structure.getOrigin(),data=event.data;if(event.origin===origin)switch(data.messageType){case"changeNgLocation":$scope.$apply(function(){var path=data.path;path&&((data.embedded||data.absolute)&&(path=structure.ngURI(path)),$location.path(path)),data.search&&$location.search(data.search),data.hash&&$location.hash(data.hash)});break;case"enterVDOM":$scope.$apply(function(){$scope.$broadcast(structure.ENTER_VDOM_EVENT,data.vdom)});break;case"pathAvailable":var reply=data;navbar.isPathAvailable(data.path,state.current_vdom).then(function(isAvailable){reply.result=isAvailable,event.source.postMessage(reply,origin)});break;case"shortcutPressed":$scope.$apply(function(){shortcuts.trigger(data.shortcut)});break;case"showObjectUsage":objectUsage.open(data.qTypes,data.mkey,data.vdom).then(void 0,function(result){result.shouldReloadRoute&&$route.reload(),result.shouldRefreshState&&state.refresh()});break;case"disconnected":$scope.$apply(function(){connection.setDisconnected()});break;case"restartNotificationsIf":$scope.$apply(function(){data.notificationID?notification.restartIfActive(data.notificationID):notification.restartIfAnyActive()});break;case state.UPDATE_EVENT:state.refresh();break;case"licenseForceUpdate":notificationRequests.license(!0).then(function(){notificationRequests.sandboxStatus(!0)});break;case"closeResponsiveMenu":structure.responsiveMenu=!1;break;case"openCliConsole":fweb.util.slide.openCli(data.entry,data.mode);break;case"extendAdminTimeout":adminTimeout.extend()}},!1),$rootScope.state=state,$scope.state=state,$scope.structure=structure,state.admin.guest_admin&&($scope.headerTemplate="/ng/structure/partials/guestadmin_header.html"),$scope.showStructure=showStructure(),$scope.showNavigation=showNavigation(),$scope.showStructure?initializeStructure():deregister=$scope.$on("$locationChangeStart",function(){$scope.showStructure=showStructure(),$scope.showStructure&&(deregister(),initializeStructure())})}),module.controller("AppControls",function($scope,$window,$location,state,help,lang,$timeout,$http,structure,usbDisk,passwordService,notification,slide){$scope.state=state,$scope.help=help,$scope.usbDisk=usbDisk,$scope.notification=notification,$scope.structure=structure,$scope.configurationVisible=state.adminHasWritePermission(state.ACCESS_GROUP.MAINTENANCE),$scope.configurationRevisionsVisible=fweb.BUILD.PLATFORM.HAVE_LOCAL_REV_CONTROL&&(!state.vdom_mode||state.admin.global_admin),$scope.openFullscreen=function(){structure.isFullscreen=!0},$scope.changePassword=function(){passwordService.openPasswordDialog()},$scope.backupConfiguration=function(){$location.url(structure.ngURI(BACKUP_CONFIGURATION_URI))},$scope.restoreConfiguration=function(){$location.url(structure.ngURI(RESTORE_CONFIGURATION_URI))},$scope.configurationRevisions=function(){$location.url(structure.ngURI(CONFIGURATION_REVISIONS_URI))},$scope.firmwareManagement=function(){$location.url(structure.ngURI(FIRMWARE_URI))},$scope.cliConsole=function(){fweb.util.structure.openCli()},$scope.logout=function(){$window.location.href=LOGOUT_URI},$scope.openHelp=function(){help.$promise.then(function(){var uri=help.getHelpUrl()+help.helpKey;$window.open(uri)})},$scope.openVideo=function(video){var uri;uri=null==video?help.hrefs.no_video:help.hrefs.video+video.id,uri+="?"+$.param(help.getTrackingInfo()),$window.open(uri)},$scope.centrallyManagedPrompt=function(){var current=fweb.util.location.get_current();$location.url(CENTRALLY_MANAGED_PROMPT_URI),$location.search({viewOnly:"",redir:current})},$scope.betaAnnouncements=function(){$window.open(BETA_ANNOUNCEMENTS_URI)},$scope.betaFeedback=function(){$window.open(BETA_FEEDBACK_URI)},$scope.betaDocumentation=function(){$window.open(BETA_DOCUMENTATION_URI)},$scope.downloadCoverage=function(){$window.location.assign(COVERAGE_DOWNLOAD_URI)},$scope.resetCoverage=function(){fweb.util.slide.confirm("Are you sure you want to reset code coverage?").then(function(){$http.post(COVERAGE_RESET_URI).then(function(){Notify.post("Code coverage reset.",Notify.LEVEL.SUCCESS)},function(){Notify.post("Failed to reset code coverage.",Notify.LEVEL.ERROR)})})},$scope.powerControlsVisible=state.admin.global_admin&&state.adminHasWritePermission(state.ACCESS_GROUP.SYSTEM),$scope.powerDevice=function(type){var title=lang("reboot"===type?"Reboot":"Shutdown").toString(),component="<f-system-power type=\"::'"+type+"'\"></f-system-power>";slide.open("powerPrompt"+type,{template:component,options:{title:title,fullHeight:!0}})}}),module.controller("Index",function($location,structure,navbar){navbar.getFirstValidEntry().then(function(entry){$location.url(structure.ngURI(entry.uri))})})}),define("ng/structure/directives/f-disconnection-notice",["ng/ftnt","ng/services/injector"],function(module,inject){"use strict";function DisconnectionNotice(injector,state,connection){injector.injectMarked(this),this.state=state,this.connection=connection}DisconnectionNotice.prototype.formatDuration=inject.mark(function($filter){var elapsedTime=$filter("elapsedTime");return function(value){return elapsedTime(value,"short","minute")}}),module.component("fDisconnectionNotice",{templateUrl:function(loader){return loader.base_path("/ng/structure/partials/f-disconnection-notice.html")},controller:DisconnectionNotice})}),define("ng/structure/directives/f-embedded-iframe",["angular","ng/ftnt","fweb","ng/services/injector"],function(angular,module,fweb,inject){"use strict";function EmbeddedIframe($scope,$element,injector){injector.injectMarked(this,{$scope:$scope,$element:$element}),this._$iframe=$element.find("iframe"),this._fromIframe=!1,this._firstLoad=!1,this._currentPath=null,this._setupScopeListeners(),this._setupLoadEvents(),this.locationChange()}var LOAD_EVENT="load.embedded_iframe",MAX_SHORTCUT_ATTACH_ATTEMPTS=4,SHORTCUT_ATTACH_ATTEMPT_TIMEOUT=500;EmbeddedIframe.prototype.getIframeLocation=function(){return this._$iframe[0].contentWindow.location},EmbeddedIframe.prototype.formatSearchParams=function(search){return"?"+fweb.util.uri.formatParams(search)},EmbeddedIframe.prototype.stringizeBooleanValues=function(object){return Object.keys(object).forEach(function(key){var value=object[key];"boolean"==typeof value&&(object[key]=String(value))}),object},EmbeddedIframe.prototype.updateFromIframe=inject.mark(function($scope,$location,structure,state,adminTimeout){return function(){var iframeLocation=this.getIframeLocation(),currentSearch=this.stringizeBooleanValues($location.search()),newSearch=angular.extend({},fweb.util.uri.urlParams(iframeLocation.search)),iframePath=decodeURIComponent(iframeLocation.pathname),newPath=structure.ngURI(iframePath);null!=currentSearch.vdom&&(newSearch.vdom=currentSearch.vdom),newPath===this._currentPath&&angular.equals(newSearch,currentSearch)?0===iframePath.indexOf("/ng")?this.locationChange():this._firstLoad?this._firstLoad=!1:(adminTimeout.reset(),state.checkRefresh()):$scope.$apply(function(){0!==newPath.indexOf(structure.EMBEDDED_URI_ROUTE)&&fweb.log.warn('Iframe incorrectly tried to embed "'+newPath+'". To reduce unecessary requests, use fweb.util.location.change_ng() when navigating from an embedded iframe page to an angular page.'),$location.path(newPath),$location.search(newSearch),this._fromIframe=!0}.bind(this))}}),EmbeddedIframe.prototype.locationChange=inject.mark(function($location,$routeParams,structure){return function(){var search=this.formatSearchParams($location.search()),path="/"+$routeParams.iframeSource,encodedPath=encodeURI(path);this._fromIframe?this._fromIframe=!1:(this._firstLoad=!0,this.getIframeLocation().replace(encodedPath+search),this.loading=!0),this._currentPath=structure.ngURI(path)}}),EmbeddedIframe.prototype._setupScopeListeners=inject.mark(function($scope,$location,$route,$routeParams,structure){var currentRoute;return function(){currentRoute=$route.current,$scope.$on("$locationChangeSuccess",function(){$route.current.$$route&&0===$route.current.$$route.originalPath.indexOf(structure.EMBEDDED_URI_ROUTE)&&(angular.copy($route.current.params,$routeParams),$route.current=currentRoute)}),$scope.$on("$locationChangeSuccess",function(){structure.isEmbeddedURI($location.path())&&this.locationChange()}.bind(this))}}),EmbeddedIframe.prototype._setupLoadEvents=inject.mark(function($scope,$timeout,structure){return function(){this._$iframe.on(LOAD_EVENT,function(){var contentWindow=this._$iframe[0].contentWindow,getValueAtPath=function(path){var split=path.split(".");return split.reduce(function(object,key){if(object)return object[key]},contentWindow)},runScriptDependantFunction=function(path){var attempts=0,attemptRun=function(){var fn=getValueAtPath(path);"function"==typeof fn?fn():attempts<MAX_SHORTCUT_ATTACH_ATTEMPTS?(attempts++,setTimeout(attemptRun,SHORTCUT_ATTACH_ATTEMPT_TIMEOUT)):fweb.log.warn('Failed to run function "'+path+'". Max attempt limit reached.')};attemptRun()},fileDownloadIntentionSet=function(){var result=!1;return getValueAtPath("fweb.util.uri")&&(result=contentWindow[contentWindow.fweb.util.uri.FILE_DOWNLOADING_IFRAME_FLAG]),result},removeFileDownloadIntention=function(){getValueAtPath("fweb.util.uri")&&delete contentWindow[contentWindow.fweb.util.uri.FILE_DOWNLOADING_IFRAME_FLAG]};contentWindow.jQuery&&contentWindow.jQuery("body").css({width:"1px","min-width":"100%"}),runScriptDependantFunction("fweb.util.shortcuts.listen"),runScriptDependantFunction("fweb.util.browser.startResponsiveListener"),this.updateFromIframe(),structure.notifyMessagesQueuedForIframe&&(fweb.util.location.notify_queued_notifications(),structure.notifyMessagesQueuedForIframe=!1),$scope.$apply(function(){this.loading=!1}.bind(this)),contentWindow.addEventListener("beforeunload",function(){fileDownloadIntentionSet()?removeFileDownloadIntention():$timeout(function(){this.loading=!0}.bind(this))}.bind(this))}.bind(this)),$scope.$on("$destroy",function(){if(this._$iframe.off(LOAD_EVENT),/Trident\/[567]\./.test(navigator.userAgent)){var input=document.body.appendChild(document.createElement("input"));input.focus(),input.blur(),input.parentNode.removeChild(input)}}.bind(this))}}),module.directive("fEmbeddedIframe",function(loader){return{restrict:"E",scope:!0,templateUrl:loader.base_path("/ng/structure/partials/f-embedded-iframe.html"),controllerAs:"embeddedIframe",controller:EmbeddedIframe}})}),define("ng/structure/directives/f-firmware-upgrade",["module","ng/ftnt"],function(module,ngModule){"use strict";function FirmwareUpgrade(firmwareUpgrade){this.firmwareUpgrade=firmwareUpgrade}ngModule.component("fFirmwareUpgrade",{templateUrl:function(loader){return loader.base_path("f-firmware-upgrade.html",module)},controller:FirmwareUpgrade})}),define("ng/structure/directives/f-shortcuts-help",["ng/ftnt","fweb"],function(module,fweb){"use strict";module.directive("fShortcutsHelp",function(loader){return{restrict:"E",controllerAs:"shortcutsHelp",templateUrl:loader.base_path("/ng/structure/partials/f-shortcuts-help.html"),controller:function($scope,shortcuts){var GENERAL=[[shortcuts.SHORTCUTS.NEXT,"shortcut::next"],[shortcuts.SHORTCUTS.PREVIOUS,"shortcut::previous"]].map(function(entry){return{labels:fweb.util.shortcuts.getLabels(entry[0]),help:entry[1]}}),ctrl=this;this.shortcuts=shortcuts,$scope.$watch("shortcutsHelp.shortcuts.showHelp",function(showHelp){var binded={global:GENERAL.slice(),view:[]};showHelp&&Object.keys(shortcuts._subscribed).forEach(function(shortcut){var config=shortcuts._subscribed[shortcut],result={help:config.help,labels:fweb.util.shortcuts.getLabels(shortcut)};config.global?binded.global.push(result):binded.view.push(result)}),ctrl.bindings=binded})}}})}),define("ng/structure/directives/f-fullscreen-toggle",["ng/ftnt","ng/services/injector"],function(module,inject){"use strict";function FullscreenToggle(injector){injector.injectMarked(this),this.showButton=!0,this._toggleTimeout=this.slideInFullScreenButton(INITIAL_SLIDE_IN_DELAY)}var INITIAL_SLIDE_IN_DELAY=5e3,SLIDE_IN_DELAY=500;FullscreenToggle.prototype.slideInFullScreenButton=inject.mark(function($timeout){return function(delay){return $timeout(function(){this.showButton=!1}.bind(this),delay)}}),FullscreenToggle.prototype.slideOutFullScreenButton=inject.mark(function($timeout){return function(){$timeout.cancel(this._toggleTimeout),this.showButton=!0}}),FullscreenToggle.prototype.toggleExitFullScreenButton=function(enter){enter?this.slideOutFullScreenButton():this._toggleTimeout=this.slideInFullScreenButton(SLIDE_IN_DELAY)},FullscreenToggle.prototype.closeFullscreen=inject.mark(function(structure){return function(){structure.isFullscreen=!1}}),module.component("fFullscreenToggle",{templateUrl:function(loader){return loader.cache_path("/ng/structure/partials/f-fullscreen-toggle.html")},controller:FullscreenToggle})}),define("ng/structure/directives/navbar",["angular","ng/ftnt","ng/services/injector","fweb"],function(angular,module,inject,fweb){"use strict";function Navbar($scope,$element,injector,state,navbar,navbarFavorites){injector.injectMarked(this,{$scope:$scope,$element:$element}),this.state=state,this.navbar=navbar,this.favorites=navbarFavorites,this.loading=!0,this.loadingVdom=!0,this.searchModel=null,this.favoriteSortingOptions={update:function(event,ui){navbarFavorites.updating&&ui.items.sortable.cancel()}},this.init()}Navbar.prototype.VDOM_SELECTION_CONFIG={
sources:"availableVdoms",singleSelect:!0,meta:{includeGlobal:!0},sortFunction:fweb.util.sort.vdomSort},Navbar.prototype.init=inject.mark(function($scope,$location,state,structure,navbar,navbarFavorites,shortcuts,vdomState){return function(){var previousUpdateID,that=this,updateAndSelectActive=function(changeLocation){that.loadingVdom=!0,navbar.update().then(function(){navbarFavorites.regenerate().then(function(){that.loadingVdom=!1,navbar.selectActiveEntry().then(function(){changeLocation&&$location.url(structure.ngURI(navbar.activeEntry.uri))},function(){changeLocation&&navbar.getFirstValidEntry().then(function(entry){$location.url(structure.ngURI(entry.uri))})})})})};this.vdom=this.createOmniselectValidVdom(state.current_vdom),$scope.$watch("navbarCtrl.vdom",function(vdom,previous){var updatedVdom=vdom.q_origin_key,previousVdom=previous.q_origin_key;updatedVdom!==previousVdom&&updatedVdom!==state.current_vdom&&(vdomState.setCurrent(updatedVdom),updateAndSelectActive(!0))}),$scope.$on("$locationChangeSuccess",function(){that.vdom.q_origin_key!==state.current_vdom?(that.vdom=that.createOmniselectValidVdom(state.current_vdom),updateAndSelectActive()):navbar.selectActiveEntry()}),$scope.$on(structure.ENTER_VDOM_EVENT,function(event,vdom){vdomState.setCurrent(vdom)&&updateAndSelectActive(!0)}),navbar.update().then(function(){navbarFavorites.regenerate().then(function(){that.loading=!1,that.loadingVdom=!1})}),navbar.selectActiveEntry(),$scope.$watchCollection("navbarCtrl.favorites.list",function(favorites){favorites.updateID&&favorites.updateID===previousUpdateID&&navbarFavorites.updateFromList(),previousUpdateID=favorites.updateID}),$scope.$watch("navbarCtrl.searchModel",function(value,previous){value!==previous&&navbar.update(value).then(function(){value&&navbar.indexSearchResults()})}),$scope.$on(state.UPDATE_EVENT,function(){that.loading=!0,that.loadingVdom=!0,state.$promise.then(function(){that.loading=!1,navbar.update().then(function(){navbarFavorites.regenerate().then(function(){that.loadingVdom=!1,navbar.selectActiveEntry()})})})}),shortcuts.subscribe(shortcuts.SHORTCUTS.SEARCH,function(){this.searchInputVisible=!0}.bind(this),"shortcut::nav_search",!0)}}),Navbar.prototype.createOmniselectValidVdom=inject.mark(function(lang){return function(name){var isGlobal=""===name;return{name:isGlobal?lang("global"):name,q_origin_key:name,datasource:"system.vdom","css-class":isGlobal?"fa-globe":fweb.util.formatters.vdom_icon_class(name)}}}),Navbar.prototype.clearSearch=function(){this.searchModel=null},Navbar.prototype.hideSearch=function(){this.searchInputVisible=!1},Navbar.prototype.entryClicked=inject.mark(function(navbar){return function(entry,doNavigation){entry&&(navbar.entryClicked(entry,doNavigation),this.clearSearch(),this.hideSearch())}}),Navbar.prototype.onSearchKeyDown=inject.mark(function($window,navbar,shortcuts){var that,webkitFocusFix=function(){$window.setTimeout(function(){document.activeElement.blur()})},shortcutChecker=fweb.util.shortcuts.createShortcutChecker([shortcuts.SHORTCUTS.CLEAR,shortcuts.SHORTCUTS.PREVIOUS,shortcuts.SHORTCUTS.NEXT,shortcuts.SHORTCUTS.SELECT],function(shortcut,event){switch(shortcut){case shortcuts.SHORTCUTS.CLEAR:that.searchModel?that.searchModel=null:(that.searchInputVisible=!1,webkitFocusFix());break;case shortcuts.SHORTCUTS.PREVIOUS:navbar.previousSearchResult();break;case shortcuts.SHORTCUTS.NEXT:navbar.nextSearchResult();break;case shortcuts.SHORTCUTS.SELECT:that.entryClicked(that.navbar.indexedSearchResult,!0),that.navbar.indexedSearchResult&&webkitFocusFix()}event.preventDefault()});return function(event){that=this,shortcutChecker(event)}}),module.directive("fNavbar",function(loader){return{restrict:"A",controllerAs:"navbarCtrl",templateUrl:loader.base_path("/ng/structure/partials/navbar.html"),controller:Navbar}}),module.directive("fNavbarMenu",function(loader){return{restrict:"E",scope:{menu:"=",level:"="},templateUrl:loader.base_path("/ng/structure/partials/navbar_menu.html"),bindToController:!0,controllerAs:"navbarMenuCtrl",controller:function(navbar){this.navbar=navbar}}}),module.directive("fNavbarMenuItem",function(loader){var navbarController;return{scope:{entry:"=fNavbarMenuItem"},templateUrl:loader.base_path("/ng/structure/partials/navbar_menu_item.html"),bindToController:!0,controllerAs:"menuItemCtrl",require:"^fNavbar",controller:function($scope,$element,$attrs,$timeout,navbar,navbarFavorites){var that=this;this.navbar=navbar,this.favorites=navbarFavorites,this.reorderableFavorite=null!=$attrs.reorderableFavorite,$scope.$watch(function(){return{isFavorite:navbarFavorites.isFavorite(that.entry.name),favoritesUpdating:navbarFavorites.updating,indexedResult:that.entry.name===(navbar.indexedSearchResult&&navbar.indexedSearchResult.name),reorderable:that.entry.reorderableItem,currentlyReordering:navbar.currentlyReordering}},function(result){var menuItemIcon,favoriteIcon,indexedResult=!1,currentlyReordering=!1;result.indexedResult?(indexedResult=!0,menuItemIcon="fa-arrow-right icon-sm"):result.reorderable&&result.currentlyReordering?(currentlyReordering=!0,menuItemIcon="fa-loading"):menuItemIcon=that.entry.icon,that.menuItemIcon=menuItemIcon,that.isIndexedResult=indexedResult,that.currentlyReordering=currentlyReordering,$scope.navbarCtrl.searchModel||(favoriteIcon=result.isFavorite?result.favoritesUpdating?"fa-loading always-visible":"fa-favorite":"fa-star-o"),that.favoriteIcon=favoriteIcon},!0),this.toggleFavorite=function(event){event.stopPropagation(),navbarFavorites.toggleFavorite(that.entry)},$element.on("click",function(){$scope.$apply(function(){navbarController.entryClicked(that.entry)})})},link:function(scope,element,attrs,controller){element.addClass("menu-item"),scope.navbarCtrl=navbarController=controller}}})}),define("ng/structure/services/admin_timeout",["ng/ftnt","fweb"],function(module,fweb){"use strict";function AdminTimeout($window,$rootScope,$injector){this._$window=$window,this._$rootScope=$rootScope,this._$injector=$injector,this.count=0}var TIMEOUT_DISPLAY_THRESHOLD=10,EXTEND_SESSION_URI="/api/v2/monitor/web-ui/extend-session";AdminTimeout.prototype._decrement=function(){var diff=Math.round(((new Date).getTime()-this._startTime)/1e3);this.count=this._timeoutSeconds-diff,this.count<=0?(this._$window.clearInterval(this._intervalId),this._$window.onbeforeunload=null,this._redirFn()):this.count===TIMEOUT_DISPLAY_THRESHOLD?this._slide.open("adminTimeout",{template:"<admin-timeout></admin-timeout>",options:{title:this._lang("Session Timeout").toString(),buttons:!0,okButtonLabel:this._lang("Extend Session").toString(),cancelButton:!1}}).finally(function(){this.extend(),this.reset()}.bind(this)):this.count<=TIMEOUT_DISPLAY_THRESHOLD&&this._$rootScope.$apply()},AdminTimeout.prototype.extend=function(){this._$http.get(EXTEND_SESSION_URI).then(function(){this.reset()}.bind(this))},AdminTimeout.prototype.reset=function(){this.started?(this._$window.clearInterval(this._intervalId),this._startTime=(new Date).getTime(),this._timeoutSeconds=this._timeoutPeriodSeconds,this._intervalId=this._$window.setInterval(this._decrement.bind(this),1e3)):fweb.log("Cannot reset admin timeout since it hasn't been initialized")},AdminTimeout.prototype.start=function(redirFn,timeoutPeriodSeconds){if(this.started)throw new Error("Admin timeout has already been initialized");this._redirFn=redirFn,this._timeoutPeriodSeconds=timeoutPeriodSeconds,["$http","slide","lang","loader"].forEach(function(serviceName){this["_"+serviceName]=this._$injector.get(serviceName)}.bind(this)),this._stopLocationListener=this._$rootScope.$on("$locationChangeSuccess",this.reset.bind(this)),this.started=!0,this.reset()},AdminTimeout.prototype.stop=function(){this.started&&(this._stopLocationListener(),this._$window.clearInterval(this._intervalId),this.started=!1)},module.service("adminTimeout",AdminTimeout),module.directive("adminTimeout",function(loader){return{restrict:"E",templateUrl:loader.base_path("/ng/structure/partials/timeout.html"),controller:function(adminTimeout){this.timeout=adminTimeout},controllerAs:"ctrl"}})}),define("ng/structure/services/connection",["ng/ftnt","ng/services/injector","notify","ftnt_shared"],function(module,inject,notify,ftnt_shared){"use strict";function Connection(injector){injector.injectMarked(this),this._disabled=!1,ftnt_shared.browser.isFortiExploreriOS()&&(this._disabled=!0),this._reset()}var TEST_URI="/ng",RECONNECT_ATTEMPT_INTERVAL=3e3,ONE_SECOND=1e3,TEST_REQUEST_TIMEOUT=5e3;Connection.prototype._reset=inject.mark(function($interval){return function(){this.verifyingDisconnected=!1,this.disconnected=!1,this.disconnectedDuration=0,this._disconnectedStart=0,this._lastReconnectAttempt=0,this._reconnectRequestInProgress=!1,$interval.cancel(this._intervalPromise),this._intervalPromise=null}}),Connection.prototype._now=function(){return(new Date).getTime()},Connection.prototype._attemptReconnect=inject.mark(function($injector,$window){return function(){var $http=$injector.get("$http"),lang=$injector.get("lang"),state=$injector.get("state");this._reconnectRequestInProgress=!0,$http.get(TEST_URI,{timeout:TEST_REQUEST_TIMEOUT}).then(function(){if(this.disconnected){var message=lang("connection_lost_warning",[state.model_name]).toString();this._reset(),notify.post(message,notify.LEVEL.WARNING,null,{clickToDismiss:!1,beforeDisplay:function($elem){$elem.find(".refresh-link").on("click",function(){$window.location.reload()})}})}}.bind(this),function(){this._lastReconnectAttempt=this._now(),this._reconnectRequestInProgress=!1}.bind(this))}}),Connection.prototype._countUp=inject.mark(function($interval){return function(){var eachSecond=function(){var now=this._now(),timeSinceLastReconnectAttempt=now-this._lastReconnectAttempt;this.disconnected&&(this.disconnectedDuration=now-this._disconnectedStart,!this._reconnectRequestInProgress&&timeSinceLastReconnectAttempt>RECONNECT_ATTEMPT_INTERVAL&&this._attemptReconnect())}.bind(this);this._intervalPromise=$interval(eachSecond,ONE_SECOND)}}),Connection.prototype._verify=inject.mark(function($injector){return function(){var $http=$injector.get("$http");this.verifyingDisconnected=!0,$http.get(TEST_URI,{timeout:TEST_REQUEST_TIMEOUT}).then(function(){this.verifyingDisconnected=!1}.bind(this),function(){if(this.verifyingDisconnected){var now=this._now();this.disconnected=!0,this._disconnectedStart=now,this._lastReconnectAttempt=now,this._countUp()}}.bind(this))}}),Connection.prototype.setDisconnected=function(){window!==top||this._disabled||this.verifyingDisconnected||this.disconnected||this._verify()},Connection.prototype.disableVerification=function(){this._disabled=!0,this._reset()},module.service("connection",Connection)}),define("ng/structure/services/help",["angular","ng/ftnt","jquery","fweb"],function(angular,module,$,fweb){"use strict";function Help($http,$rootScope,$location,loader,state,structure){this.$http=$http,this.$rootScope=$rootScope,this.$location=$location,this.loader=loader,this.state=state,this.structure=structure,this.helpKey=DEFAULT_HELP_KEY,this.videos=[],this.$promise=this._loadTopics(),this._startSync()}var URI="/js/help_topics.json",DEFAULT_HELP_KEY="default",DEFAULT_VIDEOS_KEY="default",SPECIAL_TOPIC_TRANSPARENT="op_mode_transparent";Help.prototype.getTrackingInfo=function(){var config=fweb.BUILD.CONFIG,version=[config.CONFIG_MAJOR_NUM,config.CONFIG_MINOR_NUM,config.CONFIG_PATCH_NUM].join(".");return{fgt_model:fweb.BUILD.PLATFORM.ABBREV,fgt_version:version,fgt_build:config.CONFIG_BUILD_NUMBER,fgt_page:this.helpKey}},Help.prototype.getHelpUrl=function(){var config=fweb.BUILD.CONFIG,version=[config.CONFIG_MAJOR_NUM,config.CONFIG_MINOR_NUM];return fweb.util.formatters.string_interpolate(this.hrefs.help,version)},Help.prototype._currentViewUrl=function(){var searchLength,path=this.structure.getAbsolutePath(),search=angular.extend({},this.$location.search());return delete search.vdom,searchLength=Object.keys(search).length,path+(searchLength?"?"+$.param(search):"")},Help.prototype._getSpecialTopicKey=function(){var currentVdom=this.state.current_vdom,vdomInfo=this.state.admin.vdom_info,transparentMode=currentVdom&&vdomInfo[currentVdom].transparent_mode;return transparentMode?SPECIAL_TOPIC_TRANSPARENT:null},Help.prototype._getVideos=function(helpKey){var MAX_CYCLES=50,get=function(key,cycle){var topic=this.topics[key],videos=topic&&topic.videos;if(null!=videos){if("string"==typeof videos){if(0===cycle)throw new Error('Unable to find videos for "'+helpKey+'". Cycle detected after '+MAX_CYCLES+" references followed");return get(videos,cycle-1)}return videos[this.state.language_code]||[]}throw new Error('Unable to find videos for "'+helpKey+'". Last topic: "'+key+'", references followed: '+(MAX_CYCLES-cycle)+".")}.bind(this),videos=[],topic=this.topics[helpKey];return topic&&topic.videos&&(videos=get(helpKey,MAX_CYCLES)),videos},Help.prototype._update=function(){var viewUrl=this._currentViewUrl(),specialTopicKey=this._getSpecialTopicKey();this.$promise.then(function(){var longestMatchKey=DEFAULT_HELP_KEY,longestVideosMatchKey=DEFAULT_VIDEOS_KEY,longestMatch=0;Object.keys(this.topics).forEach(function(key){var topic=this.topics[key],specialTopics=topic.special_topics,matchLength=topic.max_match_length(viewUrl);matchLength>longestMatch&&(longestMatch=matchLength,longestMatchKey=specialTopics&&specialTopics&&specialTopics[specialTopicKey]||key,topic.videos&&(longestVideosMatchKey=key))}.bind(this)),this.helpKey=longestMatchKey,this.videos=this._getVideos(longestVideosMatchKey)}.bind(this))},Help.prototype._startSync=function(){"/"!==this.$location.path()&&this._update(),this.$rootScope.$on("$locationChangeSuccess",function(){this._update()}.bind(this))},Help.prototype._loadTopics=function(){var comparePathLength=function(p1,p2){return p2.length-p1.length},maxMatchLength=function(path){for(var i=0,result="";!result&&i<this.paths.length;)this.path_expressions[i].test(path)&&(result=this.paths[i]),i++;return result.length};return this.$http.get(this.loader.base_path(URI)).then(function(results){var data=results.data;return Object.keys(data.topics).forEach(function(key){var topic=data.topics[key];topic.paths.sort(comparePathLength),topic.path_expressions=topic.paths.map(fweb.util.uri.makeExpression),topic.max_match_length=maxMatchLength}),this.hrefs=data.hrefs,this.topics=data.topics,this}.bind(this))},module.service("help",Help)}),define("ng/structure/services/firmware_upgrade",["module","ng/ftnt","ng/services/injector","fweb","notify"],function(module,ngModule,inject,fweb,notify){"use strict";function FirmwareUpgrade(injector){injector.injectMarked(this),this.cancel()}var CONFIG_BACKUP_URI="/api/v2/monitor/system/config/backup?scope=global",FIRMWARE_UPLOAD_URI="/api/v2/monitor/system/firmware/upgrade",MINIMUM_WAIT_FOR_BACKUP=3e3;FirmwareUpgrade.prototype.STEPS={CONFIRM:"confirm",BACKUP_CONFIG:"backupConfig",RUN_UPGRADE:"runUpgrade"},FirmwareUpgrade.prototype.startUpgrade=function(image,backupConfig,redirectImage){var steps=[this.STEPS.CONFIRM];this.image=image,this.redirectImage=redirectImage,this.downgrade=this.image.olderThanCurrent,backupConfig&&steps.push(this.STEPS.BACKUP_CONFIG),steps.push(this.STEPS.RUN_UPGRADE),this.steps=steps,this.running=!0,this.nextStep()},FirmwareUpgrade.prototype.cancel=function(){this.running=!1,this.steps=null,this.currentStep=null,this.uploadPercentage=0,this.uploadComplete=!1,this.image=null,this.redirectImage=null},FirmwareUpgrade.prototype._delayedPromise=inject.mark(function($q,$timeout){return function(delay){var deferred=$q.defer();return $timeout(function(){deferred.resolve()},delay),deferred.promise}}),FirmwareUpgrade.prototype._backupConfig=inject.mark(function($q){return function(){$q.all([fweb.util.uri.downloadFile(CONFIG_BACKUP_URI),this._delayedPromise(MINIMUM_WAIT_FOR_BACKUP)]).then(function(){this.nextStep()}.bind(this))}}),FirmwareUpgrade.prototype._sendRequest=inject.mark(function($q,$rootScope){return function(progressCallback){var deferred=$q.defer(),formData=new FormData,xhr=new XMLHttpRequest,onError=function(error){$rootScope.$apply(function(){deferred.reject(error)})};return xhr.addEventListener("load",function(){var response;xhr.readyState===XMLHttpRequest.DONE&&200===xhr.status?(response=JSON.parse(xhr.response),"success"===response.results.status?$rootScope.$apply(function(){deferred.resolve()}):onError(response.results.error)):onError()}),xhr.addEventListener("error",function(){onError()}),xhr.upload.addEventListener("load",function(){$rootScope.$apply(function(){progressCallback(100)})}),xhr.upload.addEventListener("progress",function(event){event.lengthComputable&&$rootScope.$apply(function(){progressCallback(100*(event.loaded/event.total))})}),xhr.open("POST",FIRMWARE_UPLOAD_URI),xhr.setRequestHeader("X-CSRFTOKEN",fweb.util.persist.getCsrfToken()),formData.append("source",this.image.source),"upload"===this.image.source?formData.append("upload_file",this.image.localFile):formData.append("filename",this.image.id),xhr.send(formData),deferred.promise}}),FirmwareUpgrade.prototype._runUpgrade=inject.mark(function($http,$location,lang){return function(){var onError=function(){var message=this.downgrade?"Image downgrade failed":"Image upgrade failed";notify.post(lang(message).toString(),notify.LEVEL.ERROR),this.cancel()}.bind(this),onProgress=function(percent){this.uploadPercentage=percent,100===percent&&(this.uploadComplete=!0)}.bind(this);"upload"!==this.image.source&&(this.uploadComplete=!0),this._sendRequest(onProgress).then(function(){var search={viewOnly:!0};this.redirectImage&&(search.redir="/ng/system/firmware?id="+this.redirectImage.id),$location.path("/prompt/reboot").search(search),this.cancel()}.bind(this),function(){onError()})}}),FirmwareUpgrade.prototype.nextStep=function(){switch(this.currentStep=this.steps[0],this.steps=this.steps.slice(1),this.currentStep){case this.STEPS.BACKUP_CONFIG:this._backupConfig();break;case this.STEPS.RUN_UPGRADE:this._runUpgrade()}},ngModule.service("firmwareUpgrade",FirmwareUpgrade)}),define("ng/structure/services/navbar",["angular","ng/ftnt","ng/services/injector","ng/services/loader","fweb","ftnt_shared","notify"],function(angular,module,inject,loader,fweb,ftnt_shared,notify){"use strict";function Navbar($cacheFactory,$rootScope,$q,injector,state){injector.injectMarked(this),this._suppressedCache=$cacheFactory(SUPPRESSED_CACHE),this._initialDeferred=$q.defer(),this.promise=this._initialDeferred.promise,$rootScope.$on(state.UPDATE_EVENT,function(){this._suppressedCache.removeAll()}.bind(this))}function NavbarDependencies($cacheFactory,$rootScope,injector,state){injector.injectMarked(this),this._dependenciesCache=$cacheFactory(NAVBAR_DEPEDENCIES_CACHE),$rootScope.$on(state.UPDATE_EVENT,function(){this._dependenciesCache.removeAll()}.bind(this))}var PLATFORM_URI=loader.base_path("js/navbar_platform_config.json"),SUPPRESSED_URI="/api/v2/monitor/web-ui/suppressed-menus",DEPENDENCIES_URI="/api/v2/monitor/web-ui/navbar-dependencies",SUPPRESSED_CACHE="navbarSuppressedMenus2",NAVBAR_DEPEDENCIES_CACHE="navbarDependencies",DASHBOARD_URI="/ng/system/dashboard/",DEFAULT_DASHBOARD_URI="/ng/system/default-dashboard/",RESPONSIVE_DASHBOARD_ICON="ftnt-responsive",FIXED_DASHBOARD_ICON="fa-television",EMPTY_IP="0.0.0.0";Navbar.prototype.update=inject.mark(function($q,navbarDependencies){return function(searchValue){return this._clearSearchIndexing(),this.promise=$q.all([this._getPlatformStructure(),this._getSuppressed(),this._getDashboards(),navbarDependencies.update()]).then(function(){this._searchValue=searchValue?searchValue.toLowerCase():null,this._buildTree(),this._initialDeferred.resolve()}.bind(this))}}),Navbar.prototype.getFirstValidEntry=inject.mark(function($q,navbarFavorites){return function(){return this.promise.then(function(){return navbarFavorites.regenerateIfNecessary().then(function(){var first;return this.leafNodes.length?first=navbarFavorites.list.length?navbarFavorites.list[0]:this.leafNodes[0]:fweb.log.warn("Navbar has no valid entries"),first?first:$q.reject()}.bind(this))}.bind(this))}}),Navbar.prototype.selectActiveEntry=inject.mark(function($q,$location,structure,navbarFavorites){return function(){var bestMatchEntry,bestMatchLength=0,currentPath=structure.getAbsolutePath(),currentSearch=$location.search(),currentURI=$location.url(),allQueryParamsInSearch=function(search){return!search||Object.keys(search).every(function(key){return search[key]===currentSearch[key]})},locationMatchesCurrent=function(path,search){return fweb.util.uri.makeExpression(path).test(currentPath)&&allQueryParamsInSearch(search)},updateBestMatch=function(entry){var length=entry.uri.length;locationMatchesCurrent(entry.path,entry.search)&&length>bestMatchLength&&(bestMatchEntry=entry,bestMatchLength=length),entry.related&&entry.related.forEach(function(path){length=path.length,locationMatchesCurrent(path)&&length>bestMatchLength&&(bestMatchEntry=entry,bestMatchLength=length)})};return this.promise.then(function(){return this.leafNodes.forEach(updateBestMatch),navbarFavorites.regenerateIfNecessary().then(function(){return bestMatchEntry?(this.activeEntry=bestMatchEntry,this.active=bestMatchEntry.name,this.expanded!==bestMatchEntry.outermostParent&&navbarFavorites.isFavorite(bestMatchEntry.name)?this.expanded=this.FAVORITE_MENU_NAME:this.expanded=bestMatchEntry.outermostParent,void 0):(this.activeEntry=void 0,this.active=void 0,fweb.log('Could not match location in navbar "'+currentURI+'"'),$q.reject())}.bind(this))}.bind(this))}}),Navbar.prototype.isExpanded=function(name){return this.expanded===name||this._searchValue},Navbar.prototype.isSelected=function(entry){return entry.uri&&entry.name===this.active},Navbar.prototype.entryClicked=inject.mark(function($route,$routeSegment,$rootScope,$location,structure){return function(entry,doNavigation){var toExpand;entry&&entry.uri?(this.isSelected(entry)?entry.path===structure.getAbsolutePath()&&($route.current.$$route.segment?$routeSegment.chain[$routeSegment.chain.length-1].reload():$route.reload()):doNavigation&&$location.url(structure.ngURI(entry.uri)),structure.responsiveMenu=!1,this._clearSearchIndexing()):(toExpand=entry?entry.name:this.FAVORITE_MENU_NAME,toExpand===this.expanded?this.expanded=void 0:this.expanded=toExpand)}}),Navbar.prototype.isPathAvailable=function(path){return this.promise.then(function(){return this.leafNodes.some(function(entry){return entry.uri===path||(entry.related||[]).some(function(relatedPath){return relatedPath===path})})}.bind(this))},Navbar.prototype.indexSearchResults=function(){this._searchIndex=0,this.indexedSearchResult=this.leafNodes.length?this.leafNodes[0]:null},Navbar.prototype.previousSearchResult=function(){var length=this.leafNodes.length;length&&(this._searchIndex--,this._searchIndex<0&&(this._searchIndex=length-1),this.indexedSearchResult=this.leafNodes[this._searchIndex])},Navbar.prototype.nextSearchResult=function(){var length=this.leafNodes.length;length&&(this._searchIndex++,this._searchIndex>length-1&&(this._searchIndex=0),this.indexedSearchResult=this.leafNodes[this._searchIndex])},Navbar.prototype.FAVORITE_MENU_NAME="favorites",Navbar.prototype.SUPPRESSED_CHECK=inject.mark(function(state,navbarDependencies){var symbols=fweb.BUILD.SYMBOLS,platform=fweb.BUILD.PLATFORM;return{csf_enabled:function(){return state.csf_enabled},csf_is_root_fortigate:function(){return!state.csf_enabled||state.csf_upstream_ip===EMPTY_IP},central_nat_enabled:function(){return state.centralNatEnabled()},operation_mode:function(){return state.getOperationMode()},inspection_mode:function(){return state.getInspectionMode()},has_virtual_wire_pair:function(){var vdom=state.getOperatingVDOM();return state.admin.vdom_info[vdom].virtual_wire_pair_count>0},has_vpn_reporting:function(){return state.featureEnabled("gui-vpn")&&(state.getOperationMode()===state.OPERATION_MODE.NAT||state.featureEnabled("gui-policy-based-ipsec"))},show_mt_advanced:function(){return!state.vdom_mode||""===state.current_vdom||state.compliance_check},wireless_mode_wtp:function(){return navbarDependencies.wifi&&navbarDependencies.wifi.wireless_mode===symbols.WIRELESS_MODE_WTP},have_managed_aps:function(){return navbarDependencies.wifi&&navbarDependencies.wifi.have_managed_aps},is_client_wireless_mode:function(){return!platform.HAVE_CAPWAP_WTP||navbarDependencies.wifi&&navbarDependencies.wifi.wireless_mode===symbols.WIRELESS_MODE_CLIENT},is_local_radio_vdom_current:function(){return!state.vdom_mode||navbarDependencies.wifi&&navbarDependencies.wifi.local_radio_vdom===state.current_vdom},full_capwap_wtp_support:function(){return platform.HAVE_CAPWAP_AC&&navbarDependencies.wifi&&navbarDependencies.wifi.full_capwap_wtp_support},disk_based_fortiview_supported:function(){return state.disk_based_fortiview_supported},has_pki_users:function(){return navbarDependencies.has_pki_users},vdom_only:function(){return!state.vdom_mode||""!==state.current_vdom},ngfw_policy_mode:function(){return state.isNgfwPolicyMode()},ngfw_policy_mode_or_central_nat_enabled:function(){return state.centralNatEnabled()||state.isNgfwPolicyMode()}}}),Navbar.prototype._clearSearchIndexing=function(){this._searchIndex=null,this.indexedSearchResult=null},Navbar.prototype._getSuppressed=inject.mark(function($http,state){return function(){var params={};return""===state.current_vdom?params.global_vdom=!0:params.vdom=state.current_vdom,$http.get(SUPPRESSED_URI,{params:params,cache:this._suppressedCache}).then(function(response){var results=response.data.results;this._suppressed=angular.extend(results.perm,results.runtime)}.bind(this))}}),Navbar.prototype._DASHBOARDS_URI=inject.mark(function(state){return"/api/v2/cmdb/system/admin/"+encodeURIComponent(state.admin.name)+"/gui-dashboard"}),Navbar.prototype._getDashboards=inject.mark(function($q,$http,state){return function(){var promise=$q.resolve([]);return state.adminHasReadPermission(state.ACCESS_GROUP.SYSTEM)&&(promise=$http.get(this._DASHBOARDS_URI).then(function(response){return response.data.results})),promise.then(function(results){var map={};this._dashboards=results,this._dashboards.forEach(function(dashboard){map[dashboard.id]=dashboard}),this._dashboardMap=map}.bind(this))}}),Navbar.prototype._moveDashboard=inject.mark(function($http){return function(dashboard,beforeDashboard){return $http.put(this._DASHBOARDS_URI+"/"+dashboard.id,null,{params:{action:"move",before:beforeDashboard.id}})}}),Navbar.prototype._getPlatformStructure=inject.mark(function($http){var promise;return function(){return promise||(promise=$http.get(PLATFORM_URI).then(function(response){this._platformStructure=response.data}.bind(this))),promise}}),Navbar.prototype._featuresEnabled=inject.mark(function(state){return function(features){return Object.keys(features).every(function(feature){return state.featureEnabled(feature)===features[feature]}.bind(this))}}),Navbar.prototype._isSuppressed=function(entry){function checkRuntimeDeps(runtime){return!Object.keys(runtime).every(function(key){var checkFunction,value=runtime[key];if("features"===key)return that._featuresEnabled(value);if(checkFunction=that.SUPPRESSED_CHECK[key],!checkFunction)throw new Error('No runtime dependency check function exists for "'+key+'"');return checkFunction()===value})}var that=this,suppressed=entry.name&&this._suppressed[entry.name];if(!suppressed&&entry.deps){if(entry.deps.runtime)return checkRuntimeDeps(entry.deps.runtime);if(entry.deps.runtimeOneOf)return entry.deps.runtimeOneOf.every(function(runtime){return checkRuntimeDeps(runtime)})}return suppressed},Navbar.prototype._isFilteredOut=function(entry,label){var filteredOut=!1;return label&&this._searchValue&&entry.uri&&(filteredOut=label.toLowerCase().indexOf(this._searchValue)<0),filteredOut},Navbar.prototype.DEFAULT_DASHBOARD_NAME=inject.mark(function(lang){return lang("Main").toString()}),Navbar.prototype._generateDashboardItems=inject.mark(function(state){return function(entry){var suppressedCount=0,items=[],createItem=function(id,label,uri,icon,suppressed,temporary){return{name:entry.name+"_"+id,id:id,label:label,path:uri,uri:uri,icon:icon,suppressed:suppressed,temporary:temporary}},isSuppressed=function(dashboard){var wrongFormFactor="fixed"===dashboard["layout-type"]&&fweb.util.browser.responsive.isSmall(),wrongScope=dashboard.scope!==state.getCurrentVDOMScope(),suppressed=wrongFormFactor||wrongScope;return suppressed&&suppressedCount++,suppressed};return this._dashboards.length&&(items=items.concat(this._dashboards.map(function(dashboard){return createItem(dashboard.id,dashboard.name,DASHBOARD_URI+dashboard.id,"responsive"===dashboard["layout-type"]?RESPONSIVE_DASHBOARD_ICON:FIXED_DASHBOARD_ICON,isSuppressed(dashboard))}.bind(this)))),items.length===suppressedCount&&items.push(createItem(-1,this.DEFAULT_DASHBOARD_NAME,DEFAULT_DASHBOARD_URI+this.DEFAULT_DASHBOARD_NAME,RESPONSIVE_DASHBOARD_ICON,!state.adminHasReadPermission(state.ACCESS_GROUP.SYSTEM),!0)),items}}),Navbar.prototype._generateDynamicItems=function(entry){var items;if("dashboard"!==entry.name)throw new Error('Dynamic menu items unsupported for "'+entry.name+'"');return items=this._generateDashboardItems(entry)},Navbar.prototype._reorderDashboards=inject.mark(function(){return function(entry,originalItems,relativeTo,relativeFrom){var toDashboard=originalItems[relativeTo],fromDashboard=originalItems[relativeFrom];return this._moveDashboard(fromDashboard,toDashboard)}}),Navbar.prototype._reorderMenuItems=inject.mark(function($http,$q){return function(entry,originalItems,to,from){return"dashboard"===entry.name?this._reorderDashboards(entry,originalItems,to,from):(fweb.log.error('Reordering menu items unsupported for "'+entry.name+'"'),$q.reject())}}),Navbar.prototype._createSortableOptions=inject.mark(function($timeout,lang){return function(node,isReorderable){var from,originalItems=isReorderable?node.items.slice():null;return{disabled:!isReorderable,start:function(evt,ui){from=ui.item.index()},update:function(event,ui){this._currentlyReordering?ui.items.sortable.cancel():$timeout(function(){var to=ui.item.index();this._reorderMenuItems(node,originalItems,to,from).catch(function(){var msg=lang("Failed to save changes").toString();notify.post(msg,notify.LEVEL.ERROR)}).finally(function(){originalItems=node.items.slice(),this.currentlyReordering=!1}.bind(this))}.bind(this))}.bind(this)}}}),Navbar.prototype._buildTree=inject.mark(function($http,$sce,lang){return function(){var leafNodes=[],leafNodeMapping={},possibleLeafNodeMapping={},build=function(entry,parentMenu,outermostParentMenu){var label,favoriteLabel,result,node,childResult,i,items,leafNode=!(!entry.name||!entry.uri),hasIncludedLeafNode=!1;entry.dynamicItem?label=entry.label:(label=entry.name?lang(entry.lang||entry.name).toString():null,favoriteLabel=entry.favoriteLang?lang(entry.favoriteLang):null);var htmlLabel=label,suppressed=entry.dynamicItem?entry.suppressed:this._isSuppressed(entry),filteredOut=this._isFilteredOut(entry,label),shouldInclude=!suppressed&&!filteredOut,reorderable=entry.dynamicItems&&entry.reorderableItems;if(outermostParentMenu=outermostParentMenu?outermostParentMenu:entry.name,entry.dynamicItems&&(entry.items=this._generateDynamicItems(entry),entry.items&&entry.items.forEach(function(item){item.dynamicItem=!0,item.reorderableItem=reorderable})),entry.items)for(items=[],i=0;i<entry.items.length;i++)childResult=build(entry.items[i],entry.name,outermostParentMenu),childResult&&(items.push(childResult),hasIncludedLeafNode=!0);return this._searchValue&&shouldInclude&&leafNode&&(htmlLabel=ftnt_shared.highlighter.highlightMatchesInHTML(label,this._searchValue,!0),htmlLabel=$sce.trustAsHtml(htmlLabel)),node={name:entry.name,favoriteLabel:favoriteLabel,id:entry.id,related:entry.related,icon:entry.icon,label:label,htmlLabel:htmlLabel,path:entry.path,params:entry.params,uri:entry.uri,parent:parentMenu,outermostParent:outermostParentMenu,items:items,suppressed:suppressed,filteredOut:filteredOut,showLabel:entry.showLabel,reorderableItem:entry.reorderableItem,
temporary:entry.temporary},node.sortableOptions=this._createSortableOptions(node,reorderable),leafNode&&(possibleLeafNodeMapping[node.name]=node),shouldInclude&&(leafNode||hasIncludedLeafNode)&&(result=node,leafNode&&(leafNodes.push(node),leafNodeMapping[node.name]=node)),result}.bind(this);this.tree=build(this._platformStructure),this.leafNodes=leafNodes,this.leafNodeMapping=leafNodeMapping,this.possibleLeafNodeMapping=possibleLeafNodeMapping}}),NavbarDependencies.prototype.update=inject.mark(function($http){return function(){return $http.get(DEPENDENCIES_URI,{cache:this._dependenciesCache}).then(function(response){angular.extend(this,response.data.results||{})}.bind(this),angular.noop)}}),module.service("navbar",Navbar),module.service("navbarDependencies",NavbarDependencies)}),define("ng/structure/services/navbar_favorites",["angular","ng/ftnt","ng/services/injector","fweb","notify"],function(angular,module,inject,fweb,notify){"use strict";function NavbarFavorites(injector){injector.injectMarked(this),this._cache={},this.list=[],this.map={},this.updating=!1,this._updateID=0}var URI="/api/v2/monitor/system/navigation-favorites",FORTIVIEW_MENU_NAME="fortiview",DASHBOARD_MENU_NAME="dashboard",FORTIVIEW_SUBMENU_NAMES={fortiview_topology:"FortiView {0}",fortiview_traffic_lan_dmz:"FortiView LAN/DMZ {0}",fortiview_traffic_wan:"FortiView WAN {0}",fortiview_all_segments:"FortiView {0}"},LOG_SUBMENU_NAMES=["log_access_traffic","log_access_event","log_access_utm"],ERROR_MSG="Failed to update favorites";NavbarFavorites.prototype._getCurrentKey=inject.mark(function(state){return function(){return""===state.current_vdom?"global":"vdom"}}),NavbarFavorites.prototype._getForCurrent=inject.mark(function($q,$http){return function(){var key=this._getCurrentKey(),deferred=$q.defer(),resolveFromCache=function(){deferred.resolve(this._cache[key])}.bind(this);return this._cache[key]?resolveFromCache():$http.get(URI,{params:{type:key}}).then(function(response){this._cache[key]=response.data.results,resolveFromCache()}.bind(this)),deferred.promise}}),NavbarFavorites.prototype._updateForCurrent=inject.mark(function($injector,$http,$q){return function(){var navbar=$injector.get("navbar"),key=this._getCurrentKey();return $http.post(URI+"/update",{type:key,favorites:this._cache[key].filter(function(name){var node=navbar.possibleLeafNodeMapping[name];return node||fweb.log.warn('Not persisting invalid favorite menu entry "'+name+'"'),node})}).then(function(response){if(!response.data.results.success)return $q.reject()})}}),NavbarFavorites.prototype.regenerate=inject.mark(function($injector,lang){return function(){var navbar=$injector.get("navbar"),overrideLabel=function(entry){var label=entry.favoriteLabel||entry.label;entry.outermostParent===FORTIVIEW_MENU_NAME?label=lang(FORTIVIEW_SUBMENU_NAMES[entry.parent],[entry.label]).toString():entry.outermostParent===DASHBOARD_MENU_NAME?label=lang("{0} dashboard",[entry.label]).toString():LOG_SUBMENU_NAMES.indexOf(entry.parent)>=0&&(label=lang("{0} Log",[entry.label]).toString()),entry.label=entry.htmlLabel=label}.bind(this);return this.promise=this._getForCurrent().then(function(results){var list=[],map={};results.forEach(function(name){var entry=angular.copy(navbar.possibleLeafNodeMapping[name]);entry&&!entry.suppressed?(overrideLabel(entry),list.push(entry),map[entry.name]=entry):fweb.log.info('Ignoring hidden/invalid favorite menu entry " '+name+'"')}.bind(this)),list.updateID=++this._updateID,this.list=list,this.map=map}.bind(this))}}),NavbarFavorites.prototype.regenerateIfNecessary=function(navbarSuppressed){return this.promise?this.promise:this.regenerate(navbarSuppressed)},NavbarFavorites.prototype.isFavorite=function(name){return!!this.map[name]},NavbarFavorites.prototype.addFavorite=inject.mark(function($q){return function(name){var key;return this.updating?$q.resolve():(key=this._getCurrentKey(),this._cache[key].push(name),this.updating=!0,this._updateForCurrent().then(function(){return this.regenerate()}.bind(this)).finally(function(){this.updating=!1}.bind(this)))}}),NavbarFavorites.prototype.removeFavorite=inject.mark(function($q){return function(name){var key,cache;return this.updating?$q.resolve():(key=this._getCurrentKey(),cache=this._cache[key],cache.splice(cache.indexOf(name),1),this.updating=!0,this._updateForCurrent().then(function(){return this.regenerate()}.bind(this)).finally(function(){this.updating=!1}.bind(this)))}}),NavbarFavorites.prototype.toggleFavorite=inject.mark(function($injector,lang){return function(menu){var promise,name=menu.name,isFavorite=this.isFavorite(name);return promise=isFavorite?this.removeFavorite(name):this.addFavorite(name),promise.catch(function(){notify.post(lang(ERROR_MSG).toString(),"error")})}}),NavbarFavorites.prototype.updateFromList=inject.mark(function(lang){return function(){var key=this._getCurrentKey(),visible=this.list.map(function(menu){return menu.name}),hidden=this._cache[key].filter(function(name){return!this.map[name]}.bind(this));return this._cache[key]=visible.concat(hidden),this.updating=!0,this._updateForCurrent().then(function(){this.updating=!1}.bind(this),function(){this.updating=!1,notify.post(lang(ERROR_MSG).toString(),"error")}.bind(this))}}),module.service("navbarFavorites",NavbarFavorites)}),define("ng/structure/services/shortcuts",["ng/ftnt","fweb.util/shortcuts"],function(module,fweb_shortcuts){"use strict";function Shortcuts($rootScope){this._subscribed={},this.showHelp=!1,this.subscribe(this.SHORTCUTS.CLEAR,function(){this.showHelp?this.showHelp=!1:Sliderin.closeLast()}.bind(this),"shortcut::clear",!0),$rootScope.$on("$locationChangeSuccess",function(){Object.keys(this._subscribed).forEach(function(shortcut){var config=this._subscribed[shortcut];config.global||delete this._subscribed[shortcut]}.bind(this))}.bind(this))}Shortcuts.prototype.SHORTCUTS=fweb_shortcuts.SHORTCUTS,Shortcuts.prototype.subscribe=function(shortcut,callback,help,global){this._subscribed[shortcut]={callback:callback,help:help,global:global}},Shortcuts.prototype.trigger=function(shortcut){var config=this._subscribed[shortcut];config&&config.callback()},module.service("shortcuts",Shortcuts)}),define("ng/structure/services/usb_disk",["angular","ng/ftnt","fweb","ng/services/injector"],function(angular,module,fweb,inject){"use strict";function USBDisk(injector){injector.injectMarked(this),this.data={},this.isDiskModel=fweb.BUILD.PLATFORM.CONFIG_RESERVE_LOG_DISK,this.copyInProgress=!1,this.copyDestination=null,this._pendingUpdate=!1,this.copyDoneNotified=!1}var USBDISK_URI="/api/v2/monitor/system/usb-log",INTERVAL={NORMAL:5e3,COPYING:1e3},LOG_USB_NOT_SUPPORTED="USB is not supported.";USBDisk.prototype.start=inject.mark(function($http,$timeout){return function(){var that=this;this.stopped=!1;var pollFn=function(){fweb.BUILD.PLATFORM.HAVE_USB?$http.get(USBDISK_URI).then(function(obj){that._pendingUpdate||(angular.extend(that.data,obj.data.results),that.data.usb_attached||(that.copyInProgress=!1),that.data.is_copying||that.copyInProgress&&(that.copyDoneNotified=!0,$timeout(function(){that.copyDoneNotified=!1},5e3),that.copyInProgress=!1,that.data.progress=0))}).finally(function(){var interval=that.copyInProgress?INTERVAL.COPYING:INTERVAL.NORMAL;that.stopped||(that.timeoutPromise=$timeout(pollFn,interval))}):fweb.log.warn(LOG_USB_NOT_SUPPORTED)};pollFn()}}),USBDisk.prototype.stop=inject.mark(function($timeout){return function(){$timeout.cancel(this.timeoutPromise),this.stopped=!0}}),USBDisk.prototype.isVisible=function(){return fweb.BUILD.PLATFORM.HAVE_USB&&this.data.usb_attached},USBDisk.prototype.copyEnabled=inject.mark(function(state,$rootScope){return function(){return!$rootScope.ADMIN_RO&&!this.data.is_copying&&this.data.log_size>0&&this.data.avail_space>=this.data.log_size&&""!==state.current_vdom&&state.disk_based_fortiview_supported&&this.isDiskModel}}),USBDisk.prototype.stopEnabled=inject.mark(function($rootScope){return function(){return!$rootScope.ADMIN_RO&&this.data.is_copying&&this.data.same_vdom}}),USBDisk.prototype.isInsufficientSpace=function(){return this.data.avail_space<this.data.log_size},USBDisk.prototype.startCopy=inject.mark(function($http){return function(){fweb.BUILD.PLATFORM.HAVE_USB?(this._pendingUpdate=!0,$http.post(USBDISK_URI+"/start").then(function(response){this.data.is_copying=!0,this.data.progress=0,this.copyDestination=response.data.results.backup_to,this.copyInProgress=!0}.bind(this),function(){fweb.log("Failed to start log backup")}).finally(function(){this._pendingUpdate=!1}.bind(this))):fweb.log.warn(LOG_USB_NOT_SUPPORTED)}}),USBDisk.prototype.stopCopy=inject.mark(function($http){return function(){fweb.BUILD.PLATFORM.HAVE_USB?(this._pendingUpdate=!0,$http.post(USBDISK_URI+"/stop").then(function(response){0===response.data.results.ret&&(this.copyInProgress=!1,this.data.is_copying=!1)}.bind(this),function(){fweb.log("Failed to stop log backup")}).finally(function(){this._pendingUpdate=!1}.bind(this))):fweb.log.warn(LOG_USB_NOT_SUPPORTED)}}),module.service("usbDisk",USBDisk)}),define("ng/prompt/controllers",["ng/ftnt","../services/ensure_dcsrf"],function(module){"use strict";module.controller("PromptIndex",function(prompt,ensureDCSRF){ensureDCSRF(),prompt.next()})}),define("ng/prompt/reboot/system-reboot",["ng/ftnt","ng/services/injector","fweb"],function(module,inject,fweb){"use strict";function SystemReboot(injector,lang){injector.injectMarked(this),this.title=lang("System rebooting").toString(),this.message=lang("Please wait while the system reboots.").toString(),this.loading=!0,this.reboot()}SystemReboot.prototype={reboot:inject.mark(function($window,$location,adminTimeout,notification,rebootService,usbDisk){return function(){rebootService.monitor(function(){usbDisk.stop(),adminTimeout.stop(),notification.stop()},"/ng").then(function(){var redir=$location.search().redir,uri="/login";redir&&(uri+="?redir="+encodeURIComponent(redir)),$window.location.href=uri},function(error){var message;"timeout-down"===error?message="reboot_system_down_too_long":"timeout-up"===error&&(message="reboot_system_up_too_long"),this.errorMessage=message}.bind(this))}})},module.component("systemReboot",{controller:SystemReboot,templateUrl:fweb.util.uri.cachePath("/ng/prompt/partials/power_prompt.html")})}),define("ng/prompt/shutdown/system-shutdown",["ng/ftnt","fweb"],function(module,fweb){"use strict";function SystemShutdown(lang){this.message=lang("System is shutting down. You may now close this window.").toString(),this.loading=!1}module.component("systemShutdown",{controller:SystemShutdown,templateUrl:fweb.util.uri.cachePath("/ng/prompt/partials/power_prompt.html")})}),define("ng/prompt/default-password/f-default-password-prompt",["angular","module","ng/services/injector"],function(angular,module,inject){"use strict";function DefaultPassword($scope,injector){injector.injectMarked(this,{$scope:$scope})}DefaultPassword.prototype.changePassword=function(){this.showPasswordChange=!0},DefaultPassword.prototype.continue=inject.mark(function(prompt){return function(){prompt.next()}}),DefaultPassword.prototype.changeSuccess=inject.mark(function(prompt){return function(){this.successMessage="Administrator password changed",prompt.logout()}}),DefaultPassword.prototype.changeFailure=function(message){this.errorMessage=message};var fDefaultPasswordPrompt={controller:DefaultPassword,templateUrl:function(loader){return loader.base_path("f-default-password-prompt.html",module)}};return function(providers){providers.$compile.component("fDefaultPasswordPrompt",fDefaultPasswordPrompt)}}),define("ng/prompt/vm-license/f-vm-license-prompt",["angular","module","fweb"],function(angular,module,fweb){"use strict";function VmLicensePrompt($scope,$http,$window,$interval,prompt,state){this.updateExecuted=!1,this.timeoutCounter=0,this.showCliConsole=function(){return this.errorMessage===TIMEOUT_MESSAGE},this.cancelInterval=function(){this.statusInterval&&$interval.cancel(this.statusInterval)},this.errorHandler=function(errorMessage){this.errorMessage=errorMessage,this.cancelInterval()},this.execUpdateNow=function(){this.updateExecuted=!0,$http.post(FTGD_UPDATE_API).then(angular.noop,function(){this.errorHandler(FAILED_MESSAGE)}.bind(this))},this.statusInterval=$interval(function(){this.updateExecuted||state.vmlicense_status!==STATUSES.LICENSE_STATUS_VM_STARTUP||this.execUpdateNow(),this.timeoutCounter===REQUEST_TIMEOUT?this.errorMessage=TIMEOUT_MESSAGE:this.timeoutCounter+=REQUEST_INTERVAL,$http.get(VM_LICENSE_STATUS_API).then(function(response){var status=response.data.results.vm.status;"error"===VM_STATUS_LEVEL[status]?this.errorHandler(VM_LICENSE_STATUS_LANGKEY+status):"success"===VM_STATUS_LEVEL[status]&&prompt.next()}.bind(this),function(){this.errorHandler(FAILED_MESSAGE)}.bind(this))}.bind(this),REQUEST_INTERVAL),$scope.$on("$destroy",function(){this.cancelInterval()}.bind(this)),this.cliConsole=function(){fweb.util.structure.openCli()}}var MONITOR_API_BASE="/api/v2/monitor/",VM_LICENSE_STATUS_API=MONITOR_API_BASE+"license/status",VM_LICENSE_STATUS_LANGKEY="VM::License::status.",FTGD_UPDATE_API=MONITOR_API_BASE+"system/fortiguard/update",REQUEST_INTERVAL=1e4,REQUEST_TIMEOUT=12e4,FAILED_MESSAGE="Failed to retrieve VM status.",TIMEOUT_MESSAGE="vm_wait_auth_too_long",VM_STATUS_LEVEL={vm_startup:"warning",vm_wait_auth:"warning",vm_eval:"success",vm_valid:"success",vm_error:"error",vm_invalid_copy:"error",vm_expired:"error",vm_invalid:"error"},STATUSES=fweb.BUILD.SYMBOLS,fVmLicensePrompt={controller:VmLicensePrompt,templateUrl:function(loader){return loader.cache_path("f-vm-license-prompt.html",module)}};return function(providers){providers.$compile.component("fVmLicensePrompt",fVmLicensePrompt)}}),define("ng/prompt/services",["ng/ftnt","fweb","ng/services/volatile_storage"],function(module,fweb){"use strict";function Prompt($location,$routeParams,$window,state,structure,volatileStorage,notificationRequests,$q){this._$location=$location,this._$routeParams=$routeParams,this._$window=$window,this._state=state,this._structure=structure,this._volatileStorage=volatileStorage,this._notificationRequests=notificationRequests,this._q=$q,this._index=-1,this._redirBlacklist=[/^\/ng\/prompt\/reboot/,/^\/ng\/prompt\/shutdown/]}var GUEST_ADMIN_URI="/p/user/guest/list/";Prompt.prototype.next=function(){var CHECKS={_vmLicense:"/prompt/vm-license",_defaultPassword:"/prompt/default-password",_fileSystem:"/prompt/file_system_check",_centrallyManaged:"/prompt/centrally_managed",_forticareUnlicensed:"/prompt/forticare-license"};if(this._index+1<Object.keys(CHECKS).length){var keys=Object.keys(CHECKS),key=keys[++this._index],permissionCheck=this[key]();this._q.when(permissionCheck).then(function(check){check?this._$location.path(CHECKS[key]):this.next()}.bind(this))}else this._$location.url(this._structure.ngURI(this.getRedirectURL()))},Prompt.prototype.getRedirectURL=function(){var url,isBlackListed;return this._state.admin.guest_admin?url=GUEST_ADMIN_URI:(url=this._$routeParams.redir||"/ng/",isBlackListed=this._redirBlacklist.some(function(regex){return regex.test(url)}),url=isBlackListed?"/ng/":url),url},Prompt.prototype.logout=function(){this._$window.location.href="/logout"},Prompt.prototype._defaultPassword=function(){var state=this._state;return this._q.resolve(!state.admin.remote_admin&&!state.admin.pki_admin&&state.admin_using_default_password)},Prompt.prototype._fileSystem=function(){var state=this._state;return this._q.resolve(state.need_fs_check&&state.admin.global_admin&&state.adminHasWritePermission(state.ACCESS_GROUP.SYSTEM))},Prompt.prototype._centrallyManaged=function(){var state=this._state;return this._q.resolve(!state.admin.guest_admin&&state.centrally_managed)},Prompt.prototype._vmLicense=function(){var state=this._state,STATUSES=fweb.BUILD.SYMBOLS;return this._q.resolve(state.is_vm&&state.admin.global_admin&&(state.vmlicense_status===STATUSES.LICENSE_STATUS_VM_WAIT_AUTH||state.vmlicense_status===STATUSES.LICENSE_STATUS_VM_STARTUP))},Prompt.prototype._forticareUnlicensed=function(){var STATUSES=fweb.BUILD.SYMBOLS;return this._state.adminHasWritePermission(this._state.ACCESS_GROUP.SYSTEM)&&this._state.admin.global_admin?this._notificationRequests.license().then(function(licenses){var forticareLicense=licenses.forticare;return!!forticareLicense&&forticareLicense.status===STATUSES.LICENSE_STATUS_NOT_REGISTERED}):this._q.resolve(!1)},module.service("prompt",Prompt)}),define("ng/system/csf/f-csf-extension-devices-info",["module","ng/ftnt","ng/services/injector","fweb"],function(module,ngModule,inject,fweb){"use strict";function ExtensionDevicesInfo($scope,injector,state,CMDB){function checkOverrideSetting(settings){extDevicesInfo.overrideGlobalLogSettings="enable"===settings.override}var fortianalyzer,extDevicesInfo;injector.injectMarked(this,{$scope:$scope}),this.loading=!0,this.vdomMode=state.vdom_mode,this.isGlobalAdmin=state.admin&&state.admin.global_admin,this.hasFctPermission=state.adminHasReadPermission(state.ACCESS_GROUP.ENDPOINT_CONTROL),this.hasFazPermission=state.adminHasReadPermission(state.ACCESS_GROUP.LOG_CONFIG)&&state.adminHasReadPermission(state.ACCESS_GROUP.LOG_DATA_ACCESS),this.hasWifiSwitchCtrlPermission=state.adminHasReadPermission(state.ACCESS_GROUP.WIFI),this.hasFsaPermission=this.isGlobalAdmin,this.vdomMode?(fortianalyzer=new CMDB("log.fortianalyzer","override-setting").fetch(),extDevicesInfo=this,fortianalyzer.$promise.then(checkOverrideSetting)):this.overrideGlobalLogSettings=!1,this._run()}var SYMBOLS=fweb.BUILD.SYMBOLS,MANAGED_DEVICE_TYPES={FORTISWITCH:{icon:"ftnt-fortiswitch",langKey:"FortiSwitch"},FORTIAP:{icon:"ftnt-fortiap",langKey:"FortiAP"}},URI_EXTERNAL_SECURITY="/system/external_security",URI_SYSTEM_SETTINGS="/system/settings",URI_LOG_SETTINGS="/log/settings",URI_PHYSICAL_TOPOLOGY="/fortiview/device/physical/all",URI_DEVICE_INVENTORY="/user/device";ExtensionDevicesInfo.prototype._setFazStatus=function(faz){var langKey,server,severity="severity-critical",icon="fa-severity-critical";if(faz.is_enabled)if(server=faz.ip,faz.error)switch(langKey=faz.status,faz.status){case"err::fortianalyzer::denied":case"err::fortianalyzer::refused":case"err::fortianalyzer::unauth":severity="severity-high",icon="fa-severity-high"}else langKey="connected",severity="",icon="fa-enabled";else langKey="Not configured",severity="disabled",icon="fa-severity-high";this.fazStatus={langKey:langKey,severity:severity,icon:icon,server:server,redirUrl:this.getFazLogRedirUrl()}},ExtensionDevicesInfo.prototype._setSandboxStatus=function(sandbox,license){var langKey,server,account,severity="severity-critical",icon="fa-severity-critical";sandbox.configured?(sandbox.connected?(langKey="connected",severity="",icon="fa-enabled"):langKey="unreachable","appliance"===sandbox.type?server=sandbox.server:account=license.forticloud.account):(langKey="Not configured",severity="disabled",icon="fa-severity-high");var redirUrl=!this.vdomMode||this.isGlobalAdmin?URI_EXTERNAL_SECURITY:"";this.vdomMode&&redirUrl&&(redirUrl="?vdom="),this.sandboxStatus={langKey:langKey,severity:severity,icon:icon,configured:sandbox.configured,type:sandbox.type,server:server,account:account,redirUrl:redirUrl}},ExtensionDevicesInfo.prototype._setFmgStatus=function(fmg){var langKey,severity,icon,server,mode,hasFmg=Object.keys(fmg).length;if(hasFmg){var isConnected=fmg.fortimanager_status_id===SYMBOLS.APS_FGFM_CONN_ST_UP,isRegistered=fmg.fortimanager_registration_status_id===SYMBOLS.APS_FGFM_REG_ST_REGISTERED;isConnected&&isRegistered?(severity="",langKey="connected",icon="fa-enabled"):isConnected?(severity="severity-high",icon="fa-severity-high",langKey="fmg_unregister"):(severity="severity-critical",icon="fa-severity-critical",langKey="disconnected"),server=fmg.server,mode=fmg.mode}else langKey="Not configured",severity="disabled",icon="fa-severity-high";var redirUrl=!this.vdomMode||this.isGlobalAdmin?URI_SYSTEM_SETTINGS:"";this.vdomMode&&redirUrl&&(redirUrl="?vdom="),this.fmgStatus={langKey:langKey,severity:severity,icon:icon,server:server,mode:mode,redirUrl:redirUrl}},ExtensionDevicesInfo.prototype._setCsfStatus=function(csfTopology){var langKey,icon,severity;csfTopology.csfEnabled?(icon="fa-connected",langKey="connected"):(severity="severity-high",langKey="disabled",icon="fa-severity-high");var redirUrl=!this.vdomMode||this.isGlobalAdmin?URI_EXTERNAL_SECURITY:"";this.vdomMode&&redirUrl&&(redirUrl="?vdom="),this.csfStatus={langKey:langKey,icon:icon,severity:severity,summary:{totalConnected:csfTopology.fortigates.length},redirUrl:redirUrl}},ExtensionDevicesInfo.prototype._makeManagedDeviceStatus=function(managedDevices,props){var summary,totalClients,severity;return props===MANAGED_DEVICE_TYPES.FORTIAP&&managedDevices.forEach(function(managedDevice){totalClients=(totalClients||0)+managedDevice.clients}),summary={totalConnected:managedDevices.length,totalClients:totalClients},0===summary.totalConnected&&(severity="disabled"),{icon:props.icon,langKey:props.langKey,summary:summary,redirUrl:URI_PHYSICAL_TOPOLOGY,severity:severity}},ExtensionDevicesInfo.prototype._setManagedDeviceStatus=function(csfTopology){var fortiswitches=[],fortiaps=[];csfTopology.fortigates.forEach(function(fgt){fortiswitches=fortiswitches.concat(fgt.fortiswitches),fortiaps=fortiaps.concat(fgt.fortiaps)}),this.managedDeviceStatus=[this._makeManagedDeviceStatus(fortiswitches,MANAGED_DEVICE_TYPES.FORTISWITCH),this._makeManagedDeviceStatus(fortiaps,MANAGED_DEVICE_TYPES.FORTIAP)]},ExtensionDevicesInfo.prototype._setFctStatus=inject.mark(function(state){return function(csfTopology){var severity,summary,forticlients=csfTopology.fortigates.reduce(function(prev,fgt){return prev.concat(fgt.forticlients)},[]),vulnerabilities=forticlients.reduce(function(prev,record){return["vuln_count_info","vuln_count_low","vuln_count_medium","vuln_count_high","vuln_count_critical"].forEach(function(key){prev[key]=(prev[key]||0)+record.vulnerabilities[key],prev.vuln_count=(prev.vuln_count||0)+prev[key]}),prev},{});summary={total:forticlients.length,totalConnected:forticlients.filter(function(record){return"registered"===record.state&&record.online}).length},0===summary.totalConnected?severity="disabled":vulnerabilities.vuln_count_critical>0?severity="severity-critical":vulnerabilities.vuln_count_high+vulnerabilities.vuln_count_medium>0&&(severity="severity-high");var hasUserDevicePermission=state.adminHasReadPermission(state.ACCESS_GROUP.USER_DEVICE);this.fctStatus={summary:summary,severity:severity,vulnerabilities:vulnerabilities,redirUrl:hasUserDevicePermission?URI_DEVICE_INVENTORY:""}}}),ExtensionDevicesInfo.prototype._run=inject.mark(function($scope,notificationRequests){return function(){var WATCH=["csfTopologyWithExtensionDevices","fortimanagerStatus"];this.hasFsaPermission&&WATCH.push("license","sandboxStatus"),this.hasFazPermission&&WATCH.push("fortianalyzerStatus"),notificationRequests.watchMultiple($scope,WATCH,function(results){this.hasFazPermission&&this._setFazStatus(results.fortianalyzerStatus),this.hasFctPermission&&this._setFctStatus(results.csfTopologyWithExtensionDevices),this.hasWifiSwitchCtrlPermission&&this._setManagedDeviceStatus(results.csfTopologyWithExtensionDevices),this.hasFsaPermission&&this._setSandboxStatus(results.sandboxStatus,results.license),this._setFmgStatus(results.fortimanagerStatus),this._setCsfStatus(results.csfTopologyWithExtensionDevices),this.loading=!1}.bind(this),!0)}}),ExtensionDevicesInfo.prototype.toggleRedirMenu=function(menu,event,status){this.selectedStatus=status,this.selectedStatus&&this.selectedStatus.redirUrl&&menu.toggle({top:event.clientY,left:event.clientX})},ExtensionDevicesInfo.prototype.getFazLogRedirLabel=inject.mark(function(lang,csfTopology){return function(){var result;return result=lang(csfTopology.csfEnabled?"Configure settings in Security Fabric > Settings":"Configure settings in Log & Report > Log Settings")}}),ExtensionDevicesInfo.prototype.getFazLogRedirUrl=inject.mark(function(csfTopology){return function(){var result,GLOBAL_PAGE="?vdom=";return csfTopology.csfEnabled?result=URI_EXTERNAL_SECURITY:(result=URI_LOG_SETTINGS,!this.overrideGlobalLogSettings&&this.isGlobalAdmin&&(result+=GLOBAL_PAGE)),result}}),ExtensionDevicesInfo.prototype.redirTo=inject.mark(function($location){return function(url){url&&$location.url(url)}}),ngModule.component("fCsfExtensionDevicesInfo",{templateUrl:function(loader){return loader.base_path("f-csf-extension-devices-info.html",module)},controller:ExtensionDevicesInfo,bindings:{loading:"=?"}})}),define("ng/system/vdom/resources/f-vdom-resources",["module","ng/ftnt","ng/services/injector"],function(module,ngModule,inject){"use strict";function VdomResources(injector,$scope){injector.injectMarked(this,{$scope:$scope}),this.setup(),this.loadData()}var MONITOR_URI="/api/v2/monitor/",GLOBAL_RESOURCES=MONITOR_URI+"system/global-resources",VDOM_RESOURCES=MONITOR_URI+"system/vdom-resource";VdomResources.prototype.setup=function(){this.options.loading=!0,this.options.saveFunction=this.save,this.isGlobal="global"===this.options.vdom,this.isGlobal?this.maximumLabel="def_max":this.maximumLabel="Global Maximum",this.colspan=this.isGlobal?4:5,this.resources={},this.resourceCategories=[{categoryResources:[{name:"session"}]},{categoryHeader:"policy_objects",categoryResources:[{name:"firewall-policy"},{name:"firewall-address"},{name:"firewall-addrgrp"},{name:"custom-service"},{name:"service-group"},{name:"onetime-schedule"},{name:"recurring-schedule"}]},{categoryHeader:"user_and_device",categoryResources:[{name:"user"},{name:"user-group"},{name:"proxy",langKey:"Concurrent Explicit Proxy Users"}]},{categoryHeader:"vpn",categoryResources:[{name:"sslvpn"},{name:"ipsec-phase1"},{name:"ipsec-phase2"},{name:"ipsec-phase1-interface"},{name:"ipsec-phase2-interface"},{name:"dialup-tunnel"}]},{categoryHeader:"Log & Report",categoryResources:[{name:"log-disk-quota",unit:"mb"}]}]},VdomResources.prototype.getMinValue=function(resource){var resourceObject=this.resources[resource];if(resourceObject)return resourceObject.current_usage>=resourceObject.min_custom_value?resourceObject.current_usage:resourceObject.min_custom_value},VdomResources.prototype.setupMaxValues=function(){Object.keys(this.resources).forEach(function(resource){var resourceObject=this.resources[resource];0===resourceObject.custom_max&&(resourceObject.custom_max=""),0===resourceObject.guaranteed&&(resourceObject.guaranteed=""),resourceObject.custom_max!==resourceObject.max_custom_value&&resourceObject.custom_max&&(resourceObject.editMode=!0)}.bind(this))},VdomResources.prototype.resetAfterToggle=function(resource){this.resources[resource].editMode||this.resetResource(resource)},VdomResources.prototype.resetResource=function(resource,resetGuaranteed){this.resources[resource].custom_max="",this.resources[resource].editMode=!1,!this.isGlobal&&resetGuaranteed&&(this.resources[resource].guaranteed="")},VdomResources.prototype.resetAll=function(){Object.keys(this.resources).forEach(function(resource){this.resetResource(resource,!0)}.bind(this))},VdomResources.prototype.loadData=inject.mark(function($http){return function(){var promise;if(this.isGlobal)promise=$http.get(GLOBAL_RESOURCES);else{var url=VDOM_RESOURCES+"?vdom="+this.options.vdom;promise=$http.get(url)}promise.then(function(results){this.resources=results.data.results,this.isGlobal||(delete this.resources.cpu,delete this.resources.memory,delete this.resources.setup_rate,delete this.resources.is_deletable),this.setupMaxValues(),this.options.loading=!1}.bind(this))}}),VdomResources.prototype.save=inject.mark(function(CMDB){return function(){var cmdbData={};return Object.keys(this.resources).forEach(function(resource){var resourceObject=this.resources[resource];this.isGlobal?resourceObject.custom_max!==resourceObject.max_custom_value&&(cmdbData[resource]=resourceObject.custom_max):(resourceObject.custom_max!==resourceObject.max_custom_value&&resourceObject.custom_max?cmdbData[resource]=resourceObject.custom_max:cmdbData[resource]=0,resourceObject.guaranteed&&resourceObject.guaranteed>0?cmdbData[resource]+=" "+resourceObject.guaranteed:cmdbData[resource]+=" 0")}.bind(this)),this.isGlobal?new CMDB("system","resource-limits").edit(null,cmdbData).$promise.then(this.loadData):new CMDB("system","vdom-property").edit(this.options.vdom,cmdbData).$promise}}),ngModule.component("fVdomResources",{templateUrl:function(loader){return loader.base_path("f-vdom-resources.html",module)},controller:VdomResources,bindings:{options:"="}})}),define("ng/fortiview/scripts/services/util",["module","angular","jquery","ng/app","fweb","widgets","ips_common","fgd_common","byod_common","ftnt_shared","ng/ftnt"],function(module,angular,$,app,fweb,widgets,ips_common,fgd_common,byod_common,ftnt_shared,ftntModule){"use strict";function Util($timeout,lang,$interpolate,$filter,state,volatileStorage,CMDB,$q,$log,csfTopology,$injector,$resource,$parse,$compile,injector){function transformMacAddress(s){return fweb.util.patterns.commonRegExp.MAC_ADDRESS.test(s)?s.replace(/:/g,"-"):s}function untransformMacAddress(s){var MAC_ADDRESS_TRANSFORMED=/^[0-9a-fA-F]{2}-[0-9a-fA-F]{2}-[0-9a-fA-F]{2}-[0-9a-fA-F]{2}-[0-9a-fA-F]{2}-[0-9a-fA-F]{2}$/;return MAC_ADDRESS_TRANSFORMED.test(s)?s.replace(/-/g,":"):s}function decodeDrilldownValue(s){return decodeURIComponent(untransformMacAddress(s))}function invert(obj){function do_invert(result,key){return result[obj[key]]=key,result}return Object.keys(obj).reduce(do_invert,{})}function extend_apps(apps){for(var app,details,map,i=0,len=apps.length;app=apps[i],i<len;++i)app.name||(map=fortiviewUtil.get_applications().$map.id||{},details=map[app.id],details&&angular.extend(app,details))}function map_attrs(result,obj){for(var attr in result)result[attr][obj[attr]]=obj;return result}function get_app_icon($routeParams,$sce,app_id,summary){var apps=fortiviewUtil.get_applications(),id=Number(summary.application)||Number(app_id);return apps.$promise.then(function(){var app=isNaN(id)?{id:0,name:app_id}:apps.$map.id[id],html=fgd_common.gen_app_html(app_id,app.name,summary);return $sce.trustAsHtml(html)})}function sum(result,value){return result+value}function values(row){return function(col){return row[col]}}function value_exists(row){return function(col){return null!=row[col]}}this.waitForNotNull=function($scope,watchExpression,callback,unwatcherCallback){var waitingContext,waitingArgs,isnull=!0,isWaiting=!1,unwatch=$scope.$watch(watchExpression,function(){null!=$scope.$eval(watchExpression)&&(isnull=!1,unwatch(),isWaiting&&(callback.apply(waitingContext,waitingArgs),waitingContext=null,waitingArgs=null,isWaiting=!1))});return null!=unwatcherCallback&&unwatcherCallback(unwatch),function(){isnull?null!=$scope.$eval(watchExpression)?(isnull=!1,unwatch(),callback.apply(this,arguments)):(waitingContext=this,waitingArgs=arguments,isWaiting=!0):callback.apply(this,arguments)}};var SEVERITY={critical:{color:"rgb(217, 83, 79)",stroke:"#d50000"},high:{color:"rgb(226, 135, 34)",stroke:"#e2a82e"},medium:{color:"rgb(243, 187, 45)",stroke:"#d2ba00"},low:{color:"rgb(91, 192, 222)",stroke:"#7bcade"}},SEVERITY_LEVEL_IDMAP=["low","medium","high","critical"];this.SEVERITY=SEVERITY;var LAZY_TOOLTIP_CLASS=this.LAZY_TOOLTIP_CLASS="fortiview-lazy-tooltip",getDataBytesValue=this.getDataBytesValue=function(row){return+(row.sentbyte||0)+ +(row.rcvdbyte||0)};getDataBytesValue.kind="key_row";var getDeviceNameValue=this.getDeviceNameValue=function(row){return row.hostname||row.mac};getDeviceNameValue.kind="key_row",this.getQuarantineColumnNameForSegment=function(which,attr){var segmentMap={source:{saddr:"srcaddr"},destination:{daddr:"dstaddr"},sandbox:{saddr:"address"}},map=segmentMap[which]||{};return map[attr]||attr},this.createDefaultSortKeyRow=function(key){var fn=function(row){return row[key]};return fn.kind="key_row",fn},this.commonBytesFormatter=function(td,col,data){return null==td?data[col.selector]:fweb.util.formatters.metric_bytes(data[col.selector])},this.humanize_seconds=function(value){
return fweb.util.datetime.humanize_seconds(value,!0)},this.threatlevel=function(value){return widgets.format_fn.level(null,{selector:"threatlevel"},{threatlevel:value})},this.escapeDrilldownValue=transformMacAddress,this.encodeDrilldownValue=function(s){return encodeURIComponent(transformMacAddress(s))},this.decodeDrilldownValue=decodeDrilldownValue,this.splitDrilldownValues=function(values,segment){var result=values.split(":").map(decodeDrilldownValue);switch(segment){case"policy":if(result.length<2)throw new Error("No policy ID supplied for drilldown value");result[0]=result[0]||"policy",result[1]=result[0]+":"+result[1]}return result},this.fixTimeRange=function(range){var offsetSeconds=state.browser_utc_offset/1e3,fixedRange={start:parseInt(range.start,10)-offsetSeconds,end:parseInt(range.end,10)-offsetSeconds};return angular.extend({},range,fixedRange)},this.invert=invert,this.client_to_server_sort_map={data_bytes:"bytes",data_packets:"packets",data_bandwidth:"bandwidth",data_shaper_drops:"shaper_drops",score:"score",files:"files",sessions:"sessions",connections:"connections",count:"count",login_count:"login_count",failure_count:"failure_count",config_changes:"config_changes",last_conn_time:"last_conn_time",failure_attempt:"failure_attempt",search_count:"search_count",severity:"severity",host_count:"host_count",vuln_count:"vuln_count",scantime:"scantime",threatlevel:"level_score",browsingtime:"browsingtime"},this.server_to_client_sort_map=invert(this.client_to_server_sort_map),this.generateSortFn=function(context,default_sort){var handler=function(info){var old=context.sourceSortBy||default_sort;context.sourceSortBy=this.client_to_server_sort_map[info.target_sort.selector],old!==context.sourceSortBy&&context.reloadQlistData(!0)}.bind(this);return handler.kind="server",{data_bytes:handler,data_packets:handler,data_bandwidth:handler,data_shaper_drops:handler,count:handler,sessions:handler,score:handler,files:handler,connections:handler,bandwidth:handler,login_count:handler,failure_count:handler,config_changes:handler,last_conn_time:handler,failure_attempt:handler,search_count:handler,severity:handler,host_count:handler,vuln_count:ftnt_shared.util.fastLocaleCompare,scantime:handler,threatlevel:handler,browsingtime:handler}},this.aggregatedDataSortFnMap={severity:function(a,b){var aIdx=SEVERITY_LEVEL_IDMAP.indexOf(a.severity),bIdx=SEVERITY_LEVEL_IDMAP.indexOf(b.severity);return aIdx<0&&bIdx<0?0:aIdx<0?-1:bIdx<0?1:bIdx-aIdx}};var _applications=null,_wf_cats=null,fortiviewUtil=this;this.get_applications=function(){function add_maps(res){var unknown={id:0,name:lang("unknown")};return res.$map={id:{0:unknown},name:{}},res.$map.name[unknown.name]=unknown,res.reduce(map_attrs,res.$map),res}if(!_applications){var prefs={cache:!0,ng_cache:!0};_applications=new CMDB("application","name",prefs).fetch(),_applications.categories=new CMDB("ips","attr-map",prefs).fetch();var applications_done=_applications.$promise.then(add_maps),categories_done=_applications.categories.$promise.then(add_maps);_applications.$promise=$q.all([applications_done,categories_done]).then(function(promises){return promises[0]})}return _applications},this.get_wf_categories=function(){function get_cats(result,group){return result.push.apply(result,group.members),result}function add_maps(all_cats){all_cats.$map={id:{},name:{}},all_cats.reduce(map_attrs,all_cats.$map)}if(!_wf_cats){var res=$resource("/p/utm/wf/categories/json/");_wf_cats=res.get(),_wf_cats.$promise=_wf_cats.$promise.then(function(cats){var numeric_keys=Object.keys(cats).filter(Number),cats_length=Math.max.apply(Math,numeric_keys)+1,cats_arraylike=angular.extend({length:cats_length,reduce:Array.prototype.reduce},cats);return cats.$all=cats_arraylike.reduce(get_cats,[]),add_maps(cats.$all),cats})}return _wf_cats},this.get_app_icon=injector.partial(get_app_icon,null,["app_id","summary"]);var format_tip_opts={show:{solo:!0,effect:!1},position:{at:"bottom center",my:"top center",viewport:"window"}};this.format_fn={address:function(td,col,data){var key=col.selector,userTypeMap={0:"auth"};return data=angular.extend({username_source:userTypeMap[data.usertype]},data),data.report_by="dstaddr"===key?"destination":"source",!data.username&&data.user&&(data.username=data.user),data.username_source||(data.username_source=data.user!==data.unauthuser?"auth":"unauth"),data.unauthusersource||(data.unauthusersource=data.fctuid?"forticlient":""),widgets.format_fn.address(td,col,data)},device:function(td,col,data){var key=col.selector,mac=data[key];if(fweb.util.patterns.isEmptyMac(mac))return"";var detectionIntf=data.detection_interface,useHostVisibilityInfo="mac"===key||detectionIntf===data.srcintf&&"srcmac"===key||detectionIntf===data.dstintf&&"dstmac"===key,entry=angular.extend({},data,{mac:data[col.selector],datasource:"fortiviewDetectedDevices"});return useHostVisibilityInfo||["device","alias","master_alias","hostname"].forEach(function(key){delete entry[key]}),widgets.format_fn.device(td,col,entry)},apps:function(el,column,data){var result="",apps=data[column.selector]||[];return extend_apps(apps),1===apps.length?result=widgets.format_fn.apps(el,column,data):apps.length>1&&(result=angular.element('<span class="tooltip-hint"></span>'),result.addClass(LAZY_TOOLTIP_CLASS),result.data(QTIP_TEMPLATE_COMPONENT,"f-apps-list"),result.data(QTIP_DATA,{apps:apps}),result.text(lang("{0} applications",[apps.length])),result=result[0]),result},cloudApps:function(el,column,data,$scope){function resolve(delayed_result){var appids=data[column.selector]||[{id:0}];data[column.selector]=appids.map(lookup_parentid);var result=fortiviewUtil.format_fn.apps(el,column,data,$scope);return void 0!==delayed_result&&el.html(result),result}function lookup_parentid(id_obj){var app=apps.$map.id[id_obj.id];if(app){var root_name=app.name.split("_");root_name.length>1&&(app=apps.$map.name[root_name[0]])}return app?app:id_obj}var apps=fortiviewUtil.get_applications();return apps.$resolved?resolve():(apps.$promise.then(resolve),apps.$resolved?resolve(!1).bind(this):"")},ngToolTip:function(template,setupScope,format){return format=format||$.format_fn["*"],function(el,column,data,$scope){function mouseEnter(){el.off(eventName);var tipStart='<div f-qtip options="options">',compiled=$compile("<div f-qtip-target>"+result+tipStart+template+"</div></div>"),newScope=$scope.$new();newScope.$apply(function(){newScope.options=format_tip_opts,setupScope(el,column,data,newScope),el.empty().append(compiled(newScope))})}var eventName="mouseover.ngToolTipSetup",result=format(el,column,data);return el.off(eventName).on(eventName,mouseEnter),result}},cloudFiles:function(columns,max_fn,tab,base_segment){var template='<div f-qtip options="options" promise="files_promise"><ul class="show-files ng-cloak"><li ng-repeat="f in files"><span class="tool_sprite tool_{{ f.$actionClass }}" title="{{ f.$action | case:\'sentence\' }}"></span>{{ f.filename }}<span class=filecount ng-show="f.count > 1"> {{ f.count }}x</span><span class=filesize ng-show="f.$showSize && f.totalsize"> {{ f.totalsize | bytes }} <span ng-show="f.totalsize != f.filesize" f-lang=total></span></span></li></ul></div>',cols=["filename","app","filesize"],format=Array.isArray(columns)?fortiviewUtil.format_fn.file_compare(max_fn,columns):fortiviewUtil.format_fn.one_compare(max_fn,columns);return function(el,column,data,$scope){function mouse_enter(){function augment_file(file){file.$showSize=/_\w+\.(Upload|Download)/.test(file.app),file.totalsize=file.filesize||0,file.$actionClass=(file.app.split(".")[1]||"").toLowerCase(),file.$action=(file.app.split("_")[1]||"").replace(/\./g," "),file.count=1}function get_more(deferred,res,fetched,session_id){function do_get_more(){if(res.completed<100){var more=filesResource.get({session_id:session_id,fetched:fetched});more.$promise.then(function(){more.source.forEach(augment_file),more.source.reduce(unique,new_scope.files),get_more(deferred,more,fetched,session_id)},fail)}else done()}function done(){new_scope.$root.$apply(deferred.resolve.bind(deferred,new_scope.files))}fetched=(fetched||0)+res.source.length,session_id=session_id||res.session_id,session_id?$timeout(do_get_more,100,!1):done()}function unique(result,file){var found=result.filter(file_match(file))[0];return found?(++found.count,found.totalsize+=file.filesize):result.push(file),result}function file_match(afile){return function(bfile){return bfile.filename===afile.filename&&(!bfile.$showSize||afile.size===bfile.size)}}function fail(error){$log.error(error)}el.off(event_name);var new_scope;$scope.$apply(function(){var compiled=$compile("<div f-qtip-target>"+result+template+"</div>");new_scope=$scope.$new(),angular.extend(new_scope,{files_res:filesResource.get(),options:format_tip_opts}),el.empty().append(compiled(new_scope)),new_scope.files_res.$promise.then(function(){new_scope.files_res.source.forEach(augment_file),new_scope.files=new_scope.files_res.source.reduce(unique,[]);var deferred=$q.defer();new_scope.files_promise=deferred.promise,get_more(deferred,new_scope.files_res)},fail)})}function filter_add(filter,id){var facet=fortiviewUtil.facets.byId(id),value=facet.getKey(data,"monitor_api");return value&&(filter[id]=[value]),filter}var count=Array.isArray(columns)?columns.map(values(data)).reduce(sum):data[column.selector];if(0===Number(count))return"";var result=format(el,column,data),event_name="mouseenter.cloud_files",filter_segments=["cloud-user","cloud-app"];if(base_segment){var fortiviewRouteMetadata=$injector.get("fortiviewRouteMetadata");filter_segments=[fortiviewRouteMetadata.baseSegment(!0)]}var filter=filter_segments.reduce(filter_add,{}),url=fortiviewUtil.facets.getLogDataUrl(tab||"files",cols,filter),filesResource=$resource(url);return el.off(event_name),el.on(event_name,mouse_enter),result}},country:function(el,column,data){var name=data[column.selector]||"",html="";return el&&el.addClass&&el.addClass("left"),data.country_id&&(html+=widgets.gen_country_flag_icon_by_id(data.country_id,name)),html+name},server:fweb.util.formatters.server_format_fn,threat:function(el,column,data){var result;return"app"===data.type?(column=angular.extend({},column,{selector:"apps"}),result=fortiviewUtil.format_fn.apps(el,column,data),angular.element(el).removeClass("apps")):result=String(lang(data[column.selector])),result},threat_type:function(el,column,data){return el?"app"===data.type?data[column.selector]:String(lang(data[column.selector])):data[column.selector]},bytes_compare:function(max_fn,keys,lang_keys){return keys=angular.isArray(keys)&&2===keys.length?keys:["sentbyte","rcvdbyte"],lang_keys=angular.isArray(lang_keys)&&2===lang_keys.length?lang_keys:["sentbyte","rcvdbyte"],f_dom.create_compare_bar_qlist_formatter(max_fn,null,keys,null,lang_keys,fweb.util.formatters.metric_bytes)},two_compare:function(max_fn,keys,lang_keys,format,blocked_allowed_bar,value_format){format=format||function(summed){return summed||0};var colors=blocked_allowed_bar?f_dom.COMPARE_BAR.COLOR_SETTINGS.BLOCKED_ALLOWED:f_dom.COMPARE_BAR.COLOR_SETTINGS.STANDARD;return f_dom.create_compare_bar_qlist_formatter(max_fn,format,keys,colors,lang_keys,value_format)},one_compare:function(max_fn,key,lang_key,format,color,value_format){format=format||function(summed){return summed||0};var color_map={red:f_dom.COMPARE_BAR.COLORS.RED};return f_dom.create_compare_bar_qlist_formatter(max_fn,format,[key],[color_map[color]||f_dom.COMPARE_BAR.COLORS.BLUE],[lang_key||key],value_format)},file_compare:function(max_fn,keys){var format=function(total,values){return values.join("/")};return f_dom.create_compare_bar_qlist_formatter(max_fn,format,keys)},count_compare:function(max_fn){return function($td,column,data){return null==data.session_allow?f_dom.compare_bar({max:max_fn(),values:[data.sessions||0],format_fn:function(summed){return summed},colors:[f_dom.COMPARE_BAR.COLORS.BLUE],lang_keys:["Sessions"]}):f_dom.compare_bar({max:max_fn(),values:[data.session_block,data.session_allow],format_fn:function(summed){return summed},colors:f_dom.COMPARE_BAR.COLOR_SETTINGS.BLOCKED_ALLOWED,lang_keys:["Sessions Blocked","Sessions Allowed"]})}},duration:function(max_fn){var format=function(value){return fweb.util.datetime.humanize_seconds(value,!0)};return this.one_compare(max_fn,"duration",null,format,null,format)},browsingtime:function(max_fn){var format=function(value){return fweb.util.datetime.humanize_seconds(value,!0)};return this.one_compare(max_fn,"browsingtime",null,format,null,format)},user_with_icon:function(el,column,data){var config={username:data[column.selector],username_source:"auth"};return widgets.format_fn.username(el,column,config)},domain:function(el,column,data){var hostname=(data.domain||"").split(":")[0];return'<img class="domain" src="https://www.google.com/s2/favicons?domain='+encodeURIComponent(hostname)+'"/>'+f_dom.escapeHTML(data.domain)},level:function(el,column,data){return widgets.format_fn.threatlevel(el,column,data)},risk:function(el,column,data){var app,app_risk,risks=["none","low","medium","high","critical"],apps=data.apps||[];return extend_apps(apps),null!=apps&&(app=apps[0])&&null!=(app_risk=app.risk)?fweb.util.formatters.severity_bar(risks[app_risk-1]):lang("unknown").toString()},category:function(el,column,data){function _gen_app(name){return name&&"unknown"!==name?'<div f-fgd-tip=".tooltip">'+fgd_common.gen_app_cat_html(name)+"</div>":String(lang("unknown"))}var app,apps=data.apps||[],categories=fortiviewUtil.get_applications().categories.$map.id;if(extend_apps(apps),null==apps||!(app=apps[0]))return _gen_app(data.category||"unknown");if(!app.category_name){var attr_map_id=ips_common.ips_get_attr_map_id(ips_common.IPS_ATTR_APP_CAT,app.category),cat=categories[attr_map_id];cat&&(app.category_name=cat.name)}return _gen_app(app.category_name||app.category||data.category)},web_category:function(el,column,data){return data.category?fgd_common.gen_wf_html_no_icon(data.category_id,data.category):""},none:function(td,column,config){return config[column.selector]},connection_time:function(el,column,data){if(data.to&&data.from){var from_time=parseInt(data.from),to_time=parseInt(data.to);return fweb.util.datetime.gmtSecondsToDate(from_time).toLocaleString()+" - "+fweb.util.datetime.gmtSecondsToDate(to_time).toLocaleString()}if(data.start_time&&data.end_time){var start=new Date(fweb.util.datetime.localFortiGateStringToUTC(data.start_time)),end=new Date(fweb.util.datetime.localFortiGateStringToUTC(data.end_time));return start.toLocaleString()+" - "+end.toLocaleString()}},utc_time_format:function(el,column,data){var name=column.selector,value=data&&data[name];return value?fweb.util.datetime.gmtSecondsToDate(value).toLocaleString():""},unauth_type_color:function(el,column,data){el.addClass("level");var type=data.unauth_type,unauth_type_cls={Admin:"access-red","IPsec VPN":"access-green","SSL-VPN":"access-yellow",FGFM:"access-blue",SNMP:"access-orange",Firewall:"access-purple","FortiGuard Web Filter Override":"access-pink",Wireless:"access-aqua"};return'<span class="legend legend-wide-1 '+unauth_type_cls[type]+'">'+type+"</span>"},unauth_target:function(el,column,data){function formatDefault(data,type){return data.unauth_target}function formatAdmin(data,type){if(!data.dst_field2)return data.unauth_target;var value=data.unauth_target1.toUpperCase(),ip_intf=_formatIntfName(data,"unauth_target2");return value+="("+ip_intf+")"}function formatTunnel(data,type){var mkey=data[unauth_maps[type].mkey_field];if("N/A"===mkey)return data.unauth_target;var mkey_label=lang(unauth_maps[type].mkey_label),text=mkey,url=unauth_maps[type].url;return _formatLink(url,mkey,mkey_label,text)}function formatDstip(data,type){return _formatIntfName(data,"unauth_target")}function formatFirewall(data,type){var value=_formatIntfName(data,"unauth_target1"),url=unauth_maps[type].url,mkey=data[unauth_maps[type].mkey_field],mkey_label=lang(unauth_maps[type].mkey_label),text=" ("+lang("policy")+": "+mkey+")";return 0===parseInt(mkey,10)?value+text:value+=_formatLink(url,mkey,mkey_label,text)}function _formatIntfName(data,field_name){var intf_name=data.intf_name||"";return intf_name?data[field_name]+" - "+intf_name:data[field_name]}function _formatLink(base_url,mkey,title,text){return'<a href="'+base_url+mkey+'" title="'+title+". "+lang("Click to see the configuration.")+'">'+text+"</a>"}var unauth_maps={Admin:{format:formatAdmin},"IPsec VPN":{url:"/ng/vpn/ipsec/edit/",mkey_field:"unauth_target",mkey_label:"tunnel",format:formatTunnel},"SSL-VPN":{format:formatDefault},FGFM:{format:formatDstip},SNMP:{format:formatDstip},Firewall:{url:"/ng/firewall/policy/policy/standard/edit/",mkey_field:"unauth_target2",mkey_label:"policy_id",format:formatFirewall},"FortiGuard Web Filter Override":{format:formatDstip},Wireless:{format:formatDefault}},type=data.unauth_type,result=angular.isFunction(unauth_maps[type]&&unauth_maps[type].format)?unauth_maps[type].format(data,type):data.unauth_target;return result},wifi_source:function(td,col,data){return widgets.format_fn.address(td,{selector:"srcip"},angular.extend({report_by:"source",username_source:"auth",username:data.wifiuser},data))},search_phrase_source:function(td,col,data){var unauthusersource="unauthuser"===data.userfield&&data.fctuid?"forticlient":"";return widgets.format_fn.address(td,{selector:"srcip"},angular.extend({report_by:"source",username_source:"user"===data.userfield?"auth":"",username:data.user,unauthusersource:unauthusersource},data))},intf:function(td,col,data){var mkey=data[col.selector],result=angular.element('<span class="tooltip-hint"></span>').text(mkey),csfPath=data.csfPath;return mkey&&(f_dom.formatObject({element:result,mkey:mkey,datasource:"firewallInterfaces",csfPath:csfPath}),f_dom.setupObjectTooltip({element:result,mkey:mkey,datasource:"firewallInterfaces",csfPath:csfPath})),result},csfFortigate:function(td,col,data){var result,fgt=data.fortigate||state.serial;return data.fortigates&&data.fortigates.length>1?(result=angular.element('<span class="tooltip-hint"></span>'),result.addClass(LAZY_TOOLTIP_CLASS),result.data(QTIP_TEMPLATE_COMPONENT,"f-fortigate-list"),result.data(QTIP_DATA,{fortigates:data.fortigates}),result.text(lang("{0} FortiGates",[data.fortigates.length]))):(result=angular.element('<span class="tooltip-hint"></span>'),csfTopology.buildIfNecessary().then(function(){var fortigate=csfTopology.fortigateMapping[fgt],label=fortigate&&fortigate.getLabel();result.text(label||fgt)}),result.text(fgt),f_dom.setupObjectTooltip({element:result,mkey:fgt,datasource:"csfFortiGates"})),result[0]},vuln_source:function(td,col,data){return widgets.format_fn.address(td,{selector:"srcip"},angular.extend({report_by:"source"},data,{unauthuser:data.user}))},vuln_count_compare:function(max_fn,keys,format){return format=format||function(summed){return summed||0},f_dom.create_compare_bar_qlist_formatter(max_fn,format,keys,[SEVERITY.critical.color,SEVERITY.high.color,SEVERITY.medium.color,SEVERITY.low.color],["critical","high","medium","low"])},vuln_category:function(td,column,entry){var value=entry[column.selector];if(!value)return"";var values=value.split(","),html=(values||[]).map(function(category){var count=category.replace(/^\D+/g,""),categoryStr=category.match(/^\D+/g);return'<span class="cell-collection-member"><span >'+(Array.isArray(categoryStr)?(categoryStr[0]||"").trim():"")+'</span><span class="category-count">'+count+"</span></span>"}).join("");return'<div class="flex-wrap">'+html+"</div>"},vuln_device:function(td,col,data){data.mac=data.srcmac;var mac=data.srcmac,alias=data.alias||data.hostname||data.srcname||data.srcmac;return byod_common.gen_fw_device_icon(mac,data.device,alias,!1,data.csfPath)},vendorurl:function(td,col,data){var url=data[col.selector];if(url){var lastSegment=url.substr(url.lastIndexOf("/")+1);return'<a href="'+url+'" target="_blank" rel="noopener noreferrer">'+f_dom.escapeHTML(lastSegment||url)+"</a>"}return""},cveid:function(td,col,data){return ips_common.log_cve_format_fn(col.selector,data,td)},vulnid:function(td,col,data){return ips_common.vulnid_format_fn(col.selector,data,td)}},this.calculateMaxima=function(target,details,sums){function calc_max(fields,row){for(var f in fields){var value;value=f in sums&&sums[f].every(value_exists(row))?sums[f].map(values(row)).reduce(sum):row[f]||0,fields[f]=Math.max(fields[f],value)}return fields}sums=angular.extend({data_bytes:["sentbyte","rcvdbyte"],data_packets:["tx_packets","rx_packets"],data_bandwidth:["tx_bandwidth","rx_bandwidth"],data_shaper_drops:["tx_shaper_drops","rx_shaper_drops"],score:["score_allow","score_block"],sessions:["session_allow","session_block"],visit_count:["visit_count"],total_count:["total_count"]},sums);var fields={score:0,bytes:0,duration:0,count:0};angular.extend(fields,target,sums);for(var key in fields)fields[key]=0;if(null!=details){details.reduce(calc_max,fields);for(var f in fields)target[f]=Math.max(1,fields[f])}},this.onLangUpdatedApply=function(scope,targetExpression,expr){function apply(){target.assign(scope,interpolateFn(scope))}var interpolateFn=$interpolate(expr),target=$parse(targetExpression);return apply(),scope.$on("lang_updated",apply)},this.view_types={destination:[{type:"destination",lang:"IP"},{type:"country",lang:"Country"}],web:[{type:"domain",lang:"Domains"},{type:"category",lang:"Categories"},{type:"search-phrase",lang:"Search Phrases"}],cloud:[{type:"app",lang:"Applications"},{type:"user",lang:"Users"}],vpn:[{type:"vpn",lang:"User"}],sandbox:[{type:"file",lang:"Files"},{type:"source",lang:"Source"}],interface:[{type:"srcintf",lang:"Source"},{type:"dstintf",lang:"Destination"},{type:"intfpair",lang:"Interface Pairs"}],device:[{type:"physical",lang:"fortiview_topology_physical"},{type:"logical",lang:"fortiview_topology_logical"}],event:[{type:"system",lang:"fortiview_system"},{type:"unauth",lang:"fortiview_unauth"},{type:"admin",lang:"fortiview_admin"}],endpoint:[{type:"device",lang:"Device"},{type:"vulnerability",lang:"vuln"}]},this.get_additional_drilldown_tabs=function(){function not(value){return function(other){return other!==value}}var fortiviewRouteMetadata=$injector.get("fortiviewRouteMetadata"),ADDITIONAL_TABS={source:["web-domain","web-category","web-search-phrase","interface-srcintf","interface-dstintf"],destination:["interface-srcintf","interface-dstintf"],country:["interface-srcintf","interface-dstintf"],web:function(w_type){var tabMaps={"web-search-phrase":["web-search-phrase-detail"],"web-domain":["web-category"],"web-category":["web-domain"]};return tabMaps[w_type]||[]},cloud:["cloud-user","cloud-app","files","videos"],vpn:["vpn-user"],sandbox:["sandbox-file"],wificlient:["web-domain","web-category","web-search-phrase"],interface:["interface-srcintf","interface-dstintf"],endpoint:function(w_type){var tabMaps={"endpoint-device":["endpoint-vulnerability"],"endpoint-vulnerability":["endpoint-device"]};return tabMaps[w_type]||[]}},segment=fortiviewRouteMetadata.baseSegment(!1),segment_w_type=fortiviewRouteMetadata.baseSegment(!0);return segment in ADDITIONAL_TABS?angular.isFunction(ADDITIONAL_TABS[segment])?ADDITIONAL_TABS[segment](segment_w_type):ADDITIONAL_TABS[segment].filter(not(segment_w_type)):[]},this.not_present=function(arr,prop){function pluck_prop(item){return item[prop]}var selectors=arr.map(pluck_prop);return function(column){return selectors.indexOf(column.selector)===-1}};var QTIP_CLASS="fortiview-qtip",qtipScopes=[];this.formattersCleanUp=function(){qtipScopes.forEach(function(scope){scope.$destroy()}),angular.element("."+QTIP_CLASS).remove(),qtipScopes=[]},this.processTooltips=function($scope){var QTIP_TEMPLATE_COMPONENT="qtipTemplateComponent",QTIP_DATA="objectData",QTIP_DEFAULT_CONFIG={style:{classes:QTIP_CLASS},position:{my:"bottom left",at:"top right",target:"mouse",viewport:angular.element(window),adjust:{x:14}},show:{delay:500}};angular.element(this).find("."+LAZY_TOOLTIP_CLASS).each(function(){var visible=!1,$content=angular.element("<div></div>"),$tooltip=angular.element(this);$tooltip.qtip(angular.extend({},QTIP_DEFAULT_CONFIG,{content:$content,events:{show:function(){var scope,$element,component,template;visible||(scope=$scope.$new(),qtipScopes.push(scope),scope.data=$tooltip.data(QTIP_DATA),component=$tooltip.data(QTIP_TEMPLATE_COMPONENT),template="<"+component+' data="data"></'+component+">",$element=$compile(template)(scope),$content.append($element),scope.$apply(),visible=!0)}}}))})},this.csfEnabled=function(){return csfTopology.csfEnabled};var interfaceRoleFilterValues={lan_dmz:["lan","dmz","undefined"],wan:["wan"]};this.getInterfaceRoleFilterValue=function(role){return interfaceRoleFilterValues[role]},fweb.util.objects.lockCurrentProperties(this)}function Interfaces(){var interfacesPromise,interfaceMap={};this.init=function(){return interfacesPromise||(interfacesPromise=fweb.util.firewallInterfaces.get().then(function(interfaces){interfaceMap=interfaces.mapping})),interfacesPromise},this.invalidate=function(){interfacesPromise=null,interfaceMap={}},this.get=function(){return interfaceMap}}var f_dom=fweb.util.dom,QTIP_TEMPLATE_COMPONENT="qtipTemplateComponent",QTIP_DATA="objectData";ftntModule.service("fortiviewUtil",Util),ftntModule.service("fortiviewInterfaceLookup",Interfaces)}),define("ng/fortiview_common/config",["angular","ng/ftnt","ng/services/injector","jquery","fweb.util/dom"],function(angular,ftntModule,inject){"use strict";function FortiviewConfig(injector){injector.injectMarked(this)}var FORTIVIEW_COLUMN_LANG={sessions:"Sessions",bytes:"total-bytes",event:"Event Name",packets:"total-packets",bandwidth:"Bandwidth",shaper_drops:"Dropped Bytes",srcaddr:"source",dstaddr:"destination",rcvdbyte:"received",sentbyte:"sent",rx_packets:"rcvdpkt",tx_packets:"sentpkt",address:"source",score:"Threat Score (Blocked/Allowed)",fortigate:"FortiGate",apps:"application",category:"category",risk:"fv_risk",srcintf:"srcintf",dstintf:"dstintf",policyid:"Policy",policytype:"Policy Type",srcssid:"srcssid",wifi_source:"source",shaper:"Shaper",saddr:"source",daddr:"destination",utm:"category",web_category:"Category",adminuser:"username",login_count:"Logins",videos:"Videos Played",failure_count:"Failed Logins",config_changes:"Configuration Changes",browsingtime:"Browsing Time",duration:"field_duration",files:"Files (Up/Down)",loginid_count:"Login IDs",keyword:"Search Phrases",search_count:"Frequency",unauth_src1:"user",unauth_src2:"srcip",unauth_type:"unauth_type",unauth_cat:"type",unauth_target:"dst",failure_attempt:"Failed Attempts",vpnuser:"user",connections:"Connections",last_conn_time:"Last Connection Time",tunneltype:"vpntype",data_bytes:"total-bytes",vuln_source:"source",vuln_count:"Detected Vulnerabilities",clouduser:"Cloud User",mac:"device"};FortiviewConfig.prototype.FORTIVIEW_CONFIG=inject.mark(function(fortiviewData,fortiviewUtil){var commonFortiviewFields=["bytes","sessions","bandwidth","packets","shaper_drops"],createAddressDrilldownFn=function(key){return function(row,fortigates,reportBy){var drilldown=row?encodeURIComponent(row[key])+fortigates:"";return"/fortiview/"+reportBy+"/lan_dmz/"+drilldown}},interfaceDrilldownFn=function(row,fortigates,reportBy){var drilldown=row?encodeURIComponent(row[reportBy])+fortigates:"";return"/fortiview/interface/all/"+reportBy+"/"+drilldown},COMMON_FORTIVIEW_FILTERS=[fortiviewData.FILTER.COUNTRY,fortiviewData.FILTER.SOURCE,fortiviewData.FILTER.DESTINATION,fortiviewData.FILTER.APPLICATION,fortiviewData.FILTER.DSTINTF,fortiviewData.FILTER.SRCINTF,fortiviewData.FILTER.POLICY,fortiviewData.FILTER.POLICY_TYPE,fortiviewData.FILTER.SECURITY_ACTION,fortiviewData.FILTER.SEGMENT],FORTIVIEW_CONFIG={};FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.SOURCE]={columns:["srcaddr","srcmac","score"].concat(commonFortiviewFields),drilldownToFn:createAddressDrilldownFn("srcaddr"),filters:COMMON_FORTIVIEW_FILTERS.concat([fortiviewData.FILTER.DEVICE,fortiviewData.FILTER.DEVICE_TYPE,fortiviewData.FILTER.SHAPER]),lang:"fortiview_sources"},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.DESTINATION]={columns:["dstaddr","apps"].concat(commonFortiviewFields),drilldownToFn:createAddressDrilldownFn("dstaddr"),filters:COMMON_FORTIVIEW_FILTERS,lang:"fortiview_destinations"},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.COUNTRY]={columns:["country"].concat(commonFortiviewFields),drilldownToFn:function(entry,fortigates){var drilldown=entry?encodeURIComponent(entry.country)+fortigates:"";return"/fortiview/country/lan_dmz/"+drilldown},lang:"fortiview_country",filters:COMMON_FORTIVIEW_FILTERS},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.INTFPAIR]={columns:["srcintf","dstintf"].concat(commonFortiviewFields),drilldownToFn:function(row,fortigates){var drilldown=row?row.srcintf+":"+row.dstintf+fortigates:"";return"/fortiview/interface/all/intfpair/"+drilldown},lang:"Interface Pairs",tooltipColumns:commonFortiviewFields,filters:COMMON_FORTIVIEW_FILTERS},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.SRCINTF]={columns:["srcintf"].concat(commonFortiviewFields),drilldownToFn:interfaceDrilldownFn,lang:"Source Interface",filters:COMMON_FORTIVIEW_FILTERS},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.DSTINTF]={columns:["dstintf"].concat(commonFortiviewFields),drilldownToFn:interfaceDrilldownFn,lang:"Destination Interface",filters:COMMON_FORTIVIEW_FILTERS},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.POLICY]={columns:["policyid"].concat(commonFortiviewFields),drilldownToFn:function(row,fortigates){var typeAndId=row&&fortiviewUtil.encodeDrilldownValue(row.policytype||"policy")+":"+fortiviewUtil.encodeDrilldownValue(row.policyid),drilldown=row?typeAndId+fortigates:"";return"/fortiview/policy/all/"+drilldown},lang:"fortiview_policies",filters:COMMON_FORTIVIEW_FILTERS},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.WIFICLIENT]={columns:["mac","wifi_source","srcssid","bytes","sessions"],drilldownToFn:function(entry){var drilldown=entry?encodeURIComponent(entry.mac||entry.srcip):"";return"/fortiview/wificlient/lan_dmz/"+drilldown},lang:"fortiview_wificlient",filters:[fortiviewData.FILTER.DEVICE,fortiviewData.FILTER.DEVICE_TYPE]},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.SHAPER]={columns:["shaper","bytes","sessions","bandwidth","packets","shaper_drops"],drilldownToFn:function(entry,fortigates){var drilldown=entry?encodeURIComponent(entry.shaper)+fortigates:"";return"/fortiview/shaper/lan_dmz/"+drilldown},historicalDisabled:!0,lang:"fortiview_shaper"},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.SESSIONS]={columns:["saddr","device","srcintf","daddr","dstintf","apps","bytes","policyid"],lang:"fortiview_sessions",sortByOptions:[]},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.ENDPOINT_VULNERABILITY]={columns:["vulnname","severity","vulncat","vulnid","cveid","host_count"],drilldownToFn:function(entry,fortigates){var drilldown=entry?encodeURIComponent(entry.vulnname)+fortigates:"";return"/fortiview/endpoint/all/vulnerability/"+drilldown},sortByOptions:["host_count","severity"],lang:"fortiview_endpoint"},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.ENDPOINT_DEVICE]={columns:["vuln_source","vuln_count","fctuid"],lang:"Endpoint Device",drilldownToFn:function(entry,fortigates){var drilldown=entry?encodeURIComponent(entry.fctuid)+fortigates:"";return"/fortiview/endpoint/all/device/"+drilldown},useLatest:!0},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.APPLICATION]={columns:["apps","category","risk"].concat(commonFortiviewFields),drilldownToFn:function(entry,fortigates){var app=entry&&entry.apps&&entry.apps.length&&entry.apps[0],value=app&&(app.id>0?app.id:encodeURIComponent(app.name)),drilldown=entry?value+fortigates:"";return"/fortiview/app/lan_dmz/"+drilldown},filters:COMMON_FORTIVIEW_FILTERS,lang:"fortiview_apps"},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.CLOUD_APPLICATION]={columns:["category","risk","loginid_count","files","videos"].concat(commonFortiviewFields),drilldownToFn:function(entry,fortigates){var app=entry&&entry.apps&&entry.apps.length&&entry.apps[0],value=app&&(app.id>0?app.id:encodeURIComponent(app.name)),drilldown=entry?value+fortigates:"";return"/fortiview/cloud/lan_dmz/app/"+drilldown},lang:"fortiview_cloud"
},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.CLOUD_USER]={columns:["clouduser","apps","files","videos"].concat(commonFortiviewFields),drilldownToFn:function(entry){var drilldown=entry?encodeURIComponent(entry.clouduser):"";return"/fortiview/cloud/lan_dmz/user/"+drilldown},lang:"Cloud User"},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.WEB_DOMAIN]={columns:["domain","web_category","browsingtime","score"].concat(commonFortiviewFields),drilldownToFn:function(entry,fortigates){var drilldown=entry?encodeURIComponent(entry.domain)+fortigates:"";return"/fortiview/web/lan_dmz/domain/"+drilldown},filters:[fortiviewData.FILTER.SOURCE],lang:"fortiview_web"},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.WEB_CATEGORY]={columns:["web_category","browsingtime","score"].concat(commonFortiviewFields),drilldownToFn:function(entry){var drilldown=entry?encodeURIComponent(entry.category_id):"";return"/fortiview/web/lan_dmz/category/"+drilldown},filters:[fortiviewData.FILTER.SOURCE],lang:"Web Category"},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.SEARCH_PHRASE]={columns:["keyword","search_count"],drilldownToFn:function(entry,fortigates){var drilldown=entry?encodeURIComponent(entry.keyword)+fortigates:"";return"/fortiview/web/lan_dmz/search-phrase/"+drilldown},filters:[fortiviewData.FILTER.SOURCE],lang:"Search Phrases"},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.THREATS]={columns:["threat","utm","threatlevel","score","sessions"],drilldownToFn:function(entry){var drilldown=entry?fortiviewUtil.encodeDrilldownValue(entry.utm)+":"+fortiviewUtil.encodeDrilldownValue(entry.threat):"";return"/fortiview/threat/lan_dmz/"+drilldown},filters:COMMON_FORTIVIEW_FILTERS,lang:"fortiview_threats"},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.SYSTEM_EVENTS]={columns:["event","count"],drilldownToFn:function(entry){var drilldown=entry?encodeURIComponent(entry.event):"";return"/fortiview/system/all/"+drilldown},filters:[fortiviewData.FILTER.EVENT],lang:"fortiview_system"},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.FAILED_AUTHENTICATION]={columns:["unauth_src1","unauth_src2","unauth_type","unauth_cat","unauth_target","failure_attempt"],drilldownToFn:function(entry){var drilldown=entry?fortiviewUtil.encodeDrilldownValue(entry.unauth_src1)+":"+fortiviewUtil.encodeDrilldownValue(entry.unauth_src2)+":"+fortiviewUtil.encodeDrilldownValue(entry.unauth_type)+":"+fortiviewUtil.encodeDrilldownValue(entry.unauth_target):"";return drilldown&&entry&&entry.logid&&(drilldown+=":"+fortiviewUtil.encodeDrilldownValue(entry.logid)),"/fortiview/unauth/all/"+drilldown},lang:"fortiview_unauth"},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.ADMIN_LOGIN]={columns:["adminuser","login_count","failure_count","config_changes","duration"],drilldownToFn:function(entry){var drilldown=entry?encodeURIComponent(entry.adminuser):"";return"/fortiview/admin/all/"+drilldown},lang:"fortiview_admin"},FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.VPN]={columns:["vpnuser","connections","last_conn_time","tunneltype","bytes","duration"],drilldownToFn:function(entry){var drilldown=entry?fortiviewUtil.encodeDrilldownValue(entry.vpnuser)+":"+fortiviewUtil.encodeDrilldownValue(entry.tunneltype):"";return"/fortiview/vpn/all/"+drilldown},lang:"fortiview_vpn"};var FORTIVIEW_COLUMNS=FortiviewConfig.prototype.FORTIVIEW_COLUMNS={},fvConfigColumnKeys=Object.keys(FORTIVIEW_CONFIG).reduce(function(columns,key){return columns.concat(FORTIVIEW_CONFIG[key].columns)},[]);return Object.keys(FORTIVIEW_COLUMN_LANG).concat(fvConfigColumnKeys).forEach(function(key){FORTIVIEW_COLUMNS[key]={key:key,lang:FORTIVIEW_COLUMN_LANG[key]||key}}),Object.keys(FORTIVIEW_CONFIG).forEach(function(fortiView){var lookup=function(column){return FORTIVIEW_COLUMNS[column]},fvConfig=FORTIVIEW_CONFIG[fortiView]=FORTIVIEW_CONFIG[fortiView]||{};fvConfig.columns=fvConfig.columns.map(lookup),fvConfig.tooltipColumns=fvConfig.tooltipColumns&&fvConfig.tooltipColumns.map(lookup)}),FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.CLOUD_APPLICATION].columns.unshift({key:"cloud_applications",selector:"apps",lang:"application"}),FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.ENDPOINT_DEVICE].columns.unshift({key:"vuln_device",selector:"device",lang:"device"}),FORTIVIEW_CONFIG[fortiviewData.REPORT_BY.SYSTEM_EVENTS].columns.push({key:"admin_level",lang:"level",selector:"level"}),["score","threatlevel","browsingtime"].forEach(function(columnKey){FORTIVIEW_COLUMNS[columnKey].hideIfRealtime=!0}),["packets","bandwidth","shaper_drops"].forEach(function(columnKey){FORTIVIEW_COLUMNS[columnKey].hideIfHistorical=!0}),["WIFICLIENT","WEB_DOMAIN","WEB_CATEGORY","SEARCH_PHRASE","THREATS","ENDPOINT_VULNERABILITY","SYSTEM_EVENTS","FAILED_AUTHENTICATION","ADMIN_LOGIN","VPN","CLOUD_APPLICATION","CLOUD_USER"].forEach(function(reportBy){FORTIVIEW_CONFIG[fortiviewData.REPORT_BY[reportBy]].realtimeDisabled=!0}),FORTIVIEW_CONFIG}),FortiviewConfig.prototype.getFortiviewConfig=function(fortiview){return this.FORTIVIEW_CONFIG[fortiview]},ftntModule.service("fortiviewConfig",FortiviewConfig)}),define("ng/fortiview_common/data",["angular","ng/ftnt","ng/services/injector","notify","fweb.util"],function(angular,ftntModule,inject,Notify,fweb_util){"use strict";function FortiviewData(injector){injector.injectMarked(this),this.deviceStats={},this.requestSessionMap={}}var DEFAULT_LIMIT_ENTRIES=100,FORTIVIEW_STATS_URL="/api/v2/monitor/fortiview/statistics",FORTIVIEW_CANCEL_URL="/api/v2/monitor/fortiview/session/cancel",FORTIVIEW_SESSIONS_URL="/api/v2/monitor/firewall/session";FortiviewData.prototype.DEVICE={DISK:"disk",FORTIANALYZER:"faz"},FortiviewData.prototype.REPORT_BY={DEVICE:"device",SOURCE:"source",DESTINATION:"destination",COUNTRY:"country",INTFPAIR:"intfpair",SRCINTF:"srcintf",DSTINTF:"dstintf",POLICY:"policy",WIFICLIENT:"wificlient",SHAPER:"shaper",SESSIONS:"sessions",ENDPOINT_VULNERABILITY:"endpoint-vulnerability",ENDPOINT_DEVICE:"endpoint-device",APPLICATION:"application",CLOUD_APPLICATION:"cloud-app",CLOUD_USER:"cloud-user",WEB_DOMAIN:"web-domain",WEB_CATEGORY:"web-category",SEARCH_PHRASE:"web-search-phrase",THREATS:"threat",SANDBOX_FILE:"sandbox-file",SANDBOX_SOURCE:"sandbox-source",SYSTEM_EVENTS:"system",FAILED_AUTHENTICATION:"unauth",ADMIN_LOGIN:"admin",VPN:"vpn"},FortiviewData.prototype.SORT_TO_ENTRY_MAP={data_bytes:["sentbyte","rcvdbyte"],data_packets:["tx_packets","rx_packets"],data_shaper_drops:["tx_shaper_drops","rx_shaper_drops"],data_bandwidth:["tx_bandwidth","rx_bandwidth"]},FortiviewData.prototype.SORTABLE_COLUMNS=["bytes","packets","bandwidth","shaper_drops","sessions","count","score","files","connections","login_count","failure_count","config_changes","last_conn_time","failure_attempt","search_count","vuln_count","threatlevel","browsingtime"];var FILTER=FortiviewData.prototype.FILTER={APPLICATION:"application",COUNTRY:"country",DESTINATION:"destination",DEVICE:"device",DEVICE_TYPE:"device_type",DOMAIN:"domain",DSTINTF:"dstintf",FORTIGATE:"fortigate",POLICY:"policy",POLICY_TYPE:"policy_type",SEARCH_PHRASE:"search-phrase",SECURITY_ACTION:"security_action",SHAPER:"shaper",SOURCE:"source",SRCINTF:"srcintf",SEGMENT:"segment",EVENT:"event"},FILTER_CONFIG=FortiviewData.prototype.FILTER_CONFIG={};FILTER_CONFIG[FILTER.APPLICATION]={key:"application",lang:"Application",source:"application.name",valueFunction:function(application){return application.q_origin_key}},FILTER_CONFIG[FILTER.COUNTRY]={key:"country",lang:"Country"},FILTER_CONFIG[FILTER.DEVICE]={historicalOnly:!0,key:"mac",lang:"Source Device"},FILTER_CONFIG[FILTER.DEVICE_TYPE]={historicalOnly:!0,key:"devtype",lang:"devtype"},FILTER_CONFIG[FILTER.DSTINTF]={key:"dstintf",lang:"Destination Interface"},FILTER_CONFIG[FILTER.DESTINATION]={key:"destination",lang:"Destination"},FILTER_CONFIG[FILTER.FORTIGATE]={key:"fortigate",lang:"FortiGate"},FILTER_CONFIG[FILTER.POLICY]={key:"policyid",lang:"Policy"},FILTER_CONFIG[FILTER.POLICY_TYPE]={key:"policytype",lang:"Policy Type",options:["policy","policy6","policy46","policy64","sniffer","proxy-policy","DoS-policy","DoS-policy6","local-in-policy","local-in-policy6","multicast-policy","multicast-policy6"]},FILTER_CONFIG[FILTER.SECURITY_ACTION]={historicalOnly:!0,key:"utmaction",lang:"Security Action",options:["allow","block","traffic-shape","reset"]},FILTER_CONFIG[FILTER.SRCINTF]={key:"srcintf",lang:"Source Interface"},FILTER_CONFIG[FILTER.SHAPER]={key:"shaper",lang:"Shaper",realtimeOnly:!0},FILTER_CONFIG[FILTER.SOURCE]={key:"source",lang:"Source",realtimeOnly:!0},FILTER_CONFIG[FILTER.SEGMENT]={key:"segment",lang:"Network Segment",options:[{value:"lan_dmz",lang:"fortiview_traffic_lan_dmz"},{value:"wan",lang:"fortiview_traffic_wan"}]},FILTER_CONFIG[FILTER.EVENT]={key:"event",lang:"Event Name"},FortiviewData.prototype.FILTER_CONFIG_FOR_KEY={},Object.keys(FILTER_CONFIG).forEach(function(key){var config=FILTER_CONFIG[key];FortiviewData.prototype.FILTER_CONFIG_FOR_KEY[config.key]=config}),FortiviewData.prototype.getRequestCount=function(){return DEFAULT_LIMIT_ENTRIES},FortiviewData.prototype.getDeviceForFieldName=inject.mark(function(state){return function(type,realtime){var FAZ_DISABLED_TYPES={shaper:!0},device=this.DEVICE.DISK,logDeviceState=state.getLogDeviceState(),fazEnabled=logDeviceState&&logDeviceState.fortianalyzer.is_available;return!fazEnabled||FAZ_DISABLED_TYPES[type]||realtime||(device=this.DEVICE.FORTIANALYZER),device}}),FortiviewData.prototype.get=inject.mark(function($q,$http,csfTopology,lang){return function(reportBy,filters,fortigates,time_period,count,extra_params,scope){var that=this;if(time_period=time_period||{},fortigates=fortigates&&new Set(fortigates),reportBy===this.REPORT_BY.SESSIONS)return this.getRealtimeSessions(extra_params);this.device=this.getDeviceForFieldName(reportBy,time_period.realtime);var params=angular.merge({report_by:reportBy,filter:filters,device:this.device,count:count||this.getRequestCount(),ip_version:"ipboth"},time_period,extra_params);return reportBy===this.REPORT_BY.DEVICE&&time_period.realtime&&delete params.count,csfTopology.buildIfNecessary().then(function(){var fazCsfRequest;csfTopology.csfEnabled&&(time_period.realtime?(params.filter=params.filter||{},params.filter["filter-csf"]=!0):(fazCsfRequest=that.device===that.DEVICE.FORTIANALYZER,fazCsfRequest&&(params.csf=csfTopology.groupName)));var csfPromises=csfTopology.fortigates.filter(function(fgt){return fazCsfRequest||!csfTopology.csfEnabled?fgt.isCurrent:!fortigates||fortigates.has(fgt.serial)}).map(function(fgt){return $http({method:"GET",url:fgt.createCSFURI(FORTIVIEW_STATS_URL),params:params}).then(function(response){var requestKey,session=response.data.results.sessionid;return scope&&(requestKey=scope.$id,that.requestSessionMap[requestKey]=session,scope.$on("$destroy",function(){that.requestSessionMap[requestKey]=null})),that.pollCompletion(session,params,requestKey,response)}).then(that.checkResponse,function(error){return csfPromises.length>1?void Notify.post(lang("Failed to get FortiView data from FortiGate {0}.",[fgt.serial]).toString(),"warning"):$q.reject(error)}).then(function(response){if(response&&response.data.results.details)return response.data.results.details.forEach(function(detail){detail.fortigates=detail.fortigate&&detail.fortigate.split(",")||[fgt.serial],detail.fortigate=detail.fortigates[0]||fgt.serial;var detailFortigate=csfTopology.fortigateMapping[detail.fortigate];detailFortigate&&(detail.fortigateLabel=detailFortigate.getLabel(),detail.csfPath=detailFortigate.path)}),response.data.results.summary&&(response.data.results.summary.csfPath=fgt.path,response.data.results.summary.fortigate=fgt.serial,response.data.results.summary.fortigates=[fgt.serial]),response})});return $q.all(csfPromises).then(that.processCsf).then(function(response){return that.setDeviceStats(reportBy,response.data.results.details),response})})}}),FortiviewData.prototype.pollCompletion=inject.mark(function($q,$http,$timeout){return function(session,fullParams,requestKey,response){return"error"===response.data.results.status?$q.reject({lang:"FortiAnalyzer error",details:response.data.results.error}):requestKey&&this.requestSessionMap[requestKey]!==session?($http.post(FORTIVIEW_CANCEL_URL,angular.extend({sessionid:session},fullParams)),response):null==session||null==response.data.results.percentage||100===response.data.results.percentage?response:$timeout(1e3).then(function(){return requestKey&&this.requestSessionMap[requestKey]!==session?response:$http.get(response.config.url,{params:angular.extend({device:"faz",sessionid:session},fullParams)})}.bind(this)).then(this.pollCompletion.bind(this,session,fullParams,requestKey))}}),FortiviewData.prototype.checkResponse=inject.mark(function($q){return function(response){return response.params=response.config.params,response.data.results.error?$q.reject({lang:"FortiView error",details:response.data.results.error}):response}}),FortiviewData.prototype.processCsf=inject.mark(function($q,state,fortiviewUtil){return function(results){function sessionsDetailAggregation(destination,source){var aggregatedColumns=["sessions","session_allow","session_block","sentbyte","rcvdbyte","tx_packets","rx_packets","tx_shaper_drops","rx_shaper_drops","tx_bandwidth","rx_bandwidth"];aggregatedColumns.forEach(function(column){null!=destination[column]&&null!=source[column]?destination[column]+=source[column]:null==destination[column]&&(destination[column]=source[column])}),destination.apps&&(destination.apps=destination.apps.concat((source.apps||[]).filter(function(srcApp){return destination.apps.every(function(dstApp){return srcApp.id!==dstApp.id})})))}function addressAggregateKeyFnBy(key){return function(detail){return fweb_util.ip.IpMask.isPublic(detail[key])?detail[key]:(detail.fortigate||state.serial)+"-"+detail[key]}}function processDetails(details,dataMap){details.forEach(function(detail){var detailKey=angular.isFunction(aggregateKey)?aggregateKey(detail):detail[aggregateKey],currentDetail=dataMap[detailKey];if(currentDetail){currentDetail.csfDetails?currentDetail.csfDetails.push(detail):currentDetail.csfDetails=[angular.copy(currentDetail),detail],currentDetail.fortigate!==detail.fortigate&&currentDetail.fortigates.push(detail.fortigate);var aggregateFn=config.aggregateFn||sessionsDetailAggregation;aggregateFn(currentDetail,detail)}else dataMap[detailKey]=detail})}if(results=results.filter(angular.identity),results.length<=1)return results[0]||$q.reject();var local=results[0],csfResponses=results.slice(1),params=local.config.params,fortigates=local.data.results.details.length?[local.data.serial]:[];local.data.results.summary=local.data.results.summary||{};var aggregateConfig={source:{key:addressAggregateKeyFnBy("srcaddr")},destination:{key:addressAggregateKeyFnBy("dstaddr")},intfpair:{key:function(detail){return detail.fortigate+"-"+detail.srcintf+"-"+detail.dstintf}},dstintf:!1,srcintf:!1,policy:!1,country:{key:"country_id"},application:{key:function(detail){var app=detail.apps[0];return 0===app.id?app.name+"-"+app.port+"-"+app.protocol:app.id}},"cloud-app":!1,"web-domain":{key:function(detail){return detail.category+"-"+detail.domain}},"web-category":{key:"category"},"web-search-phrase":{key:"keyword",aggregateFn:function(destination,source){destination.search_count+=source.search_count}},threat:{key:"threat"}},config=aggregateConfig[params.report_by],aggregateKey=config&&config.key;if(csfResponses.forEach(function(csfResponse){var results=csfResponse.data.results;results.summary=results.summary||{},results.details&&(results.details.length&&fortigates.push(csfResponse.data.serial),results.details.forEach(function(detail){detail.fortigate=csfResponse.data.serial,detail.fortigates=[csfResponse.data.serial]})),params.realtime||params.no_chart?angular.equals(local.data.results.summary,{})?local.data.results.summary=results.summary:sessionsDetailAggregation(local.data.results.summary,results.summary):local.data.results.summary.graph&&results.summary.graph&&(sessionsDetailAggregation(local.data.results.summary,results.summary),local.data.results.summary.graph.forEach(function(point,i){var csfPoint=results.summary.graph[i];csfPoint&&sessionsDetailAggregation(point,csfPoint)}))}),local.data.results.summary.fortigates=fortigates,local.data.results.details.forEach(function(detail){detail.fortigate=local.data.serial,detail.fortigates=[local.data.serial]}),aggregateKey){var dataMap={};processDetails(local.data.results.details,dataMap),csfResponses.forEach(function(csfResponse){csfResponse.data.results.details&&processDetails(csfResponse.data.results.details,dataMap)}),local.data.results.details=Object.keys(dataMap).map(function(key){return dataMap[key]})}else{var result=local.data.results;csfResponses.forEach(function(csfResponse){result.details=result.details.concat(csfResponse.data.results.details||[])})}var key=fortiviewUtil.server_to_client_sort_map[params.sort_by||"bytes"],valueKeys=this.SORT_TO_ENTRY_MAP[key]||[key],getValue=function(entry){var value=0;return valueKeys.forEach(function(key){value+=isNaN(entry[key])?0:entry[key]}),value},defaultAggregatedDataSortFn=function(a,b){return getValue(b)-getValue(a)},aggregatedDataSortFn=fortiviewUtil.aggregatedDataSortFnMap[key]||defaultAggregatedDataSortFn;return local.data.results.details.sort(aggregatedDataSortFn),local}}),FortiviewData.prototype.getRealtimeSessions=inject.mark(function($q,$http,lang,state,csfTopology){return function(params,fortigate){return angular.merge(params,{summary:!0,count:state.lines_per_page,"filter-csf":csfTopology.csfEnabled}),csfTopology.buildIfNecessary().then(function(){var fgt=csfTopology.fortigateMapping[fortigate]||csfTopology.thisFortigate;return $http.get(fgt.createCSFURI(FORTIVIEW_SESSIONS_URL),{params:params}).then(function(response){return this.deviceStats={},response.data.results.details&&response.data.results.details.forEach(function(detail){detail.csfPath=fgt.path,detail.fortigate=fgt.serial,detail.fortigateLabel=fgt.getLabel();var mac=detail.detection_interface===detail.dstintf?detail.dstmac:detail.srcmac;if(mac){var keys=["detection_interface","srcintf","dstintf","srcmac","dstmac","csfPath"],entry={};keys.forEach(function(k){entry[k]=detail[k]}),entry.srcaddr=detail.saddr,entry.dstaddr=detail.daddr,this.deviceStats[fgt.serial]||(this.deviceStats[fgt.serial]={}),this.deviceStats[fgt.serial][mac]=entry}}.bind(this)),response}.bind(this))}.bind(this))}}),FortiviewData.prototype.getDeviceStats=function(serial,mac){return this.deviceStats[serial]&&this.deviceStats[serial][mac]||{}},FortiviewData.prototype.setDeviceStats=function(reportBy,details){var isSource=reportBy===this.REPORT_BY.SOURCE,toServer=reportBy===this.REPORT_BY.DESTINATION,isDevice=reportBy===this.REPORT_BY.DEVICE;(isDevice||toServer||isSource)&&details.forEach(function(detail){var mac=detail.srcmac||detail.dstmac;isDevice?mac=detail.detection_interface===detail.dstintf?detail.dstmac:detail.srcmac:toServer?mac=detail.dstmac:isSource&&(mac=detail.srcmac),mac||(mac=detail.mac);var serial=detail.fortigate;"unknown-0"!==detail.srcintf&&mac&&(this.deviceStats[serial]||(this.deviceStats[serial]={}),this.deviceStats[serial][mac]=detail)}.bind(this))},ftntModule.service("fortiviewData",FortiviewData)}),define("ng/fortiview_common/visualization_config",["module","angular","ng/ftnt","jquery","fweb.util/dom","ng/services/injector","ng/services/persistent_storage","ng/filters/ftnt"],function(module,angular,ftntModule,$,dom,inject){"use strict";function Visualization(injector){injector.injectMarked(this)}var TYPES=Visualization.prototype.TYPES={TABLE:"table",BUBBLE:"bubble",BUBBLE_CLUSTER:"bubble_cluster",COUNTRY:"country",CHORD:"chord",VPN_MAP:"vpn_map"},MAP_FORMAT={};MAP_FORMAT[TYPES.COUNTRY]=!0,Visualization.prototype.TYPES_LIST=Object.keys(TYPES).map(function(key){return TYPES[key]}),Visualization.prototype.VISUALIZATION_CONFIG=inject.mark(function(lang,score,fortiviewUtil,fortiviewInterfaceLookup,iconCode){var getValue=function(entry,valueKeys){var value=0;return valueKeys.forEach(function(key){value+=isNaN(entry[key])?0:entry[key]}),value},shouldUseHostVisibilityInfo=function(entry,segment){if(!entry.device)return!1;var isDst="destination"===segment,detectionIntf=entry.detection_interface,detectedFromSrc=detectionIntf&&detectionIntf===entry.srcintf,detectedFromDst=detectionIntf&&detectionIntf===entry.dstintf;return isDst?detectedFromDst:detectedFromSrc},simpleKeyFn=function(key,segment){return function(entry,valueKeys){var name=entry[key];fortiviewUtil.csfEnabled()&&entry.fortigate&&(name=entry.fortigate+"-"+entry[key]);var codeObj;return["mac","srcaddr","dstaddr"].includes(key)&&shouldUseHostVisibilityInfo(entry,segment)&&(codeObj=iconCode.getDeviceIconCode(entry.device)),angular.extend({},entry,{name:entry.fortigate?entry.fortigate+"-"+entry[key]:entry[key],label:entry[key],value:getValue(entry,valueKeys),_segmentType:segment,iconCode:codeObj&&codeObj.unicode,iconFontFamily:codeObj&&codeObj.fontFamily})}},applicationFn=function(entry,valueKeys){var app=entry.apps[0]||{id:0},map=fortiviewUtil.get_applications().$map.id,mappedName=map[app.id]?map[app.id].name:app.id,name=app.id?mappedName:app.name;return fortiviewUtil.csfEnabled()&&entry.fortigate&&(name=entry.fortigate+name),angular.extend({},entry,{name:name,label:app.id?mappedName:app.name,value:getValue(entry,valueKeys)})},policyFn=function(entry,valueKeys){var name=entry.policyname||entry.policyid,label=name,type=lang("Firewall::policytype."+(entry.policytype||"policy"));return fortiviewUtil.csfEnabled()&&entry.fortigate&&(name=entry.fortigate+name),angular.extend({},entry,{name:name+" ("+type+")",label:label+" ("+type+")",value:getValue(entry,valueKeys)})};return{source:{supported:[TYPES.TABLE,TYPES.BUBBLE],fn:{default:simpleKeyFn("srcaddr")}},destination:{supported:[TYPES.TABLE,TYPES.BUBBLE],fn:{default:simpleKeyFn("dstaddr","destination")}},country:{supported:[TYPES.TABLE,TYPES.BUBBLE,TYPES.COUNTRY],filterFn:{country:function(entry){return"Reserved"!==entry.country}},fn:{default:function(entry,valueKeys){var shortLabel=String.fromCharCode(255&entry.country_id)+String.fromCharCode(entry.country_id>>8);return"ZZ"===shortLabel&&(shortLabel="?"),angular.extend({},entry,{name:entry.country,value:getValue(entry,valueKeys),shortLabel:shortLabel,_segmentType:"country"})}}},policy:{supported:[TYPES.TABLE,TYPES.BUBBLE],fn:{default:policyFn}},srcintf:{supported:[TYPES.TABLE,TYPES.BUBBLE],fn:{default:simpleKeyFn("srcintf")}},dstintf:{supported:[TYPES.TABLE,TYPES.BUBBLE],fn:{default:simpleKeyFn("dstintf")}},intfpair:{supported:[TYPES.TABLE,TYPES.BUBBLE,TYPES.CHORD],processFn:{chord:function(details,config,valueKeys){var intfToIntf={};details=details.map(function(detail){return config.fn.default(detail,valueKeys)}),details.forEach(function(detail){var srcintf=detail.fortigate+"-"+detail.srcintf,dstintf=detail.fortigate+"-"+detail.dstintf;intfToIntf[srcintf]=intfToIntf[srcintf]||{},intfToIntf[dstintf]=intfToIntf[dstintf]||{};var srcToDest=intfToIntf[srcintf][dstintf];if(srcToDest){var detailCopy=angular.copy(detail);detailCopy.realValue=detailCopy.value+srcToDest.realValue,detailCopy.value+=srcToDest.value,intfToIntf[srcintf][dstintf]=detailCopy}else detail.realValue=detail.value,intfToIntf[srcintf][dstintf]=detail;var destToSrc=intfToIntf[dstintf][srcintf];if(destToSrc)destToSrc.value+=detail.value;else{var reversedDetail={srcintf:srcintf,dstintf:dstintf,value:detail.value,realValue:0};intfToIntf[dstintf][srcintf]=reversedDetail}});var interfaces=details.reduce(function(interfaces,detail){return interfaces[detail.fortigate+"-"+detail.dstintf]={fortigate:detail.fortigate,intf:detail.dstintf},interfaces[detail.fortigate+"-"+detail.srcintf]={fortigate:detail.fortigate,intf:detail.srcintf},interfaces},{}),matrix=[],intfs=Object.keys(interfaces);return fortiviewUtil.csfEnabled()&&intfs.sort(function(intfKeyA,intfKeyB){return interfaces[intfKeyA].fortigate.localeCompare(interfaces[intfKeyB].fortigate)}),intfs.forEach(function(rowEntity){var row=[];intfs.forEach(function(columnEntity){var value=0;intfToIntf[rowEntity]&&intfToIntf[rowEntity][columnEntity]&&(value=intfToIntf[rowEntity][columnEntity].value||0),row.push(value)}),matrix.push(row)}),{matrix:matrix,dataMap:intfToIntf,entities:intfs.map(function(intf){return interfaces[intf].key=intf,interfaces[intf]}),entitiesExtra:fortiviewInterfaceLookup.get()}}},fn:{default:function(entry,valueKeys){var src=simpleKeyFn("srcintf")(entry,valueKeys),dst=simpleKeyFn("dstintf")(entry,valueKeys);return angular.extend({},src,{name:src.name+"-to-"+dst.name,label:src.label+"-to-"+dst.label})}}},application:{supported:[TYPES.TABLE,TYPES.BUBBLE],fn:{default:applicationFn}},threat:{supported:[TYPES.TABLE,TYPES.BUBBLE],fn:{default:function(entry,valueKeys){var key=valueKeys[0];return"threatlevel"===key&&(key="score"),simpleKeyFn("threat")(entry,[key])}},colorFn:function(name,entry){return{0:fortiviewUtil.SEVERITY.low.color,1:fortiviewUtil.SEVERITY.medium.color,2:fortiviewUtil.SEVERITY.high.color,3:fortiviewUtil.SEVERITY.critical.color}[entry.threatlevel]},strokeFn:function(name,entry){return{0:fortiviewUtil.SEVERITY.low.stroke,1:fortiviewUtil.SEVERITY.medium.stroke,2:fortiviewUtil.SEVERITY.high.stroke,3:fortiviewUtil.SEVERITY.critical.stroke}[entry.threatlevel]}},"web-category":{supported:[TYPES.TABLE,TYPES.BUBBLE],fn:{default:simpleKeyFn("category")}},"web-domain":{supported:[TYPES.TABLE,TYPES.BUBBLE],fn:{default:simpleKeyFn("domain")}},"web-search-phrase":{supported:[TYPES.TABLE,TYPES.BUBBLE],fn:{default:simpleKeyFn("keyword")}},"cloud-app":{supported:[TYPES.TABLE,TYPES.BUBBLE],fn:{default:applicationFn}},"cloud-user":{supported:[TYPES.TABLE,TYPES.BUBBLE],fn:{default:simpleKeyFn("clouduser")}},admin:{supported:[TYPES.TABLE],fn:{default:simpleKeyFn("admin")}},wificlient:{supported:[TYPES.TABLE,TYPES.BUBBLE],fn:{default:simpleKeyFn("mac")}},shaper:{supported:[TYPES.TABLE,TYPES.BUBBLE],fn:{default:simpleKeyFn("shaper")}},"endpoint-device":{supported:[TYPES.TABLE,TYPES.BUBBLE],fn:{default:simpleKeyFn("srcip")},colorFn:function(name,entry){return{low:fortiviewUtil.SEVERITY.low.color,medium:fortiviewUtil.SEVERITY.medium.color,high:fortiviewUtil.SEVERITY.high.color,critical:fortiviewUtil.SEVERITY.critical.color}[entry.severity]},strokeFn:function(name,entry){return{low:fortiviewUtil.SEVERITY.low.stroke,medium:fortiviewUtil.SEVERITY.medium.stroke,high:fortiviewUtil.SEVERITY.high.stroke,critical:fortiviewUtil.SEVERITY.critical.stroke}[entry.severity]}},"endpoint-vulnerability":{supported:[TYPES.TABLE,TYPES.BUBBLE],requiredServices:[score.$promise],fn:{default:function(entry,valueKeys){return angular.extend({},entry,{name:entry.vulnname,value:"severity"===valueKeys[0]?score.severityScore(entry):getValue(entry,valueKeys),shortLabel:entry.vulnid})}},colorFn:function(name,entry){return{low:fortiviewUtil.SEVERITY.low.color,medium:fortiviewUtil.SEVERITY.medium.color,high:fortiviewUtil.SEVERITY.high.color,critical:fortiviewUtil.SEVERITY.critical.color}[entry.severity]},strokeFn:function(name,entry){return{low:fortiviewUtil.SEVERITY.low.stroke,medium:fortiviewUtil.SEVERITY.medium.stroke,high:fortiviewUtil.SEVERITY.high.stroke,critical:fortiviewUtil.SEVERITY.critical.stroke}[entry.severity]}},vpn:{supported:[TYPES.TABLE,TYPES.VPN_MAP],widgetSupported:[TYPES.TABLE],fn:{default:simpleKeyFn("vpn")}}}}),Visualization.prototype.getValueKeys=inject.mark(function(fortiviewUtil,fortiviewData){return function(sortBy){var key=fortiviewUtil.server_to_client_sort_map[sortBy||"bytes"];return fortiviewData.SORT_TO_ENTRY_MAP[key]||[key]}}),Visualization.prototype.getVisualizationConfig=function(reportBy){return this.VISUALIZATION_CONFIG[reportBy]},Visualization.prototype.getD3Source=inject.mark(function($q){return function(details,sortBy,visualizationConfig,reqData){var promises=[];return visualizationConfig?(visualizationConfig.requiredServices&&(promises=promises.concat(visualizationConfig.requiredServices)),$q.all(promises).then(function(){return this.processSource(details,sortBy,reqData,visualizationConfig)}.bind(this))):$q.when({})}}),Visualization.prototype.processSource=function(details,sortBy,reqData,config){var supported=(config||{}).supported,result={};return supported&&supported.length&&supported.forEach(function(supportedType){var fn,dataMap,data=[],meta={},detailsLength=details.length;return config.processFn&&config.processFn[supportedType]?void(result[supportedType]=config.processFn[supportedType](details,config,this.getValueKeys(sortBy),reqData)):(config.filterFn&&config.filterFn[supportedType]&&(details=details.filter(config.filterFn[supportedType])),void(supportedType!==TYPES.TABLE&&(fn=config.fn.default,MAP_FORMAT[supportedType]&&(dataMap={}),detailsLength&&(meta.sum=0),details.forEach(function(entry){entry=fn(entry,this.getValueKeys(sortBy)),data.push(entry),dataMap&&(dataMap[entry.name]=entry),meta.sum+=entry.value,(null==meta.max||entry.value>meta.max)&&(meta.max=entry.value),(null==meta.min||entry.value<meta.min)&&(meta.min=entry.value),(null==meta.minNonZero||entry.value<meta.minNonZero)&&entry.value>0&&(meta.minNonZero=entry.value)}.bind(this)),detailsLength&&(meta.average=meta.sum/detailsLength),result[supportedType]=dataMap?dataMap:data,result[supportedType]._meta=meta)))}.bind(this)),result},Visualization.prototype.createTooltipFormatterFromQlistOptions=function(qlistOptions){var EXEMPT={rcvdbyte:!0,sentbyte:!0,rx_packets:!0,tx_packets:!0},defaultSelectorsMap=Object.create(null),defaultItems=[],otherItems=[];return qlistOptions.default_columns.forEach(function(selector){defaultSelectorsMap[selector]=!0}),qlistOptions.columns.forEach(function(column){var selector=column.selector;!column||column.hidden||EXEMPT[selector]||(defaultSelectorsMap[selector]?defaultItems:otherItems).push({selector:selector,lang:column.lang_key||selector,formatter:qlistOptions.format_fn[selector]})}),this.createTooltipFormatter(defaultItems.concat(otherItems))},Visualization.prototype.createTooltipFormatter=inject.mark(function(lang){return function(columns){var FICON_RIGHT=' <f-icon class="fa-long-arrow-right"></f-icon> ',FICON_LEFT=' <f-icon class="fa-long-arrow-left"></f-icon> ';return function(entry){var $table,$tableBody,addItem=function(entry,rowClass){return function(item){var fmt,$tr=angular.element("<tr></tr>").addClass(rowClass),$td=angular.element("<td></td>");if($td.text(lang(item.lang).toString()).appendTo($tr),$td=angular.element("<td></td>"),item.formatter){if(fmt=item.formatter($td,{selector:item.selector},entry),!fmt)return;$td.html(fmt)}else{if(fmt=entry[item.selector],!fmt)return;$td.text(fmt)}$tableBody.append($tr.append($td))}};if($table=angular.element('<table class="table bubble-tooltip slightly-condensed key-value"></table>'),$table.css("background-color","transparent"),$tableBody=angular.element("<tbody></tbody>"),entry.reversed){var $tr=angular.element("<tr></tr>"),$td=angular.element("<td></td>").html(entry.srcintf+FICON_RIGHT+entry.dstintf).css("font-weight","bold");$tableBody.append($tr.append($td)),columns.forEach(addItem(entry,"child")),$tr=angular.element("<tr></tr>"),$td=angular.element("<td></td>").html(entry.srcintf+FICON_LEFT+entry.dstintf).css("font-weight","bold"),$tableBody.append($tr.append($td)),columns.forEach(addItem(entry.reversed,"child"))}else columns.forEach(addItem(entry));return $table.append($tableBody)}}}),Visualization.prototype.createLegendValueFormatter=inject.mark(function($filter,fortiviewUtil){return function(sortBy){var MAP={bytes:$filter("bytes"),data_bytes:$filter("bytes"),bandwidth:$filter("bitsPerSecond"),data_bandwidth:$filter("bitsPerSecond")};return function(value){var fn=MAP[fortiviewUtil.server_to_client_sort_map[sortBy]];return fn?fn(value):$filter("number")(value)}}}),Visualization.prototype.createDeviceTooltipBindFn=inject.mark(function(lang){return function(d,element){var $element=angular.element(element),mac=d.srcmac;d.detection_interface===d.dstintf&&(mac=d.dstmac);var config={element:$element,mkey:mac,datasource:"fortiviewDetectedDevices",failureText:lang("No device information")};return d.csfPath&&(config.csfPath=d.csfPath),
!!mac&&dom.setupObjectTooltip(config)}}),ftntModule.service("fortiviewVisualization",Visualization)}),define("ng/fortiview_common/select_source",["angular","ng/ftnt","ng/services/injector","ftnt_shared","fweb.util/dom","fweb.util/formatters","fweb.util/avatars","select_setup","fweb.util/ip"],function(angular,ftntModule,inject,ftnt_shared,util_dom,util_formatters,util_avatars,select_setup,util_ip){"use strict";function getAddress(d){return d.detection_interface===d.dstintf?d.dstaddr:d.srcaddr}function getDetectedMac(d){return(d.detection_interface===d.dstintf?d.dstmac:d.srcmac)||d.mac}function SelectSource(injector){injector.injectMarked(this)}var TooltipKey=ftnt_shared.TooltipKey,THREAT_SCORE_TEMPLATE='<f-threat-formatter entry="$entry"></f-threat-formatter>',DEVICE_TOPOLOGY_TEMPLATE='<f-csf-tree path="$path" device-entry="$entry"></f-csf-tree>',THREAT_LEVEL_MAP={low:1,medium:2,high:3,critical:4};SelectSource.prototype={updateFortiviewDestinationOmniselectSource:inject.mark(function(lang){var translate=function(key){return lang(key).toString()};return function(){var sourceID="fortiviewDestination",fvDst=Omniselect.prototype.SOURCES[sourceID];fvDst&&(fvDst.tooltipKeys.sessions=new TooltipKey(translate("sessions"),function(entry){return"session_allow"in entry?util_dom.create_compare_bar_on_tooltip(entry,{keys:["session_block","session_allow"],format_fn:function(summed){return summed},colors:util_dom.COMPARE_BAR.COLOR_SETTINGS.BLOCKED_ALLOWED}):"sessions"in entry?entry.sessions||0:void 0}),fvDst.tooltipKeys.data_bytes=new TooltipKey(translate("total-bytes"),function(entry){return util_dom.create_compare_bar_on_tooltip(entry,{keys:["sentbyte","rcvdbyte"]})}),fvDst.tooltipKeys.data_bandwidth=new TooltipKey(translate("Bandwidth"),function(entry){return util_dom.create_compare_bar_on_tooltip(entry,{keys:["tx_bandwidth","rx_bandwidth"],format_fn:util_formatters.metric_bits_per_second})}),fvDst.tooltipKeys.data_packets=new TooltipKey(translate("total-packets"),function(entry){return util_dom.create_compare_bar_on_tooltip(entry,{keys:["tx_packets","rx_packets"]})}),fvDst.tooltipKeys.data_shaper_drops=new TooltipKey(translate("Dropped Bytes"),function(entry){return util_dom.create_compare_bar_on_tooltip(entry,{keys:["tx_shaper_drops","rx_shaper_drops"]})}))}}),updateFortiviewDeviceOmniselectSource:inject.mark(function($compile,$rootScope,lang,state,csfTopology,fortiviewData){var translate=function(key){return lang(key).toString()};return function(){function getSerial(select){var sn,source=select.getSource(sourceID),csfPath=source&&source.csfPath;if(csfPath){var paths=csfPath.split(":");paths.length>=2&&(sn=paths[paths.length-1])}return sn||state.serial}var sourceID="fortiviewDetectedDevices",fvDevices=Omniselect.prototype.SOURCES[sourceID];if(fvDevices||(select_setup.createExtensionSource("detectedDevices",sourceID,{onSourceDestroy:function(sourceLifeCycleData){Object.keys(sourceLifeCycleData).forEach(function(scopeKey){sourceLifeCycleData[scopeKey].$destroy()})}}),fvDevices=Omniselect.prototype.SOURCES[sourceID]),fvDevices){fvDevices.tooltipHeaderFormatFunction=function(device,sourceID){var authuser,sn=getSerial(this),fvEntry=fortiviewData.getDeviceStats(sn,device.mac),source=this.getSource(sourceID),csfPath=source&&source.csfPath;authuser="auth"===fvEntry.username_source&&fvEntry.username?fvEntry.username:fvEntry.authuser||device.authuser;var unauthuser=fvEntry.unauthuser||device.unauthuser,unauthusersource=fvEntry.unauthusersource||device.unauthusersource,uid=fvEntry.fctuid||device.forticlient&&device.forticlient.uid,addr=device.addr,fvAddr=getAddress(fvEntry);if(addr){if(fvAddr){var fvIpNumber=util_ip.IpMask.toNumber(fvAddr),devIpNumber=util_ip.IpMask.toNumber(addr);fvIpNumber!==devIpNumber&&(addr=fvAddr+", "+addr+" (NAT)")}}else addr=fvAddr;var alias=fvEntry.master_alias||fvEntry.alias||device["master-device"]||device.alias;return util_avatars.headerFormatFn({user:authuser,unauthuser:unauthuser,uid:uid,unauthusersource:unauthusersource,alias:alias,display_mode:"large",addr:addr,csfPath:csfPath})};var isExtraKey=!0;fvDevices.searchKeys.addr=fvDevices.searchKeys.address=function(device,searchString,searchRegex){var sn=getSerial(this),entry=fortiviewData.getDeviceStats(sn,device.mac),addr=device.addr,fvAddr=getAddress(entry);if(addr){if(fvAddr){var fvIpNumber=util_ip.IpMask.toNumber(fvAddr),devIpNumber=util_ip.IpMask.toNumber(addr);fvIpNumber!==devIpNumber&&(addr=fvAddr+", "+addr+" (NAT)")}}else addr=fvAddr;if(addr)return searchRegex.test(addr)},fvDevices.searchKeys.authuser=fvDevices.searchKeys.unauthuser=fvDevices.searchKeys.username=function(device,searchString,searchRegex){var sn=getSerial(this),entry=fortiviewData.getDeviceStats(sn,device.mac),user=device.username||device.authuser||device.unauthuser||entry.username||entry.authuser||entry.unauthuser;if(user)return searchRegex.test(user)},fvDevices.tooltipKeys.interface=new TooltipKey(translate("Interface"),function(device){if(!device.online_interfaces&&device.interface){var meta=this.getSourceMetaData("devices"),intf=meta.mapping&&meta.mapping[device.interface],html="";intf&&(html=Omniselect.formatEntry(intf,"firewallInterfaces"));var sn=getSerial(this),entry=fortiviewData.getDeviceStats(sn,device.mac),extra="";if(entry){var fapId=entry.fortiap_id,ssidName=entry.fortiap_ssid,behindFap=fapId&&ssidName,fswId=entry.fortilink_switch_id,fswPort=entry.fortilink_port_id,behindFsw=fswId&&fswPort,fswStr="";behindFsw&&(fswStr='<span><f-icon class="ftnt-fortiswitch"></f-icon><span>'+fswId+": port"+fswPort+"</span></span>");var fapStr="";behindFap&&(fapStr='<span><f-icon class="ftnt-fortiap"></f-icon><span>'+fapId+": "+ssidName+"</span></span>"),behindFsw&&behindFap?extra="<br>("+fswStr+")<br>("+fapStr+")":behindFsw&&(extra=" ("+fswStr+")")}return html+extra}}),fvDevices.tooltipKeys.topology=new TooltipKey(translate("Topology"),function(device){if(!state.vdom_mode&&device.mac){var sn=getSerial(this),entry=fortiviewData.getDeviceStats(sn,device.mac),mac=getDetectedMac(entry);if(mac===device.mac){var source=this.getSource(sourceID),csfPath=source&&source.csfPath||state.serial,element=document.createElement("div"),lifeCycleData=this.getSourceLifeCycleData(sourceID),uniquePath=csfPath+device.mac,scope=lifeCycleData[uniquePath];return scope||(scope=lifeCycleData[uniquePath]=$rootScope.$new(!0)),scope.$path=csfPath,scope.$entry=device,element.innerHTML=DEVICE_TOPOLOGY_TEMPLATE,$compile(element)(scope),scope.$digest(),element}}},function(device){return!state.vdom_mode&&device.mac},isExtraKey),fvDevices.tooltipKeys.sessions=new TooltipKey(translate("sessions"),function(device){var sn=getSerial(this),entry=fortiviewData.getDeviceStats(sn,device.mac);return"session_allow"in entry?util_dom.create_compare_bar_on_tooltip(entry,{keys:["session_block","session_allow"],format_fn:function(summed){return summed},colors:util_dom.COMPARE_BAR.COLOR_SETTINGS.BLOCKED_ALLOWED}):"sessions"in entry?entry.sessions||0:void 0},null,isExtraKey),fvDevices.tooltipKeys.data_bytes=new TooltipKey(translate("total-bytes"),function(device){var sn=getSerial(this),entry=fortiviewData.getDeviceStats(sn,device.mac);return util_dom.create_compare_bar_on_tooltip(entry,{keys:["sentbyte","rcvdbyte"]})},null,isExtraKey),fvDevices.tooltipKeys.data_bandwidth=new TooltipKey(translate("Bandwidth"),function(device){var sn=getSerial(this),entry=fortiviewData.getDeviceStats(sn,device.mac);return util_dom.create_compare_bar_on_tooltip(entry,{keys:["tx_bandwidth","rx_bandwidth"],format_fn:util_formatters.metric_bits_per_second})},null,isExtraKey),fvDevices.tooltipKeys.data_packets=new TooltipKey(translate("total-packets"),function(device){var sn=getSerial(this),entry=fortiviewData.getDeviceStats(sn,device.mac);return util_dom.create_compare_bar_on_tooltip(entry,{keys:["tx_packets","rx_packets"]})},null,isExtraKey),fvDevices.tooltipKeys.threats=new TooltipKey(translate("Threat Score"),function(device){if(device.mac){var sn=getSerial(this),entry=fortiviewData.getDeviceStats(sn,device.mac),element=document.createElement("div"),lifeCycleData=this.getSourceLifeCycleData(sourceID),mac=device.mac,scope=lifeCycleData[mac];return scope||(scope=lifeCycleData[mac]=$rootScope.$new(!0)),scope.$entry=entry,"string"==typeof entry.threatlevel&&(scope.$entry.threatlevel=THREAT_LEVEL_MAP[entry.threatlevel]),element.innerHTML=THREAT_SCORE_TEMPLATE,$compile(element)(scope),scope.$digest(),element}},function(device){var sn=getSerial(this),entry=fortiviewData.getDeviceStats(sn,device.mac);return entry&&entry.score>0},isExtraKey)}csfTopology.buildIfNecessary().then(function(){csfTopology.addOmniselectProxySources(sourceID)})}})},ftntModule.service("fortiviewSelectSource",SelectSource)}),define("ng/services/score",["ng/ftnt"],function(ftntModule){"use strict";function Score(CMDB,state){var promise=new Promise(function(resolve){if(state.featureEnabled("gui-threat-weight")){var cmdb=new CMDB("log","threat-weight",{prune:!0}),settings=cmdb.fetch({format:LOG_THREAT_WEIGHT_CMDB_FORMAT});settings.$promise.then(function(){resolve("enable"===settings.status?settings.level:DEFAULT_WEIGHT)},function(){resolve(DEFAULT_WEIGHT)})}else resolve(DEFAULT_WEIGHT)});this.$promise=promise.then(function(weight){return this.WEIGHT=weight,this}.bind(this))}var DEFAULT_WEIGHT={low:5,medium:10,high:30,critical:50},LOG_THREAT_WEIGHT_CMDB_FORMAT="status|level";Score.prototype={vulnerabilityScore:function(entry){var score=0;return Object.keys(this.WEIGHT).forEach(function(level){var key="vuln_count_"+level;entry[key]&&(score+=entry[key]*this.WEIGHT[level])}.bind(this)),score},severityScore:function(entry){var value=entry.severity;return this.WEIGHT[value]}},ftntModule.service("score",Score)}),define("ng/app",["angular","jquery","fweb","notify","text!ng/router/route_config.json","ftnt_shared","closure-ipaddress","select_setup","select_setup_device","mutable_setup","slide_setup","ng/admin/password/f-password-change","ng/templates","ng/fortiview/scripts/services/util","ng/fortiview_common/config","ng/fortiview_common/data","ng/fortiview_common/visualization_config","ng/fortiview_common/select_source","ng/services/loader","ng/services/cmdb","ng/services/csf_topology","ng/services/interceptor","ng/services/ftnt_copy","ng/services/ftnt_route","ng/services/persistent_storage","ng/services/injector","ng/services/ip-location-service","ng/services/reboot","ng/services/route","ng/services/score","ng/services/slide-bridge","ng/services/state","ng/services/password","ng/services/ensure_dcsrf","ng/services/vdom_state","ng/services/volatile_storage","ng/services/license/license","ng/services/registration","ng/system/csf/f-csf-extension-devices-info","ng/system/vdom/resources/f-vdom-resources","ng/directives/qlist","ng/directives/f-equal-width","ng/directives/f-list","ng/directives/f-object-formatted","ng/directives/f-object-tooltip","ng/directives/f-system-power","ng/directives/f-csf-tree","ng/directives/f-time-format","ng/directives/head","ng/directives/ftnt","ng/directives/menu/menu_items","ng/directives/menu/templates","ng/directives/registration/f-registration","ng/filters/ftnt","ng/notification/notification","ng/notification/notification_requests","ng/structure/controllers","ng/structure/directives/f-disconnection-notice","ng/structure/directives/f-embedded-iframe","ng/structure/directives/f-firmware-upgrade","ng/structure/directives/f-shortcuts-help","ng/structure/directives/f-fullscreen-toggle","ng/structure/directives/navbar","ng/structure/services/admin_timeout","ng/structure/services/connection","ng/structure/services/firmware_upgrade","ng/structure/services/help","ng/structure/services/navbar","ng/structure/services/navbar_favorites","ng/structure/services/structure","ng/structure/services/shortcuts","ng/structure/services/usb_disk","ng/structure/templates","ng/prompt/controllers","ng/prompt/reboot/system-reboot","ng/prompt/shutdown/system-shutdown","ng/prompt/services"],function(angular,$,fweb,notify,routeConfig,ftnt_shared){"use strict";var app=angular.module("app",["ngRoute","ngSanitize","ngCookies","ngResource","route-segment","view-segment","ftnt","fortiview","ui.jq","ui.event","ui.mask","ui.validate","ui.sortable","ftnt-gui"]);return app.controller("QlistCustomMenuItems",function(){}),app.config(function($locationProvider,$httpProvider,fosRouteProvider,loaderProvider,structureProvider,$compileProvider){$compileProvider.debugInfoEnabled(fweb.BUILD.CONFIG.CONFIG_DEBUG);var TEMPLATES={legacy_base:loaderProvider.base_path("/ng/templates/base.html"),legacy_base_prompt:loaderProvider.base_path("/ng/templates/base_prompt.html"),legacy_base_dialog:loaderProvider.base_path("/ng/templates/base_dialog.html"),legacy_base_list:loaderProvider.base_path("/ng/templates/base_list.html")};$locationProvider.html5Mode(!0),$httpProvider.interceptors.push("ftntInterceptor");var routes=angular.fromJson(routeConfig);routes.configs.forEach(function(route){Object.keys(TEMPLATES).forEach(function(key){route.config[key]&&(route.config.templateUrl=TEMPLATES[key])}),route.config.loader_resolve&&(route.config.resolve=loaderProvider.resolve(route.config.loader_resolve)),fosRouteProvider.when(route.url,route.config)}),fosRouteProvider.when(structureProvider.EMBEDDED_URI_ROUTE+"/:iframeSource*",{template:"<f-embedded-iframe></f-embedded-iframe>"}).otherwise(structureProvider.ngURI("/p/error/404/"))}).run(function($rootScope,$location,fosRoute,fDialogConfig,fFieldConfig,lang,structure,csfTopology,$injector){$injector.get("slideBridge"),fosRoute.enablePermissionCache(),csfTopology.addCSFOmniselectSources(),fDialogConfig.setDefaults({dialogTitle:"Title",onCancel:function(){fweb.util.location.go_back()},buttonText:{ok:lang("ok").toString(),cancel:lang("Cancel").toString(),apply:lang("Apply").toString(),return:lang("Return").toString(),close:lang("close").toString()}}),fFieldConfig.addErrorTranslations({required:"err_required",f_is_unique:-15,f_password_policy:-49,f_ipv4_address:"err_ip4",f_ipv6_address:"err_ip6",f_ipmask:"err_netmask",f_subnet_list:"err_subnet_list",f_combined_field:"err_ip_range",f_min_length:"err_min_str_length",f_mac_address:"invalid_mac",f_max_length:"err_max_str_length",f_length:"err_str_length",f_one_required:"One of these fields are required",max:"err_max_value",min:"err_min_value",email:"Invalid Email",f_value_confirm:"Doesn't Match"}),fFieldConfig.setForceValidationMessageName("validation-msg_show");var routeDefaults=function(){fDialogConfig.setDefaults({readOnly:$rootScope.ADMIN_RO}),delete $rootScope.page_title,$rootScope.dialogFooterType="okCancel",$rootScope.hide_footer_button=!1},resetSlides=function(){top===window&&(Sliderin.closeAll(!0),Sliderin.updateTarget())};$rootScope.$on("$locationChangeSuccess",function(){fweb.util.location.clear_cache(),fweb.util.cmdb.update_history_from_cookie(),fweb.util.cmdb.notify_cmdb_edits(),structure.responsiveMenu=!1,resetSlides(),notify.clearAll(),structure.isEmbeddedURI($location.path())?structure.notifyMessagesQueuedForIframe=!0:fweb.util.location.notify_queued_notifications()}),$rootScope.$on("$routeChangeSuccess",function(){routeDefaults(),resetSlides(),ftnt_shared.Tooltip.cleanupElementTooltips(),$(".qtip:not(.f-qtip)").remove(),Omniselect.invalidateCache()}),routeDefaults(),top===window&&(fweb.util.shortcuts.listen(document),fweb.util.browser.startResponsiveListener())}),app.run(function($rootScope,$routeSegment){$rootScope.$routeIsSegment=!1,$rootScope.$on("$routeChangeSuccess",function(event,current,previous){var segmentsOn=!1,segmentsOff=!1,inPrev=!1,inCurrent=!1;null!=previous&&(inPrev="segment"in(previous.$route||previous.$$route||{})),null!=current&&(inCurrent="segment"in(current.$route||current.$$route||{})),$rootScope.$routeIsSegment=inCurrent,segmentsOff=inPrev&&!inCurrent,segmentsOn=inCurrent&&!inPrev,null!=previous&&(segmentsOff||segmentsOn)&&$rootScope.$broadcast("routeSegmentChange",{index:0,segment:segmentsOff?null:$routeSegment.chain[0]})})}),app}),define("ng/fortiview/scripts/main",["angular","ng/services/loader","module"],function(angular,loader,module){"use strict";var CSS=["/ng/log/view/main.css","/module_css/widget.css","/ng/directives/faceted_search/faceted_search.css","/p/sprite/app_logos/sprite_map.css","/module_css/utm/appctrl/sensor.css","/module_css/top_sessions.css","/ng/fortiview/styles/main.css","/ng/report/audit/main.css"],fortiview=angular.module("fortiview",["ngRoute","ngSanitize","ngCookies","ngResource","route-segment","view-segment","ftnt","ui.jq","ui.event","ui.mask","ui.validate"]);return fortiview.config(function($routeSegmentProvider,$routeProvider,$injector,loaderProvider){var drilldown_template="fortiview/views/drilldown.html",main_template="fortiview/views/main.html",ctap_template="fortiview/views/ctap_main.html";$routeSegmentProvider.options.autoLoadTemplates=!0,$routeSegmentProvider.when("/fortiview/web/:role_type","fortiview.web_redirect").when("/fortiview/cloud/:role_type","fortiview.cloud_redirect").when("/fortiview/sandbox/:role_type","fortiview.sandbox_redirect").when("/fortiview/interface/:role_type","fortiview.interface_redirect").when("/fortiview/device/:role_type","fortiview.device_redirect").when("/fortiview/endpoint/:role_type","fortiview.endpoint_redirect").when("/fortiview/source/:role_type","fortiview.source").when("/fortiview/source/:role_type/:drilldownValue/:tab?","fortiview.sourceDrilldown").when("/fortiview/destination/:role_type","fortiview.destination").when("/fortiview/destination/:role_type/:drilldownValue","fortiview.destinationDrilldown").when("/fortiview/country/:role_type","fortiview.country").when("/fortiview/country/:role_type/:drilldownValue","fortiview.countryDrilldown").when("/fortiview/policy/:role_type","fortiview.policy").when("/fortiview/policy/:role_type/:drilldownValue","fortiview.policyDrilldown").when("/fortiview/interface/:role_type/:type","fortiview.interface").when("/fortiview/interface/:role_type/:type/:drilldownValue","fortiview.interfaceDrilldown").when("/fortiview/app/:role_type","fortiview.application").when("/fortiview/app/:role_type/:drilldownValue","fortiview.applicationDrilldown").when("/fortiview/web/:role_type/:type","fortiview.web").when("/fortiview/web/:role_type/:type/:drilldownValue","fortiview.websiteDrilldown").when("/fortiview/cloud/:role_type/:type","fortiview.cloud").when("/fortiview/cloud/:role_type/:type/:drilldownValue","fortiview.cloudDrilldown").when("/fortiview/threat/:role_type","fortiview.threat").when("/fortiview/threat/:role_type/:drilldownValue","fortiview.threatDrilldown").when("/fortiview/endpoint/:role_type/:type","fortiview.endpoint").when("/fortiview/endpoint/:role_type/:type/:drilldownValue","fortiview.endpointDrilldown").when("/fortiview/unauth/:role_type","fortiview.unauth").when("/fortiview/unauth/:role_type/:drilldownValue","fortiview.unauthDrilldown").when("/fortiview/system/:role_type","fortiview.system").when("/fortiview/system/:role_type/:drilldownValue","fortiview.systemDrilldown").when("/fortiview/admin/:role_type","fortiview.admin").when("/fortiview/admin/:role_type/:drilldownValue","fortiview.adminDrilldown").when("/fortiview/vpn/:role_type","fortiview.vpn").when("/fortiview/vpn/:role_type/:drilldownValue","fortiview.vpnDrilldown").when("/fortiview/sandbox/:role_type/:type/:drilldownValue/:checksum","sandboxFileDetails").when("/fortiview/sandbox/:role_type/file/:checksum","sandboxFileDetails").when("/fortiview/sandbox/:role_type/:type","fortiview.sandbox").when("/fortiview/sandbox/:role_type/:type/:drilldownValue","fortiview.sandboxDrilldown").when("/fortiview/wificlient/:role_type","fortiview.wificlient").when("/fortiview/wificlient/:role_type/:drilldownValue","fortiview.wificlientDrilldown").when("/fortiview/:segment/:role_type/:type/:drilldownValue/:tab/:drilldownTabValue","fortiview.sessionDrilldown").when("/fortiview/:segment/:role_type/:drilldownValue/:tab/:drilldownTabValue","fortiview.sessionDrilldown").when("/fortiview/session/:role_type","fortiview.session").when("/fortiview/device/:type/:role_type","fortiview.device").when("/fortiview/shaper/:role_type","fortiview.shaper").when("/fortiview/shaper/:role_type/:drilldownValue","fortiview.shaperDrilldown").when("/fortiview/learning_report","fortiview.learningReport").segment("sandboxFileDetails",{templateUrl:"fortiview/views/sandboxFileDetails.html",css:CSS,controller:"FortiviewSandboxFileDetails",resolve:loaderProvider.resolve(["controllers/sandboxFileDetails"],module)}).segment("fortiview",{templateUrl:"fortiview/views/root.html",css:CSS,controller:"Fortiview",resolve:loaderProvider.resolve(["controllers/root"],module)}).within().segment("session",{templateUrl:main_template,controller:"FortiviewSessions",dependencies:["role_type"],resolve:loaderProvider.resolve(["controllers/session"],module)}).segment("sessionDrilldown",{templateUrl:main_template,controller:"FortiviewSessions",dependencies:["role_type"],resolve:loaderProvider.resolve(["controllers/session"],module)}).segment("device_redirect",{template:"",controller:"FortiviewDeviceRedirect",dependencies:["role_type"],resolve:loaderProvider.resolve(["controllers/device"],module)}).segment("device",{templateUrl:main_template,controller:"FortiviewDevice",dependencies:["role_type","type"],resolve:loaderProvider.resolve(["controllers/device"],module)}).segment("learningReport",{templateUrl:ctap_template,controller:"FortiviewLearningReport",resolve:loaderProvider.resolve(["controllers/learningReport"],module)}).segment("shaper",{templateUrl:main_template,controller:"FortiviewShaper",dependencies:["role_type"],resolve:loaderProvider.resolve(["controllers/shaper"],module)}).segment("shaperDrilldown",{templateUrl:drilldown_template,controller:"FortiviewShaperDrilldown",dependencies:["role_type","drilldownValue"],resolve:loaderProvider.resolve(["controllers/shaperDrilldown"],module),untilResolved:{template:"Loading..."}}).segment("source",{templateUrl:main_template,dependencies:["role_type"],controller:"FortiviewSource",resolve:loaderProvider.resolve(["controllers/source"],module)}).segment("sourceDrilldown",{templateUrl:drilldown_template,controller:"FortiviewSourceDrilldown",dependencies:["role_type","drilldownValue"],resolve:loaderProvider.resolve(["controllers/sourceDrilldown"],module),untilResolved:{template:'{{ "Loading..." | lang }}'}}).segment("destination",{templateUrl:main_template,dependencies:["role_type"],controller:"FortiviewDestination",resolve:loaderProvider.resolve(["controllers/destination"],module)}).segment("destinationDrilldown",{templateUrl:drilldown_template,controller:"FortiviewDestinationDrilldown",dependencies:["role_type","drilldownValue"],resolve:loaderProvider.resolve(["controllers/destinationDrilldown"],module),untilResolved:{template:"Loading..."}}).segment("country",{templateUrl:main_template,dependencies:["role_type"],controller:"FortiviewCountry",resolve:loaderProvider.resolve(["controllers/country"],module)}).segment("countryDrilldown",{templateUrl:drilldown_template,controller:"FortiviewCountryDrilldown",dependencies:["role_type","drilldownValue"],resolve:loaderProvider.resolve(["controllers/countryDrilldown"],module),untilResolved:{template:"Loading..."}}).segment("policy",{templateUrl:main_template,controller:"FortiviewPolicy",dependencies:["role_type"],resolve:loaderProvider.resolve(["controllers/policy"],module)}).segment("policyDrilldown",{templateUrl:drilldown_template,controller:"FortiviewPolicyDrilldown",dependencies:["role_type","drilldownValue"],resolve:loaderProvider.resolve(["controllers/policyDrilldown"],module),untilResolved:{template:"Loading..."}}).segment("interface_redirect",{template:"",controller:"FortiviewInterfaceRedirect",dependencies:["role_type"],resolve:loaderProvider.resolve(["controllers/interface"],module)}).segment("interface",{templateUrl:main_template,controller:"FortiviewInterface",dependencies:["role_type","type"],resolve:loaderProvider.resolve(["controllers/interface"],module)}).segment("interfaceDrilldown",{templateUrl:drilldown_template,controller:"FortiviewInterfaceDrilldown",dependencies:["role_type","type","drilldownValue"],resolve:loaderProvider.resolve(["controllers/interfaceDrilldown"],module)}).segment("application",{templateUrl:main_template,controller:"FortiviewApplication",dependencies:["role_type"],resolve:loaderProvider.resolve(["controllers/application"],module)}).segment("applicationDrilldown",{templateUrl:drilldown_template,controller:"FortiviewApplicationDrilldown",dependencies:["role_type","drilldownValue"],resolve:loaderProvider.resolve(["controllers/applicationDrilldown"],module),untilResolved:{template:"Loading..."}}).segment("threat",{templateUrl:main_template,controller:"FortiviewThreat",dependencies:["role_type"],resolve:loaderProvider.resolve(["controllers/threat"],module)}).segment("threatDrilldown",{templateUrl:drilldown_template,controller:"FortiviewThreatDrilldown",dependencies:["role_type","drilldownValue"],resolve:loaderProvider.resolve(["controllers/threatDrilldown"],module)}).segment("endpoint_redirect",{template:"",controller:"FortiviewEndpointRedirect",dependencies:["role_type"],resolve:loaderProvider.resolve(["controllers/endpoint"],module)}).segment("endpoint",{templateUrl:main_template,controller:"FortiviewEndpoint",dependencies:["role_type","type"],resolve:loaderProvider.resolve(["controllers/endpoint"],module)}).segment("endpointDrilldown",{templateUrl:drilldown_template,controller:"FortiviewEndpointDrilldown",dependencies:["role_type","type","drilldownValue"],resolve:loaderProvider.resolve(["controllers/endpointDrilldown"],module)}).segment("web_redirect",{template:"",controller:"FortiviewWebsiteRedirect",dependencies:["role_type"],resolve:loaderProvider.resolve(["controllers/website"],module)}).segment("web",{templateUrl:main_template,controller:"FortiviewWebsite",dependencies:["role_type","type"],resolve:loaderProvider.resolve(["controllers/website"],module)}).segment("websiteDrilldown",{templateUrl:drilldown_template,controller:"FortiviewWebsiteDrilldown",dependencies:["role_type","type","drilldownValue"],resolve:loaderProvider.resolve(["controllers/websiteDrilldown"],module)}).segment("cloud_redirect",{template:"",controller:"FortiviewCloudRedirect",dependencies:["role_type"],resolve:loaderProvider.resolve(["controllers/cloud"],module)}).segment("cloud",{templateUrl:main_template,controller:"FortiviewCloud",dependencies:["role_type","type"],resolve:loaderProvider.resolve(["controllers/cloud"],module)}).segment("cloudDrilldown",{templateUrl:drilldown_template,controller:"FortiviewCloudDrilldown",dependencies:["role_type","type","drilldownValue"],resolve:loaderProvider.resolve(["controllers/cloudDrilldown"],module)}).segment("system",{templateUrl:main_template,controller:"FortiviewSystem",dependencies:["role_type"],resolve:loaderProvider.resolve(["controllers/system"],module)}).segment("systemDrilldown",{templateUrl:drilldown_template,controller:"FortiviewSystemDrilldown",dependencies:["role_type","drilldownValue"],resolve:loaderProvider.resolve(["controllers/systemDrilldown"],module)}).segment("admin",{templateUrl:main_template,controller:"FortiviewAdmin",dependencies:["role_type"],resolve:loaderProvider.resolve(["controllers/admin"],module)}).segment("adminDrilldown",{templateUrl:drilldown_template,controller:"FortiviewAdminDrilldown",dependencies:["role_type","drilldownValue"],resolve:loaderProvider.resolve(["controllers/adminDrilldown"],module)}).segment("vpn",{templateUrl:main_template,controller:"FortiviewVpn",css:["/ng/vpn/map/vpn-map.css"],dependencies:["role_type"],resolve:loaderProvider.resolve(["controllers/vpn"],module)}).segment("vpnDrilldown",{templateUrl:drilldown_template,controller:"FortiviewVpnDrilldown",dependencies:["role_type","drilldownValue"],resolve:loaderProvider.resolve(["controllers/vpnDrilldown"],module)}).segment("unauth",{templateUrl:main_template,controller:"FortiviewUnauth",dependencies:["role_type"],resolve:loaderProvider.resolve(["controllers/unauth"],module)}).segment("unauthDrilldown",{templateUrl:drilldown_template,controller:"FortiviewUnauthDrilldown",dependencies:["role_type","drilldownValue"],resolve:loaderProvider.resolve(["controllers/unauthDrilldown"],module)}).segment("sandbox_redirect",{template:"",controller:"FortiviewSandboxRedirect",dependencies:["role_type"],resolve:loaderProvider.resolve(["controllers/sandbox"],module)}).segment("sandbox",{templateUrl:main_template,controller:"FortiviewSandbox",dependencies:["role_type","type"],resolve:loaderProvider.resolve(["controllers/sandbox"],module)}).segment("sandboxDrilldown",{templateUrl:drilldown_template,controller:"FortiviewSandboxDrilldown",dependencies:["role_type","drilldownValue"],resolve:loaderProvider.resolve(["controllers/sandboxDrilldown"],module)}).segment("wificlient",{templateUrl:main_template,controller:"FortiviewWifiClient",dependencies:["role_type"],resolve:loaderProvider.resolve(["controllers/wifiClient"],module)}).segment("wificlientDrilldown",{templateUrl:drilldown_template,controller:"FortiviewWifiClientDrilldown",dependencies:["role_type","drilldownValue"],resolve:loaderProvider.resolve(["controllers/wifiClientDrilldown"],module),untilResolved:{template:"Loading..."}})}),fortiview.config(function($httpProvider){$httpProvider.interceptors.push("templateUrlInterceptor")}),fortiview.factory("templateUrlInterceptor",function(){var GUI_NO;return"undefined"!=typeof fweb&&(GUI_NO=fweb.CONFIG_GUI_NO),{request:function(config){return GUI_NO&&/^fortiview\/views\/.*.html$/.test(config.url)&&(config.url="/"+GUI_NO+"/ng/"+config.url),config}}}),fortiview});